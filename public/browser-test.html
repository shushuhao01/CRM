<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµè§ˆå™¨ç¯å¢ƒæµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .test-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 10px 0;
            backdrop-filter: blur(10px);
        }
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }
        .status {
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
            margin: 5px;
        }
        .success { background: #4CAF50; }
        .error { background: #f44336; }
        .warning { background: #ff9800; }
        #apiTest { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ” æµè§ˆå™¨ç¯å¢ƒå¯¹æ¯”æµ‹è¯•</h1>
    
    <div class="test-card">
        <h2>ğŸ“Š æµè§ˆå™¨ä¿¡æ¯</h2>
        <div class="info-grid">
            <div><strong>ç”¨æˆ·ä»£ç†:</strong> <span id="userAgent"></span></div>
            <div><strong>æµè§ˆå™¨:</strong> <span id="browser"></span></div>
            <div><strong>ç‰ˆæœ¬:</strong> <span id="version"></span></div>
            <div><strong>å¹³å°:</strong> <span id="platform"></span></div>
            <div><strong>è¯­è¨€:</strong> <span id="language"></span></div>
            <div><strong>æ—¶åŒº:</strong> <span id="timezone"></span></div>
        </div>
    </div>

    <div class="test-card">
        <h2>ğŸŒ ç½‘ç»œè¿æ¥æµ‹è¯•</h2>
        <div id="networkTest">
            <div>æµ‹è¯•ä¸­...</div>
        </div>
    </div>

    <div class="test-card">
        <h2>ğŸ¨ CSSç‰¹æ€§æ”¯æŒ</h2>
        <div id="cssTest">
            <div class="status" id="flexbox">Flexbox</div>
            <div class="status" id="grid">CSS Grid</div>
            <div class="status" id="backdrop">Backdrop Filter</div>
            <div class="status" id="variables">CSS Variables</div>
        </div>
    </div>

    <div class="test-card">
        <h2>âš¡ JavaScriptç‰¹æ€§</h2>
        <div id="jsTest">
            <div class="status" id="es6">ES6</div>
            <div class="status" id="fetch">Fetch API</div>
            <div class="status" id="promise">Promise</div>
            <div class="status" id="async">Async/Await</div>
        </div>
    </div>

    <div class="test-card">
        <h2>ğŸ”— APIè¿æ¥æµ‹è¯•</h2>
        <div id="apiTest">
            <button onclick="testAPI()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">æµ‹è¯•åç«¯è¿æ¥</button>
            <div id="apiResult" style="margin-top: 10px;"></div>
        </div>
    </div>

    <script>
        // æµè§ˆå™¨ä¿¡æ¯æ£€æµ‹
        function detectBrowser() {
            const ua = navigator.userAgent;
            document.getElementById('userAgent').textContent = ua;
            document.getElementById('platform').textContent = navigator.platform;
            document.getElementById('language').textContent = navigator.language;
            document.getElementById('timezone').textContent = Intl.DateTimeFormat().resolvedOptions().timeZone;

            let browser = 'Unknown';
            let version = 'Unknown';

            if (ua.includes('Chrome') && !ua.includes('Edg')) {
                browser = 'Chrome';
                version = ua.match(/Chrome\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.includes('Firefox')) {
                browser = 'Firefox';
                version = ua.match(/Firefox\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                browser = 'Safari';
                version = ua.match(/Version\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.includes('Edg')) {
                browser = 'Edge';
                version = ua.match(/Edg\/([0-9.]+)/)?.[1] || 'Unknown';
            }

            document.getElementById('browser').textContent = browser;
            document.getElementById('version').textContent = version;
        }

        // CSSç‰¹æ€§æµ‹è¯•
        function testCSS() {
            const tests = {
                flexbox: () => CSS.supports('display', 'flex'),
                grid: () => CSS.supports('display', 'grid'),
                backdrop: () => CSS.supports('backdrop-filter', 'blur(10px)'),
                variables: () => CSS.supports('--test', 'value')
            };

            Object.entries(tests).forEach(([test, fn]) => {
                const element = document.getElementById(test);
                try {
                    if (fn()) {
                        element.classList.add('success');
                        element.textContent += ' âœ“';
                    } else {
                        element.classList.add('error');
                        element.textContent += ' âœ—';
                    }
                } catch (e) {
                    element.classList.add('error');
                    element.textContent += ' âœ—';
                }
            });
        }

        // JavaScriptç‰¹æ€§æµ‹è¯•
        function testJS() {
            const tests = {
                es6: () => {
                    try {
                        eval('const test = () => {};');
                        return true;
                    } catch (e) {
                        return false;
                    }
                },
                fetch: () => typeof fetch !== 'undefined',
                promise: () => typeof Promise !== 'undefined',
                async: () => {
                    try {
                        eval('async function test() {}');
                        return true;
                    } catch (e) {
                        return false;
                    }
                }
            };

            Object.entries(tests).forEach(([test, fn]) => {
                const element = document.getElementById(test);
                try {
                    if (fn()) {
                        element.classList.add('success');
                        element.textContent += ' âœ“';
                    } else {
                        element.classList.add('error');
                        element.textContent += ' âœ—';
                    }
                } catch (e) {
                    element.classList.add('error');
                    element.textContent += ' âœ—';
                }
            });
        }

        // ç½‘ç»œæµ‹è¯•
        async function testNetwork() {
            const networkDiv = document.getElementById('networkTest');
            const tests = [
                { name: 'æœ¬åœ°å‰ç«¯', url: 'http://localhost:5173/' },
                { name: 'æœ¬åœ°åç«¯', url: 'http://localhost:3000/health' }
            ];

            networkDiv.innerHTML = '';

            for (const test of tests) {
                const testDiv = document.createElement('div');
                testDiv.innerHTML = `<span class="status warning">${test.name}: æµ‹è¯•ä¸­...</span>`;
                networkDiv.appendChild(testDiv);

                try {
                    const response = await fetch(test.url, { 
                        method: 'GET',
                        mode: 'cors'
                    });
                    if (response.ok) {
                        testDiv.innerHTML = `<span class="status success">${test.name}: è¿æ¥æˆåŠŸ âœ“</span>`;
                    } else {
                        testDiv.innerHTML = `<span class="status error">${test.name}: HTTP ${response.status} âœ—</span>`;
                    }
                } catch (error) {
                    testDiv.innerHTML = `<span class="status error">${test.name}: ${error.message} âœ—</span>`;
                }
            }
        }

        // APIæµ‹è¯•
        async function testAPI() {
            const resultDiv = document.getElementById('apiResult');
            resultDiv.innerHTML = '<div class="status warning">æµ‹è¯•ä¸­...</div>';

            try {
                const response = await fetch('http://localhost:3000/health');
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="status success">âœ“ åç«¯è¿æ¥æˆåŠŸ</div>
                        <div style="margin-top: 10px; font-size: 14px;">
                            <strong>å“åº”:</strong> ${JSON.stringify(data, null, 2)}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `<div class="status error">âœ— HTTP ${response.status}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="status error">âœ— ${error.message}</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œæµ‹è¯•
        window.addEventListener('load', () => {
            detectBrowser();
            testCSS();
            testJS();
            testNetwork();
        });
    </script>
</body>
</html>