# 检查现有索引

## 查看当前索引

在宝塔phpMyAdmin中执行：

```sql
SHOW INDEX FROM value_added_orders;
```

## 需要的索引清单

以下是性能优化需要的7个索引：

1. ✅ `idx_order_id` - 如果已存在，跳过
2. ⬜ `idx_order_date` - 如果不存在，需要创建
3. ⬜ `idx_order_status` - 如果不存在，需要创建
4. ⬜ `idx_customer_name` - 如果不存在，需要创建
5. ⬜ `idx_status_date` - 如果不存在，需要创建
6. ⬜ `idx_settlement_date` - 如果不存在，需要创建
7. ⬜ `idx_company_date` - 如果不存在，需要创建

## 根据检查结果执行

### 如果 idx_order_id 已存在

说明表已经有部分优化，继续执行第2-8条：

```sql
-- 第2条
CREATE INDEX idx_order_date ON value_added_orders(order_date);

-- 第3条
CREATE INDEX idx_order_status ON value_added_orders(order_status);

-- 第4条
CREATE INDEX idx_customer_name ON value_added_orders(customer_name);

-- 第5条
CREATE INDEX idx_status_date ON value_added_orders(status, order_date);

-- 第6条
CREATE INDEX idx_settlement_date ON value_added_orders(settlement_status, order_date);

-- 第7条
CREATE INDEX idx_company_date ON value_added_orders(company_id, order_date);

-- 第8条
ANALYZE TABLE value_added_orders;
```

### 如果所有索引都已存在

恭喜！优化已完成，只需执行：

```sql
ANALYZE TABLE value_added_orders;
```

## 验证优化效果

执行完成后，刷新增值管理页面，观察加载速度是否有明显提升。

**预期效果：**
- 首次加载：从 15-30秒 降到 1-3秒
- 切换标签：从 3-8秒 降到 0.3-1秒
- 日期筛选：从 5-10秒 降到 0.5-1.5秒

如果速度仍然很慢，可能需要：
1. 检查数据量是否过大（> 100万）
2. 检查服务器资源（CPU、内存）
3. 重启后端服务：`pm2 restart backend`
