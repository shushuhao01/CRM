# 订单取消申请时间格式修复说明

## 问题描述
订单取消申请的"申请时间"显示为 ISO 格式（`2024-02-26T08:24:58.000Z`），需要统一为系统的北京时间格式。

## 修复内容

### 1. 导入时间格式化工具
在 `backend/src/routes/orders.ts` 文件顶部添加：
```typescript
import { formatDateTime } from '../utils/dateFormat';
```

### 2. 修改待审核取消订单 API
**路由**: `GET /api/v1/orders/pending-cancel`

**修改前**:
```typescript
cancelRequestTime: order.updatedAt?.toISOString() || ''
```

**修改后**:
```typescript
cancelRequestTime: formatDateTime(order.updatedAt)
```

### 3. 修改已审核取消订单 API
**路由**: `GET /api/v1/orders/audited-cancel`

**修改前**:
```typescript
cancelRequestTime: order.updatedAt?.toISOString() || ''
```

**修改后**:
```typescript
cancelRequestTime: formatDateTime(order.updatedAt)
```

## 时间格式说明

### formatDateTime 函数
- **位置**: `backend/src/utils/dateFormat.ts`
- **功能**: 将日期对象或日期字符串格式化为北京时间格式
- **格式**: `YYYY-MM-DD HH:mm:ss`（例如：`2024-02-26 16:24:58`）
- **参数**: 
  - `date`: Date 对象或日期字符串
  - `showSeconds`: 是否显示秒数，默认 true
- **返回**: 格式化后的日期字符串，如果日期无效则返回空字符串

## 验证步骤

1. 员工提交取消订单申请
2. 管理员打开"取消订单申请审核"弹窗
3. 检查"申请时间"列是否显示为北京时间格式（YYYY-MM-DD HH:mm:ss）
4. 审核通过或拒绝后，在"已审核取消订单"列表中检查时间格式

## 预期结果
- 待审核列表：申请时间显示为 `2024-02-26 16:24:58`
- 已审核列表：申请时间显示为 `2024-02-26 16:30:15`

## 部署说明
- 修改文件：`backend/src/routes/orders.ts`
- 需要重启后端服务
- 前端无需修改

## 相关文件
- `backend/src/routes/orders.ts` - 订单路由（已修改）
- `backend/src/utils/dateFormat.ts` - 时间格式化工具
- `docs/临时文件/订单取消申请问题修复验证.md` - 完整修复说明
