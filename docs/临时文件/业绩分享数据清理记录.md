# 业绩分享数据清理记录

## 清理时间
2026-02-27

## 清理原因
开发环境中存在516条无效的业绩分享记录,这些记录引用的订单不存在于数据库中。这些是前端页面在开发环境下自动创建的测试数据。

## 问题表现
- 业绩分享页面显示20条记录(实际数据库有516条)
- 所有记录都引用了两个不存在的订单:
  - `ORD202401150001` (ID: 1)
  - `ORD202401160002` (ID: 2)

## 清理过程

### 1. 检查脚本
使用 `backend/scripts/check-share-orders.js` 检查了前20条记录,确认订单都不存在。

### 2. 执行清理
运行清理脚本:
```bash
node backend/scripts/clean-invalid-shares.js
```

### 3. 清理结果
- 删除业绩分享记录: 516 条
- 删除分享成员记录: 1032 条
- 清理后数据库状态: 0 条记录(干净状态)

## 清理脚本说明
脚本位置: `backend/scripts/clean-invalid-shares.js`

清理逻辑:
1. 连接数据库(使用 `.env.local` 配置)
2. 统计清理前的数据
3. 查找所有订单不存在的分享记录
4. 显示将要删除的记录(前10条)
5. 删除分享成员记录
6. 删除分享记录
7. 显示清理结果

## 后续验证
1. 刷新浏览器访问业绩分享页面
2. 确认显示"暂无数据"或0条记录
3. 测试新建分享功能是否正常

## 注意事项
- 此清理仅针对开发环境(`crm_local`数据库)
- 生产环境数据未受影响
- 清理脚本可重复执行,不会影响有效数据
