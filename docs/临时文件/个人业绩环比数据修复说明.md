# ä¸ªäººä¸šç»©ç¯æ¯”æ•°æ®ä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°
ç”¨æˆ·åé¦ˆä¸ªäººä¸šç»©é¡µé¢çš„æ±‡æ€»å¡ç‰‡ä¸­ï¼Œç¯æ¯”æŒ‡æ ‡éƒ½æ²¡æœ‰åŠ¨æ€å˜åŒ–ï¼Œä¸€ç›´æ˜¾ç¤ºå›ºå®šçš„æ•°å€¼ã€‚åŒæ—¶ï¼Œ"è¾ƒä¸ŠæœŸ"çš„æ–‡å­—ä¸å¤Ÿå‡†ç¡®ï¼Œåº”è¯¥æ ¹æ®ç­›é€‰æ¡ä»¶åŠ¨æ€æ˜¾ç¤ºä¸º"è¾ƒæ˜¨æ—¥"ã€"è¾ƒä¸Šæœˆ"ç­‰ã€‚

## é—®é¢˜æ ¹æº

### 1. ç¯æ¯”æ•°æ®ç¡¬ç¼–ç 
åœ¨ `src/stores/performance.ts` ä¸­ï¼Œ`personalPerformance` è®¡ç®—å±æ€§è¿”å›çš„ç¯æ¯”æ•°æ®éƒ½æ˜¯ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿæ•°æ®ï¼š

```typescript
return {
  totalSales,
  salesTrend: 12.5, // ç¡¬ç¼–ç ï¼
  totalOrders,
  ordersTrend: 8.3, // ç¡¬ç¼–ç ï¼
  newCustomers,
  customersTrend: -2.1, // ç¡¬ç¼–ç ï¼
  conversionRate,
  conversionTrend: 5.2 // ç¡¬ç¼–ç ï¼
}
```

### 2. ç­¾æ”¶ä¸šç»©ç¯æ¯”ç¼ºå¤±
- `PerformanceData` æ¥å£æ²¡æœ‰å®šä¹‰ç­¾æ”¶ä¸šç»©ç›¸å…³å­—æ®µ
- `personalPerformance` è®¡ç®—å±æ€§æ²¡æœ‰è®¡ç®—ç­¾æ”¶ä¸šç»©çš„ç¯æ¯”
- ä¸ªäººä¸šç»©é¡µé¢ä¸­ç­¾æ”¶ä¸šç»©çš„ç¯æ¯”è¢«ç¡¬ç¼–ç ä¸º 0

### 3. ç¯æ¯”æ–‡å­—ä¸å‡†ç¡®
æ‰€æœ‰å¡ç‰‡éƒ½æ˜¾ç¤º"è¾ƒä¸ŠæœŸ"ï¼Œä¸å¤Ÿç›´è§‚ï¼Œåº”è¯¥æ ¹æ®ç­›é€‰æ¡ä»¶æ˜¾ç¤ºï¼š
- ä»Šæ—¥ â†’ è¾ƒæ˜¨æ—¥
- æœ¬å‘¨ â†’ è¾ƒä¸Šå‘¨
- æœ¬æœˆ â†’ è¾ƒä¸Šæœˆ
- ç­‰ç­‰

## ä¿®å¤æ–¹æ¡ˆ

### 1. Performance Store ä¿®å¤ âœ…

#### æ‰©å±• PerformanceData æ¥å£
```typescript
export interface PerformanceData {
  totalSales: number
  salesTrend: number
  totalOrders: number
  ordersTrend: number
  newCustomers: number
  customersTrend: number
  conversionRate: number
  conversionTrend: number
  // ğŸ”¥ æ–°å¢ï¼šç­¾æ”¶ä¸šç»©ç›¸å…³å­—æ®µ
  signedAmount?: number
  signedTrend?: number
  signedOrders?: number
  signedOrdersTrend?: number
}
```

#### é‡å†™ personalPerformance è®¡ç®—é€»è¾‘
1. **æ ¹æ®æ—¥æœŸèŒƒå›´è®¡ç®—å½“æœŸå’Œä¸ŠæœŸ**
   - å¦‚æœæœ‰è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´ï¼šä¸ŠæœŸ = ç›¸åŒå¤©æ•°çš„å‰ä¸€ä¸ªæ—¶é—´æ®µ
   - å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´ï¼šå½“æœŸ = æœ¬æœˆè‡³ä»Šï¼Œä¸ŠæœŸ = ä¸Šæœˆæ•´æœˆ

2. **æŒ‰æ—¶é—´æ®µè¿‡æ»¤è®¢å•å’Œå®¢æˆ·**
   - å½“æœŸè®¢å•ï¼š`currentOrders`
   - ä¸ŠæœŸè®¢å•ï¼š`previousOrders`
   - å½“æœŸå®¢æˆ·ï¼š`currentCustomers`
   - ä¸ŠæœŸå®¢æˆ·ï¼š`previousCustomers`

3. **è®¡ç®—çœŸå®çš„ç¯æ¯”æ•°æ®**
   ```typescript
   const calculateTrend = (current: number, previous: number): number => {
     if (previous === 0) {
       return current > 0 ? 100 : 0
     }
     if (current === 0) {
       return -100
     }
     const rawChange = ((current - previous) / previous) * 100
     let change = Number(rawChange.toFixed(1))
     if (Math.abs(change) < 0.1) {
       change = 0
     }
     return change
   }
   ```

4. **æ·»åŠ ç­¾æ”¶ä¸šç»©è®¡ç®—**
   - è®¡ç®—å½“æœŸç­¾æ”¶ä¸šç»©å’Œç­¾æ”¶è®¢å•æ•°
   - è®¡ç®—ä¸ŠæœŸç­¾æ”¶ä¸šç»©å’Œç­¾æ”¶è®¢å•æ•°
   - è®¡ç®—ç­¾æ”¶ä¸šç»©ç¯æ¯”å’Œç­¾æ”¶è®¢å•ç¯æ¯”

### 2. ä¸ªäººä¸šç»©é¡µé¢ä¿®å¤ âœ…

#### æ·»åŠ åŠ¨æ€ç¯æ¯”æ–‡å­—
```typescript
// ğŸ”¥ è®¡ç®—å±æ€§ï¼šæ ¹æ®ç­›é€‰æ¡ä»¶åŠ¨æ€æ˜¾ç¤ºç¯æ¯”æ–‡å­—
const trendLabel = computed(() => {
  switch (selectedQuickFilter.value) {
    case 'today':
      return 'è¾ƒæ˜¨æ—¥'
    case 'yesterday':
      return 'è¾ƒå‰æ—¥'
    case 'thisWeek':
      return 'è¾ƒä¸Šå‘¨'
    case 'lastWeek':
      return 'è¾ƒå‰å‘¨'
    case 'last7days':
      return 'è¾ƒå‰7å¤©'
    case 'thisMonth':
      return 'è¾ƒä¸Šæœˆ'
    case 'lastMonth':
      return 'è¾ƒå‰æœˆ'
    case 'thisYear':
      return 'è¾ƒå»å¹´'
    default:
      return 'è¾ƒä¸ŠæœŸ'
  }
})
```

#### æ›´æ–°æ¨¡æ¿ä½¿ç”¨åŠ¨æ€æ–‡å­—
å°†æ‰€æœ‰å¡ç‰‡ä¸­çš„ `è¾ƒä¸ŠæœŸ` æ›¿æ¢ä¸º `{{ trendLabel }}`

#### ä½¿ç”¨ Store ä¸­çš„ç­¾æ”¶ä¸šç»©ç¯æ¯”
```typescript
signedTrend: data.signedTrend || 0, // ğŸ”¥ ä½¿ç”¨storeä¸­çš„ç­¾æ”¶ä¸šç»©ç¯æ¯”
signedOrdersTrend: data.signedOrdersTrend || 0 // ğŸ”¥ ä½¿ç”¨storeä¸­çš„ç­¾æ”¶è®¢å•ç¯æ¯”
```

#### åŒæ­¥æ—¥æœŸèŒƒå›´åˆ° Store
åœ¨ `handleQuickFilter` å’Œ `handleDateChange` ä¸­è°ƒç”¨ `performanceStore.updateDateRange()`ï¼Œç¡®ä¿ store ä¸­çš„æ—¥æœŸèŒƒå›´ä¸é¡µé¢åŒæ­¥ã€‚

## ç¯æ¯”è®¡ç®—è§„åˆ™

### æ—¥æœŸèŒƒå›´å¯¹åº”å…³ç³»

| ç­›é€‰æ¡ä»¶ | å½“æœŸ | ä¸ŠæœŸ | ç¯æ¯”æ–‡å­— |
|---------|------|------|---------|
| ä»Šæ—¥ | ä»Šå¤© | æ˜¨å¤© | è¾ƒæ˜¨æ—¥ |
| æ˜¨æ—¥ | æ˜¨å¤© | å‰å¤© | è¾ƒå‰æ—¥ |
| æœ¬å‘¨ | æœ¬å‘¨ä¸€è‡³ä»Š | ä¸Šå‘¨ä¸€è‡³ä¸Šå‘¨æ—¥ | è¾ƒä¸Šå‘¨ |
| ä¸Šå‘¨ | ä¸Šå‘¨ä¸€è‡³ä¸Šå‘¨æ—¥ | å‰å‘¨ä¸€è‡³å‰å‘¨æ—¥ | è¾ƒå‰å‘¨ |
| è¿‘7å¤© | æœ€è¿‘7å¤© | å‰7å¤© | è¾ƒå‰7å¤© |
| æœ¬æœˆ | æœ¬æœˆ1æ—¥è‡³ä»Š | ä¸Šæœˆ1æ—¥è‡³ä¸Šæœˆæœ« | è¾ƒä¸Šæœˆ |
| ä¸Šæœˆ | ä¸Šæœˆ1æ—¥è‡³ä¸Šæœˆæœ« | å‰æœˆ1æ—¥è‡³å‰æœˆæœ« | è¾ƒå‰æœˆ |
| ä»Šå¹´ | ä»Šå¹´1æœˆ1æ—¥è‡³ä»Š | å»å¹´åŒæœŸ | è¾ƒå»å¹´ |
| è‡ªå®šä¹‰ | é€‰æ‹©çš„æ—¥æœŸèŒƒå›´ | ç›¸åŒå¤©æ•°çš„å‰ä¸€ä¸ªæ—¶é—´æ®µ | è¾ƒä¸ŠæœŸ |

### ç¯æ¯”è®¡ç®—å…¬å¼
```
ç¯æ¯” = ((å½“æœŸ - ä¸ŠæœŸ) / ä¸ŠæœŸ) Ã— 100%
```

ç‰¹æ®Šæƒ…å†µå¤„ç†ï¼š
- ä¸ŠæœŸä¸º0ï¼Œå½“æœŸ>0ï¼šæ˜¾ç¤º +100%
- ä¸ŠæœŸä¸º0ï¼Œå½“æœŸ=0ï¼šæ˜¾ç¤º 0%
- ä¸ŠæœŸ>0ï¼Œå½“æœŸ=0ï¼šæ˜¾ç¤º -100%
- ç¯æ¯”ç»å¯¹å€¼<0.1ï¼šæ˜¾ç¤º 0%ï¼ˆé¿å…-0çš„æƒ…å†µï¼‰

## ä¿®æ”¹æ–‡ä»¶æ¸…å•

1. âœ… `src/stores/performance.ts`
   - æ‰©å±• `PerformanceData` æ¥å£
   - é‡å†™ `personalPerformance` è®¡ç®—å±æ€§
   - æ·»åŠ çœŸå®çš„ç¯æ¯”è®¡ç®—é€»è¾‘
   - æ·»åŠ ç­¾æ”¶ä¸šç»©ç¯æ¯”è®¡ç®—

2. âœ… `src/views/Performance/Personal.vue`
   - æ·»åŠ  `trendLabel` è®¡ç®—å±æ€§
   - æ›´æ–°æ¨¡æ¿ä½¿ç”¨åŠ¨æ€ç¯æ¯”æ–‡å­—
   - ä½¿ç”¨ store ä¸­çš„ç­¾æ”¶ä¸šç»©ç¯æ¯”
   - åŒæ­¥æ—¥æœŸèŒƒå›´åˆ° store

## éªŒè¯æ­¥éª¤

1. **æ‰“å¼€ä¸ªäººä¸šç»©é¡µé¢**
   - é»˜è®¤æ˜¾ç¤º"æœ¬æœˆ"æ•°æ®
   - ç¯æ¯”æ–‡å­—åº”æ˜¾ç¤º"è¾ƒä¸Šæœˆ"

2. **åˆ‡æ¢ç­›é€‰æ¡ä»¶**
   - ç‚¹å‡»"ä»Šæ—¥"ï¼šç¯æ¯”æ–‡å­—å˜ä¸º"è¾ƒæ˜¨æ—¥"
   - ç‚¹å‡»"æœ¬å‘¨"ï¼šç¯æ¯”æ–‡å­—å˜ä¸º"è¾ƒä¸Šå‘¨"
   - ç‚¹å‡»"ä¸Šæœˆ"ï¼šç¯æ¯”æ–‡å­—å˜ä¸º"è¾ƒå‰æœˆ"

3. **éªŒè¯ç¯æ¯”æ•°æ®**
   - ç¯æ¯”æ•°å­—åº”è¯¥æ ¹æ®å®é™…æ•°æ®åŠ¨æ€å˜åŒ–
   - ä¸å†æ˜¯å›ºå®šçš„ 12.5%ã€8.3% ç­‰æ¨¡æ‹Ÿæ•°æ®
   - ç­¾æ”¶ä¸šç»©çš„ç¯æ¯”ä¹Ÿåº”è¯¥æ­£ç¡®æ˜¾ç¤º

4. **éªŒè¯è®¡ç®—é€»è¾‘**
   - å¦‚æœä¸ŠæœŸæœ‰æ•°æ®ï¼Œå½“æœŸæ²¡æœ‰æ•°æ®ï¼šåº”æ˜¾ç¤º -100%
   - å¦‚æœä¸ŠæœŸæ²¡æœ‰æ•°æ®ï¼Œå½“æœŸæœ‰æ•°æ®ï¼šåº”æ˜¾ç¤º +100%
   - å¦‚æœéƒ½æ²¡æœ‰æ•°æ®ï¼šåº”æ˜¾ç¤º 0%

## æŠ€æœ¯è¦ç‚¹

1. **å“åº”å¼è®¡ç®—**
   - ä½¿ç”¨ Vue çš„ `computed` å±æ€§ï¼Œç¡®ä¿æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°è®¡ç®—
   - æ—¥æœŸèŒƒå›´å˜åŒ–æ—¶ï¼Œé€šè¿‡ `updateDateRange` è§¦å‘é‡æ–°è®¡ç®—

2. **æ—¶é—´èŒƒå›´å¤„ç†**
   - ä½¿ç”¨æœ¬åœ°æ—¶é—´ï¼Œé¿å… UTC æ—¶åŒºé—®é¢˜
   - æ­£ç¡®å¤„ç†æœˆä»½è¾¹ç•Œï¼ˆå¦‚1æœˆçš„ä¸Šæœˆæ˜¯å»å¹´12æœˆï¼‰

3. **ä¸šç»©åˆ†äº«è€ƒè™‘**
   - ç¯æ¯”è®¡ç®—è€ƒè™‘äº†ä¸šç»©åˆ†äº«çš„å½±å“
   - æ‰£é™¤åˆ†äº«å‡ºå»çš„éƒ¨åˆ†ï¼ŒåŠ ä¸Šæ¥æ”¶åˆ°çš„éƒ¨åˆ†

4. **æ•°æ®ä¸€è‡´æ€§**
   - Store ä¸­çš„è®¡ç®—é€»è¾‘ä¸é¡µé¢æ˜¾ç¤ºä¿æŒä¸€è‡´
   - é¿å…é‡å¤è®¡ç®—ï¼Œæé«˜æ€§èƒ½

## ç›¸å…³æ–‡ä»¶
- âœ… `src/stores/performance.ts` - Performance Store
- âœ… `src/views/Performance/Personal.vue` - ä¸ªäººä¸šç»©é¡µé¢
- âœ… `docs/ä¸´æ—¶æ–‡ä»¶/æ•°æ®çœ‹æ¿ç¯æ¯”æ•°æ®é—®é¢˜è¯´æ˜.md` - æ•°æ®çœ‹æ¿ç¯æ¯”ä¿®å¤ï¼ˆç±»ä¼¼é—®é¢˜ï¼‰


## æœ€ç»ˆä¿®å¤å®Œæˆ âœ…

### é—®é¢˜æ ¹æº
ç”¨æˆ·ç‚¹å‡»å¿«é€Ÿç­›é€‰æŒ‰é’®ï¼ˆå¦‚"ä»Šæ—¥"ã€"æœ¬æœˆ"ï¼‰åï¼Œæ—¥æœŸé€‰æ‹©å™¨çš„å€¼ä¼šè¢«ç¨‹åºåŒ–è®¾ç½®ã€‚ä½†æ˜¯ Element Plus çš„æ—¥æœŸé€‰æ‹©å™¨åœ¨å€¼å˜åŒ–æ—¶ä¼šè§¦å‘ `@change` äº‹ä»¶ï¼Œå³ä½¿æ˜¯ç¨‹åºåŒ–è®¾ç½®ä¹Ÿä¼šè§¦å‘ã€‚

åŸæ¥çš„ `handleDateChange` å‡½æ•°ä¼šæ— æ¡ä»¶æ¸…ç©º `selectedQuickFilter`ï¼š
```typescript
const handleDateChange = () => {
  selectedQuickFilter.value = '' // æ¸…ç©ºå¿«æ·ç­›é€‰ âŒ è¿™å¯¼è‡´äº†é—®é¢˜
  // ...
}
```

è¿™å¯¼è‡´ï¼š
1. ç”¨æˆ·ç‚¹å‡»"ä»Šæ—¥"æŒ‰é’®
2. `handleQuickFilter('today')` è®¾ç½® `selectedQuickFilter = 'today'` å’Œ `dateRange`
3. æ—¥æœŸé€‰æ‹©å™¨å€¼å˜åŒ–ï¼Œè§¦å‘ `handleDateChange`
4. `handleDateChange` æ¸…ç©º `selectedQuickFilter`
5. `trendLabel` è®¡ç®—å±æ€§å‘ç° `selectedQuickFilter` ä¸ºç©ºï¼Œèµ°åˆ°è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´é€»è¾‘
6. è®¡ç®—å¤©æ•°å·®å¼‚ï¼Œæ˜¾ç¤º"è¾ƒå‰1å¤©"è€Œä¸æ˜¯"è¾ƒæ˜¨æ—¥"

### æœ€ç»ˆè§£å†³æ–¹æ¡ˆ
é‡å†™ `handleDateChange` å‡½æ•°ï¼Œæ™ºèƒ½æ£€æµ‹æ—¥æœŸèŒƒå›´æ˜¯å¦åŒ¹é…æŸä¸ªå¿«é€Ÿç­›é€‰ï¼š

```typescript
const handleDateChange = () => {
  // ğŸ”¥ æ£€æŸ¥å½“å‰æ—¥æœŸèŒƒå›´æ˜¯å¦åŒ¹é…å¿«é€Ÿç­›é€‰
  const today = new Date()
  const formatDate = (date: Date) => {
    const year = date.getFullYear()
    const month = String(date.getMonth() + 1).padStart(2, '0')
    const day = String(date.getDate()).padStart(2, '0')
    return `${year}-${month}-${day}`
  }

  let matchedFilter = ''
  if (dateRange.value && dateRange.value.length === 2) {
    const [start, end] = dateRange.value

    // æ£€æŸ¥æ˜¯å¦åŒ¹é…"ä»Šæ—¥"
    if (start === formatDate(today) && end === formatDate(today)) {
      matchedFilter = 'today'
    }
    // æ£€æŸ¥æ˜¯å¦åŒ¹é…"æ˜¨æ—¥"
    else {
      const yesterday = new Date(today)
      yesterday.setDate(today.getDate() - 1)
      if (start === formatDate(yesterday) && end === formatDate(yesterday)) {
        matchedFilter = 'yesterday'
      }
    }
    // ... æ£€æŸ¥å…¶ä»–å¿«é€Ÿç­›é€‰
  }

  // å¦‚æœåŒ¹é…åˆ°å¿«é€Ÿç­›é€‰ï¼Œä¿ç•™å®ƒï¼›å¦åˆ™æ¸…ç©º
  if (matchedFilter) {
    selectedQuickFilter.value = matchedFilter
  } else {
    selectedQuickFilter.value = ''
  }

  // æ›´æ–°storeä¸­çš„æ—¥æœŸèŒƒå›´
  if (dateRange.value && dateRange.value.length === 2) {
    performanceStore.updateDateRange([dateRange.value[0], dateRange.value[1]])
  } else {
    performanceStore.updateDateRange(null)
  }
}
```

### ä¿®å¤æ•ˆæœ
- âœ… ç‚¹å‡»"ä»Šæ—¥"æŒ‰é’®ï¼šæ˜¾ç¤º"è¾ƒæ˜¨æ—¥"
- âœ… ç‚¹å‡»"æœ¬å‘¨"æŒ‰é’®ï¼šæ˜¾ç¤º"è¾ƒä¸Šå‘¨"
- âœ… ç‚¹å‡»"æœ¬æœˆ"æŒ‰é’®ï¼šæ˜¾ç¤º"è¾ƒä¸Šæœˆ"
- âœ… æ‰‹åŠ¨é€‰æ‹©è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´ï¼šæ ¹æ®å¤©æ•°æ™ºèƒ½æ˜¾ç¤ºï¼ˆå¦‚"è¾ƒå‰7å¤©"ï¼‰
- âœ… å¿«é€Ÿç­›é€‰æŒ‰é’®çš„é«˜äº®çŠ¶æ€æ­£ç¡®ä¿æŒ

### æµ‹è¯•å»ºè®®
1. ä¾æ¬¡ç‚¹å‡»æ‰€æœ‰å¿«é€Ÿç­›é€‰æŒ‰é’®ï¼ŒéªŒè¯ç¯æ¯”æ–‡å­—æ˜¯å¦æ­£ç¡®
2. æ‰‹åŠ¨é€‰æ‹©ä¸åŒçš„æ—¥æœŸèŒƒå›´ï¼ŒéªŒè¯ç¯æ¯”æ–‡å­—æ˜¯å¦æ™ºèƒ½è®¡ç®—
3. ç‚¹å‡»å¿«é€Ÿç­›é€‰åï¼Œå†æ‰‹åŠ¨ä¿®æ”¹æ—¥æœŸï¼ŒéªŒè¯æ˜¯å¦æ­£ç¡®åˆ‡æ¢åˆ°è‡ªå®šä¹‰æ¨¡å¼
4. åˆ·æ–°é¡µé¢ï¼ŒéªŒè¯é»˜è®¤çŠ¶æ€ï¼ˆæœ¬æœˆï¼‰æ˜¯å¦æ­£ç¡®æ˜¾ç¤º"è¾ƒä¸Šæœˆ"

### ä¿®æ”¹æ–‡ä»¶
- âœ… `src/views/Performance/Personal.vue` - é‡å†™ `handleDateChange` å‡½æ•°

### ç›¸å…³æ–‡æ¡£
- `docs/ä¸´æ—¶æ–‡ä»¶/æ•°æ®çœ‹æ¿ç¯æ¯”æ•°æ®é—®é¢˜è¯´æ˜.md` - ç±»ä¼¼é—®é¢˜çš„ä¿®å¤ç»éªŒ
