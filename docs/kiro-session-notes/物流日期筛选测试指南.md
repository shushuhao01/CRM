# 物流日期筛选测试指南

## 测试目的

验证物流管理模块的日期筛选功能是否正确使用**下单时间**而非发货时间。

## 测试环境

- 当前日期: 2026年2月24日
- 测试月份: 2026年1月(上月)

## 测试页面

### 1. 发货列表 (`/logistics/shipping`)

#### 测试步骤:

1. **进入已发货标签页**
   - 导航到: 物流管理 -> 发货列表 -> 已发货

2. **测试"上月订单"快捷按钮**
   - 点击"上月订单"按钮
   - 预期结果: 显示2026年1月1日 - 1月31日下单的订单
   - 验证方法: 检查"下单时间"列,所有订单应该在1月份

3. **测试自定义日期范围**
   - 选择日期范围: 2026-01-01 至 2026-01-31
   - 预期结果: 显示1月份下单的订单
   - 验证方法: 检查"下单时间"列

4. **测试其他快捷按钮**
   - 今日订单: 显示今天(2月24日)下单的订单
   - 昨日订单: 显示昨天(2月23日)下单的订单
   - 本周订单: 显示本周(2月17日-24日)下单的订单
   - 本月订单: 显示本月(2月1日-24日)下单的订单
   - 今年订单: 显示今年(1月1日-2月24日)下单的订单

### 2. 状态更新 (`/logistics/status-update`)

#### 测试步骤:

1. **进入待更新标签页**
   - 导航到: 物流管理 -> 状态更新 -> 待更新

2. **测试"上月"快捷按钮**
   - 点击"上月"按钮
   - 预期结果: 显示2026年1月1日 - 1月31日下单的订单
   - 验证方法: 检查"下单日期"列,所有订单应该在1月份

3. **测试自定义日期范围**
   - 选择日期范围: 2026-01-01 至 2026-01-31
   - 预期结果: 显示1月份下单的订单
   - 验证方法: 检查"下单日期"列

4. **切换到"已更新"标签页**
   - 重复上述测试
   - 验证日期筛选同样基于下单时间

## 测试数据准备

为了更好地测试,建议准备以下测试数据:

1. **1月份下单,1月份发货的订单** (正常情况)
2. **1月份下单,2月份发货的订单** (跨月发货)
3. **2月份下单,2月份发货的订单** (当月订单)

## 预期结果

### 正确行为:
- 点击"上月订单"时,显示**1月份下单**的所有订单(包括1月下单2月发货的订单)
- 不应该显示2月份下单的订单

### 错误行为(修复前):
- 点击"上月订单"时,显示**1月份发货**的订单
- 可能包含12月下单1月发货的订单
- 不包含1月下单2月发货的订单

## 验证要点

### 关键字段对比:

| 字段名 | 说明 | 筛选依据 |
|--------|------|----------|
| 下单时间 / 下单日期 | 订单创建时间 | ✅ 应该用这个 |
| 发货时间 | 订单发货时间 | ❌ 不应该用这个 |

### 测试场景:

#### 场景1: 跨月发货订单
```
订单A:
- 下单时间: 2026-01-28
- 发货时间: 2026-02-03

点击"上月订单"时:
✅ 应该显示 (因为1月下单)
❌ 不应该隐藏
```

#### 场景2: 上上月订单
```
订单B:
- 下单时间: 2025-12-25
- 发货时间: 2026-01-05

点击"上月订单"时:
❌ 不应该显示 (因为12月下单)
✅ 应该隐藏
```

## 测试报告模板

```
测试日期: ____年__月__日
测试人员: __________

【发货列表 - 已发货】
□ 上月订单筛选正确
□ 自定义日期范围正确
□ 其他快捷按钮正确
问题描述: _______________

【状态更新 - 待更新】
□ 上月订单筛选正确
□ 自定义日期范围正确
□ 其他快捷按钮正确
问题描述: _______________

【状态更新 - 已更新】
□ 上月订单筛选正确
□ 自定义日期范围正确
问题描述: _______________

总体评价:
□ 通过 □ 不通过

备注: _______________
```

## 常见问题

### Q1: 为什么要用下单时间而不是发货时间?
A: 业务需求是查看某个时间段下单的订单,而不是发货的订单。例如查看"上月订单"时,应该显示上月下单的所有订单,无论它们何时发货。

### Q2: 如果我想查看某个时间段发货的订单怎么办?
A: 目前系统设计是按下单时间筛选。如果需要按发货时间筛选,可以在订单列表中按"发货时间"列排序。

### Q3: 快捷按钮和自定义日期范围有什么区别?
A: 快捷按钮是预设的时间范围(如上月、本月),自定义日期范围可以选择任意时间段。两者都基于下单时间筛选。

## 修复记录

- 修复日期: 2026-02-24
- 修复内容: 将所有日期筛选从发货时间改为下单时间
- 影响接口: 
  - `/api/v1/orders/shipping/pending`
  - `/api/v1/orders/shipping/shipped`
  - `/api/v1/orders/shipping/returned`
  - `/api/v1/orders/shipping/cancelled`
  - `/api/v1/orders/shipping/draft`
