# å®å¡”é¢æ¿é…ç½®æŒ‡å—

## ğŸ“Š æ•°æ®åº“é…ç½®

### ç¬¬ä¸€æ­¥ï¼šåœ¨å®å¡”é¢æ¿åˆ›å»ºæ•°æ®åº“

1. **ç™»å½•å®å¡”é¢æ¿**
   - è®¿é—®ï¼šhttp://your-server-ip:8888
   - ä½¿ç”¨æ‚¨çš„å®å¡”è´¦å·å¯†ç ç™»å½•

2. **åˆ›å»ºæ•°æ®åº“**
   - ç‚¹å‡»å·¦ä¾§èœå• "æ•°æ®åº“"
   - ç‚¹å‡» "æ·»åŠ æ•°æ®åº“"
   - å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
     ```
     æ•°æ®åº“åï¼šcrm_system
     ç”¨æˆ·åï¼šcrm_user
     å¯†ç ï¼šè®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ï¼ˆå»ºè®®16ä½ä»¥ä¸Šï¼‰
     è®¿é—®æƒé™ï¼šæœ¬åœ°æœåŠ¡å™¨
     å­—ç¬¦é›†ï¼šutf8mb4
     ```
   - ç‚¹å‡» "æäº¤" åˆ›å»º

3. **è®°å½•æ•°æ®åº“ä¿¡æ¯**
   ```
   æ•°æ®åº“åœ°å€ï¼šlocalhost
   ç«¯å£ï¼š3306
   æ•°æ®åº“åï¼šcrm_system
   ç”¨æˆ·åï¼šcrm_user
   å¯†ç ï¼š[æ‚¨è®¾ç½®çš„å¯†ç ]
   ```

### ç¬¬äºŒæ­¥ï¼šé…ç½®ç«™ç‚¹

1. **æ·»åŠ ç«™ç‚¹**
   - ç‚¹å‡»å·¦ä¾§èœå• "ç½‘ç«™"
   - ç‚¹å‡» "æ·»åŠ ç«™ç‚¹"
   - å¡«å†™ä¿¡æ¯ï¼š
     ```
     åŸŸåï¼šabc789.cn
     æ ¹ç›®å½•ï¼š/www/wwwroot/abc789.cn
     FTPï¼šä¸åˆ›å»º
     æ•°æ®åº“ï¼šä¸åˆ›å»ºï¼ˆå·²å•ç‹¬åˆ›å»ºï¼‰
     PHPç‰ˆæœ¬ï¼šçº¯é™æ€
     ```

2. **é…ç½®SSLè¯ä¹¦**
   - åœ¨ç«™ç‚¹åˆ—è¡¨ä¸­æ‰¾åˆ° abc789.cn
   - ç‚¹å‡» "è®¾ç½®"
   - é€‰æ‹© "SSL" æ ‡ç­¾
   - å¦‚æœå·²æœ‰è¯ä¹¦ï¼Œé€‰æ‹©å¯¹åº”è¯ä¹¦
   - å¼€å¯ "å¼ºåˆ¶HTTPS"

3. **é…ç½®åå‘ä»£ç†**
   - åœ¨ç«™ç‚¹è®¾ç½®ä¸­é€‰æ‹© "åå‘ä»£ç†"
   - ç‚¹å‡» "æ·»åŠ åå‘ä»£ç†"
   - é…ç½®ï¼š
     ```
     ä»£ç†åç§°ï¼šCRM-API
     ç›®æ ‡URLï¼šhttp://127.0.0.1:3000
     å‘é€åŸŸåï¼š$host
     ä»£ç†ç›®å½•ï¼š/api
     ```

## ğŸ”§ Node.js ç¯å¢ƒé…ç½®

### å®‰è£… Node.js ç®¡ç†å™¨

1. **åœ¨å®å¡”é¢æ¿å®‰è£… Node.js**
   - ç‚¹å‡»å·¦ä¾§èœå• "è½¯ä»¶å•†åº—"
   - æœç´¢ "Node.jsç‰ˆæœ¬ç®¡ç†å™¨"
   - ç‚¹å‡»å®‰è£…

2. **å®‰è£… Node.js 18**
   - å®‰è£…å®Œæˆåï¼Œç‚¹å‡» "è®¾ç½®"
   - é€‰æ‹©å®‰è£… Node.js 18.x ç‰ˆæœ¬
   - è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬

3. **å®‰è£… PM2**
   - åœ¨ Node.js ç®¡ç†å™¨ä¸­
   - ç‚¹å‡» "æ¨¡å—ç®¡ç†"
   - å®‰è£… PM2 æ¨¡å—

## ğŸŒ Nginx é…ç½®

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®å¡”é¢æ¿é…ç½®

1. **ç¼–è¾‘ç«™ç‚¹é…ç½®**
   - åœ¨ç½‘ç«™åˆ—è¡¨ä¸­ç‚¹å‡»ç«™ç‚¹åç§°
   - é€‰æ‹© "é…ç½®æ–‡ä»¶"
   - æ›¿æ¢ä¸ºä»¥ä¸‹é…ç½®ï¼š

```nginx
server {
    listen 80;
    server_name abc789.cn www.abc789.cn;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name abc789.cn www.abc789.cn;
    
    # SSLé…ç½®
    ssl_certificate /www/server/panel/vhost/cert/abc789.cn/fullchain.pem;
    ssl_certificate_key /www/server/panel/vhost/cert/abc789.cn/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;
    
    # ç½‘ç«™æ ¹ç›®å½•
    root /www/wwwroot/abc789.cn;
    index index.html index.htm;
    
    # Gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;
    
    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;
    
    # APIåå‘ä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:3000/api/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_read_timeout 300;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
    }
    
    # æ–‡ä»¶ä¸Šä¼ ä»£ç†
    location /uploads/ {
        proxy_pass http://127.0.0.1:3000/uploads/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # å‰ç«¯è·¯ç”±å¤„ç†
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }
    
    # ç¦æ­¢è®¿é—®æ•æ„Ÿæ–‡ä»¶
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    location ~ \.(sql|log|env)$ {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # æ—¥å¿—é…ç½®
    access_log /www/wwwlogs/abc789.cn.log;
    error_log /www/wwwlogs/abc789.cn.error.log;
}
```

2. **é‡è½½Nginxé…ç½®**
   - ç‚¹å‡» "ä¿å­˜"
   - åœ¨å®å¡”é¢æ¿é¦–é¡µç‚¹å‡» "é‡è½½é…ç½®"

## ğŸ”’ å®‰å…¨é…ç½®

### é˜²ç«å¢™è®¾ç½®

1. **åœ¨å®å¡”é¢æ¿é…ç½®é˜²ç«å¢™**
   - ç‚¹å‡»å·¦ä¾§èœå• "å®‰å…¨"
   - æ·»åŠ ä»¥ä¸‹ç«¯å£è§„åˆ™ï¼š
     ```
     ç«¯å£ï¼š3000  åè®®ï¼šTCP  ç­–ç•¥ï¼šæ”¾è¡Œ  å¤‡æ³¨ï¼šCRMåç«¯API
     ç«¯å£ï¼š80    åè®®ï¼šTCP  ç­–ç•¥ï¼šæ”¾è¡Œ  å¤‡æ³¨ï¼šHTTP
     ç«¯å£ï¼š443   åè®®ï¼šTCP  ç­–ç•¥ï¼šæ”¾è¡Œ  å¤‡æ³¨ï¼šHTTPS
     ç«¯å£ï¼š22    åè®®ï¼šTCP  ç­–ç•¥ï¼šæ”¾è¡Œ  å¤‡æ³¨ï¼šSSH
     ç«¯å£ï¼š8888  åè®®ï¼šTCP  ç­–ç•¥ï¼šæ”¾è¡Œ  å¤‡æ³¨ï¼šå®å¡”é¢æ¿
     ```

### SSHå®‰å…¨

1. **ä¿®æ”¹SSHç«¯å£**ï¼ˆå¯é€‰ï¼‰
   - åœ¨ "å®‰å…¨" é¡µé¢
   - ç‚¹å‡» "SSHå®‰å…¨"
   - ä¿®æ”¹é»˜è®¤ç«¯å£22ä¸ºå…¶ä»–ç«¯å£

2. **ç¦ç”¨rootç™»å½•**ï¼ˆå¯é€‰ï¼‰
   - åˆ›å»ºæ™®é€šç”¨æˆ·
   - ç¦ç”¨rootç›´æ¥ç™»å½•

## ğŸ“‹ é…ç½®æ£€æŸ¥æ¸…å•

- [ ] æ•°æ®åº“åˆ›å»ºå®Œæˆ
- [ ] ç«™ç‚¹æ·»åŠ å®Œæˆ
- [ ] SSLè¯ä¹¦é…ç½®
- [ ] Node.jsç¯å¢ƒå®‰è£…
- [ ] PM2å®‰è£…å®Œæˆ
- [ ] Nginxé…ç½®æ›´æ–°
- [ ] é˜²ç«å¢™è§„åˆ™è®¾ç½®
- [ ] åå‘ä»£ç†é…ç½®

å®Œæˆä»¥ä¸Šé…ç½®åï¼Œå°±å¯ä»¥å¼€å§‹éƒ¨ç½²CRMç³»ç»Ÿäº†ï¼