var w=(me,G,P)=>new Promise((F,O)=>{var U=g=>{try{V(P.next(g))}catch(L){O(L)}},E=g=>{try{V(P.throw(g))}catch(L){O(L)}},V=g=>g.done?F(g.value):Promise.resolve(g.value).then(U,E);V((P=P.apply(me,G)).next())});import{aC as dt,az as ut,r as v,Z as Ce,e as N,c as ct,Y as mt,ag as u,m as h,p as m,q as s,U as t,M as q,Q as T,O as a,u as y,F as Q,a9 as Y,J as pt,P as ke,S as c,V as Ve,T as i,a2 as Ae}from"./vendor-D8Vxqhr-.js";import{E as p,F as vt,m as ft,ad as _t,T as ht,p as Se,a4 as yt,r as Ie,s as Pe,K as Ue,af as bt,b as gt}from"./elementPlus-Bmwh7Rh8.js";import{_ as wt,j as Ct,t as kt,c as Vt}from"./settings-CuxbDWOu.js";import{u as At}from"./product-DLyzXkG9.js";import"./utils-ywHRn0uI.js";const St={class:"order-edit-page"},It={class:"form-section"},Pt={class:"section-header"},Ut={key:0,class:"form-section"},xt={class:"header-left"},Nt={class:"header-right"},Tt={class:"phone-management"},zt={class:"form-section"},Mt={class:"section-header"},$t={class:"header-left"},qt={class:"header-right"},Ft={class:"product-search"},Ot={class:"product-container"},Et={class:"product-list"},Lt=["onClick"],Bt={class:"product-image"},Dt=["src","alt"],Wt={class:"product-info"},Rt={class:"product-name"},Kt={class:"product-price"},jt={class:"product-stock"},Zt={class:"product-actions"},Jt={class:"form-section"},Qt={class:"section-header"},Yt={key:0,class:"selected-products"},Gt={key:1,class:"empty-products"},Ht={class:"amount-summary-modern"},Xt={class:"amount-row"},eo={class:"amount-field"},to={class:"field-amount subtotal"},oo={class:"amount-field"},so={class:"field-label"},lo={class:"amount-field"},ao={class:"amount-row"},no={class:"amount-field"},ro={class:"field-amount collect"},io={class:"amount-field"},uo={class:"discount-horizontal"},co={class:"field-amount discount"},mo={key:0,class:"discount-percent"},po={class:"amount-field screenshot-field"},vo={class:"screenshot-buttons"},fo={class:"screenshot-content"},_o={key:0,class:"screenshot-thumbnails"},ho=["onMouseenter","onClick"],yo=["src"],bo={class:"thumbnail-overlay"},go=["onClick"],wo={class:"mark-section"},Co={class:"mark-description"},ko={class:"remark-section"},Vo={class:"form-footer"},Ao={class:"customer-search"},So={class:"customer-list"},Io={class:"dialog-footer"},Po={class:"confirm-content"},Uo={class:"confirm-section"},xo={class:"info-grid"},No={class:"info-item"},To={class:"value"},zo={class:"info-item"},Mo={class:"value"},$o={class:"info-item"},qo={class:"value"},Fo={class:"info-item"},Oo={class:"value"},Eo={class:"info-item"},Lo={key:0,class:"info-item"},Bo={class:"value"},Do={class:"confirm-section"},Wo={class:"amount-summary-two-columns"},Ro={class:"amount-column basic-amounts"},Ko={class:"amount-item"},jo={class:"value"},Zo={class:"amount-item"},Jo={class:"discount-info"},Qo={class:"value discount"},Yo={key:0,class:"discount-percent"},Go={class:"amount-column important-amounts"},Ho={class:"amount-item total-amount"},Xo={class:"value"},es={class:"amount-item deposit-amount"},ts={class:"value"},os={class:"amount-item collect-amount"},ss={class:"value"},ls={class:"confirm-section"},as={class:"dialog-footer"},ns={__name:"Edit",setup(me){const G=dt(),P=ut(),F=Vt(P),O=Ct(),U=kt(),E=At(),V=G.params.id,g=v(!1),L=v(""),xe=v([]),B=v(""),D=v(""),W=v([]),R=v([]),Z=v(!1),K=v(!1),z=v(!1),H=v(!1),pe=v([]);v("");const X=v(null),b=v([]),ee=v(-1),te=v(null),M=v(!1),l=Ce({id:null,customerId:null,customerName:"",customerPhone:"",deliveryAddress:"",deliveryTime:"",receiverName:"",receiverPhone:"",expressCompany:"",serviceWechat:"",orderSource:"",products:[],subtotal:0,totalAmount:0,depositAmount:0,collectedAmount:0,discountAmount:0,depositScreenshot:"",orderType:"normal",remarks:""}),A=Ce({phone:""}),x=N(()=>l.products.reduce((o,e)=>o+(e.price||0)*(e.quantity||0),0)),Ne=N(()=>(l.totalAmount||0)-(l.depositAmount||0)),J=N(()=>x.value-(l.totalAmount||0)),oe=N(()=>x.value>0&&J.value>0?J.value/x.value*100:0),Te=N(()=>B.value?E.products.filter(o=>{var e;return o.status==="active"&&(o.name.toLowerCase().includes(B.value.toLowerCase())||((e=o.code)==null?void 0:e.toLowerCase().includes(B.value.toLowerCase())))}):E.products.filter(o=>o.status==="active")),ze=N(()=>U.customers.filter(o=>!o.deleted));ct(()=>w(this,null,function*(){yield se(),window.addEventListener("orderUpdated",ve),window.addEventListener("orderStatusUpdated",fe)})),mt(()=>{window.removeEventListener("orderUpdated",ve),window.removeEventListener("orderStatusUpdated",fe)});const ve=o=>{const{orderId:e}=o.detail;e===V&&(se(),p.success("è®¢å•æ•°æ®å·²åŒæ­¥æ›´æ–°"))},fe=o=>{const{orderId:e}=o.detail;e===V&&(se(),p.info("è®¢å•çŠ¶æ€å·²æ›´æ–°"))},se=()=>w(this,null,function*(){try{const o=O.getOrderById(V);o&&(Object.assign(l,{id:o.id,customerId:o.customerId,customerName:o.customerName,customerPhone:o.customerPhone,receiverName:o.receiverName||"",receiverPhone:o.receiverPhone||"",deliveryAddress:o.deliveryAddress||"",deliveryTime:o.deliveryTime||"",expressCompany:o.expressCompany||"",serviceWechat:o.serviceWechat||"",orderSource:o.orderSource||"",products:o.products||[],subtotal:o.subtotal||0,totalAmount:o.totalAmount||0,depositAmount:o.depositAmount||0,collectedAmount:o.collectedAmount||0,discountAmount:o.discountAmount||0,depositScreenshot:o.depositScreenshot||"",orderType:o.orderType||"normal",remarks:o.remarks||""}),o.customerId&&(yield ne(o.customerId)),o.depositScreenshots&&Array.isArray(o.depositScreenshots)?b.value=[...o.depositScreenshots]:o.depositScreenshot?b.value=[o.depositScreenshot]:b.value=[],le())}catch(o){console.error("åŠ è½½è®¢å•æ•°æ®å¤±è´¥:",o),p.error("åŠ è½½è®¢å•æ•°æ®å¤±è´¥"),et()}}),Me=o=>{const e=l.products.find(r=>r.productId===o.id);e?(e.quantity+=1,e.subtotal=e.quantity*e.price):l.products.push({productId:o.id,productName:o.name,productCode:o.code,specification:o.specification,price:o.price,quantity:1,subtotal:o.price}),le(),L.value="",xe.value=[]},$e=o=>{l.products.splice(o,1),le()},le=()=>{l.products.forEach(o=>{o.subtotal=o.quantity*o.price}),l.subtotal=l.products.reduce((o,e)=>o+e.subtotal,0),_e()},_e=()=>{l.totalAmount=l.subtotal-l.discountAmount,l.collectedAmount=l.depositAmount},qe=()=>{},Fe=o=>w(this,null,function*(){if(o){const e=U.getCustomerById(o);e&&(te.value=e,l.customerName=e.name,l.customerPhone=e.phone,l.deliveryAddress=e.address||"",l.receiverName=e.name,l.receiverPhone=e.phone,l.serviceWechat=e.wechatId||"",l.orderSource=e.source||"",M.value=!1,yield ne(o))}else te.value=null,l.customerName="",l.customerPhone="",l.deliveryAddress="",l.receiverName="",l.receiverPhone="",l.serviceWechat="",l.orderSource="",R.value=[]}),Oe=()=>{E.refreshProducts(),p.success("äº§å“åˆ—è¡¨å·²åˆ·æ–°")},Ee=o=>{F.push(`/product/detail/${o.id}`)},Le=()=>{ae()},ae=()=>{l.collectedAmount=(l.totalAmount||0)-(l.depositAmount||0)},Be=()=>{l.totalAmount=x.value,ae()},De=N(()=>Math.abs((l.totalAmount||0)-x.value)>.01),We=()=>w(this,null,function*(){if(D.value.trim())try{W.value=yield U.searchCustomers(D.value)}catch(o){console.error("æœç´¢å®¢æˆ·å¤±è´¥:",o),W.value=[]}else W.value=[]}),Re=o=>w(this,null,function*(){l.customerId=o.id,l.customerName=o.name,l.customerPhone=o.phone,l.deliveryAddress=o.address||"",l.receiverName=o.name,l.receiverPhone=o.phone,l.serviceWechat=o.wechatId||"",l.orderSource=o.source||"",M.value=!1,yield ne(o.id),Z.value=!1}),ne=o=>w(this,null,function*(){try{const e=yield U.getCustomerPhones(o);R.value=e||[]}catch(e){console.error("åŠ è½½å®¢æˆ·ç”µè¯å¤±è´¥:",e),R.value=[]}}),Ke=()=>w(this,null,function*(){if(!A.phone.trim()){p.warning("è¯·è¾“å…¥ç”µè¯å·ç ");return}try{yield U.addCustomerPhone(l.customerId,A.phone),R.value.push(A.phone),l.customerPhone=A.phone,A.phone="",K.value=!1,p.success("æ·»åŠ ç”µè¯å·ç æˆåŠŸ")}catch(o){console.error("æ·»åŠ ç”µè¯å·ç å¤±è´¥:",o),p.error("æ·»åŠ ç”µè¯å·ç å¤±è´¥")}}),je=()=>{var o;(o=X.value)==null||o.click()},he=o=>{const e=o.target.files;if(e&&e.length>0){for(let r=0;r<e.length;r++){if(b.value.length>=3){p.warning("æœ€å¤šåªèƒ½ä¸Šä¼ 3å¼ å›¾ç‰‡");break}ye(e[r])}o.target.value=""}},Ze=()=>w(this,null,function*(){if(b.value.length>=3){p.warning("æœ€å¤šåªèƒ½ä¸Šä¼ 3å¼ å›¾ç‰‡");return}try{const o=yield navigator.clipboard.read();for(const e of o)for(const r of e.types)if(r.startsWith("image/")){const d=yield e.getType(r),C=new File([d],"pasted-image.png",{type:r});ye(C);return}p.warning("å‰ªè´´æ¿ä¸­æ²¡æœ‰å›¾ç‰‡")}catch(o){p.error("ç²˜è´´å›¾ç‰‡å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æƒé™")}}),ye=o=>{if(!Je(o))return;if(b.value.length>=3){p.warning("æœ€å¤šåªèƒ½ä¸Šä¼ 3å¼ å›¾ç‰‡");return}const e=new FileReader;e.onload=r=>{var C;const d=(C=r.target)==null?void 0:C.result;b.value.push(d),l.depositScreenshot=b.value[0]||"",p.success("å›¾ç‰‡å·²æ·»åŠ ")},e.readAsDataURL(o)},Je=o=>{const e=o.type.startsWith("image/"),r=o.size/1024/1024<2;return e?r?!0:(p.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 2MB!"),!1):(p.error("åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶!"),!1)},Qe=o=>{const e=o||l.depositScreenshot;e&&(pe.value=[e],H.value=!0)},Ye=o=>{typeof o=="number"?(b.value.splice(o,1),l.depositScreenshot=b.value[0]||"",p.success("å›¾ç‰‡å·²åˆ é™¤")):(b.value=[],l.depositScreenshot="")},Ge=()=>{if(!l.customerName){p.warning("è¯·é€‰æ‹©å®¢æˆ·");return}if(l.products.length===0){p.warning("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªäº§å“");return}z.value=!0},He=()=>w(this,null,function*(){g.value=!0;try{yield O.updateOrder(V,l),p.success("è®¢å•æ›´æ–°æˆåŠŸ"),z.value=!1,setTimeout(()=>{F.push("/order/list")},1e3)}catch(o){console.error("æ›´æ–°è®¢å•å¤±è´¥:",o),p.error("æ›´æ–°è®¢å•å¤±è´¥")}finally{g.value=!1}}),Xe=()=>w(this,null,function*(){try{yield gt.confirm("ç¡®å®šè¦å–æ¶ˆå—ï¼Ÿæœªä¿å­˜çš„æ•°æ®å°†ä¸¢å¤±","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"ç»§ç»­ç¼–è¾‘",type:"warning"}),F.push("/order/list")}catch(o){}}),et=()=>{P.back()},tt=()=>{Z.value=!1,D.value="",W.value=[]},ot=()=>{z.value=!1};return(o,e)=>{const r=u("el-icon"),d=u("el-option"),C=u("el-select"),k=u("el-form-item"),S=u("el-col"),$=u("el-input"),re=u("el-row"),f=u("el-button"),st=u("el-collapse-transition"),lt=u("Money"),_=u("el-table-column"),ie=u("el-input-number"),de=u("el-table"),at=u("el-empty"),nt=u("el-tooltip"),ue=u("el-tag"),be=u("el-radio"),rt=u("el-radio-group"),ge=u("el-alert"),we=u("el-form"),ce=u("el-dialog"),it=u("el-image-viewer");return m(),h("div",St,[e[63]||(e[63]=s("div",{class:"page-header"},[s("h2",{class:"page-title"},"ç¼–è¾‘è®¢å•")],-1)),t(we,{model:l,rules:o.formRules,ref:"orderFormRef","label-width":"120px",class:"order-form"},{default:a(()=>[s("div",It,[s("div",Pt,[t(r,null,{default:a(()=>[t(y(vt))]),_:1}),e[22]||(e[22]=s("span",null,"å®¢æˆ·ä¿¡æ¯",-1))]),t(re,{gutter:20},{default:a(()=>[t(S,{span:8},{default:a(()=>[t(k,{label:"é€‰æ‹©å®¢æˆ·",prop:"customerId",required:""},{default:a(()=>[t(C,{modelValue:l.customerId,"onUpdate:modelValue":e[0]||(e[0]=n=>l.customerId=n),placeholder:"è¯·é€‰æ‹©å®¢æˆ·",style:{width:"100%"},filterable:"",onChange:Fe,size:"large"},{default:a(()=>[(m(!0),h(Q,null,Y(ze.value,n=>(m(),q(d,{key:n.id,label:`${n.name} (${n.phone})`,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(S,{span:8},{default:a(()=>[t(k,{label:"å®¢æœå¾®ä¿¡å·",prop:"serviceWechat",required:""},{default:a(()=>[t($,{modelValue:l.serviceWechat,"onUpdate:modelValue":e[1]||(e[1]=n=>l.serviceWechat=n),placeholder:"è¯·è¾“å…¥è´Ÿè´£å®¢æœçš„å¾®ä¿¡å·",clearable:""},{prefix:a(()=>[t(r,null,{default:a(()=>[t(y(ft))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(S,{span:8},{default:a(()=>[t(k,{label:"è®¢å•æ¥æº",prop:"orderSource",required:""},{default:a(()=>[t(C,{modelValue:l.orderSource,"onUpdate:modelValue":e[2]||(e[2]=n=>l.orderSource=n),placeholder:"è¯·é€‰æ‹©è®¢å•æ¥æº",style:{width:"100%"}},{default:a(()=>[t(d,{label:"ðŸ›’ çº¿ä¸Šå•†åŸŽ",value:"online_store"}),t(d,{label:"ðŸ“± å¾®ä¿¡å°ç¨‹åº",value:"wechat_mini"}),t(d,{label:"ðŸ’¬ å¾®ä¿¡å®¢æœ",value:"wechat_service"}),t(d,{label:"ðŸ“ž ç”µè¯å’¨è¯¢",value:"phone_call"}),t(d,{label:"ðŸª çº¿ä¸‹é—¨åº—",value:"offline_store"}),t(d,{label:"ðŸ‘¥ å®¢æˆ·æŽ¨è",value:"referral"}),t(d,{label:"ðŸ“º å¹¿å‘ŠæŠ•æ”¾",value:"advertisement"}),t(d,{label:"ðŸŽ¯ å…¶ä»–æ¸ é“",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),te.value?(m(),h("div",Ut,[s("div",{class:"section-header",onClick:e[3]||(e[3]=n=>M.value=!M.value),style:{cursor:"pointer"}},[s("div",xt,[t(r,null,{default:a(()=>[t(y(_t))]),_:1}),e[23]||(e[23]=s("span",null,"æ”¶è´§ä¿¡æ¯",-1))]),s("div",Nt,[t(r,{class:pt(["collapse-icon",{collapsed:M.value}])},{default:a(()=>[t(y(ht))]),_:1},8,["class"])])]),t(st,null,{default:a(()=>[ke(s("div",null,[t(re,{gutter:20},{default:a(()=>[t(S,{span:6},{default:a(()=>[t(k,{label:"æ”¶è´§äºº",prop:"receiverName"},{default:a(()=>[t($,{modelValue:l.receiverName,"onUpdate:modelValue":e[4]||(e[4]=n=>l.receiverName=n),placeholder:"è¯·è¾“å…¥æ”¶è´§äººå§“å",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(S,{span:12},{default:a(()=>[t(k,{label:"æ”¶è´§ç”µè¯",prop:"receiverPhone"},{default:a(()=>[s("div",Tt,[t(C,{modelValue:l.receiverPhone,"onUpdate:modelValue":e[5]||(e[5]=n=>l.receiverPhone=n),placeholder:"è¯·é€‰æ‹©æ”¶è´§ç”µè¯",style:{width:"100%"},clearable:""},{default:a(()=>[(m(!0),h(Q,null,Y(R.value,n=>(m(),q(d,{key:n.id,label:n.number,value:n.number},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),t(f,{type:"primary",size:"small",onClick:e[6]||(e[6]=n=>K.value=!0),style:{"margin-left":"8px"},icon:y(Se)},{default:a(()=>[...e[24]||(e[24]=[c(" æ–°å¢ž ",-1)])]),_:1},8,["icon"])])]),_:1})]),_:1}),t(S,{span:6},{default:a(()=>[t(k,{label:"æŒ‡å®šå¿«é€’",prop:"expressCompany",required:""},{default:a(()=>[t(C,{modelValue:l.expressCompany,"onUpdate:modelValue":e[7]||(e[7]=n=>l.expressCompany=n),placeholder:"è¯·é€‰æ‹©å¿«é€’å…¬å¸",style:{width:"100%"}},{default:a(()=>[t(d,{label:"ðŸšš é¡ºä¸°é€Ÿè¿",value:"sf"}),t(d,{label:"ðŸ“¦ ä¸­é€šå¿«é€’",value:"zt"}),t(d,{label:"ðŸš› åœ†é€šé€Ÿé€’",value:"yt"}),t(d,{label:"ðŸ“® ç”³é€šå¿«é€’",value:"st"}),t(d,{label:"ðŸš éŸµè¾¾é€Ÿé€’",value:"yd"}),t(d,{label:"ðŸšš å¾·é‚¦å¿«é€’",value:"db"}),t(d,{label:"ðŸ“¦ äº¬ä¸œç‰©æµ",value:"jd"}),t(d,{label:"ðŸš› é‚®æ”¿EMS",value:"ems"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],512),[[Ve,!M.value]])]),_:1})])):T("",!0),s("div",zt,[s("div",Mt,[s("div",$t,[t(r,null,{default:a(()=>[t(y(yt))]),_:1}),e[25]||(e[25]=s("span",null,"äº§å“é€‰æ‹©",-1))]),s("div",qt,[t(f,{type:"primary",size:"small",icon:y(Ie),onClick:Oe,title:"åˆ·æ–°å•†å“åˆ—è¡¨"},{default:a(()=>[...e[26]||(e[26]=[c(" åˆ·æ–° ",-1)])]),_:1},8,["icon"])])]),s("div",Ft,[t($,{modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]=n=>B.value=n),placeholder:"æœç´¢äº§å“åç§°ã€ç¼–å·...",size:"large",clearable:"",onInput:qe},{prefix:a(()=>[t(r,null,{default:a(()=>[t(y(Pe))]),_:1})]),_:1},8,["modelValue"])]),s("div",Ot,[s("div",Et,[(m(!0),h(Q,null,Y(Te.value,n=>(m(),h("div",{key:n.id,class:"product-item",onClick:I=>Me(n)},[s("div",Bt,[s("img",{src:n.image||"/default-product.png",alt:n.name},null,8,Dt)]),s("div",Wt,[s("div",Rt,i(n.name),1),s("div",Kt,"Â¥"+i(n.price),1),s("div",jt,"åº“å­˜: "+i(n.stock),1)]),s("div",Zt,[t(f,{type:"info",size:"small",icon:o.View,onClick:Ae(I=>Ee(n),["stop"]),title:"æŸ¥çœ‹å•†å“è¯¦æƒ…"},{default:a(()=>[...e[27]||(e[27]=[c(" è¯¦æƒ… ",-1)])]),_:1},8,["icon","onClick"]),t(f,{type:"primary",size:"small",icon:y(Se)},{default:a(()=>[...e[28]||(e[28]=[c("æ·»åŠ ",-1)])]),_:1},8,["icon"])])],8,Lt))),128))])])]),s("div",Jt,[s("div",Qt,[t(r,null,{default:a(()=>[t(lt)]),_:1}),e[29]||(e[29]=s("span",null,"è®¢å•æ±‡æ€»",-1))]),l.products.length>0?(m(),h("div",Yt,[e[31]||(e[31]=s("h4",null,"å·²é€‰å•†å“",-1)),t(de,{data:l.products,style:{width:"100%"}},{default:a(()=>[t(_,{prop:"productName",label:"å•†å“åç§°"}),t(_,{prop:"price",label:"å•ä»·",width:"100"},{default:a(({row:n})=>[c(" Â¥"+i(n.price),1)]),_:1}),t(_,{label:"æ•°é‡",width:"150"},{default:a(({row:n,$index:I})=>[t(ie,{modelValue:n.quantity,"onUpdate:modelValue":j=>n.quantity=j,min:1,max:n.stock,size:"small",onChange:_e},null,8,["modelValue","onUpdate:modelValue","max"])]),_:1}),t(_,{label:"å°è®¡",width:"100"},{default:a(({row:n})=>[c(" Â¥"+i(((n.price||0)*(n.quantity||0)).toFixed(2)),1)]),_:1}),t(_,{label:"æ“ä½œ",width:"80"},{default:a(({$index:n})=>[t(f,{type:"danger",size:"small",icon:y(Ue),onClick:I=>$e(n)},{default:a(()=>[...e[30]||(e[30]=[c(" åˆ é™¤ ",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])])):(m(),h("div",Gt,[t(at,{description:"æš‚æ— é€‰æ‹©å•†å“"})])),s("div",Ht,[s("div",Xt,[s("div",eo,[e[32]||(e[32]=s("span",{class:"field-label"},"å•†å“å°è®¡",-1)),s("span",to,"Â¥"+i(x.value.toFixed(2)),1)]),s("div",oo,[s("span",so,[e[33]||(e[33]=c(" è®¢å•æ€»é¢ ",-1)),De.value?(m(),q(nt,{key:0,content:"ç‚¹å‡»åŒæ­¥å•†å“å°è®¡",placement:"top"},{default:a(()=>[t(f,{type:"text",size:"small",icon:y(Ie),onClick:Be,class:"sync-button"},null,8,["icon"])]),_:1})):T("",!0)]),t(ie,{modelValue:l.totalAmount,"onUpdate:modelValue":e[9]||(e[9]=n=>l.totalAmount=n),min:0,max:x.value,precision:2,placeholder:"è®¢å•æ€»é¢",class:"field-input",onChange:Le},null,8,["modelValue","max"])]),s("div",lo,[e[34]||(e[34]=s("span",{class:"field-label"},"å®šé‡‘",-1)),t(ie,{modelValue:l.depositAmount,"onUpdate:modelValue":e[10]||(e[10]=n=>l.depositAmount=n),min:0,max:l.totalAmount||0,precision:2,placeholder:"å®šé‡‘é‡‘é¢",class:"field-input",onChange:ae},null,8,["modelValue","max"])])]),s("div",ao,[s("div",no,[e[35]||(e[35]=s("span",{class:"field-label"},"ä»£æ”¶é‡‘é¢",-1)),s("span",ro,"Â¥"+i(Ne.value.toFixed(2)),1)]),s("div",io,[e[36]||(e[36]=s("span",{class:"field-label"},"ä¼˜æƒ é‡‘é¢",-1)),s("div",uo,[s("span",co,"Â¥"+i(J.value.toFixed(2)),1),J.value>0?(m(),h("span",mo," ("+i(oe.value.toFixed(1))+"%) ",1)):T("",!0)])]),s("div",po,[e[39]||(e[39]=s("span",{class:"field-label"},"å®šé‡‘æˆªå›¾",-1)),s("div",vo,[t(f,{type:"primary",size:"small",icon:o.Upload,onClick:je},{default:a(()=>[...e[37]||(e[37]=[c(" ä¸Šä¼ æˆªå›¾ ",-1)])]),_:1},8,["icon"]),t(f,{type:"success",size:"small",icon:o.DocumentCopy,onClick:Ze},{default:a(()=>[...e[38]||(e[38]=[c(" ç²˜è´´å›¾ç‰‡ ",-1)])]),_:1},8,["icon"])]),s("div",fo,[b.value.length>0?(m(),h("div",_o,[(m(!0),h(Q,null,Y(b.value,(n,I)=>(m(),h("div",{key:I,class:"thumbnail-item",onMouseenter:j=>ee.value=I,onMouseleave:e[11]||(e[11]=j=>ee.value=-1),onClick:j=>Qe(n)},[s("img",{src:n,alt:"å®šé‡‘æˆªå›¾"},null,8,yo),ke(s("div",bo,[t(r,{class:"zoom-icon"},{default:a(()=>[t(y(bt))]),_:1})],512),[[Ve,ee.value===I]]),s("div",{class:"thumbnail-delete",onClick:Ae(j=>Ye(I),["stop"])},[t(r,null,{default:a(()=>[t(y(Ue))]),_:1})],8,go)],40,ho))),128))])):T("",!0)]),s("input",{ref_key:"fileInput",ref:X,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:he},null,544)])])]),s("div",wo,[e[42]||(e[42]=s("h4",null,"è®¢å•æ ‡è®°",-1)),t(re,{gutter:20},{default:a(()=>[t(S,{span:12},{default:a(()=>[t(k,{label:"è®¢å•ç±»åž‹",prop:"markType",required:""},{default:a(()=>[t(rt,{modelValue:l.markType,"onUpdate:modelValue":e[12]||(e[12]=n=>l.markType=n),onChange:o.handleMarkTypeChange},{default:a(()=>[t(be,{value:"normal"},{default:a(()=>[t(ue,{type:"success",size:"small"},{default:a(()=>[...e[40]||(e[40]=[c("æ­£å¸¸å‘è´§å•",-1)])]),_:1})]),_:1}),t(be,{value:"reserved"},{default:a(()=>[t(ue,{type:"warning",size:"small"},{default:a(()=>[...e[41]||(e[41]=[c("é¢„ç•™å•",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),t(S,{span:12},{default:a(()=>[s("div",Co,[l.markType==="reserved"?(m(),q(ge,{key:0,title:"é¢„ç•™å•è¯´æ˜Ž",description:"é¢„ç•™å•å°†ä¿ç•™åœ¨ä¸‹å•äººå¤„ï¼Œä¸ä¼šæµè½¬åˆ°å®¡æ ¸å‘˜ã€‚éœ€è¦ä¿®æ”¹ä¸ºæ­£å¸¸å‘è´§å•åŽæ‰ä¼šè¿›å…¥å®¡æ ¸æµç¨‹ã€‚",type:"warning",closable:!1,"show-icon":""})):(m(),q(ge,{key:1,title:"æ­£å¸¸å‘è´§å•",description:"è®¢å•å°†æŒ‰æ­£å¸¸æµç¨‹è¿›è¡Œå®¡æ ¸å’Œå‘è´§å¤„ç†ã€‚",type:"success",closable:!1,"show-icon":""}))])]),_:1})]),_:1})]),s("div",ko,[t(k,{label:"è®¢å•å¤‡æ³¨"},{default:a(()=>[t($,{modelValue:l.remark,"onUpdate:modelValue":e[13]||(e[13]=n=>l.remark=n),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥è®¢å•å¤‡æ³¨ä¿¡æ¯"},null,8,["modelValue"])]),_:1})]),s("div",Vo,[t(f,{onClick:Xe,size:"large"},{default:a(()=>[...e[43]||(e[43]=[c("å–æ¶ˆ",-1)])]),_:1}),t(f,{onClick:Ge,type:"primary",size:"large",loading:g.value},{default:a(()=>[...e[44]||(e[44]=[c(" ä¿å­˜æ›´æ–° ",-1)])]),_:1},8,["loading"])])])]),_:1},8,["model","rules"]),t(ce,{modelValue:Z.value,"onUpdate:modelValue":e[15]||(e[15]=n=>Z.value=n),title:"é€‰æ‹©å®¢æˆ·",width:"800px","before-close":tt},{default:a(()=>[s("div",Ao,[t($,{modelValue:D.value,"onUpdate:modelValue":e[14]||(e[14]=n=>D.value=n),placeholder:"æœç´¢å®¢æˆ·å§“åæˆ–ç”µè¯...",onInput:We,clearable:""},{prefix:a(()=>[t(r,null,{default:a(()=>[t(y(Pe))]),_:1})]),_:1},8,["modelValue"])]),s("div",So,[t(de,{data:W.value,onRowClick:Re,"highlight-current-row":"",style:{width:"100%"}},{default:a(()=>[t(_,{prop:"name",label:"å®¢æˆ·å§“å"}),t(_,{prop:"phone",label:"è”ç³»ç”µè¯"}),t(_,{prop:"address",label:"åœ°å€"})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),t(ce,{modelValue:K.value,"onUpdate:modelValue":e[18]||(e[18]=n=>K.value=n),title:"æ·»åŠ ç”µè¯å·ç ",width:"400px"},{footer:a(()=>[s("span",Io,[t(f,{onClick:e[17]||(e[17]=n=>K.value=!1)},{default:a(()=>[...e[45]||(e[45]=[c("å–æ¶ˆ",-1)])]),_:1}),t(f,{type:"primary",onClick:Ke},{default:a(()=>[...e[46]||(e[46]=[c("ç¡®å®š",-1)])]),_:1})])]),default:a(()=>[t(we,{model:A,"label-width":"80px"},{default:a(()=>[t(k,{label:"ç”µè¯å·ç "},{default:a(()=>[t($,{modelValue:A.phone,"onUpdate:modelValue":e[16]||(e[16]=n=>A.phone=n),placeholder:"è¯·è¾“å…¥ç”µè¯å·ç "},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(ce,{modelValue:z.value,"onUpdate:modelValue":e[20]||(e[20]=n=>z.value=n),title:"è®¢å•ç¡®è®¤",width:"900px","before-close":ot},{footer:a(()=>[s("span",as,[t(f,{onClick:e[19]||(e[19]=n=>z.value=!1)},{default:a(()=>[...e[61]||(e[61]=[c("å–æ¶ˆ",-1)])]),_:1}),t(f,{type:"primary",onClick:He,loading:g.value},{default:a(()=>[...e[62]||(e[62]=[c(" ç¡®è®¤ä¿å­˜ ",-1)])]),_:1},8,["loading"])])]),default:a(()=>[s("div",Po,[s("div",Uo,[e[53]||(e[53]=s("h4",{class:"confirm-title"},"å®¢æˆ·ä¿¡æ¯",-1)),s("div",xo,[s("div",No,[e[47]||(e[47]=s("span",{class:"label"},"å®¢æˆ·å§“å:",-1)),s("span",To,i(l.customerName),1)]),s("div",zo,[e[48]||(e[48]=s("span",{class:"label"},"è”ç³»ç”µè¯:",-1)),s("span",Mo,i(l.customerPhone),1)]),s("div",$o,[e[49]||(e[49]=s("span",{class:"label"},"é…é€åœ°å€:",-1)),s("span",qo,i(l.deliveryAddress||"æ— "),1)]),s("div",Fo,[e[50]||(e[50]=s("span",{class:"label"},"é…é€æ—¶é—´:",-1)),s("span",Oo,i(l.deliveryTime||"æ— "),1)]),s("div",Eo,[e[51]||(e[51]=s("span",{class:"label"},"è®¢å•ç±»åž‹:",-1)),t(ue,{type:l.orderType==="normal"?"success":"warning"},{default:a(()=>[c(i(l.orderType==="normal"?"æ­£å¸¸è®¢å•":"é¢„ç•™è®¢å•"),1)]),_:1},8,["type"])]),l.remarks?(m(),h("div",Lo,[e[52]||(e[52]=s("span",{class:"label"},"å¤‡æ³¨:",-1)),s("span",Bo,i(l.remarks),1)])):T("",!0)])]),s("div",Do,[e[59]||(e[59]=s("h4",{class:"confirm-title"},"é‡‘é¢æ±‡æ€»",-1)),s("div",Wo,[s("div",Ro,[s("div",Ko,[e[54]||(e[54]=s("span",{class:"label"},"å•†å“å°è®¡",-1)),s("span",jo,"Â¥"+i(l.subtotal),1)]),s("div",Zo,[e[55]||(e[55]=s("span",{class:"label"},"ä¼˜æƒ é‡‘é¢",-1)),s("div",Jo,[s("span",Qo,"-Â¥"+i(l.discountAmount),1),oe.value>0?(m(),h("span",Yo,i(oe.value)+"%",1)):T("",!0)])])]),s("div",Go,[s("div",Ho,[e[56]||(e[56]=s("span",{class:"label"},"è®¢å•æ€»é¢",-1)),s("span",Xo,"Â¥"+i(l.totalAmount),1)]),s("div",es,[e[57]||(e[57]=s("span",{class:"label"},"å®šé‡‘é‡‘é¢",-1)),s("span",ts,"Â¥"+i(l.depositAmount),1)]),s("div",os,[e[58]||(e[58]=s("span",{class:"label"},"å·²æ”¶é‡‘é¢",-1)),s("span",ss,"Â¥"+i(l.collectedAmount),1)])])])]),s("div",ls,[e[60]||(e[60]=s("h4",{class:"confirm-title"},"äº§å“ä¿¡æ¯",-1)),t(de,{data:l.products,style:{width:"100%"}},{default:a(()=>[t(_,{prop:"productName",label:"äº§å“åç§°"}),t(_,{prop:"productCode",label:"äº§å“ç¼–å·",width:"120"}),t(_,{prop:"specification",label:"è§„æ ¼",width:"120"}),t(_,{prop:"price",label:"å•ä»·",width:"100"},{default:a(n=>[c(" Â¥"+i(n.row.price),1)]),_:1}),t(_,{prop:"quantity",label:"æ•°é‡",width:"80"}),t(_,{prop:"subtotal",label:"å°è®¡",width:"100"},{default:a(n=>[c(" Â¥"+i(n.row.subtotal),1)]),_:1})]),_:1},8,["data"])])])]),_:1},8,["modelValue"]),H.value?(m(),q(it,{key:0,"url-list":pe.value,"initial-index":0,onClose:e[21]||(e[21]=n=>H.value=!1)},null,8,["url-list"])):T("",!0),s("input",{ref_key:"fileInput",ref:X,type:"file",accept:"image/*",style:{display:"none"},onChange:he},null,544)])}}},ps=wt(ns,[["__scopeId","data-v-fcafe148"]]);export{ps as default};
