import{H as e,l as a,E as l,b as s}from"./elementPlus-DxaqjplL.js";import{S as i,_ as n}from"./index-DkAJPKqn.js";import{l as o,r as t,b as u,ag as r,m as d,q as c,U as p,O as v,p as m,J as f,T as b,F as h,a9 as _,M as y,S as g,u as w,Q as C}from"./vendor-BtukhyiH.js";import"./utils-DfI7e5Rl.js";const T={class:"sensitive-info-permission-manager"},k={class:"card-header"},x={class:"info-type-cell"},V={class:"batch-operations"},E={class:"batch-controls"},P={class:"save-section"},A={key:0,class:"permission-detail"},N={class:"info-description"},U=n(o({__name:"SensitiveInfoPermissionManager",setup(n){const o=t([]),U=t([{value:"super_admin",label:"超级管理员"},{value:"department_manager",label:"部门经理"},{value:"sales_staff",label:"销售员"},{value:"customer_service",label:"客服"}]),I=t(""),$=t(!1),j=t(!1),B=t(null),D={[i.PHONE]:{name:"手机号码",icon:"Phone",description:"客户的手机号码信息，用于联系和身份验证"},[i.ID_CARD]:{name:"身份证号",icon:"CreditCard",description:"客户的身份证号码，重要的身份识别信息"},[i.EMAIL]:{name:"邮箱地址",icon:"Message",description:"客户的电子邮箱地址，用于邮件通信"},[i.WECHAT]:{name:"微信号",icon:"User",description:"客户的微信号码，用于微信联系"},[i.ADDRESS]:{name:"地址信息",icon:"Location",description:"客户的详细地址信息，包括收货地址等"},[i.BANK_ACCOUNT]:{name:"银行账户",icon:"Wallet",description:"客户的银行账户信息，财务相关敏感数据"},[i.FINANCIAL]:{name:"财务信息",icon:"Wallet",description:"客户的财务状况、收入等敏感财务数据"}},S=()=>{const e=[];Object.values(i).forEach(a=>{const l={};U.value.forEach(e=>{"super_admin"===e.value?l[e.value]=!0:l[e.value]=!1}),e.push({infoType:a,permissions:l})}),o.value=e},M=e=>D[e]?.name||e,O=()=>{I.value&&(o.value.forEach(e=>{e.permissions[I.value]=!0}),l.success(`已为${U.value.find(e=>e.value===I.value)?.label}启用所有敏感信息权限`))},H=()=>{I.value&&s.confirm(`确定要禁用${U.value.find(e=>e.value===I.value)?.label}的所有敏感信息权限吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.value.forEach(e=>{e.permissions[I.value]=!1}),l.success(`已禁用${U.value.find(e=>e.value===I.value)?.label}的所有敏感信息权限`)})},L=async()=>{$.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),l.success("权限配置保存成功！")}catch(e){l.error("保存失败，请重试"),console.error("保存权限配置失败:",e)}finally{$.value=!1}},W=()=>{s.confirm("确定要重置所有权限配置吗？这将恢复到默认设置。","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{S(),l.success("权限配置已重置")})};return u(()=>{S()}),(l,s)=>{const i=r("el-icon"),n=r("el-table-column"),t=r("el-switch"),u=r("el-button"),S=r("el-table"),z=r("el-divider"),F=r("el-option"),R=r("el-select"),q=r("el-card"),J=r("el-tag"),K=r("el-dialog");return c(),d("div",T,[p(q,{class:"manager-card"},{header:v(()=>[m("div",k,[m("h3",null,[p(i,null,{default:v(()=>[p(w(a))]),_:1}),s[2]||(s[2]=g(" 客户敏感信息权限管理 ",-1))]),s[3]||(s[3]=m("p",{class:"header-description"},"设置不同角色对客户敏感信息的访问权限",-1))])]),default:v(()=>[p(S,{data:o.value,border:"",style:{width:"100%"},class:"permission-table"},{default:v(()=>[p(n,{prop:"infoType",label:"敏感信息类型",width:"150",fixed:"left"},{default:v(({row:e})=>{return[m("div",x,[p(i,{class:f((a=e.infoType,D[a]?.icon||"Document"))},null,8,["class"]),m("span",null,b(M(e.infoType)),1)])];var a}),_:1}),(c(!0),d(h,null,_(U.value,e=>(c(),y(n,{key:e.value,label:e.label,width:"120",align:"center"},{default:v(({row:a})=>[p(t,{modelValue:a.permissions[e.value],"onUpdate:modelValue":l=>a.permissions[e.value]=l,onChange:l=>((e,a,l)=>{console.log(`权限变更: ${e} - ${a} - ${l}`)})(a.infoType,e.value,l),disabled:"super_admin"===e.value,"active-color":"#13ce66","inactive-color":"#ff4949"},null,8,["modelValue","onUpdate:modelValue","onChange","disabled"])]),_:2},1032,["label"]))),128)),p(n,{label:"操作",width:"100",fixed:"right"},{default:v(({row:e})=>[p(u,{type:"primary",size:"small",onClick:a=>(e=>{B.value=e,j.value=!0})(e),link:""},{default:v(()=>[...s[4]||(s[4]=[g(" 详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),m("div",V,[p(z,{"content-position":"left"},{default:v(()=>[...s[5]||(s[5]=[g("批量操作",-1)])]),_:1}),m("div",E,[p(R,{modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=e=>I.value=e),placeholder:"选择角色",style:{width:"150px"}},{default:v(()=>[(c(!0),d(h,null,_(U.value.filter(e=>"super_admin"!==e.value),e=>(c(),y(F,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p(u,{type:"success",onClick:O,disabled:!I.value},{default:v(()=>[...s[6]||(s[6]=[g(" 全部启用 ",-1)])]),_:1},8,["disabled"]),p(u,{type:"danger",onClick:H,disabled:!I.value},{default:v(()=>[...s[7]||(s[7]=[g(" 全部禁用 ",-1)])]),_:1},8,["disabled"])])]),m("div",P,[p(u,{type:"primary",size:"large",onClick:L,loading:$.value},{default:v(()=>[p(i,null,{default:v(()=>[p(w(e))]),_:1}),s[8]||(s[8]=g(" 保存权限配置 ",-1))]),_:1},8,["loading"]),p(u,{onClick:W,disabled:$.value},{default:v(()=>[...s[9]||(s[9]=[g(" 重置 ",-1)])]),_:1},8,["disabled"])])]),_:1}),p(K,{modelValue:j.value,"onUpdate:modelValue":s[1]||(s[1]=e=>j.value=e),title:"敏感信息权限详情",width:"600px"},{default:v(()=>{return[B.value?(c(),d("div",A,[m("h4",null,b(M(B.value.infoType)),1),m("p",N,b((a=B.value.infoType,D[a]?.description||"")),1),p(S,{data:(e=B.value,U.value.map(a=>({roleName:a.label,hasPermission:e.permissions[a.value],description:"super_admin"===a.value?"超级管理员拥有所有权限":e.permissions[a.value]?"可以查看此类敏感信息":"无法查看此类敏感信息"}))),border:""},{default:v(()=>[p(n,{prop:"roleName",label:"角色",width:"120"}),p(n,{prop:"hasPermission",label:"权限状态",width:"100"},{default:v(({row:e})=>[p(J,{type:e.hasPermission?"success":"danger"},{default:v(()=>[g(b(e.hasPermission?"有权限":"无权限"),1)]),_:2},1032,["type"])]),_:1}),p(n,{prop:"description",label:"说明"})]),_:1},8,["data"])])):C("",!0)];var e,a}),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3b62d666"]]);export{U as default};
