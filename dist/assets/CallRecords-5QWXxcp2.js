import{u as e}from"./call-x2JnX9hE.js";import{u as l,S as a,c as t,_ as s}from"./index-C4IdUW1A.js";import{l as o,aA as i,e as u,r as n,Z as d,b as r,ag as c,aq as v,m,q as p,p as f,U as g,S as y,O as _,u as h,T as w,F as b,a9 as C,M as k,P as V,J as x,Q as q}from"./vendor-BtukhyiH.js";import{d as R}from"./sensitiveInfo-CTSC2tj2.js";import{aE as z,G as I,r as N,M as U,a3 as D,F as S,az as T,Z as P,O as j,d as O,Q as $,V as M,A as Y,E as F,b as H}from"./elementPlus-DxaqjplL.js";import"./utils-DfI7e5Rl.js";const A={class:"call-records"},E={class:"page-header"},Q={class:"header-content"},L={class:"page-title"},Z={class:"header-actions"},G={class:"overview-section"},J={class:"overview-content"},B={class:"overview-icon total"},K={class:"overview-info"},W={class:"overview-value"},X={class:"overview-change"},ee={class:"change-text positive"},le={class:"overview-content"},ae={class:"overview-icon incoming"},te={class:"overview-info"},se={class:"overview-value"},oe={class:"overview-change"},ie={class:"change-text"},ue={class:"overview-content"},ne={class:"overview-icon outgoing"},de={class:"overview-info"},re={class:"overview-value"},ce={class:"overview-change"},ve={class:"change-text"},me={class:"overview-content"},pe={class:"overview-icon duration"},fe={class:"overview-info"},ge={class:"overview-value"},ye={class:"overview-change"},_e={class:"change-text"},he={class:"search-section"},we={class:"table-section"},be={class:"table-header"},Ce={class:"table-actions"},ke={class:"phone-info"},Ve={key:1,style:{color:"#C0C4CC"}},xe={key:0,class:"quality-info"},qe={key:1,style:{color:"#C0C4CC"}},Re={class:"pagination-wrapper"},ze={key:0,class:"call-detail"},Ie={key:0,class:"quality-detail"},Ne={class:"quality-item"},Ue={class:"quality-item"},De={class:"quality-item"},Se={class:"quality-item"},Te={key:1,class:"no-quality"},Pe={class:"notes-content"},je={class:"recording-player"},Oe=["src"],$e={class:"recording-actions",style:{"margin-top":"10px"}},Me=s(o({__name:"CallRecords",setup(s){const o=e(),Me=l(),Ye=i(),Fe=t(Ye),He=u(()=>Me.users.filter(e=>["sales_staff","department_manager","admin","super_admin","customer_service"].includes(e.role)).map(e=>({id:e.id,name:e.realName||e.name||e.username}))),Ae=n(!1),Ee=n(!1),Qe=n(!1),Le=n([]),Ze=n([]),Ge=n(0),Je=n(!1),Be=n(!1),Ke=n(null),We=n({totalCalls:0,incomingCalls:0,outgoingCalls:0,totalDuration:0,avgDuration:0,todayIncrease:0}),Xe=d({direction:"",status:"",customerInfo:"",dateRange:[],userId:"",durationRange:""}),el=d({page:1,size:20}),ll=d({customerName:"",notes:"",qualityScore:0}),al=n(),tl={customerName:[{required:!0,message:"请输入客户姓名",trigger:"blur"}]},sl=e=>new Date(e).toLocaleString("zh-CN"),ol=e=>{if(e<60)return`${e}秒`;const l=Math.floor(e/3600),a=Math.floor(e%3600/60),t=e%60;return l>0?`${l}小时${a}分${t}秒`:`${a}分${t}秒`},il=e=>({connected:"success",missed:"warning",rejected:"danger",failed:"info"}[e]||"info"),ul=e=>({connected:"已接通",missed:"未接听",rejected:"拒接",failed:"失败"}[e]||"未知"),nl=async()=>{try{Ae.value=!0;const e={page:el.page,size:el.size,...Xe,startTime:Xe.dateRange[0],endTime:Xe.dateRange[1]},l=await o.fetchCallRecords(e);Le.value=l.records,Ge.value=l.total}catch(e){console.error("加载通话记录失败:",e),F.error("加载数据失败")}finally{Ae.value=!1}},dl=async()=>{try{const e=await o.fetchCallStatistics({startDate:(new Date).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0]});We.value={totalCalls:e.totalCalls,incomingCalls:e.incomingCalls||0,outgoingCalls:e.outgoingCalls||0,totalDuration:e.totalDuration,avgDuration:e.averageDuration,todayIncrease:e.todayIncrease||0}}catch(e){console.error("加载概览数据失败:",e)}},rl=()=>{el.page=1,nl()},cl=()=>{Object.assign(Xe,{direction:"",status:"",customerInfo:"",dateRange:[],userId:"",durationRange:""}),rl()},vl=()=>{nl(),dl()},ml=e=>{Ze.value=e},pl=e=>{el.size=e,nl()},fl=e=>{el.page=e,nl()},gl=async()=>{if(al.value&&Ke.value)try{await al.value.validate(),Ee.value=!0,await o.updateCallRecord(Ke.value.id,{customerName:ll.customerName,notes:ll.notes,quality:{...Ke.value.quality,score:ll.qualityScore}}),F.success("记录已更新"),Be.value=!1,nl()}catch(e){console.error("更新记录失败:",e),F.error("更新失败")}finally{Ee.value=!1}},yl=e=>{e.hasRecording?Fe.push(`/service-management/call/recordings?recordId=${e.id}`):F.warning("该通话没有录音")},_l=async e=>{if(e.hasRecording)try{await o.downloadRecording(e.id),F.success("录音下载成功")}catch(l){console.error("下载录音失败:",l),F.error("下载失败")}else F.warning("该通话没有录音")},hl=e=>{F.info("分享功能开发中")},wl=async()=>{if(Ze.value&&0!==Ze.value.length)try{const e=Ze.value.map(e=>e.id);await o.exportCallRecords({recordIds:e}),F.success("批量导出成功")}catch(e){console.error("批量导出失败:",e),F.error("批量导出失败")}else F.warning("请先选择要导出的记录")},bl=async()=>{if(Ze.value&&0!==Ze.value.length)try{await H.confirm(`确定要删除选中的 ${Ze.value.length} 条记录吗？`,"批量删除",{type:"warning"});const e=Ze.value.map(e=>e.id);await o.batchDeleteCallRecords(e),F.success("批量删除成功"),nl()}catch(e){"cancel"!==e&&(console.error("批量删除失败:",e),F.error("批量删除失败"))}else F.warning("请先选择要删除的记录")},Cl=async()=>{try{Qe.value=!0;const e={...Xe,startTime:Xe.dateRange[0],endTime:Xe.dateRange[1]};await o.exportCallRecords(e),F.success("导出成功")}catch(e){console.error("导出失败:",e),F.error("导出失败")}finally{Qe.value=!1}};return r(async()=>{await Me.loadUsers(),nl(),dl()}),(e,l)=>{const t=c("el-icon"),s=c("el-button"),i=c("el-card"),u=c("el-col"),n=c("PhoneIncoming"),d=c("PhoneOutgoing"),r=c("el-row"),Me=c("el-option"),Ye=c("el-select"),dl=c("el-form-item"),kl=c("el-input"),Vl=c("el-date-picker"),xl=c("el-form"),ql=c("el-table-column"),Rl=c("el-tag"),zl=c("el-rate"),Il=c("el-dropdown-item"),Nl=c("el-dropdown-menu"),Ul=c("el-dropdown"),Dl=c("el-table"),Sl=c("el-pagination"),Tl=c("el-descriptions-item"),Pl=c("el-descriptions"),jl=c("el-progress"),Ol=c("el-empty"),$l=c("el-dialog"),Ml=v("loading");return p(),m("div",A,[f("div",E,[f("div",Q,[f("h1",L,[g(t,null,{default:_(()=>[g(h(z))]),_:1}),l[17]||(l[17]=y(" 通话记录 ",-1))]),l[18]||(l[18]=f("p",{class:"page-description"},"查看和管理所有通话记录，包括呼入和呼出通话详情",-1))]),f("div",Z,[g(s,{onClick:Cl,loading:Qe.value},{default:_(()=>[g(t,null,{default:_(()=>[g(h(I))]),_:1}),l[19]||(l[19]=y(" 导出记录 ",-1))]),_:1},8,["loading"]),g(s,{onClick:vl,loading:Ae.value},{default:_(()=>[g(t,null,{default:_(()=>[g(h(N))]),_:1}),l[20]||(l[20]=y(" 刷新 ",-1))]),_:1},8,["loading"])])]),f("div",G,[g(r,{gutter:20},{default:_(()=>[g(u,{span:6},{default:_(()=>[g(i,{class:"overview-card"},{default:_(()=>[f("div",J,[f("div",B,[g(t,null,{default:_(()=>[g(h(U))]),_:1})]),f("div",K,[f("div",W,w(We.value.totalCalls||0),1),l[22]||(l[22]=f("div",{class:"overview-label"},"总通话数",-1)),f("div",X,[f("span",ee,"+"+w(We.value.todayIncrease||0),1),l[21]||(l[21]=f("span",{class:"change-label"},"今日新增",-1))])])])]),_:1})]),_:1}),g(u,{span:6},{default:_(()=>[g(i,{class:"overview-card"},{default:_(()=>[f("div",le,[f("div",ae,[g(t,null,{default:_(()=>[g(n)]),_:1})]),f("div",te,[f("div",se,w(We.value.incomingCalls||0),1),l[24]||(l[24]=f("div",{class:"overview-label"},"呼入通话",-1)),f("div",oe,[f("span",ie,w((We.value.incomingCalls/We.value.totalCalls*100).toFixed(1))+"%",1),l[23]||(l[23]=f("span",{class:"change-label"},"占比",-1))])])])]),_:1})]),_:1}),g(u,{span:6},{default:_(()=>[g(i,{class:"overview-card"},{default:_(()=>[f("div",ue,[f("div",ne,[g(t,null,{default:_(()=>[g(d)]),_:1})]),f("div",de,[f("div",re,w(We.value.outgoingCalls||0),1),l[26]||(l[26]=f("div",{class:"overview-label"},"呼出通话",-1)),f("div",ce,[f("span",ve,w((We.value.outgoingCalls/We.value.totalCalls*100).toFixed(1))+"%",1),l[25]||(l[25]=f("span",{class:"change-label"},"占比",-1))])])])]),_:1})]),_:1}),g(u,{span:6},{default:_(()=>[g(i,{class:"overview-card"},{default:_(()=>[f("div",me,[f("div",pe,[g(t,null,{default:_(()=>[g(h(D))]),_:1})]),f("div",fe,[f("div",ge,w(ol(We.value.totalDuration||0)),1),l[28]||(l[28]=f("div",{class:"overview-label"},"总通话时长",-1)),f("div",ye,[f("span",_e,w(ol(We.value.avgDuration||0)),1),l[27]||(l[27]=f("span",{class:"change-label"},"平均时长",-1))])])])]),_:1})]),_:1})]),_:1})]),f("div",he,[g(i,null,{default:_(()=>[g(xl,{model:Xe,inline:""},{default:_(()=>[g(dl,{label:"通话类型"},{default:_(()=>[g(Ye,{modelValue:Xe.direction,"onUpdate:modelValue":l[0]||(l[0]=e=>Xe.direction=e),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:_(()=>[g(Me,{label:"全部",value:""}),g(Me,{label:"呼入",value:"incoming"}),g(Me,{label:"呼出",value:"outgoing"})]),_:1},8,["modelValue"])]),_:1}),g(dl,{label:"通话状态"},{default:_(()=>[g(Ye,{modelValue:Xe.status,"onUpdate:modelValue":l[1]||(l[1]=e=>Xe.status=e),placeholder:"请选择状态",clearable:"",style:{width:"150px"}},{default:_(()=>[g(Me,{label:"全部",value:""}),g(Me,{label:"已接通",value:"connected"}),g(Me,{label:"未接听",value:"missed"}),g(Me,{label:"拒接",value:"rejected"}),g(Me,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),g(dl,{label:"客户信息"},{default:_(()=>[g(kl,{modelValue:Xe.customerInfo,"onUpdate:modelValue":l[2]||(l[2]=e=>Xe.customerInfo=e),placeholder:"客户姓名/电话",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),g(dl,{label:"通话时间"},{default:_(()=>[g(Vl,{modelValue:Xe.dateRange,"onUpdate:modelValue":l[3]||(l[3]=e=>Xe.dateRange=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"320px"}},null,8,["modelValue"])]),_:1}),g(dl,{label:"通话人员"},{default:_(()=>[g(Ye,{modelValue:Xe.userId,"onUpdate:modelValue":l[4]||(l[4]=e=>Xe.userId=e),placeholder:"请选择人员",clearable:"",style:{width:"150px"}},{default:_(()=>[g(Me,{label:"全部",value:""}),(p(!0),m(b,null,C(He.value,e=>(p(),k(Me,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),g(dl,{label:"时长筛选"},{default:_(()=>[g(Ye,{modelValue:Xe.durationRange,"onUpdate:modelValue":l[5]||(l[5]=e=>Xe.durationRange=e),placeholder:"请选择时长",clearable:"",style:{width:"150px"}},{default:_(()=>[g(Me,{label:"全部",value:""}),g(Me,{label:"30秒以下",value:"0-30"}),g(Me,{label:"30秒-2分钟",value:"30-120"}),g(Me,{label:"2-5分钟",value:"120-300"}),g(Me,{label:"5分钟以上",value:"300+"})]),_:1},8,["modelValue"])]),_:1}),g(dl,null,{default:_(()=>[g(s,{type:"primary",onClick:rl},{default:_(()=>[g(t,null,{default:_(()=>[g(h(S))]),_:1}),l[29]||(l[29]=y(" 搜索 ",-1))]),_:1}),g(s,{onClick:cl},{default:_(()=>[...l[30]||(l[30]=[y("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),f("div",we,[g(i,null,{header:_(()=>[f("div",be,[f("span",null,"通话记录 (共 "+w(Ge.value)+" 条)",1),f("div",Ce,[g(s,{size:"small",disabled:!Ze.value.length,onClick:wl},{default:_(()=>[...l[31]||(l[31]=[y(" 批量导出 ",-1)])]),_:1},8,["disabled"]),g(s,{size:"small",disabled:!Ze.value.length,onClick:bl},{default:_(()=>[...l[32]||(l[32]=[y(" 批量删除 ",-1)])]),_:1},8,["disabled"])])])]),default:_(()=>[V((p(),k(Dl,{data:Le.value,onSelectionChange:ml,style:{width:"100%"},"row-key":"id"},{default:_(()=>[g(ql,{type:"selection",width:"55"}),g(ql,{prop:"direction",label:"类型",width:"80"},{default:_(({row:e})=>[g(Rl,{type:"incoming"===e.direction?"success":"primary",size:"small"},{default:_(()=>[g(t,null,{default:_(()=>["incoming"===e.direction?(p(),k(n,{key:0})):(p(),k(d,{key:1}))]),_:2},1024),y(" "+w("incoming"===e.direction?"呼入":"呼出"),1)]),_:2},1032,["type"])]),_:1}),g(ql,{prop:"customerName",label:"客户姓名",width:"120"},{default:_(({row:e})=>[g(s,{text:"",onClick:l=>{return a=e.customerId,void Fe.push(`/customer-management/detail/${a}`);var a}},{default:_(()=>[y(w(e.customerName||"未知客户"),1)]),_:2},1032,["onClick"])]),_:1}),g(ql,{prop:"customerPhone",label:"客户电话",width:"140"},{default:_(({row:e})=>[f("div",ke,[f("span",null,w(h(R)(e.customerPhone,h(a).PHONE)),1),g(s,{text:"",type:"primary",size:"small",onClick:l=>(async e=>{try{await o.makeOutboundCall({customerPhone:e,customerName:"",notes:"回拨电话"}),F.success("回拨已发起")}catch(l){console.error("回拨失败:",l),F.error("回拨失败")}})(e.customerPhone),style:{"margin-left":"8px"}},{default:_(()=>[g(t,null,{default:_(()=>[g(h(U))]),_:1})]),_:1},8,["onClick"])])]),_:1}),g(ql,{prop:"userName",label:"通话人员",width:"100"}),g(ql,{prop:"startTime",label:"开始时间",width:"160"},{default:_(({row:e})=>[y(w(sl(e.startTime)),1)]),_:1}),g(ql,{prop:"endTime",label:"结束时间",width:"160"},{default:_(({row:e})=>[y(w(e.endTime?sl(e.endTime):"-"),1)]),_:1}),g(ql,{prop:"duration",label:"通话时长",width:"100",sortable:""},{default:_(({row:e})=>{return[f("span",{class:x((l=e.duration,l<30?"short-duration":l<300?"medium-duration":"long-duration"))},w(ol(e.duration)),3)];var l}),_:1}),g(ql,{prop:"status",label:"通话状态",width:"100"},{default:_(({row:e})=>[g(Rl,{type:il(e.status),size:"small"},{default:_(()=>[y(w(ul(e.status)),1)]),_:2},1032,["type"])]),_:1}),g(ql,{prop:"hasRecording",label:"录音",width:"80"},{default:_(({row:e})=>[e.hasRecording?(p(),k(s,{key:0,text:"",size:"small",onClick:l=>yl(e)},{default:_(()=>[g(t,{color:"#67C23A"},{default:_(()=>[g(h(T))]),_:1})]),_:1},8,["onClick"])):(p(),m("span",Ve,"无"))]),_:1}),g(ql,{prop:"quality",label:"通话质量",width:"100"},{default:_(({row:e})=>[e.quality?(p(),m("div",xe,[g(zl,{modelValue:e.quality.score,"onUpdate:modelValue":l=>e.quality.score=l,disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):(p(),m("span",qe,"未评分"))]),_:1}),g(ql,{prop:"notes",label:"备注","min-width":"150","show-overflow-tooltip":""}),g(ql,{label:"操作",width:"200",fixed:"right"},{default:_(({row:e})=>[g(s,{text:"",size:"small",onClick:l=>{return a=e,Ke.value=a,void(Je.value=!0);var a}},{default:_(()=>[g(t,null,{default:_(()=>[g(h(P))]),_:1}),l[33]||(l[33]=y(" 详情 ",-1))]),_:1},8,["onClick"]),g(s,{text:"",size:"small",onClick:l=>yl(e),disabled:!e.hasRecording},{default:_(()=>[g(t,null,{default:_(()=>[g(h(T))]),_:1}),l[34]||(l[34]=y(" 录音 ",-1))]),_:1},8,["onClick","disabled"]),g(s,{text:"",size:"small",onClick:l=>{return a=e,void Fe.push({path:"/service-management/call/follow-up-records",query:{customerId:a.customerId,callRecordId:a.id}});var a}},{default:_(()=>[g(t,null,{default:_(()=>[g(h(j))]),_:1}),l[35]||(l[35]=y(" 跟进 ",-1))]),_:1},8,["onClick"]),g(Ul,null,{dropdown:_(()=>[g(Nl,null,{default:_(()=>[g(Il,{onClick:l=>{return a=e,Ke.value=a,Object.assign(ll,{customerName:a.customerName||"",notes:a.notes||"",qualityScore:a.quality?.score||0}),void(Be.value=!0);var a}},{default:_(()=>[g(t,null,{default:_(()=>[g(h($))]),_:1}),l[37]||(l[37]=y(" 编辑记录 ",-1))]),_:1},8,["onClick"]),g(Il,{onClick:l=>_l(e),disabled:!e.hasRecording},{default:_(()=>[g(t,null,{default:_(()=>[g(h(I))]),_:1}),l[38]||(l[38]=y(" 下载录音 ",-1))]),_:1},8,["onClick","disabled"]),g(Il,{onClick:e=>hl()},{default:_(()=>[g(t,null,{default:_(()=>[g(h(M))]),_:1}),l[39]||(l[39]=y(" 分享记录 ",-1))]),_:1},8,["onClick"]),g(Il,{onClick:l=>(async e=>{try{await H.confirm("确定要删除这条通话记录吗？","确认删除",{type:"warning"}),await o.deleteCallRecord(e.id),F.success("删除成功"),nl()}catch(l){"cancel"!==l&&(console.error("删除记录失败:",l),F.error("删除失败"))}})(e),divided:""},{default:_(()=>[g(t,null,{default:_(()=>[g(h(Y))]),_:1}),l[40]||(l[40]=y(" 删除记录 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),default:_(()=>[g(s,{text:"",size:"small"},{default:_(()=>[l[36]||(l[36]=y(" 更多",-1)),g(t,null,{default:_(()=>[g(h(O))]),_:1})]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ml,Ae.value]]),f("div",Re,[g(Sl,{"current-page":el.page,"onUpdate:currentPage":l[6]||(l[6]=e=>el.page=e),"page-size":el.size,"onUpdate:pageSize":l[7]||(l[7]=e=>el.size=e),"page-sizes":[10,20,50,100],total:Ge.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:pl,onCurrentChange:fl},null,8,["current-page","page-size","total"])])]),_:1})]),g($l,{modelValue:Je.value,"onUpdate:modelValue":l[11]||(l[11]=e=>Je.value=e),title:"通话记录详情",width:"800px"},{default:_(()=>[Ke.value?(p(),m("div",ze,[g(r,{gutter:20},{default:_(()=>[g(u,{span:12},{default:_(()=>[g(i,null,{header:_(()=>[...l[41]||(l[41]=[f("span",null,"基本信息",-1)])]),default:_(()=>[g(Pl,{column:1,border:""},{default:_(()=>[g(Tl,{label:"通话类型"},{default:_(()=>[g(Rl,{type:"incoming"===Ke.value.direction?"success":"primary"},{default:_(()=>[y(w("incoming"===Ke.value.direction?"呼入":"呼出"),1)]),_:1},8,["type"])]),_:1}),g(Tl,{label:"客户姓名"},{default:_(()=>[y(w(Ke.value.customerName||"未知客户"),1)]),_:1}),g(Tl,{label:"客户电话"},{default:_(()=>[y(w(h(R)(Ke.value.customerPhone,h(a).PHONE)),1)]),_:1}),g(Tl,{label:"通话人员"},{default:_(()=>[y(w(Ke.value.userName),1)]),_:1}),g(Tl,{label:"开始时间"},{default:_(()=>[y(w(sl(Ke.value.startTime)),1)]),_:1}),g(Tl,{label:"结束时间"},{default:_(()=>[y(w(Ke.value.endTime?sl(Ke.value.endTime):"未结束"),1)]),_:1}),g(Tl,{label:"通话时长"},{default:_(()=>[y(w(ol(Ke.value.duration)),1)]),_:1}),g(Tl,{label:"通话状态"},{default:_(()=>[g(Rl,{type:il(Ke.value.status)},{default:_(()=>[y(w(ul(Ke.value.status)),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),g(u,{span:12},{default:_(()=>[g(i,null,{header:_(()=>[...l[42]||(l[42]=[f("span",null,"通话质量",-1)])]),default:_(()=>{return[Ke.value.quality?(p(),m("div",Ie,[f("div",Ne,[l[43]||(l[43]=f("span",{class:"quality-label"},"整体评分：",-1)),g(zl,{modelValue:Ke.value.quality.score,"onUpdate:modelValue":l[8]||(l[8]=e=>Ke.value.quality.score=e),disabled:"","show-score":"","text-color":"#ff9900"},null,8,["modelValue"])]),f("div",Ue,[l[44]||(l[44]=f("span",{class:"quality-label"},"音频质量：",-1)),g(jl,{percentage:Ke.value.quality.audioQuality,color:(e=Ke.value.quality.audioQuality,e>=80?"#67C23A":e>=60?"#E6A23C":"#F56C6C")},null,8,["percentage","color"])]),f("div",De,[l[45]||(l[45]=f("span",{class:"quality-label"},"网络延迟：",-1)),f("span",null,w(Ke.value.quality.latency)+"ms",1)]),f("div",Se,[l[46]||(l[46]=f("span",{class:"quality-label"},"丢包率：",-1)),f("span",null,w(Ke.value.quality.packetLoss)+"%",1)])])):(p(),m("div",Te,[g(Ol,{description:"暂无质量数据","image-size":80})]))];var e}),_:1})]),_:1})]),_:1}),Ke.value.notes?(p(),k(i,{key:0,style:{"margin-top":"20px"}},{header:_(()=>[...l[47]||(l[47]=[f("span",null,"通话备注",-1)])]),default:_(()=>[f("div",Pe,w(Ke.value.notes),1)]),_:1})):q("",!0),Ke.value.hasRecording?(p(),k(i,{key:1,style:{"margin-top":"20px"}},{header:_(()=>[...l[48]||(l[48]=[f("span",null,"录音播放",-1)])]),default:_(()=>[f("div",je,[f("audio",{ref:"audioPlayer",controls:"",style:{width:"100%"},src:Ke.value.recordingUrl}," 您的浏览器不支持音频播放 ",8,Oe),f("div",$e,[g(s,{size:"small",onClick:l[9]||(l[9]=e=>_l(Ke.value))},{default:_(()=>[g(t,null,{default:_(()=>[g(h(I))]),_:1}),l[49]||(l[49]=y(" 下载录音 ",-1))]),_:1}),g(s,{size:"small",onClick:l[10]||(l[10]=e=>hl(Ke.value))},{default:_(()=>[g(t,null,{default:_(()=>[g(h(M))]),_:1}),l[50]||(l[50]=y(" 分享录音 ",-1))]),_:1})])])]),_:1})):q("",!0)])):q("",!0)]),_:1},8,["modelValue"]),g($l,{modelValue:Be.value,"onUpdate:modelValue":l[16]||(l[16]=e=>Be.value=e),title:"编辑通话记录",width:"600px","close-on-click-modal":!1},{footer:_(()=>[g(s,{onClick:l[15]||(l[15]=e=>Be.value=!1)},{default:_(()=>[...l[51]||(l[51]=[y("取消",-1)])]),_:1}),g(s,{type:"primary",onClick:gl,loading:Ee.value},{default:_(()=>[...l[52]||(l[52]=[y(" 保存 ",-1)])]),_:1},8,["loading"])]),default:_(()=>[g(xl,{model:ll,rules:tl,ref_key:"editFormRef",ref:al,"label-width":"100px"},{default:_(()=>[g(dl,{label:"客户姓名",prop:"customerName"},{default:_(()=>[g(kl,{modelValue:ll.customerName,"onUpdate:modelValue":l[12]||(l[12]=e=>ll.customerName=e),placeholder:"请输入客户姓名"},null,8,["modelValue"])]),_:1}),g(dl,{label:"通话备注",prop:"notes"},{default:_(()=>[g(kl,{modelValue:ll.notes,"onUpdate:modelValue":l[13]||(l[13]=e=>ll.notes=e),type:"textarea",rows:4,placeholder:"请输入通话备注"},null,8,["modelValue"])]),_:1}),g(dl,{label:"通话质量"},{default:_(()=>[g(zl,{modelValue:ll.qualityScore,"onUpdate:modelValue":l[14]||(l[14]=e=>ll.qualityScore=e),"show-text":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0c31ac21"]]);export{Me as default};
