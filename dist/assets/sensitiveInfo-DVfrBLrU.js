import{S as t,u as s,n as e,P as n}from"./index-DkAJPKqn.js";const r={[t.PHONE]:{showStart:3,showEnd:4,maskChar:"*",minLength:7},[t.ID_CARD]:{showStart:4,showEnd:4,maskChar:"*",minLength:8},[t.EMAIL]:{showStart:2,showEnd:0,maskChar:"*",minLength:5},[t.WECHAT]:{showStart:2,showEnd:2,maskChar:"*",minLength:4},[t.ADDRESS]:{showStart:6,showEnd:0,maskChar:"*",minLength:10},[t.BANK_ACCOUNT]:{showStart:4,showEnd:4,maskChar:"*",minLength:8},[t.FINANCIAL]:{showStart:0,showEnd:0,maskChar:"*",minLength:1}};class a{static applyMask(t,s){if(!t||t.length<s.minLength)return t;const{showStart:e,showEnd:n,maskChar:r}=s,a=e+n;if(t.length<=a)return t;const i=t.substring(0,e),c=n>0?t.substring(t.length-n):"",h=t.length-a;return i+r.repeat(h)+c}static maskPhone(s){if(!s||"string"!=typeof s)return s||"";const e=s.replace(/\D/g,"");return 11===e.length?e.substring(0,3)+"****"+e.substring(7):e.length>=7?a.applyMask(e,r[t.PHONE]):s}static maskIdCard(s){return s&&"string"==typeof s?a.applyMask(s,r[t.ID_CARD]):s||""}static maskEmail(t){if(!t||"string"!=typeof t)return t||"";const s=t.indexOf("@");if(-1===s)return t;const e=t.substring(0,s),n=t.substring(s);return e.length<=2?t:e.length<=4?e.charAt(0)+"*".repeat(e.length-2)+e.charAt(e.length-1)+n:e.substring(0,2)+"*".repeat(e.length-3)+e.charAt(e.length-1)+n}static maskWechat(s){return s&&"string"==typeof s?a.applyMask(s,r[t.WECHAT]):s||""}static maskAddress(t){return t&&"string"==typeof t?t.length<=10?t:t.substring(0,6)+"*".repeat(Math.min(t.length-6,8)):t||""}static maskBankAccount(s){return s&&"string"==typeof s?a.applyMask(s,r[t.BANK_ACCOUNT]):s||""}static maskFinancial(t){return t&&"string"==typeof t?"***":t||""}static maskByType(s,e){switch(e){case t.PHONE:return a.maskPhone(s);case t.ID_CARD:return a.maskIdCard(s);case t.EMAIL:return a.maskEmail(s);case t.WECHAT:return a.maskWechat(s);case t.ADDRESS:return a.maskAddress(s);case t.BANK_ACCOUNT:return a.maskBankAccount(s);case t.FINANCIAL:return a.maskFinancial(s);default:return s}}static displaySensitiveInfo(t,r,i){if(!t)return t;if(!i)try{const t=s();i=t.currentUser?.id}catch(h){console.warn("无法获取当前用户信息，使用受限模式显示敏感信息")}if(!i)return a.maskByType(t,r);const c=e.checkSensitiveInfoAccess(i,r);if(e.logAccess(i,r,"view",c.hasAccess),c.hasAccess){if(c.level===n.FULL_ACCESS)return t;if(c.level===n.PARTIAL_ACCESS)return a.maskByType(t,r)}return a.maskByType(t,r)}static batchDisplaySensitiveInfo(t,s,e){const n={...t};for(const[r,i]of Object.entries(s))n[r]&&(n[r]=a.displaySensitiveInfo(n[r],i,e));return n}static canViewSensitiveInfo(t,n){if(!n)try{const t=s();n=t.currentUser?.id}catch(r){return!1}if(!n)return!1;return e.checkSensitiveInfoAccess(n,t).hasAccess}static getAccessLevel(t,r){if(!r)try{const t=s();r=t.currentUser?.id}catch(a){return n.RESTRICTED}if(!r)return n.RESTRICTED;return e.checkSensitiveInfoAccess(r,t).level}}const{displaySensitiveInfo:i}=a,c=a.displaySensitiveInfo;export{c as a,i as d};
