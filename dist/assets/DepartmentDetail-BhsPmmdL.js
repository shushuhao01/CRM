import{l as ts,aC as as,az as os,r as P,e as k,w as ls,c as is,ag as h,m as v,p as u,q as s,Q as C,U as t,O as i,S as c,u as d,T as n,F as N,a9 as z,M as ns}from"./vendor-D8Vxqhr-.js";import{c as ds,_ as rs}from"./settings-CuxbDWOu.js";import{E as Q,a3 as cs,a7 as us,F as U,a2 as _s,d as ms,aC as q,aI as vs,aR as ps,l as fs,i as hs,aQ as gs,G as ys}from"./elementPlus-Bmwh7Rh8.js";import{useDepartmentStore as bs}from"./department-CTOju6hT.js";import{D as ks}from"./DepartmentDialog-CYatLe97.js";import"./utils-ywHRn0uI.js";import"./departmentPermissionService--eajZN4h.js";const Ds={class:"department-detail-container"},ws={class:"page-header"},Cs={class:"header-left"},Ns={class:"title-section"},zs={class:"page-title"},Is={class:"department-meta"},Vs={class:"level-info"},Bs={class:"header-actions"},Ss={class:"info-section"},xs={class:"info-card"},Es={class:"card-header"},Ms={class:"info-grid"},As={class:"info-item"},Fs={class:"value"},Ls={class:"info-item"},Rs={class:"value"},Ts={class:"info-item"},$s={class:"value"},Ps={class:"info-item"},Qs={class:"value"},Us={class:"info-item"},qs={class:"value"},Gs={class:"info-item"},Os={class:"info-item"},js={class:"value"},Hs={class:"info-item"},Js={class:"value"},Ks={key:0,class:"description-section"},Ws={class:"description-text"},Xs={class:"stats-card"},Ys={class:"card-header"},Zs={class:"stats-list"},se={class:"stat-item"},ee={class:"stat-icon members"},te={class:"stat-content"},ae={class:"stat-number"},oe={class:"stat-item"},le={class:"stat-icon children"},ie={class:"stat-content"},ne={class:"stat-number"},de={class:"stat-item"},re={class:"stat-icon permissions"},ce={class:"stat-content"},ue={class:"stat-number"},_e={key:0,class:"manager-section"},me={class:"section-card"},ve={class:"card-header"},pe={class:"manager-info"},fe={class:"manager-details"},he={class:"manager-name"},ge={class:"manager-id"},ye={class:"manager-actions"},be={class:"permissions-section"},ke={class:"section-card"},De={class:"card-header"},we={class:"permissions-grid"},Ce={class:"category-header"},Ne={class:"category-name"},ze={class:"permission-list"},Ie={key:1,class:"children-section"},Ve={class:"section-card"},Be={class:"card-header"},Se={class:"children-list"},xe=["onClick"],Ee={class:"child-info"},Me={class:"child-details"},Ae={class:"child-name"},Fe={class:"child-code"},Le={class:"child-stats"},Re={class:"member-count"},Te=ts({__name:"DepartmentDetail",setup($e){const I=as(),G=os(),g=ds(G),D=bs(),y=P(I.params.id),b=P(!1),a=k(()=>D.getDepartmentById(y.value)),O=k(()=>{var e;if(!((e=a.value)!=null&&e.parentId))return null;const l=D.getDepartmentById(a.value.parentId);return l==null?void 0:l.name}),w=k(()=>D.departmentList.filter(l=>l.parentId===y.value)),j=k(()=>{var e;if(!((e=a.value)!=null&&e.permissions))return{};const l={};return a.value.permissions.forEach(p=>{const[_]=p.split(":");l[_]||(l[_]=[]),l[_].push(p)}),l}),H=()=>{g.push("/system/departments")},J=()=>{b.value=!0},K=()=>{g.push(`/system/department/members/${y.value}`)},W=l=>{g.push(`/system/department/detail/${l.id}`)},X=()=>{b.value=!1,Q.success("部门信息已更新")},V=l=>l?new Date(l).toLocaleString("zh-CN"):"-",Y=l=>({customer:"客户管理",order:"订单管理",finance:"财务管理",logistics:"物流管理",service:"客服管理",performance:"绩效管理",system:"系统管理",all:"全部权限"})[l]||l,Z=l=>({"customer:read":"查看客户","customer:write":"编辑客户","customer:delete":"删除客户","order:read":"查看订单","order:write":"编辑订单","order:audit":"审核订单","order:delete":"删除订单","finance:read":"查看财务","finance:write":"编辑财务","logistics:read":"查看物流","logistics:write":"编辑物流","service:read":"查看客服","service:write":"编辑客服","performance:read":"查看绩效","performance:write":"编辑绩效","system:read":"查看系统","system:write":"编辑系统",all:"全部权限"})[l]||l;return ls(()=>I.params.id,l=>{l&&(y.value=l)},{immediate:!0}),is(()=>{a.value||(Q.error("部门不存在"),g.push("/system/departments"))}),(l,e)=>{var S,x,E,M;const p=h("el-button"),_=h("el-tag"),r=h("el-icon"),B=h("el-col"),ss=h("el-row"),es=h("el-avatar");return u(),v("div",Ds,[s("div",ws,[s("div",Cs,[t(p,{icon:d(cs),onClick:H,class:"back-btn"},{default:i(()=>[...e[1]||(e[1]=[c("返回",-1)])]),_:1},8,["icon"]),s("div",Ns,[s("h2",zs,n((S=a.value)==null?void 0:S.name),1),s("div",Is,[t(_,{type:"primary",size:"small"},{default:i(()=>{var o;return[c(n((o=a.value)==null?void 0:o.code),1)]}),_:1}),s("span",Vs,n((x=a.value)==null?void 0:x.level)+"级部门",1),t(_,{type:((E=a.value)==null?void 0:E.status)==="active"?"success":"danger",size:"small"},{default:i(()=>{var o;return[c(n(((o=a.value)==null?void 0:o.status)==="active"?"活跃":"停用"),1)]}),_:1},8,["type"])])])]),s("div",Bs,[t(p,{type:"primary",icon:d(us),onClick:J,class:"edit-btn"},{default:i(()=>[...e[2]||(e[2]=[c(" 编辑部门 ",-1)])]),_:1},8,["icon"]),t(p,{type:"success",icon:d(U),onClick:K,class:"members-btn"},{default:i(()=>[...e[3]||(e[3]=[c(" 成员管理 ",-1)])]),_:1},8,["icon"])])]),s("div",Ss,[t(ss,{gutter:24},{default:i(()=>[t(B,{span:16},{default:i(()=>{var o,m,f,A,F,L,R,T;return[s("div",xs,[s("div",Es,[e[4]||(e[4]=s("h3",null,"基本信息",-1)),t(r,{class:"header-icon"},{default:i(()=>[t(d(_s))]),_:1})]),s("div",Ms,[s("div",As,[e[5]||(e[5]=s("span",{class:"label"},"部门名称",-1)),s("span",Fs,n((o=a.value)==null?void 0:o.name),1)]),s("div",Ls,[e[6]||(e[6]=s("span",{class:"label"},"部门编码",-1)),s("span",Rs,n((m=a.value)==null?void 0:m.code),1)]),s("div",Ts,[e[7]||(e[7]=s("span",{class:"label"},"部门层级",-1)),s("span",$s,n((f=a.value)==null?void 0:f.level)+"级",1)]),s("div",Ps,[e[8]||(e[8]=s("span",{class:"label"},"排序位置",-1)),s("span",Qs,"第"+n((A=a.value)==null?void 0:A.sort)+"位",1)]),s("div",Us,[e[9]||(e[9]=s("span",{class:"label"},"上级部门",-1)),s("span",qs,n(O.value||"无（顶级部门）"),1)]),s("div",Gs,[e[10]||(e[10]=s("span",{class:"label"},"部门状态",-1)),t(_,{type:((F=a.value)==null?void 0:F.status)==="active"?"success":"danger",size:"small"},{default:i(()=>{var $;return[c(n((($=a.value)==null?void 0:$.status)==="active"?"活跃":"停用"),1)]}),_:1},8,["type"])]),s("div",Os,[e[11]||(e[11]=s("span",{class:"label"},"创建时间",-1)),s("span",js,n(V((L=a.value)==null?void 0:L.createdAt)),1)]),s("div",Hs,[e[12]||(e[12]=s("span",{class:"label"},"更新时间",-1)),s("span",Js,n(V((R=a.value)==null?void 0:R.updatedAt)),1)])]),(T=a.value)!=null&&T.description?(u(),v("div",Ks,[e[13]||(e[13]=s("h4",null,"部门描述",-1)),s("p",Ws,n(a.value.description),1)])):C("",!0)])]}),_:1}),t(B,{span:8},{default:i(()=>{var o,m,f;return[s("div",Xs,[s("div",Ys,[e[14]||(e[14]=s("h3",null,"统计信息",-1)),t(r,{class:"header-icon"},{default:i(()=>[t(d(ms))]),_:1})]),s("div",Zs,[s("div",se,[s("div",ee,[t(r,null,{default:i(()=>[t(d(U))]),_:1})]),s("div",te,[s("div",ae,n(((o=a.value)==null?void 0:o.memberCount)||0),1),e[15]||(e[15]=s("div",{class:"stat-label"},"部门成员",-1))])]),s("div",oe,[s("div",le,[t(r,null,{default:i(()=>[t(d(q))]),_:1})]),s("div",ie,[s("div",ne,n(w.value.length),1),e[16]||(e[16]=s("div",{class:"stat-label"},"子部门",-1))])]),s("div",de,[s("div",re,[t(r,null,{default:i(()=>[t(d(vs))]),_:1})]),s("div",ce,[s("div",ue,n(((f=(m=a.value)==null?void 0:m.permissions)==null?void 0:f.length)||0),1),e[17]||(e[17]=s("div",{class:"stat-label"},"权限数量",-1))])])])])]}),_:1})]),_:1})]),(M=a.value)!=null&&M.managerId?(u(),v("div",_e,[s("div",me,[s("div",ve,[e[18]||(e[18]=s("h3",null,"部门负责人",-1)),t(r,{class:"header-icon"},{default:i(()=>[t(d(ps))]),_:1})]),s("div",pe,[t(es,{size:60,class:"manager-avatar"},{default:i(()=>{var o;return[c(n((o=a.value.managerName)==null?void 0:o.charAt(0)),1)]}),_:1}),s("div",fe,[s("div",he,n(a.value.managerName),1),s("div",ge,"用户ID: "+n(a.value.managerId),1),e[19]||(e[19]=s("div",{class:"manager-role"},"部门负责人",-1))]),s("div",ye,[t(p,{size:"small",type:"primary",link:""},{default:i(()=>[...e[20]||(e[20]=[c(" 查看详情 ",-1)])]),_:1}),t(p,{size:"small",type:"primary",link:""},{default:i(()=>[...e[21]||(e[21]=[c(" 发送消息 ",-1)])]),_:1})])])])])):C("",!0),s("div",be,[s("div",ke,[s("div",De,[e[22]||(e[22]=s("h3",null,"部门权限",-1)),t(r,{class:"header-icon"},{default:i(()=>[t(d(fs))]),_:1})]),s("div",we,[(u(!0),v(N,null,z(j.value,(o,m)=>(u(),v("div",{key:m,class:"permission-category"},[s("div",Ce,[t(r,{class:"category-icon"},{default:i(()=>[t(d(hs))]),_:1}),s("span",Ne,n(Y(m)),1)]),s("div",ze,[(u(!0),v(N,null,z(o,f=>(u(),ns(_,{key:f,type:"info",size:"small",class:"permission-tag"},{default:i(()=>[c(n(Z(f)),1)]),_:2},1024))),128))])]))),128))])])]),w.value.length>0?(u(),v("div",Ie,[s("div",Ve,[s("div",Be,[e[23]||(e[23]=s("h3",null,"子部门",-1)),t(r,{class:"header-icon"},{default:i(()=>[t(d(gs))]),_:1})]),s("div",Se,[(u(!0),v(N,null,z(w.value,o=>(u(),v("div",{key:o.id,class:"child-item",onClick:m=>W(o)},[s("div",Ee,[t(r,{class:"child-icon"},{default:i(()=>[t(d(q))]),_:1}),s("div",Me,[s("div",Ae,n(o.name),1),s("div",Fe,n(o.code),1)])]),s("div",Le,[s("span",Re,n(o.memberCount)+"人",1),t(_,{type:o.status==="active"?"success":"danger",size:"small"},{default:i(()=>[c(n(o.status==="active"?"活跃":"停用"),1)]),_:2},1032,["type"])]),t(r,{class:"arrow-icon"},{default:i(()=>[t(d(ys))]),_:1})],8,xe))),128))])])])):C("",!0),t(ks,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o),department:a.value,"is-edit":!0,onSuccess:X},null,8,["modelValue","department"])])}}}),He=rs(Te,[["__scopeId","data-v-728a6cda"]]);export{He as default};
