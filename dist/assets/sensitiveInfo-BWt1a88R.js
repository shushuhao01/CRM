var y=Object.defineProperty;var k=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var o=(c,t,s)=>t in c?y(c,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[t]=s,u=(c,t)=>{for(var s in t||(t={}))E.call(t,s)&&o(c,s,t[s]);if(k)for(var s of k(t))S.call(t,s)&&o(c,s,t[s]);return c};import{S as i,u as f,w as m,J as A}from"./settings-CuxbDWOu.js";const g={[i.PHONE]:{showStart:3,showEnd:4,maskChar:"*",minLength:7},[i.ID_CARD]:{showStart:4,showEnd:4,maskChar:"*",minLength:8},[i.EMAIL]:{showStart:2,showEnd:0,maskChar:"*",minLength:5},[i.WECHAT]:{showStart:2,showEnd:2,maskChar:"*",minLength:4},[i.ADDRESS]:{showStart:6,showEnd:0,maskChar:"*",minLength:10},[i.BANK_ACCOUNT]:{showStart:4,showEnd:4,maskChar:"*",minLength:8},[i.FINANCIAL]:{showStart:0,showEnd:0,maskChar:"*",minLength:1}};class e{static applyMask(t,s){if(!t||t.length<s.minLength)return t;const{showStart:n,showEnd:r,maskChar:a}=s,h=n+r;if(t.length<=h)return t;const p=t.substring(0,n),l=r>0?t.substring(t.length-r):"",C=t.length-h;return p+a.repeat(C)+l}static maskPhone(t){if(!t||typeof t!="string")return t||"";const s=t.replace(/\D/g,"");return s.length===11?s.substring(0,3)+"****"+s.substring(7):s.length>=7?e.applyMask(s,g[i.PHONE]):t}static maskIdCard(t){return!t||typeof t!="string"?t||"":e.applyMask(t,g[i.ID_CARD])}static maskEmail(t){if(!t||typeof t!="string")return t||"";const s=t.indexOf("@");if(s===-1)return t;const n=t.substring(0,s),r=t.substring(s);return n.length<=2?t:n.length<=4?n.charAt(0)+"*".repeat(n.length-2)+n.charAt(n.length-1)+r:n.substring(0,2)+"*".repeat(n.length-3)+n.charAt(n.length-1)+r}static maskWechat(t){return!t||typeof t!="string"?t||"":e.applyMask(t,g[i.WECHAT])}static maskAddress(t){return!t||typeof t!="string"?t||"":t.length<=10?t:t.substring(0,6)+"*".repeat(Math.min(t.length-6,8))}static maskBankAccount(t){return!t||typeof t!="string"?t||"":e.applyMask(t,g[i.BANK_ACCOUNT])}static maskFinancial(t){return!t||typeof t!="string"?t||"":"***"}static maskByType(t,s){switch(s){case i.PHONE:return e.maskPhone(t);case i.ID_CARD:return e.maskIdCard(t);case i.EMAIL:return e.maskEmail(t);case i.WECHAT:return e.maskWechat(t);case i.ADDRESS:return e.maskAddress(t);case i.BANK_ACCOUNT:return e.maskBankAccount(t);case i.FINANCIAL:return e.maskFinancial(t);default:return t}}static displaySensitiveInfo(t,s,n){var a;if(!t)return t;if(!n)try{n=(a=f().currentUser)==null?void 0:a.id}catch(h){console.warn("无法获取当前用户信息，使用受限模式显示敏感信息")}if(!n)return e.maskByType(t,s);const r=m.checkSensitiveInfoAccess(n,s);if(m.logAccess(n,s,"view",r.hasAccess),r.hasAccess){if(r.level===A.FULL_ACCESS)return t;if(r.level===A.PARTIAL_ACCESS)return e.maskByType(t,s)}return e.maskByType(t,s)}static batchDisplaySensitiveInfo(t,s,n){const r=u({},t);for(const[a,h]of Object.entries(s))r[a]&&(r[a]=e.displaySensitiveInfo(r[a],h,n));return r}static canViewSensitiveInfo(t,s){var r;if(!s)try{s=(r=f().currentUser)==null?void 0:r.id}catch(a){return!1}return s?m.checkSensitiveInfoAccess(s,t).hasAccess:!1}static getAccessLevel(t,s){var r;if(!s)try{s=(r=f().currentUser)==null?void 0:r.id}catch(a){return A.RESTRICTED}return s?m.checkSensitiveInfoAccess(s,t).level:A.RESTRICTED}}const{displaySensitiveInfo:T}=e,D=e.displaySensitiveInfo;export{D as a,T as d};
