var ql=Object.defineProperty,El=Object.defineProperties;var Nl=Object.getOwnPropertyDescriptors;var dl=Object.getOwnPropertySymbols;var Yl=Object.prototype.hasOwnProperty,Hl=Object.prototype.propertyIsEnumerable;var il=(V,K,x)=>K in V?ql(V,K,{enumerable:!0,configurable:!0,writable:!0,value:x}):V[K]=x,Le=(V,K)=>{for(var x in K||(K={}))Yl.call(K,x)&&il(V,x,K[x]);if(dl)for(var x of dl(K))Hl.call(K,x)&&il(V,x,K[x]);return V},tl=(V,K)=>El(V,Nl(K));var fe=(V,K,x)=>new Promise((k,U)=>{var M=c=>{try{j(x.next(c))}catch(u){U(u)}},O=c=>{try{j(x.throw(c))}catch(u){U(u)}},j=c=>c.done?k(c.value):Promise.resolve(c.value).then(M,O);j((x=x.apply(V,K)).next())});import{l as xe,az as Jl,r as w,ag as o,m as R,p as i,q as t,U as e,O as l,u as $,S as a,aA as Pe,e as de,w as qe,M as D,Q as oe,F as te,a9 as se,T as g,aq as ml,P as Ke,R as Kl,c as Gl}from"./vendor-D8Vxqhr-.js";import{i as al,x as Zl,D as Ql,F as je,G as Te,l as Me,H as Fe,C as Ge,I as Wl,E as P,J as Je,p as Ze,K as Xl,s as Qe,b as Se,e as Ae,f as ze,L as et,M as lt,d as tt,N as at,O as st,u as ul,n as rl,P as ot,r as nt}from"./elementPlus-Bmwh7Rh8.js";import{_ as $e}from"./settings-CuxbDWOu.js";const dt={class:"permission-management"},it={class:"page-header"},ut={class:"header-content"},rt={class:"header-icon"},mt={class:"view-toggle"},pt={key:0,class:"permission-grid"},ct={class:"card-header"},vt={class:"card-icon roles-icon"},ft={class:"card-footer"},_t={class:"card-stats"},gt={class:"stat-item"},bt={class:"card-header"},yt={class:"card-icon sensitive-icon"},wt={class:"card-footer"},Vt={class:"card-stats"},kt={class:"stat-item"},Ct={class:"card-header"},xt={class:"card-icon admin-icon"},$t={class:"card-footer"},Ut={class:"card-stats"},Pt={class:"stat-item"},Tt={class:"card-header"},St={class:"card-icon service-icon"},Dt={class:"card-footer"},Rt={class:"card-stats"},Lt={class:"stat-item"},At={class:"card-header"},zt={class:"card-icon guide-icon"},It={class:"card-footer"},Mt={class:"card-stats"},ht={class:"stat-item"},Bt={key:1,class:"permission-list"},Ot={class:"list-container"},jt={class:"list-icon roles-icon"},Ft={class:"list-action"},qt={class:"list-icon sensitive-icon"},Et={class:"list-action"},Nt={class:"list-icon admin-icon"},Yt={class:"list-action"},Ht={class:"list-icon service-icon"},Jt={class:"list-action"},Kt={class:"list-icon guide-icon"},Gt={class:"list-action"},Zt={class:"quick-actions"},Qt={class:"quick-actions-grid"},Wt=xe({__name:"PermissionManagement",setup(V){const K=Jl(),x=w("card"),k=()=>{K.push("/system/roles")},U=()=>{K.push("/system/sensitive-info-permissions")},M=()=>{K.push("/system/super-admin-panel")},O=()=>{K.push("/system/customer-service-permissions")},j=()=>{K.push("/system/permission-guide")};return(c,u)=>{const m=o("el-icon"),I=o("el-button"),T=o("el-button-group"),q=o("el-card");return i(),R("div",dt,[t("div",it,[u[5]||(u[5]=t("div",{class:"header-background"},null,-1)),t("div",ut,[t("div",rt,[e(m,{size:"32"},{default:l(()=>[e($(al))]),_:1})]),u[4]||(u[4]=t("div",{class:"header-text"},[t("h1",{class:"page-title"},"权限管理中心"),t("p",{class:"page-subtitle"},"统一管理系统权限，确保数据安全与访问控制")],-1)),t("div",mt,[e(T,null,{default:l(()=>[e(I,{type:x.value==="card"?"primary":"default",onClick:u[0]||(u[0]=C=>x.value="card"),icon:$(Zl)},{default:l(()=>[...u[2]||(u[2]=[a(" 卡片视图 ",-1)])]),_:1},8,["type","icon"]),e(I,{type:x.value==="list"?"primary":"default",onClick:u[1]||(u[1]=C=>x.value="list"),icon:$(Ql)},{default:l(()=>[...u[3]||(u[3]=[a(" 列表视图 ",-1)])]),_:1},8,["type","icon"])]),_:1})])])]),x.value==="card"?(i(),R("div",pt,[t("div",{class:"permission-card roles-card",onClick:k},[t("div",ct,[t("div",vt,[e(m,{size:"32"},{default:l(()=>[e($(je))]),_:1})]),u[6]||(u[6]=t("div",{class:"card-badge"},"基础权限",-1))]),u[8]||(u[8]=Pe('<div class="card-content" data-v-9d5a097a><h3 class="card-title" data-v-9d5a097a>角色权限管理</h3><p class="card-description" data-v-9d5a097a>管理系统角色和基础权限分配</p><div class="feature-tags" data-v-9d5a097a><span class="feature-tag" data-v-9d5a097a>角色管理</span><span class="feature-tag" data-v-9d5a097a>权限分配</span><span class="feature-tag" data-v-9d5a097a>权限树</span></div></div>',1)),t("div",ft,[t("div",_t,[t("span",gt,[e(m,null,{default:l(()=>[e($(je))]),_:1}),u[7]||(u[7]=a(" 角色管理 ",-1))])]),e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"permission-card sensitive-card",onClick:U},[t("div",bt,[t("div",yt,[e(m,{size:"32"},{default:l(()=>[e($(Me))]),_:1})]),u[9]||(u[9]=t("div",{class:"card-badge security"},"安全权限",-1))]),u[11]||(u[11]=Pe('<div class="card-content" data-v-9d5a097a><h3 class="card-title" data-v-9d5a097a>敏感信息权限</h3><p class="card-description" data-v-9d5a097a>精确控制客户敏感信息的访问权限</p><div class="feature-tags" data-v-9d5a097a><span class="feature-tag" data-v-9d5a097a>手机号</span><span class="feature-tag" data-v-9d5a097a>身份证</span><span class="feature-tag" data-v-9d5a097a>邮箱</span></div></div>',1)),t("div",wt,[t("div",Vt,[t("span",kt,[e(m,null,{default:l(()=>[e($(Me))]),_:1}),u[10]||(u[10]=a(" 隐私保护 ",-1))])]),e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"permission-card admin-card",onClick:M},[t("div",Ct,[t("div",xt,[e(m,{size:"32"},{default:l(()=>[e($(Me))]),_:1})]),u[12]||(u[12]=t("div",{class:"card-badge admin"},"高级权限",-1))]),u[14]||(u[14]=Pe('<div class="card-content" data-v-9d5a097a><h3 class="card-title" data-v-9d5a097a>超管面板</h3><p class="card-description" data-v-9d5a097a>高级权限管理功能和审计监控</p><div class="feature-tags" data-v-9d5a097a><span class="feature-tag" data-v-9d5a097a>批量管理</span><span class="feature-tag" data-v-9d5a097a>模板配置</span><span class="feature-tag" data-v-9d5a097a>审计日志</span></div></div>',1)),t("div",$t,[t("div",Ut,[t("span",Pt,[e(m,null,{default:l(()=>[e($(Me))]),_:1}),u[13]||(u[13]=a(" 超级权限 ",-1))])]),e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"permission-card service-card",onClick:O},[t("div",Tt,[t("div",St,[e(m,{size:"32"},{default:l(()=>[e($(Fe))]),_:1})]),u[15]||(u[15]=t("div",{class:"card-badge service"},"业务权限",-1))]),u[17]||(u[17]=Pe('<div class="card-content" data-v-9d5a097a><h3 class="card-title" data-v-9d5a097a>客服管理</h3><p class="card-description" data-v-9d5a097a>专门针对客服业务场景的权限配置</p><div class="feature-tags" data-v-9d5a097a><span class="feature-tag" data-v-9d5a097a>客服分组</span><span class="feature-tag" data-v-9d5a097a>业务权限</span><span class="feature-tag" data-v-9d5a097a>数据范围</span></div></div>',1)),t("div",Dt,[t("div",Rt,[t("span",Lt,[e(m,null,{default:l(()=>[e($(Fe))]),_:1}),u[16]||(u[16]=a(" 客服管理 ",-1))])]),e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"permission-card guide-card",onClick:j},[t("div",At,[t("div",zt,[e(m,{size:"32"},{default:l(()=>[e($(Ge))]),_:1})]),u[18]||(u[18]=t("div",{class:"card-badge guide"},"使用指南",-1))]),u[20]||(u[20]=Pe('<div class="card-content" data-v-9d5a097a><h3 class="card-title" data-v-9d5a097a>权限管理指南</h3><p class="card-description" data-v-9d5a097a>详细了解各个权限管理页面的功能</p><div class="feature-tags" data-v-9d5a097a><span class="feature-tag" data-v-9d5a097a>功能对比</span><span class="feature-tag" data-v-9d5a097a>使用说明</span><span class="feature-tag" data-v-9d5a097a>最佳实践</span></div></div>',1)),t("div",It,[t("div",Mt,[t("span",ht,[e(m,null,{default:l(()=>[e($(Ge))]),_:1}),u[19]||(u[19]=a(" 帮助文档 ",-1))])]),e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])])])):(i(),R("div",Bt,[t("div",Ot,[t("div",{class:"list-item",onClick:k},[t("div",jt,[e(m,null,{default:l(()=>[e($(je))]),_:1})]),u[21]||(u[21]=Pe('<div class="list-content" data-v-9d5a097a><div class="list-header" data-v-9d5a097a><h3 class="list-title" data-v-9d5a097a>角色权限管理</h3><span class="list-badge" data-v-9d5a097a>基础权限</span></div><p class="list-description" data-v-9d5a097a>管理系统角色和基础权限分配</p><div class="list-tags" data-v-9d5a097a><span class="list-tag" data-v-9d5a097a>角色管理</span><span class="list-tag" data-v-9d5a097a>权限分配</span><span class="list-tag" data-v-9d5a097a>权限树</span></div></div>',1)),t("div",Ft,[e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"list-item",onClick:U},[t("div",qt,[e(m,null,{default:l(()=>[e($(Me))]),_:1})]),u[22]||(u[22]=Pe('<div class="list-content" data-v-9d5a097a><div class="list-header" data-v-9d5a097a><h3 class="list-title" data-v-9d5a097a>敏感信息权限</h3><span class="list-badge security" data-v-9d5a097a>安全权限</span></div><p class="list-description" data-v-9d5a097a>精确控制客户敏感信息的访问权限</p><div class="list-tags" data-v-9d5a097a><span class="list-tag" data-v-9d5a097a>手机号</span><span class="list-tag" data-v-9d5a097a>身份证</span><span class="list-tag" data-v-9d5a097a>邮箱</span></div></div>',1)),t("div",Et,[e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"list-item",onClick:M},[t("div",Nt,[e(m,null,{default:l(()=>[e($(Me))]),_:1})]),u[23]||(u[23]=Pe('<div class="list-content" data-v-9d5a097a><div class="list-header" data-v-9d5a097a><h3 class="list-title" data-v-9d5a097a>超级管理员面板</h3><span class="list-badge admin" data-v-9d5a097a>高级权限</span></div><p class="list-description" data-v-9d5a097a>高级权限管理功能和审计监控</p><div class="list-tags" data-v-9d5a097a><span class="list-tag" data-v-9d5a097a>批量管理</span><span class="list-tag" data-v-9d5a097a>模板配置</span><span class="list-tag" data-v-9d5a097a>审计日志</span></div></div>',1)),t("div",Yt,[e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"list-item",onClick:O},[t("div",Ht,[e(m,null,{default:l(()=>[e($(Fe))]),_:1})]),u[24]||(u[24]=Pe('<div class="list-content" data-v-9d5a097a><div class="list-header" data-v-9d5a097a><h3 class="list-title" data-v-9d5a097a>客服权限管理</h3><span class="list-badge service" data-v-9d5a097a>业务权限</span></div><p class="list-description" data-v-9d5a097a>专门针对客服业务场景的权限配置</p><div class="list-tags" data-v-9d5a097a><span class="list-tag" data-v-9d5a097a>客服分组</span><span class="list-tag" data-v-9d5a097a>业务权限</span><span class="list-tag" data-v-9d5a097a>数据范围</span></div></div>',1)),t("div",Jt,[e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])]),t("div",{class:"list-item",onClick:j},[t("div",Kt,[e(m,null,{default:l(()=>[e($(Ge))]),_:1})]),u[25]||(u[25]=Pe('<div class="list-content" data-v-9d5a097a><div class="list-header" data-v-9d5a097a><h3 class="list-title" data-v-9d5a097a>权限管理指南</h3><span class="list-badge guide" data-v-9d5a097a>使用指南</span></div><p class="list-description" data-v-9d5a097a>详细了解各个权限管理页面的功能</p><div class="list-tags" data-v-9d5a097a><span class="list-tag" data-v-9d5a097a>功能对比</span><span class="list-tag" data-v-9d5a097a>使用说明</span><span class="list-tag" data-v-9d5a097a>最佳实践</span></div></div>',1)),t("div",Gt,[e(m,{class:"arrow-icon"},{default:l(()=>[e($(Te))]),_:1})])])])])),t("div",Zt,[e(q,{shadow:"never"},{header:l(()=>[...u[26]||(u[26]=[t("div",{class:"quick-actions-header"},[t("span",null,"快速操作")],-1)])]),default:l(()=>[t("div",Qt,[e(I,{onClick:k,class:"quick-action-btn"},{default:l(()=>[e(m,null,{default:l(()=>[e($(je))]),_:1}),u[27]||(u[27]=t("span",null,"角色管理",-1))]),_:1}),e(I,{onClick:U,class:"quick-action-btn"},{default:l(()=>[e(m,null,{default:l(()=>[e($(Me))]),_:1}),u[28]||(u[28]=t("span",null,"敏感权限",-1))]),_:1}),e(I,{onClick:M,class:"quick-action-btn"},{default:l(()=>[e(m,null,{default:l(()=>[e($(Wl))]),_:1}),u[29]||(u[29]=t("span",null,"超级面板",-1))]),_:1}),e(I,{onClick:O,class:"quick-action-btn"},{default:l(()=>[e(m,null,{default:l(()=>[e($(Fe))]),_:1}),u[30]||(u[30]=t("span",null,"客服管理",-1))]),_:1})])]),_:1})])])}}}),Xt=$e(Wt,[["__scopeId","data-v-9d5a097a"]]),ko=Object.freeze(Object.defineProperty({__proto__:null,default:Xt},Symbol.toStringTag,{value:"Module"})),ea={class:"dialog-footer"},la=xe({__name:"UserPermissionDialog",props:{modelValue:{type:Boolean},user:{}},emits:["update:modelValue","confirm"],setup(V,{emit:K}){const x=V,k=K,U=w(),M=w(!1),O=de({get:()=>x.modelValue,set:C=>k("update:modelValue",C)}),j=de(()=>{var C;return!!((C=x.user)!=null&&C.id)}),c=w({name:"",email:"",password:"",confirmPassword:"",departmentId:"",role:"",dataScope:"",permissionLevel:"",status:"active",permissions:[],remark:""}),u=[{label:"客户查看",value:"customer_view"},{label:"客户编辑",value:"customer_edit"},{label:"客户删除",value:"customer_delete"},{label:"订单查看",value:"order_view"},{label:"订单编辑",value:"order_edit"},{label:"订单删除",value:"order_delete"},{label:"报表查看",value:"report_view"},{label:"报表导出",value:"report_export"},{label:"系统设置",value:"system_setting"},{label:"用户管理",value:"user_management"},{label:"权限管理",value:"permission_management"},{label:"数据导入",value:"data_import"}],m={name:[{required:!0,message:"请输入用户姓名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],password:[{required:!0,message:"请输入默认密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@$!%*?&]{6,}$/,message:"密码必须包含大小写字母和数字",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(C,z,G)=>{z!==c.value.password?G(new Error("两次输入的密码不一致")):G()},trigger:"blur"}],departmentId:[{required:!0,message:"请选择所属部门",trigger:"change"}],role:[{required:!0,message:"请选择用户角色",trigger:"change"}],dataScope:[{required:!0,message:"请选择数据权限",trigger:"change"}],permissionLevel:[{required:!0,message:"请选择权限级别",trigger:"change"}]},I=()=>{var C;c.value={name:"",email:"",password:"",confirmPassword:"",departmentId:"",role:"",dataScope:"",permissionLevel:"",status:"active",permissions:[],remark:""},(C=U.value)==null||C.clearValidate()};qe(()=>x.user,C=>{C?c.value=tl(Le({},C),{password:"",confirmPassword:""}):I()},{immediate:!0});const T=()=>{O.value=!1,I()},q=()=>fe(this,null,function*(){try{yield U.value.validate(),M.value=!0,yield new Promise(z=>setTimeout(z,1e3));const C=Le({},c.value);j.value&&delete C.password,delete C.confirmPassword,k("confirm",C),T(),P.success(j.value?"用户权限更新成功":"用户创建成功")}catch(C){console.error("表单验证失败:",C)}finally{M.value=!1}});return(C,z)=>{const G=o("el-input"),N=o("el-form-item"),ee=o("el-col"),le=o("el-row"),Z=o("el-option"),L=o("el-select"),r=o("el-radio"),s=o("el-radio-group"),J=o("el-checkbox"),y=o("el-checkbox-group"),B=o("el-form"),_=o("el-button"),d=o("el-dialog");return i(),D(d,{modelValue:O.value,"onUpdate:modelValue":z[11]||(z[11]=p=>O.value=p),title:j.value?"编辑用户权限":"新增用户",width:"800px",onClose:T},{footer:l(()=>[t("div",ea,[e(_,{onClick:T},{default:l(()=>[...z[14]||(z[14]=[a("取消",-1)])]),_:1}),e(_,{type:"primary",onClick:q,loading:M.value},{default:l(()=>[a(g(j.value?"更新":"创建"),1)]),_:1},8,["loading"])])]),default:l(()=>[e(B,{ref_key:"formRef",ref:U,model:c.value,rules:m,"label-width":"120px"},{default:l(()=>[e(le,{gutter:20},{default:l(()=>[e(ee,{span:12},{default:l(()=>[e(N,{label:"用户姓名",prop:"name"},{default:l(()=>[e(G,{modelValue:c.value.name,"onUpdate:modelValue":z[0]||(z[0]=p=>c.value.name=p),placeholder:"请输入用户姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(ee,{span:12},{default:l(()=>[e(N,{label:"邮箱地址",prop:"email"},{default:l(()=>[e(G,{modelValue:c.value.email,"onUpdate:modelValue":z[1]||(z[1]=p=>c.value.email=p),placeholder:"请输入邮箱地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),j.value?oe("",!0):(i(),D(le,{key:0,gutter:20},{default:l(()=>[e(ee,{span:12},{default:l(()=>[e(N,{label:"默认密码",prop:"password"},{default:l(()=>[e(G,{modelValue:c.value.password,"onUpdate:modelValue":z[2]||(z[2]=p=>c.value.password=p),type:"password",placeholder:"请输入默认密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1}),e(ee,{span:12},{default:l(()=>[e(N,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[e(G,{modelValue:c.value.confirmPassword,"onUpdate:modelValue":z[3]||(z[3]=p=>c.value.confirmPassword=p),type:"password",placeholder:"请再次输入密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})),e(le,{gutter:20},{default:l(()=>[e(ee,{span:12},{default:l(()=>[e(N,{label:"所属部门",prop:"departmentId"},{default:l(()=>[e(L,{modelValue:c.value.departmentId,"onUpdate:modelValue":z[4]||(z[4]=p=>c.value.departmentId=p),placeholder:"请选择部门"},{default:l(()=>[e(Z,{label:"管理部",value:"admin"}),e(Z,{label:"销售一部",value:"sales_1"}),e(Z,{label:"销售二部",value:"sales_2"}),e(Z,{label:"客服部",value:"service"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(ee,{span:12},{default:l(()=>[e(N,{label:"用户角色",prop:"role"},{default:l(()=>[e(L,{modelValue:c.value.role,"onUpdate:modelValue":z[5]||(z[5]=p=>c.value.role=p),placeholder:"请选择角色"},{default:l(()=>[e(Z,{label:"超级管理员",value:"super_admin"}),e(Z,{label:"部门负责人",value:"department_manager"}),e(Z,{label:"销售员",value:"sales_staff"}),e(Z,{label:"客服",value:"customer_service"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(le,{gutter:20},{default:l(()=>[e(ee,{span:12},{default:l(()=>[e(N,{label:"数据权限",prop:"dataScope"},{default:l(()=>[e(L,{modelValue:c.value.dataScope,"onUpdate:modelValue":z[6]||(z[6]=p=>c.value.dataScope=p),placeholder:"请选择数据权限"},{default:l(()=>[e(Z,{label:"全部数据",value:"all"}),e(Z,{label:"部门数据",value:"department"}),e(Z,{label:"个人数据",value:"personal"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(ee,{span:12},{default:l(()=>[e(N,{label:"权限级别",prop:"permissionLevel"},{default:l(()=>[e(L,{modelValue:c.value.permissionLevel,"onUpdate:modelValue":z[7]||(z[7]=p=>c.value.permissionLevel=p),placeholder:"请选择权限级别"},{default:l(()=>[e(Z,{label:"完全权限",value:"full_access"}),e(Z,{label:"部分权限",value:"partial_access"}),e(Z,{label:"只读权限",value:"read_only"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(N,{label:"用户状态",prop:"status"},{default:l(()=>[e(s,{modelValue:c.value.status,"onUpdate:modelValue":z[8]||(z[8]=p=>c.value.status=p)},{default:l(()=>[e(r,{value:"active"},{default:l(()=>[...z[12]||(z[12]=[a("启用",-1)])]),_:1}),e(r,{value:"inactive"},{default:l(()=>[...z[13]||(z[13]=[a("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"功能权限"},{default:l(()=>[e(y,{modelValue:c.value.permissions,"onUpdate:modelValue":z[9]||(z[9]=p=>c.value.permissions=p)},{default:l(()=>[e(le,{gutter:20},{default:l(()=>[(i(),R(te,null,se(u,p=>e(ee,{span:8,key:p.value},{default:l(()=>[e(J,{value:p.value},{default:l(()=>[a(g(p.label),1)]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{label:"备注"},{default:l(()=>[e(G,{modelValue:c.value.remark,"onUpdate:modelValue":z[10]||(z[10]=p=>c.value.remark=p),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ta=$e(la,[["__scopeId","data-v-d0d2dbc9"]]),aa={class:"dialog-footer"},sa={class:"permission-preview"},oa={key:0,class:"no-permissions"},na=xe({__name:"RoleTemplateDialog",props:{modelValue:{type:Boolean},template:{}},emits:["update:modelValue","confirm"],setup(V,{emit:K}){const x=V,k=K,U=w(),M=w(!1),O=w(!1),j=w("customer"),c=de({get:()=>x.modelValue,set:r=>k("update:modelValue",r)}),u=de(()=>{var r;return!!((r=x.template)!=null&&r.id)}),m=w({name:"",description:"",targetRole:"",permissions:[],dataScope:"department",isActive:!0}),I=[{label:"客户查看",value:"customer_view",description:"查看客户基本信息和联系方式"},{label:"客户新增",value:"customer_create",description:"创建新的客户档案"},{label:"客户编辑",value:"customer_edit",description:"修改客户信息"},{label:"客户删除",value:"customer_delete",description:"删除客户档案"},{label:"客户导入",value:"customer_import",description:"批量导入客户数据"},{label:"客户导出",value:"customer_export",description:"导出客户数据"}],T=[{label:"订单查看",value:"order_view",description:"查看订单详情和状态"},{label:"订单创建",value:"order_create",description:"创建新订单"},{label:"订单编辑",value:"order_edit",description:"修改订单信息"},{label:"订单删除",value:"order_delete",description:"删除订单记录"},{label:"订单审核",value:"order_approve",description:"审核订单状态"},{label:"订单发货",value:"order_ship",description:"处理订单发货"}],q=[{label:"销售报表",value:"report_sales",description:"查看销售数据报表"},{label:"客户报表",value:"report_customer",description:"查看客户分析报表"},{label:"业绩报表",value:"report_performance",description:"查看业绩统计报表"},{label:"财务报表",value:"report_finance",description:"查看财务数据报表"},{label:"报表导出",value:"report_export",description:"导出各类报表数据"},{label:"报表打印",value:"report_print",description:"打印报表文档"}],C=[{label:"用户管理",value:"user_management",description:"管理系统用户账户"},{label:"角色管理",value:"role_management",description:"管理用户角色权限"},{label:"部门管理",value:"department_management",description:"管理组织架构"},{label:"系统设置",value:"system_setting",description:"配置系统参数"},{label:"日志查看",value:"log_view",description:"查看系统操作日志"},{label:"数据备份",value:"data_backup",description:"执行数据备份操作"}],z=[...I,...T,...q,...C],G=de(()=>m.value.permissions.map(r=>{const s=z.find(J=>J.value===r);return s?s.label:r})),N={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],description:[{required:!0,message:"请输入模板描述",trigger:"blur"}],targetRole:[{required:!0,message:"请选择适用角色",trigger:"change"}],permissions:[{required:!0,message:"请至少选择一个权限",trigger:"change"}]},ee=()=>{var r;m.value={name:"",description:"",targetRole:"",permissions:[],dataScope:"department",isActive:!0},(r=U.value)==null||r.clearValidate()};qe(()=>x.template,r=>{r?m.value=Le({},r):ee()},{immediate:!0});const le=()=>{c.value=!1,ee()},Z=()=>{O.value=!0},L=()=>fe(this,null,function*(){try{if(yield U.value.validate(),m.value.permissions.length===0){P.warning("请至少选择一个权限");return}M.value=!0,yield new Promise(r=>setTimeout(r,1e3)),k("confirm",Le({},m.value)),le(),P.success(u.value?"角色模板更新成功":"角色模板创建成功")}catch(r){console.error("表单验证失败:",r)}finally{M.value=!1}});return(r,s)=>{const J=o("el-input"),y=o("el-form-item"),B=o("el-col"),_=o("el-option"),d=o("el-select"),p=o("el-row"),X=o("el-icon"),F=o("el-tooltip"),Y=o("el-checkbox"),me=o("el-checkbox-group"),re=o("el-tab-pane"),pe=o("el-tabs"),ie=o("el-radio"),H=o("el-radio-group"),_e=o("el-switch"),b=o("el-form"),Q=o("el-button"),ge=o("el-tag"),ye=o("el-dialog");return i(),D(ye,{modelValue:c.value,"onUpdate:modelValue":s[11]||(s[11]=S=>c.value=S),title:u.value?"编辑角色模板":"创建角色模板",width:"900px",onClose:le},{footer:l(()=>[t("div",aa,[e(Q,{onClick:le},{default:l(()=>[...s[15]||(s[15]=[a("取消",-1)])]),_:1}),e(Q,{onClick:Z,type:"info"},{default:l(()=>[...s[16]||(s[16]=[a("预览权限",-1)])]),_:1}),e(Q,{type:"primary",onClick:L,loading:M.value},{default:l(()=>[a(g(u.value?"更新模板":"创建模板"),1)]),_:1},8,["loading"])])]),default:l(()=>[e(b,{ref_key:"formRef",ref:U,model:m.value,rules:N,"label-width":"120px"},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[e(B,{span:12},{default:l(()=>[e(y,{label:"模板名称",prop:"name"},{default:l(()=>[e(J,{modelValue:m.value.name,"onUpdate:modelValue":s[0]||(s[0]=S=>m.value.name=S),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(B,{span:12},{default:l(()=>[e(y,{label:"适用角色",prop:"targetRole"},{default:l(()=>[e(d,{modelValue:m.value.targetRole,"onUpdate:modelValue":s[1]||(s[1]=S=>m.value.targetRole=S),placeholder:"请选择适用角色"},{default:l(()=>[e(_,{label:"部门负责人",value:"department_manager"}),e(_,{label:"销售员",value:"sales_staff"}),e(_,{label:"客服",value:"customer_service"}),e(_,{label:"财务",value:"finance"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(y,{label:"模板描述",prop:"description"},{default:l(()=>[e(J,{modelValue:m.value.description,"onUpdate:modelValue":s[2]||(s[2]=S=>m.value.description=S),type:"textarea",rows:3,placeholder:"请输入模板描述"},null,8,["modelValue"])]),_:1}),e(y,{label:"权限配置",prop:"permissions"},{default:l(()=>[e(pe,{modelValue:j.value,"onUpdate:modelValue":s[7]||(s[7]=S=>j.value=S),type:"border-card"},{default:l(()=>[e(re,{label:"客户管理",name:"customer"},{default:l(()=>[e(me,{modelValue:m.value.permissions,"onUpdate:modelValue":s[3]||(s[3]=S=>m.value.permissions=S)},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[(i(),R(te,null,se(I,S=>e(B,{span:8,key:S.value},{default:l(()=>[e(Y,{value:S.value},{default:l(()=>[t("span",null,g(S.label),1),e(F,{content:S.description,placement:"top"},{default:l(()=>[e(X,{style:{"margin-left":"5px",color:"#909399"}},{default:l(()=>[e($(Je))]),_:1})]),_:1},8,["content"])]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(re,{label:"订单管理",name:"order"},{default:l(()=>[e(me,{modelValue:m.value.permissions,"onUpdate:modelValue":s[4]||(s[4]=S=>m.value.permissions=S)},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[(i(),R(te,null,se(T,S=>e(B,{span:8,key:S.value},{default:l(()=>[e(Y,{value:S.value},{default:l(()=>[t("span",null,g(S.label),1),e(F,{content:S.description,placement:"top"},{default:l(()=>[e(X,{style:{"margin-left":"5px",color:"#909399"}},{default:l(()=>[e($(Je))]),_:1})]),_:1},8,["content"])]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(re,{label:"报表分析",name:"report"},{default:l(()=>[e(me,{modelValue:m.value.permissions,"onUpdate:modelValue":s[5]||(s[5]=S=>m.value.permissions=S)},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[(i(),R(te,null,se(q,S=>e(B,{span:8,key:S.value},{default:l(()=>[e(Y,{value:S.value},{default:l(()=>[t("span",null,g(S.label),1),e(F,{content:S.description,placement:"top"},{default:l(()=>[e(X,{style:{"margin-left":"5px",color:"#909399"}},{default:l(()=>[e($(Je))]),_:1})]),_:1},8,["content"])]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(re,{label:"系统管理",name:"system"},{default:l(()=>[e(me,{modelValue:m.value.permissions,"onUpdate:modelValue":s[6]||(s[6]=S=>m.value.permissions=S)},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[(i(),R(te,null,se(C,S=>e(B,{span:8,key:S.value},{default:l(()=>[e(Y,{value:S.value},{default:l(()=>[t("span",null,g(S.label),1),e(F,{content:S.description,placement:"top"},{default:l(()=>[e(X,{style:{"margin-left":"5px",color:"#909399"}},{default:l(()=>[e($(Je))]),_:1})]),_:1},8,["content"])]),_:2},1032,["value"])]),_:2},1024)),64))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"数据范围"},{default:l(()=>[e(H,{modelValue:m.value.dataScope,"onUpdate:modelValue":s[8]||(s[8]=S=>m.value.dataScope=S)},{default:l(()=>[e(ie,{value:"all"},{default:l(()=>[...s[12]||(s[12]=[a("全部数据",-1)])]),_:1}),e(ie,{value:"department"},{default:l(()=>[...s[13]||(s[13]=[a("部门数据",-1)])]),_:1}),e(ie,{value:"personal"},{default:l(()=>[...s[14]||(s[14]=[a("个人数据",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"模板状态"},{default:l(()=>[e(_e,{modelValue:m.value.isActive,"onUpdate:modelValue":s[9]||(s[9]=S=>m.value.isActive=S),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),e(ye,{modelValue:O.value,"onUpdate:modelValue":s[10]||(s[10]=S=>O.value=S),title:"权限预览",width:"600px","append-to-body":""},{default:l(()=>[t("div",sa,[s[17]||(s[17]=t("h4",null,"已选择的权限：",-1)),(i(!0),R(te,null,se(G.value,S=>(i(),D(ge,{key:S,style:{margin:"5px"},type:"success"},{default:l(()=>[a(g(S),1)]),_:2},1024))),128)),G.value.length===0?(i(),R("div",oa," 暂未选择任何权限 ")):oe("",!0)])]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),da=$e(na,[["__scopeId","data-v-2c24d138"]]),ia={class:"dialog-footer"},ua=xe({__name:"DepartmentDialog",props:{modelValue:{type:Boolean},department:{},parentDepartments:{default:()=>[]},availableManagers:{default:()=>[]}},emits:["update:modelValue","confirm"],setup(V,{emit:K}){const x=V,k=K,U=w(),M=w(!1),O=de({get:()=>x.modelValue,set:q=>k("update:modelValue",q)}),j=de(()=>{var q;return!!((q=x.department)!=null&&q.id)}),c=w({name:"",parentId:"",managerId:"",permissionLevel:"basic",dataScope:"department",description:"",isActive:!0}),u={name:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:2,max:50,message:"部门名称长度在 2 到 50 个字符",trigger:"blur"}],permissionLevel:[{required:!0,message:"请选择权限级别",trigger:"change"}],dataScope:[{required:!0,message:"请选择数据范围",trigger:"change"}]},m=()=>{var q;c.value={name:"",parentId:"",managerId:"",permissionLevel:"basic",dataScope:"department",description:"",isActive:!0},(q=U.value)==null||q.clearValidate()};qe(()=>x.department,q=>{q?c.value=Le({},q):m()},{immediate:!0});const I=()=>{m(),k("update:modelValue",!1)},T=()=>fe(this,null,function*(){try{yield U.value.validate(),M.value=!0,yield new Promise(q=>setTimeout(q,1e3)),k("confirm",Le({},c.value)),I(),P.success(j.value?"部门更新成功":"部门创建成功")}catch(q){console.error("表单验证失败:",q)}finally{M.value=!1}});return(q,C)=>{const z=o("el-input"),G=o("el-form-item"),N=o("el-option"),ee=o("el-select"),le=o("el-radio"),Z=o("el-radio-group"),L=o("el-switch"),r=o("el-form"),s=o("el-button"),J=o("el-dialog");return i(),D(J,{modelValue:O.value,"onUpdate:modelValue":C[7]||(C[7]=y=>O.value=y),title:j.value?"编辑部门":"新增部门",width:"600px",onClose:I},{footer:l(()=>[t("div",ia,[e(s,{onClick:I},{default:l(()=>[...C[11]||(C[11]=[a("取消",-1)])]),_:1}),e(s,{type:"primary",onClick:T,loading:M.value},{default:l(()=>[a(g(j.value?"更新部门":"创建部门"),1)]),_:1},8,["loading"])])]),default:l(()=>[e(r,{ref_key:"formRef",ref:U,model:c.value,rules:u,"label-width":"120px"},{default:l(()=>[e(G,{label:"部门名称",prop:"name"},{default:l(()=>[e(z,{modelValue:c.value.name,"onUpdate:modelValue":C[0]||(C[0]=y=>c.value.name=y),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),e(G,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(ee,{modelValue:c.value.parentId,"onUpdate:modelValue":C[1]||(C[1]=y=>c.value.parentId=y),placeholder:"请选择上级部门",clearable:""},{default:l(()=>[e(N,{label:"无上级部门",value:""}),(i(!0),R(te,null,se(V.parentDepartments,y=>(i(),D(N,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"部门负责人",prop:"managerId"},{default:l(()=>[e(ee,{modelValue:c.value.managerId,"onUpdate:modelValue":C[2]||(C[2]=y=>c.value.managerId=y),placeholder:"请选择部门负责人",clearable:"",filterable:""},{default:l(()=>[(i(!0),R(te,null,se(V.availableManagers,y=>(i(),D(N,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"权限级别",prop:"permissionLevel"},{default:l(()=>[e(ee,{modelValue:c.value.permissionLevel,"onUpdate:modelValue":C[3]||(C[3]=y=>c.value.permissionLevel=y),placeholder:"请选择权限级别"},{default:l(()=>[e(N,{label:"高级权限",value:"high"}),e(N,{label:"中级权限",value:"medium"}),e(N,{label:"基础权限",value:"basic"})]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"数据范围",prop:"dataScope"},{default:l(()=>[e(Z,{modelValue:c.value.dataScope,"onUpdate:modelValue":C[4]||(C[4]=y=>c.value.dataScope=y)},{default:l(()=>[e(le,{value:"all"},{default:l(()=>[...C[8]||(C[8]=[a("全部数据",-1)])]),_:1}),e(le,{value:"department"},{default:l(()=>[...C[9]||(C[9]=[a("部门数据",-1)])]),_:1}),e(le,{value:"personal"},{default:l(()=>[...C[10]||(C[10]=[a("个人数据",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(G,{label:"部门描述",prop:"description"},{default:l(()=>[e(z,{modelValue:c.value.description,"onUpdate:modelValue":C[5]||(C[5]=y=>c.value.description=y),type:"textarea",rows:3,placeholder:"请输入部门描述"},null,8,["modelValue"])]),_:1}),e(G,{label:"部门状态"},{default:l(()=>[e(L,{modelValue:c.value.isActive,"onUpdate:modelValue":C[6]||(C[6]=y=>c.value.isActive=y),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),ra=$e(ua,[["__scopeId","data-v-c18d6ae1"]]),ma={class:"member-management"},pa={class:"actions"},ca={class:"dialog-footer"},va=xe({__name:"DepartmentMembersDialog",props:{modelValue:{type:Boolean},department:{}},emits:["update:modelValue"],setup(V,{emit:K}){const x=V,k=K,U=w(!1),M=w(!1),O=w(!1),j=w(""),c=w([]),u=de({get:()=>x.modelValue,set:r=>k("update:modelValue",r)}),m=w([{id:"1",name:"张三",email:"zhangsan@example.com",role:"department_manager",joinDate:"2024-01-15",status:"active"},{id:"2",name:"李四",email:"lisi@example.com",role:"sales_staff",joinDate:"2024-02-01",status:"active"}]),I=w([{id:"3",name:"王五",email:"wangwu@example.com"},{id:"4",name:"赵六",email:"zhaoliu@example.com"}]),T=w({userIds:[],defaultRole:"sales_staff"}),q=de(()=>j.value?m.value.filter(r=>r.name.includes(j.value)||r.email.includes(j.value)):m.value),C=r=>({department_manager:"danger",sales_staff:"primary",customer_service:"success",finance:"warning"})[r]||"info",z=r=>({department_manager:"部门负责人",sales_staff:"销售员",customer_service:"客服",finance:"财务"})[r]||r,G=r=>{c.value=r},N=r=>{P.info(`编辑 ${r.name} 的角色`)},ee=r=>fe(this,null,function*(){try{yield Se.confirm(`确定要将 ${r.name} 从部门中移除吗？`,"确认移除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),m.value=m.value.filter(s=>s.id!==r.id),P.success("成员移除成功")}catch(s){}}),le=()=>fe(this,null,function*(){try{yield Se.confirm(`确定要移除选中的 ${c.value.length} 个成员吗？`,"批量移除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const r=c.value.map(s=>s.id);m.value=m.value.filter(s=>!r.includes(s.id)),c.value=[],P.success("批量移除成功")}catch(r){}}),Z=()=>fe(this,null,function*(){if(T.value.userIds.length===0){P.warning("请选择要添加的用户");return}M.value=!0;try{yield new Promise(s=>setTimeout(s,1e3));const r=T.value.userIds.map(s=>{const J=I.value.find(y=>y.id===s);return{id:s,name:(J==null?void 0:J.name)||"",email:(J==null?void 0:J.email)||"",role:T.value.defaultRole,joinDate:new Date().toISOString().split("T")[0],status:"active"}});m.value.push(...r),I.value=I.value.filter(s=>!T.value.userIds.includes(s.id)),O.value=!1,T.value.userIds=[],T.value.defaultRole="sales_staff",P.success("成员添加成功")}catch(r){P.error("添加成员失败")}finally{M.value=!1}}),L=()=>{k("update:modelValue",!1)};return(r,s)=>{var ie;const J=o("el-icon"),y=o("el-button"),B=o("el-input"),_=o("el-table-column"),d=o("el-tag"),p=o("el-table"),X=o("el-option"),F=o("el-select"),Y=o("el-form-item"),me=o("el-form"),re=o("el-dialog"),pe=ml("loading");return i(),D(re,{modelValue:u.value,"onUpdate:modelValue":s[6]||(s[6]=H=>u.value=H),title:`管理部门成员 - ${(ie=V.department)==null?void 0:ie.name}`,width:"800px",onClose:L},{footer:l(()=>[t("div",ca,[e(y,{onClick:L},{default:l(()=>[...s[13]||(s[13]=[a("关闭",-1)])]),_:1})])]),default:l(()=>[t("div",ma,[t("div",pa,[e(y,{onClick:s[0]||(s[0]=H=>O.value=!0),type:"primary"},{default:l(()=>[e(J,null,{default:l(()=>[e($(Ze))]),_:1}),s[7]||(s[7]=a(" 添加成员 ",-1))]),_:1}),e(y,{onClick:le,type:"danger",disabled:c.value.length===0},{default:l(()=>[e(J,null,{default:l(()=>[e($(Xl))]),_:1}),s[8]||(s[8]=a(" 批量移除 ",-1))]),_:1},8,["disabled"]),e(B,{modelValue:j.value,"onUpdate:modelValue":s[1]||(s[1]=H=>j.value=H),placeholder:"搜索成员",style:{width:"200px","margin-left":"10px"},clearable:""},{prefix:l(()=>[e(J,null,{default:l(()=>[e($(Qe))]),_:1})]),_:1},8,["modelValue"])]),Ke((i(),D(p,{data:q.value,style:{width:"100%","margin-top":"20px"},onSelectionChange:G},{default:l(()=>[e(_,{type:"selection",width:"55"}),e(_,{prop:"name",label:"姓名",width:"120"}),e(_,{prop:"email",label:"邮箱",width:"200"}),e(_,{prop:"role",label:"角色",width:"120"},{default:l(({row:H})=>[e(d,{type:C(H.role)},{default:l(()=>[a(g(z(H.role)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"joinDate",label:"加入时间",width:"120"}),e(_,{label:"状态",width:"100"},{default:l(({row:H})=>[e(d,{type:H.status==="active"?"success":"danger"},{default:l(()=>[a(g(H.status==="active"?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(_,{label:"操作",width:"150"},{default:l(({row:H})=>[e(y,{onClick:_e=>N(H),size:"small",type:"primary"},{default:l(()=>[...s[9]||(s[9]=[a("编辑角色",-1)])]),_:1},8,["onClick"]),e(y,{onClick:_e=>ee(H),size:"small",type:"danger"},{default:l(()=>[...s[10]||(s[10]=[a("移除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,U.value]])]),e(re,{modelValue:O.value,"onUpdate:modelValue":s[5]||(s[5]=H=>O.value=H),title:"添加部门成员",width:"500px","append-to-body":""},{footer:l(()=>[e(y,{onClick:s[4]||(s[4]=H=>O.value=!1)},{default:l(()=>[...s[11]||(s[11]=[a("取消",-1)])]),_:1}),e(y,{type:"primary",onClick:Z,loading:M.value},{default:l(()=>[...s[12]||(s[12]=[a("确定",-1)])]),_:1},8,["loading"])]),default:l(()=>[e(me,{model:T.value,"label-width":"100px"},{default:l(()=>[e(Y,{label:"选择用户"},{default:l(()=>[e(F,{modelValue:T.value.userIds,"onUpdate:modelValue":s[2]||(s[2]=H=>T.value.userIds=H),placeholder:"请选择要添加的用户",multiple:"",filterable:"",style:{width:"100%"}},{default:l(()=>[(i(!0),R(te,null,se(I.value,H=>(i(),D(X,{key:H.id,label:`${H.name} (${H.email})`,value:H.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(Y,{label:"默认角色"},{default:l(()=>[e(F,{modelValue:T.value.defaultRole,"onUpdate:modelValue":s[3]||(s[3]=H=>T.value.defaultRole=H),placeholder:"请选择默认角色"},{default:l(()=>[e(X,{label:"部门负责人",value:"department_manager"}),e(X,{label:"销售员",value:"sales_staff"}),e(X,{label:"客服",value:"customer_service"}),e(X,{label:"财务",value:"finance"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])}}}),fa=$e(va,[["__scopeId","data-v-3b2855bd"]]),_a={class:"permission-details"},ga={class:"permission-section"},ba={class:"section-header"},ya={class:"permission-section"},wa={class:"section-header"},Va={class:"permission-section"},ka={class:"section-header"},Ca={class:"data-permission"},xa={class:"inheritance-info"},$a={class:"inheritance-tree"},Ua={class:"dialog-footer"},Pa=xe({__name:"DepartmentPermissionsDialog",props:{modelValue:{type:Boolean},department:{}},emits:["update:modelValue","update"],setup(V,{emit:K}){const x=V,k=K,U=w("functional"),M=w(!1),O=w(!1),j=de({get:()=>x.modelValue,set:r=>k("update:modelValue",r)}),c=w([]),u=w("department"),m=w({customer:["view","create"],order:["view"],report:["view"]}),I=[{key:"customer.view",label:"查看客户"},{key:"customer.create",label:"创建客户"},{key:"customer.edit",label:"编辑客户"},{key:"customer.delete",label:"删除客户"},{key:"customer.export",label:"导出客户"},{key:"customer.import",label:"导入客户"}],T=[{key:"order.view",label:"查看订单"},{key:"order.create",label:"创建订单"},{key:"order.edit",label:"编辑订单"},{key:"order.delete",label:"删除订单"},{key:"order.export",label:"导出订单"},{key:"order.audit",label:"审核订单"}],q=[{key:"system.user",label:"用户管理"},{key:"system.role",label:"角色管理"},{key:"system.permission",label:"权限管理"},{key:"system.config",label:"系统配置"}],C=w([{label:"销售部",children:[{label:"客户管理权限"},{label:"订单管理权限"},{label:"报表查看权限"}]}]),z=w(["customer.view","customer.create","order.view"]);qe(()=>x.department,r=>{r&&(c.value=r.permissions||[],u.value=r.dataScope||"department")},{immediate:!0});const G=r=>c.value.includes(r),N=(r,s)=>{if(s)c.value.includes(r)||c.value.push(r);else{const J=c.value.indexOf(r);J>-1&&c.value.splice(J,1)}},ee=r=>{M.value=!0,P.info(`编辑${r}权限组`)},le=()=>{M.value=!1,x.department&&(c.value=x.department.permissions||[],u.value=x.department.dataScope||"department")},Z=()=>fe(this,null,function*(){O.value=!0;try{if(yield new Promise(r=>setTimeout(r,1e3)),x.department){const r=tl(Le({},x.department),{permissions:[...c.value],dataScope:u.value});k("update",r)}M.value=!1,P.success("权限保存成功")}catch(r){P.error("权限保存失败")}finally{O.value=!1}}),L=()=>{M.value=!1,k("update:modelValue",!1)};return(r,s)=>{var _e;const J=o("el-button"),y=o("el-checkbox"),B=o("el-col"),_=o("el-row"),d=o("el-tab-pane"),p=o("el-radio"),X=o("el-radio-group"),F=o("el-form-item"),Y=o("el-checkbox-group"),me=o("el-form"),re=o("el-alert"),pe=o("el-tree"),ie=o("el-tabs"),H=o("el-dialog");return i(),D(H,{modelValue:j.value,"onUpdate:modelValue":s[9]||(s[9]=b=>j.value=b),title:`部门权限详情 - ${(_e=V.department)==null?void 0:_e.name}`,width:"900px",onClose:L},{footer:l(()=>[t("div",Ua,[e(J,{onClick:L},{default:l(()=>[...s[35]||(s[35]=[a("关闭",-1)])]),_:1}),M.value?(i(),R(te,{key:1},[e(J,{onClick:le},{default:l(()=>[...s[37]||(s[37]=[a("取消",-1)])]),_:1}),e(J,{onClick:Z,type:"primary",loading:O.value},{default:l(()=>[...s[38]||(s[38]=[a("保存",-1)])]),_:1},8,["loading"])],64)):(i(),D(J,{key:0,onClick:s[8]||(s[8]=b=>M.value=!0),type:"primary"},{default:l(()=>[...s[36]||(s[36]=[a("编辑权限",-1)])]),_:1}))])]),default:l(()=>[t("div",_a,[e(ie,{modelValue:U.value,"onUpdate:modelValue":s[7]||(s[7]=b=>U.value=b),type:"border-card"},{default:l(()=>[e(d,{label:"功能权限",name:"functional"},{default:l(()=>[t("div",ga,[t("div",ba,[s[11]||(s[11]=t("h4",null,"客户管理权限",-1)),e(J,{onClick:s[0]||(s[0]=b=>ee("customer")),size:"small",type:"primary"},{default:l(()=>[...s[10]||(s[10]=[a("编辑",-1)])]),_:1})]),e(_,{gutter:20},{default:l(()=>[(i(),R(te,null,se(I,b=>e(B,{span:6,key:b.key},{default:l(()=>[e(y,{"model-value":G(b.key),onChange:Q=>N(b.key,Q),disabled:!M.value},{default:l(()=>[a(g(b.label),1)]),_:2},1032,["model-value","onChange","disabled"])]),_:2},1024)),64))]),_:1})]),t("div",ya,[t("div",wa,[s[13]||(s[13]=t("h4",null,"订单管理权限",-1)),e(J,{onClick:s[1]||(s[1]=b=>ee("order")),size:"small",type:"primary"},{default:l(()=>[...s[12]||(s[12]=[a("编辑",-1)])]),_:1})]),e(_,{gutter:20},{default:l(()=>[(i(),R(te,null,se(T,b=>e(B,{span:6,key:b.key},{default:l(()=>[e(y,{"model-value":G(b.key),onChange:Q=>N(b.key,Q),disabled:!M.value},{default:l(()=>[a(g(b.label),1)]),_:2},1032,["model-value","onChange","disabled"])]),_:2},1024)),64))]),_:1})]),t("div",Va,[t("div",ka,[s[15]||(s[15]=t("h4",null,"系统管理权限",-1)),e(J,{onClick:s[2]||(s[2]=b=>ee("system")),size:"small",type:"primary"},{default:l(()=>[...s[14]||(s[14]=[a("编辑",-1)])]),_:1})]),e(_,{gutter:20},{default:l(()=>[(i(),R(te,null,se(q,b=>e(B,{span:6,key:b.key},{default:l(()=>[e(y,{"model-value":G(b.key),onChange:Q=>N(b.key,Q),disabled:!M.value},{default:l(()=>[a(g(b.label),1)]),_:2},1032,["model-value","onChange","disabled"])]),_:2},1024)),64))]),_:1})])]),_:1}),e(d,{label:"数据权限",name:"data"},{default:l(()=>[t("div",Ca,[e(me,{"label-width":"120px"},{default:l(()=>[e(F,{label:"数据范围"},{default:l(()=>[e(X,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=b=>u.value=b),disabled:!M.value},{default:l(()=>[e(p,{value:"all"},{default:l(()=>[...s[16]||(s[16]=[a("全部数据",-1)])]),_:1}),e(p,{value:"department"},{default:l(()=>[...s[17]||(s[17]=[a("本部门数据",-1)])]),_:1}),e(p,{value:"personal"},{default:l(()=>[...s[18]||(s[18]=[a("个人数据",-1)])]),_:1}),e(p,{value:"custom"},{default:l(()=>[...s[19]||(s[19]=[a("自定义范围",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),u.value==="custom"?(i(),D(F,{key:0,label:"客户数据权限"},{default:l(()=>[e(Y,{modelValue:m.value.customer,"onUpdate:modelValue":s[4]||(s[4]=b=>m.value.customer=b),disabled:!M.value},{default:l(()=>[e(y,{value:"view"},{default:l(()=>[...s[20]||(s[20]=[a("查看",-1)])]),_:1}),e(y,{value:"create"},{default:l(()=>[...s[21]||(s[21]=[a("创建",-1)])]),_:1}),e(y,{value:"edit"},{default:l(()=>[...s[22]||(s[22]=[a("编辑",-1)])]),_:1}),e(y,{value:"delete"},{default:l(()=>[...s[23]||(s[23]=[a("删除",-1)])]),_:1}),e(y,{value:"export"},{default:l(()=>[...s[24]||(s[24]=[a("导出",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})):oe("",!0),u.value==="custom"?(i(),D(F,{key:1,label:"订单数据权限"},{default:l(()=>[e(Y,{modelValue:m.value.order,"onUpdate:modelValue":s[5]||(s[5]=b=>m.value.order=b),disabled:!M.value},{default:l(()=>[e(y,{value:"view"},{default:l(()=>[...s[25]||(s[25]=[a("查看",-1)])]),_:1}),e(y,{value:"create"},{default:l(()=>[...s[26]||(s[26]=[a("创建",-1)])]),_:1}),e(y,{value:"edit"},{default:l(()=>[...s[27]||(s[27]=[a("编辑",-1)])]),_:1}),e(y,{value:"delete"},{default:l(()=>[...s[28]||(s[28]=[a("删除",-1)])]),_:1}),e(y,{value:"export"},{default:l(()=>[...s[29]||(s[29]=[a("导出",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})):oe("",!0),u.value==="custom"?(i(),D(F,{key:2,label:"报表数据权限"},{default:l(()=>[e(Y,{modelValue:m.value.report,"onUpdate:modelValue":s[6]||(s[6]=b=>m.value.report=b),disabled:!M.value},{default:l(()=>[e(y,{value:"view"},{default:l(()=>[...s[30]||(s[30]=[a("查看",-1)])]),_:1}),e(y,{value:"export"},{default:l(()=>[...s[31]||(s[31]=[a("导出",-1)])]),_:1}),e(y,{value:"share"},{default:l(()=>[...s[32]||(s[32]=[a("分享",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1})):oe("",!0)]),_:1})])]),_:1}),e(d,{label:"权限继承",name:"inheritance"},{default:l(()=>[t("div",xa,[e(re,{title:"权限继承说明",type:"info",closable:!1,style:{"margin-bottom":"20px"}},{default:l(()=>[...s[33]||(s[33]=[t("p",null,"部门权限会自动继承给部门内的所有成员，成员的个人权限不能超过部门权限范围。",-1)])]),_:1}),t("div",$a,[s[34]||(s[34]=t("h4",null,"权限继承关系",-1)),e(pe,{data:C.value,props:{children:"children",label:"label"},"default-expand-all":"","show-checkbox":"","check-strictly":!1,"default-checked-keys":z.value},null,8,["data","default-checked-keys"])])])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","title"])}}}),Ta=$e(Pa,[["__scopeId","data-v-d76d1f5b"]]),Sa={class:"batch-assign"},Da={key:0,class:"step-content"},Ra={key:1,class:"step-content"},La={class:"permission-group"},Aa={class:"permission-group"},za={class:"permission-group"},Ia={class:"template-actions"},Ma={key:2,class:"step-content"},ha={class:"confirm-info"},Ba={class:"selected-departments"},Oa={class:"selected-permissions"},ja={class:"permission-summary"},Fa={key:0},qa={key:1},Ea={key:2},Na={class:"dialog-footer"},Ya=xe({__name:"BatchAssignPermissionsDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","assigned"],setup(V,{emit:K}){const x=V,k=K,U=w(0),M=w("functional"),O=w(!1),j=de({get:()=>x.modelValue,set:_=>k("update:modelValue",_)}),c=w([{key:"1",label:"销售部",disabled:!1},{key:"2",label:"市场部",disabled:!1},{key:"3",label:"技术部",disabled:!1},{key:"4",label:"客服部",disabled:!1},{key:"5",label:"财务部",disabled:!1},{key:"6",label:"人事部",disabled:!1}]),u=w([]),m=w({customer:["view"],order:["view"],system:[]}),I=w("department"),T=w("readonly"),q=w(null),C=de(()=>c.value.filter(_=>u.value.includes(_.key)).map(_=>_.label)),z=de(()=>({readonly:"只读",edit:"编辑",manage:"管理",super:"超级管理员"})[T.value]||"未设置"),G=de(()=>({all:"全部数据",department:"本部门数据",personal:"个人数据",custom:"自定义范围"})[I.value]||"未设置"),N=de(()=>q.value?`${q.value[0]} 至 ${q.value[1]}`:"立即生效"),ee={customer:{view:"查看客户",create:"创建客户",edit:"编辑客户",delete:"删除客户",export:"导出客户"},order:{view:"查看订单",create:"创建订单",edit:"编辑订单",delete:"删除订单",audit:"审核订单"},system:{user:"用户管理",role:"角色管理",permission:"权限管理",config:"系统配置"}},le=(_,d)=>{var p;return((p=ee[_])==null?void 0:p[d])||d},Z=()=>{if(U.value===0&&u.value.length===0){P.warning("请至少选择一个部门");return}if(U.value===1&&!(m.value.customer.length>0||m.value.order.length>0||m.value.system.length>0)){P.warning("请至少选择一个权限");return}U.value<2&&U.value++},L=()=>{U.value>0&&U.value--},r=()=>{P.info("加载权限模板功能开发中")},s=()=>{P.info("保存权限模板功能开发中")},J=()=>{m.value={customer:[],order:[],system:[]},P.success("权限已清空")},y=()=>fe(this,null,function*(){try{yield Se.confirm(`确定要为 ${C.value.length} 个部门分配权限吗？`,"确认分配",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.value=!0,yield new Promise(_=>setTimeout(_,2e3)),P.success("权限分配成功"),k("assigned"),B()}catch(_){_!=="cancel"&&P.error("权限分配失败")}finally{O.value=!1}}),B=()=>{U.value=0,u.value=[],m.value={customer:["view"],order:["view"],system:[]},I.value="department",T.value="readonly",q.value=null,k("update:modelValue",!1)};return(_,d)=>{const p=o("el-step"),X=o("el-steps"),F=o("el-transfer"),Y=o("el-checkbox"),me=o("el-checkbox-group"),re=o("el-tab-pane"),pe=o("el-radio"),ie=o("el-radio-group"),H=o("el-form-item"),_e=o("el-option"),b=o("el-select"),Q=o("el-date-picker"),ge=o("el-form"),ye=o("el-tabs"),S=o("el-button"),we=o("el-descriptions-item"),Ie=o("el-descriptions"),Ce=o("el-tag"),E=o("el-dialog");return i(),D(E,{modelValue:j.value,"onUpdate:modelValue":d[8]||(d[8]=ae=>j.value=ae),title:"批量分配权限",width:"800px",onClose:B},{footer:l(()=>[t("div",Na,[e(S,{onClick:B},{default:l(()=>[...d[41]||(d[41]=[a("取消",-1)])]),_:1}),U.value>0?(i(),D(S,{key:0,onClick:L},{default:l(()=>[...d[42]||(d[42]=[a("上一步",-1)])]),_:1})):oe("",!0),U.value<2?(i(),D(S,{key:1,onClick:Z,type:"primary"},{default:l(()=>[...d[43]||(d[43]=[a("下一步",-1)])]),_:1})):oe("",!0),U.value===2?(i(),D(S,{key:2,onClick:y,type:"primary",loading:O.value},{default:l(()=>[...d[44]||(d[44]=[a(" 确认分配 ",-1)])]),_:1},8,["loading"])):oe("",!0)])]),default:l(()=>[t("div",Sa,[e(X,{active:U.value,"finish-status":"success","align-center":""},{default:l(()=>[e(p,{title:"选择部门"}),e(p,{title:"配置权限"}),e(p,{title:"确认分配"})]),_:1},8,["active"]),U.value===0?(i(),R("div",Da,[d[9]||(d[9]=t("h4",null,"选择要分配权限的部门",-1)),e(F,{modelValue:u.value,"onUpdate:modelValue":d[0]||(d[0]=ae=>u.value=ae),data:c.value,titles:["可选部门","已选部门"],"button-texts":["移除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},filterable:"","filter-placeholder":"搜索部门"},null,8,["modelValue","data"])])):oe("",!0),U.value===1?(i(),R("div",Ra,[d[34]||(d[34]=t("h4",null,"配置权限模板",-1)),e(ye,{modelValue:M.value,"onUpdate:modelValue":d[7]||(d[7]=ae=>M.value=ae),type:"border-card"},{default:l(()=>[e(re,{label:"功能权限",name:"functional"},{default:l(()=>[t("div",La,[d[15]||(d[15]=t("h5",null,"客户管理",-1)),e(me,{modelValue:m.value.customer,"onUpdate:modelValue":d[1]||(d[1]=ae=>m.value.customer=ae)},{default:l(()=>[e(Y,{value:"view"},{default:l(()=>[...d[10]||(d[10]=[a("查看客户",-1)])]),_:1}),e(Y,{value:"create"},{default:l(()=>[...d[11]||(d[11]=[a("创建客户",-1)])]),_:1}),e(Y,{value:"edit"},{default:l(()=>[...d[12]||(d[12]=[a("编辑客户",-1)])]),_:1}),e(Y,{value:"delete"},{default:l(()=>[...d[13]||(d[13]=[a("删除客户",-1)])]),_:1}),e(Y,{value:"export"},{default:l(()=>[...d[14]||(d[14]=[a("导出客户",-1)])]),_:1})]),_:1},8,["modelValue"])]),t("div",Aa,[d[21]||(d[21]=t("h5",null,"订单管理",-1)),e(me,{modelValue:m.value.order,"onUpdate:modelValue":d[2]||(d[2]=ae=>m.value.order=ae)},{default:l(()=>[e(Y,{value:"view"},{default:l(()=>[...d[16]||(d[16]=[a("查看订单",-1)])]),_:1}),e(Y,{value:"create"},{default:l(()=>[...d[17]||(d[17]=[a("创建订单",-1)])]),_:1}),e(Y,{value:"edit"},{default:l(()=>[...d[18]||(d[18]=[a("编辑订单",-1)])]),_:1}),e(Y,{value:"delete"},{default:l(()=>[...d[19]||(d[19]=[a("删除订单",-1)])]),_:1}),e(Y,{value:"audit"},{default:l(()=>[...d[20]||(d[20]=[a("审核订单",-1)])]),_:1})]),_:1},8,["modelValue"])]),t("div",za,[d[26]||(d[26]=t("h5",null,"系统管理",-1)),e(me,{modelValue:m.value.system,"onUpdate:modelValue":d[3]||(d[3]=ae=>m.value.system=ae)},{default:l(()=>[e(Y,{value:"user"},{default:l(()=>[...d[22]||(d[22]=[a("用户管理",-1)])]),_:1}),e(Y,{value:"role"},{default:l(()=>[...d[23]||(d[23]=[a("角色管理",-1)])]),_:1}),e(Y,{value:"permission"},{default:l(()=>[...d[24]||(d[24]=[a("权限管理",-1)])]),_:1}),e(Y,{value:"config"},{default:l(()=>[...d[25]||(d[25]=[a("系统配置",-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),e(re,{label:"数据权限",name:"data"},{default:l(()=>[e(ge,{"label-width":"120px"},{default:l(()=>[e(H,{label:"数据范围"},{default:l(()=>[e(ie,{modelValue:I.value,"onUpdate:modelValue":d[4]||(d[4]=ae=>I.value=ae)},{default:l(()=>[e(pe,{value:"all"},{default:l(()=>[...d[27]||(d[27]=[a("全部数据",-1)])]),_:1}),e(pe,{value:"department"},{default:l(()=>[...d[28]||(d[28]=[a("本部门数据",-1)])]),_:1}),e(pe,{value:"personal"},{default:l(()=>[...d[29]||(d[29]=[a("个人数据",-1)])]),_:1}),e(pe,{value:"custom"},{default:l(()=>[...d[30]||(d[30]=[a("自定义范围",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(H,{label:"权限级别"},{default:l(()=>[e(b,{modelValue:T.value,"onUpdate:modelValue":d[5]||(d[5]=ae=>T.value=ae),placeholder:"选择权限级别"},{default:l(()=>[e(_e,{label:"只读",value:"readonly"}),e(_e,{label:"编辑",value:"edit"}),e(_e,{label:"管理",value:"manage"}),e(_e,{label:"超级管理员",value:"super"})]),_:1},8,["modelValue"])]),_:1}),e(H,{label:"生效时间"},{default:l(()=>[e(Q,{modelValue:q.value,"onUpdate:modelValue":d[6]||(d[6]=ae=>q.value=ae),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t("div",Ia,[e(S,{onClick:r,type:"primary",plain:""},{default:l(()=>[...d[31]||(d[31]=[a("加载权限模板",-1)])]),_:1}),e(S,{onClick:s,type:"success",plain:""},{default:l(()=>[...d[32]||(d[32]=[a("保存为模板",-1)])]),_:1}),e(S,{onClick:J,type:"danger",plain:""},{default:l(()=>[...d[33]||(d[33]=[a("清空权限",-1)])]),_:1})])])):oe("",!0),U.value===2?(i(),R("div",Ma,[d[40]||(d[40]=t("h4",null,"确认分配信息",-1)),t("div",ha,[e(Ie,{column:2,border:""},{default:l(()=>[e(we,{label:"选择部门数量"},{default:l(()=>[a(g(C.value.length),1)]),_:1}),e(we,{label:"权限级别"},{default:l(()=>[a(g(z.value),1)]),_:1}),e(we,{label:"数据范围"},{default:l(()=>[a(g(G.value),1)]),_:1}),e(we,{label:"生效时间"},{default:l(()=>[a(g(N.value),1)]),_:1})]),_:1}),t("div",Ba,[d[35]||(d[35]=t("h5",null,"选择的部门：",-1)),(i(!0),R(te,null,se(C.value,ae=>(i(),D(Ce,{key:ae,style:{margin:"5px"},type:"primary"},{default:l(()=>[a(g(ae),1)]),_:2},1024))),128))]),t("div",Oa,[d[39]||(d[39]=t("h5",null,"分配的权限：",-1)),t("div",ja,[m.value.customer.length>0?(i(),R("div",Fa,[d[36]||(d[36]=t("strong",null,"客户管理：",-1)),(i(!0),R(te,null,se(m.value.customer,ae=>(i(),D(Ce,{key:ae,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(le("customer",ae)),1)]),_:2},1024))),128))])):oe("",!0),m.value.order.length>0?(i(),R("div",qa,[d[37]||(d[37]=t("strong",null,"订单管理：",-1)),(i(!0),R(te,null,se(m.value.order,ae=>(i(),D(Ce,{key:ae,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(le("order",ae)),1)]),_:2},1024))),128))])):oe("",!0),m.value.system.length>0?(i(),R("div",Ea,[d[38]||(d[38]=t("strong",null,"系统管理：",-1)),(i(!0),R(te,null,se(m.value.system,ae=>(i(),D(Ce,{key:ae,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(le("system",ae)),1)]),_:2},1024))),128))])):oe("",!0)])])])])):oe("",!0)])]),_:1},8,["modelValue"])}}}),Ha=$e(Ya,[["__scopeId","data-v-8b2355fb"]]),Ja={key:0,class:"user-detail"},Ka={class:"basic-info"},Ga={class:"user-avatar"},Za={class:"user-status"},Qa={class:"permissions-detail"},Wa={class:"permission-section"},Xa={class:"permission-group"},es={class:"permission-list"},ls={class:"permission-group"},ts={class:"permission-list"},as={class:"permission-group"},ss={class:"permission-list"},os={class:"permission-section"},ns={class:"operation-logs"},ds={class:"logs-filter"},is={class:"pagination"},us={class:"security-settings"},rs={class:"security-actions",style:{"margin-top":"20px"}},ms={class:"dialog-footer"},ps=xe({__name:"UserDetailDialog",props:{modelValue:{type:Boolean},user:{}},emits:["update:modelValue","edit"],setup(V,{emit:K}){const x=V,k=K,U=w("basic"),M=w(75),O=de({get:()=>x.modelValue,set:B=>k("update:modelValue",B)}),j=w({customer:[{key:"view",name:"查看客户",granted:!0},{key:"create",name:"创建客户",granted:!0},{key:"edit",name:"编辑客户",granted:!1},{key:"delete",name:"删除客户",granted:!1},{key:"export",name:"导出客户",granted:!0}],order:[{key:"view",name:"查看订单",granted:!0},{key:"create",name:"创建订单",granted:!0},{key:"edit",name:"编辑订单",granted:!0},{key:"delete",name:"删除订单",granted:!1},{key:"audit",name:"审核订单",granted:!1}],system:[{key:"user",name:"用户管理",granted:!1},{key:"role",name:"角色管理",granted:!1},{key:"permission",name:"权限管理",granted:!1},{key:"config",name:"系统配置",granted:!1}]}),c=w({scope:"本部门数据",customer:"可查看、编辑",order:"可查看、创建",report:"仅查看",canExport:!0,canAudit:!1}),u=w({type:"",dateRange:null}),m=w([{time:"2024-01-15 14:30:25",type:"登录",action:"用户登录系统",ip:"192.168.1.100",userAgent:"Chrome 120.0.0.0",result:"成功"},{time:"2024-01-15 14:25:10",type:"数据操作",action:"查看客户列表",ip:"192.168.1.100",userAgent:"Chrome 120.0.0.0",result:"成功"},{time:"2024-01-15 14:20:05",type:"权限变更",action:"权限被管理员修改",ip:"192.168.1.1",userAgent:"Chrome 120.0.0.0",result:"成功"}]),I=w({currentPage:1,pageSize:10,total:50}),T=B=>({超级管理员:"danger",管理员:"warning",普通用户:"primary",只读用户:"info"})[B]||"info",q=B=>({登录:"primary",权限变更:"warning",数据操作:"success",系统操作:"info"})[B]||"info",C=()=>M.value>=80?"#67C23A":M.value>=60?"#E6A23C":"#F56C6C",z=()=>{P.info("搜索操作记录")},G=()=>{u.value={type:"",dateRange:null}},N=B=>{I.value.pageSize=B},ee=B=>{I.value.currentPage=B},le=()=>fe(this,null,function*(){try{yield Se.confirm("确定要重置该用户的密码吗？","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.success("密码重置成功，新密码已发送到用户邮箱")}catch(B){}}),Z=()=>fe(this,null,function*(){var _;const B=(_=x.user)!=null&&_.twoFactorEnabled?"禁用":"启用";try{yield Se.confirm(`确定要${B}双因子认证吗？`,`确认${B}`,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.success(`双因子认证${B}成功`)}catch(d){}}),L=()=>fe(this,null,function*(){try{yield Se.confirm("确定要解锁该用户账户吗？","确认解锁",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.success("账户解锁成功")}catch(B){}}),r=()=>fe(this,null,function*(){try{yield Se.confirm("确定要强制该用户下线吗？","确认下线",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.success("用户已强制下线")}catch(B){}}),s=()=>{x.user&&(k("edit",x.user),y())},J=()=>{P.success("用户信息导出成功")},y=()=>{U.value="basic",k("update:modelValue",!1)};return qe(()=>x.user,B=>{},{immediate:!0}),(B,_)=>{var Ce;const d=o("el-avatar"),p=o("el-tag"),X=o("el-col"),F=o("el-descriptions-item"),Y=o("el-descriptions"),me=o("el-row"),re=o("el-tab-pane"),pe=o("el-icon"),ie=o("el-option"),H=o("el-select"),_e=o("el-date-picker"),b=o("el-button"),Q=o("el-table-column"),ge=o("el-table"),ye=o("el-pagination"),S=o("el-progress"),we=o("el-tabs"),Ie=o("el-dialog");return i(),D(Ie,{modelValue:O.value,"onUpdate:modelValue":_[5]||(_[5]=E=>O.value=E),title:`用户详情 - ${(Ce=V.user)==null?void 0:Ce.name}`,width:"1000px",onClose:y},{footer:l(()=>[t("div",ms,[e(b,{onClick:y},{default:l(()=>[..._[16]||(_[16]=[a("关闭",-1)])]),_:1}),e(b,{onClick:s,type:"primary"},{default:l(()=>[..._[17]||(_[17]=[a("编辑用户",-1)])]),_:1}),e(b,{onClick:J,type:"success"},{default:l(()=>[..._[18]||(_[18]=[a("导出信息",-1)])]),_:1})])]),default:l(()=>[V.user?(i(),R("div",Ja,[e(we,{modelValue:U.value,"onUpdate:modelValue":_[4]||(_[4]=E=>U.value=E),type:"border-card"},{default:l(()=>[e(re,{label:"基本信息",name:"basic"},{default:l(()=>[t("div",Ka,[e(me,{gutter:20},{default:l(()=>[e(X,{span:8},{default:l(()=>[t("div",Ga,[e(d,{size:120,src:V.user.avatar},{default:l(()=>[a(g(V.user.name.charAt(0)),1)]),_:1},8,["src"]),t("div",Za,[e(p,{type:V.user.status==="正常"?"success":"danger"},{default:l(()=>[a(g(V.user.status),1)]),_:1},8,["type"])])])]),_:1}),e(X,{span:16},{default:l(()=>[e(Y,{column:2,border:""},{default:l(()=>[e(F,{label:"用户名"},{default:l(()=>[a(g(V.user.username),1)]),_:1}),e(F,{label:"姓名"},{default:l(()=>[a(g(V.user.name),1)]),_:1}),e(F,{label:"邮箱"},{default:l(()=>[a(g(V.user.email),1)]),_:1}),e(F,{label:"手机号"},{default:l(()=>[a(g(V.user.phone||"未设置"),1)]),_:1}),e(F,{label:"部门"},{default:l(()=>[a(g(V.user.department),1)]),_:1}),e(F,{label:"职位"},{default:l(()=>[a(g(V.user.position||"未设置"),1)]),_:1}),e(F,{label:"角色"},{default:l(()=>[(i(!0),R(te,null,se(V.user.roles,E=>(i(),D(p,{key:E,size:"small",style:{"margin-right":"5px"}},{default:l(()=>[a(g(E),1)]),_:2},1024))),128))]),_:1}),e(F,{label:"权限级别"},{default:l(()=>[e(p,{type:T(V.user.permissionLevel)},{default:l(()=>[a(g(V.user.permissionLevel),1)]),_:1},8,["type"])]),_:1}),e(F,{label:"创建时间"},{default:l(()=>[a(g(V.user.createTime),1)]),_:1}),e(F,{label:"最后登录"},{default:l(()=>[a(g(V.user.lastLogin||"从未登录"),1)]),_:1}),e(F,{label:"登录次数"},{default:l(()=>[a(g(V.user.loginCount||0),1)]),_:1}),e(F,{label:"账户状态"},{default:l(()=>[e(p,{type:V.user.status==="正常"?"success":"danger"},{default:l(()=>[a(g(V.user.status),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(re,{label:"权限详情",name:"permissions"},{default:l(()=>[t("div",Qa,[t("div",Wa,[_[9]||(_[9]=t("h4",null,"功能权限",-1)),e(me,{gutter:20},{default:l(()=>[e(X,{span:8},{default:l(()=>[t("div",Xa,[_[6]||(_[6]=t("h5",null,"客户管理",-1)),t("div",es,[(i(!0),R(te,null,se(j.value.customer,E=>(i(),R("div",{key:E.key,class:"permission-item"},[e(pe,{color:E.granted?"#67C23A":"#F56C6C"},{default:l(()=>[E.granted?(i(),D($(Ae),{key:0})):(i(),D($(ze),{key:1}))]),_:2},1032,["color"]),t("span",null,g(E.name),1)]))),128))])])]),_:1}),e(X,{span:8},{default:l(()=>[t("div",ls,[_[7]||(_[7]=t("h5",null,"订单管理",-1)),t("div",ts,[(i(!0),R(te,null,se(j.value.order,E=>(i(),R("div",{key:E.key,class:"permission-item"},[e(pe,{color:E.granted?"#67C23A":"#F56C6C"},{default:l(()=>[E.granted?(i(),D($(Ae),{key:0})):(i(),D($(ze),{key:1}))]),_:2},1032,["color"]),t("span",null,g(E.name),1)]))),128))])])]),_:1}),e(X,{span:8},{default:l(()=>[t("div",as,[_[8]||(_[8]=t("h5",null,"系统管理",-1)),t("div",ss,[(i(!0),R(te,null,se(j.value.system,E=>(i(),R("div",{key:E.key,class:"permission-item"},[e(pe,{color:E.granted?"#67C23A":"#F56C6C"},{default:l(()=>[E.granted?(i(),D($(Ae),{key:0})):(i(),D($(ze),{key:1}))]),_:2},1032,["color"]),t("span",null,g(E.name),1)]))),128))])])]),_:1})]),_:1})]),t("div",os,[_[10]||(_[10]=t("h4",null,"数据权限",-1)),e(Y,{column:3,border:""},{default:l(()=>[e(F,{label:"数据范围"},{default:l(()=>[a(g(c.value.scope),1)]),_:1}),e(F,{label:"客户数据"},{default:l(()=>[a(g(c.value.customer),1)]),_:1}),e(F,{label:"订单数据"},{default:l(()=>[a(g(c.value.order),1)]),_:1}),e(F,{label:"报表数据"},{default:l(()=>[a(g(c.value.report),1)]),_:1}),e(F,{label:"导出权限"},{default:l(()=>[e(p,{type:c.value.canExport?"success":"danger"},{default:l(()=>[a(g(c.value.canExport?"允许":"禁止"),1)]),_:1},8,["type"])]),_:1}),e(F,{label:"审计权限"},{default:l(()=>[e(p,{type:c.value.canAudit?"success":"danger"},{default:l(()=>[a(g(c.value.canAudit?"允许":"禁止"),1)]),_:1},8,["type"])]),_:1})]),_:1})])])]),_:1}),e(re,{label:"操作记录",name:"logs"},{default:l(()=>[t("div",ns,[t("div",ds,[e(me,{gutter:20},{default:l(()=>[e(X,{span:6},{default:l(()=>[e(H,{modelValue:u.value.type,"onUpdate:modelValue":_[0]||(_[0]=E=>u.value.type=E),placeholder:"操作类型",clearable:""},{default:l(()=>[e(ie,{label:"登录",value:"login"}),e(ie,{label:"权限变更",value:"permission"}),e(ie,{label:"数据操作",value:"data"}),e(ie,{label:"系统操作",value:"system"})]),_:1},8,["modelValue"])]),_:1}),e(X,{span:8},{default:l(()=>[e(_e,{modelValue:u.value.dateRange,"onUpdate:modelValue":_[1]||(_[1]=E=>u.value.dateRange=E),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(X,{span:6},{default:l(()=>[e(b,{onClick:z,type:"primary"},{default:l(()=>[..._[11]||(_[11]=[a("搜索",-1)])]),_:1}),e(b,{onClick:G},{default:l(()=>[..._[12]||(_[12]=[a("重置",-1)])]),_:1})]),_:1})]),_:1})]),e(ge,{data:m.value,style:{width:"100%","margin-top":"20px"}},{default:l(()=>[e(Q,{prop:"time",label:"操作时间",width:"180"}),e(Q,{prop:"type",label:"操作类型",width:"120"},{default:l(({row:E})=>[e(p,{type:q(E.type)},{default:l(()=>[a(g(E.type),1)]),_:2},1032,["type"])]),_:1}),e(Q,{prop:"action",label:"操作内容"}),e(Q,{prop:"ip",label:"IP地址",width:"140"}),e(Q,{prop:"userAgent",label:"设备信息",width:"200","show-overflow-tooltip":""}),e(Q,{prop:"result",label:"操作结果",width:"100"},{default:l(({row:E})=>[e(p,{type:E.result==="成功"?"success":"danger"},{default:l(()=>[a(g(E.result),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"]),t("div",is,[e(ye,{"current-page":I.value.currentPage,"onUpdate:currentPage":_[2]||(_[2]=E=>I.value.currentPage=E),"page-size":I.value.pageSize,"onUpdate:pageSize":_[3]||(_[3]=E=>I.value.pageSize=E),"page-sizes":[10,20,50,100],total:I.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:ee},null,8,["current-page","page-size","total"])])])]),_:1}),e(re,{label:"安全设置",name:"security"},{default:l(()=>[t("div",us,[e(Y,{column:2,border:""},{default:l(()=>[e(F,{label:"密码强度"},{default:l(()=>[e(S,{percentage:M.value,color:C()},null,8,["percentage","color"])]),_:1}),e(F,{label:"双因子认证"},{default:l(()=>[e(p,{type:V.user.twoFactorEnabled?"success":"warning"},{default:l(()=>[a(g(V.user.twoFactorEnabled?"已启用":"未启用"),1)]),_:1},8,["type"])]),_:1}),e(F,{label:"密码最后修改"},{default:l(()=>[a(g(V.user.passwordLastChanged||"从未修改"),1)]),_:1}),e(F,{label:"登录失败次数"},{default:l(()=>[a(g(V.user.failedLoginAttempts||0),1)]),_:1}),e(F,{label:"账户锁定状态"},{default:l(()=>[e(p,{type:V.user.isLocked?"danger":"success"},{default:l(()=>[a(g(V.user.isLocked?"已锁定":"正常"),1)]),_:1},8,["type"])]),_:1}),e(F,{label:"会话超时设置"},{default:l(()=>[a(g(V.user.sessionTimeout||"30分钟"),1)]),_:1})]),_:1}),t("div",rs,[e(b,{onClick:le,type:"warning"},{default:l(()=>[..._[13]||(_[13]=[a("重置密码",-1)])]),_:1}),e(b,{onClick:Z,type:V.user.twoFactorEnabled?"danger":"primary"},{default:l(()=>[a(g(V.user.twoFactorEnabled?"禁用":"启用")+"双因子认证 ",1)]),_:1},8,["type"]),V.user.isLocked?(i(),D(b,{key:0,onClick:L,type:"success"},{default:l(()=>[..._[14]||(_[14]=[a("解锁账户",-1)])]),_:1})):oe("",!0),e(b,{onClick:r,type:"danger"},{default:l(()=>[..._[15]||(_[15]=[a("强制下线",-1)])]),_:1})])])]),_:1})]),_:1},8,["modelValue"])])):oe("",!0)]),_:1},8,["modelValue","title"])}}}),cs=$e(ps,[["__scopeId","data-v-459da61d"]]),vs={class:"import-content"},fs={key:0,class:"step-content"},_s={class:"upload-section"},gs={key:0,class:"template-options"},bs={key:1,class:"step-content"},ys={class:"preview-section"},ws={class:"preview-summary"},Vs={key:0,class:"validation-results"},ks={key:2,class:"step-content"},Cs={class:"confirm-section"},xs={class:"import-summary"},$s={class:"selected-templates"},Us={class:"dialog-footer"},Ps={class:"permission-preview"},Ts=xe({__name:"RoleTemplateImportDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","imported"],setup(V,{emit:K}){const x=V,k=K,U=w(0),M=w(!1),O=w(),j=w(null),c=w(!1),u=w(null),m=de({get:()=>x.modelValue,set:d=>k("update:modelValue",d)}),I=w({mode:"merge",conflictResolution:"skip",validatePermissions:!0}),T=w([{id:"1",name:"销售经理模板",description:"销售经理角色权限模板",permissionCount:18,status:"valid",permissions:{customer:["查看客户","创建客户","编辑客户","分配客户","导出客户"],order:["查看订单","创建订单","编辑订单","审核订单","导出订单"],product:["查看商品","编辑商品"],report:["查看报表","导出报表","自定义报表"]},dataPermissions:{customer:{level:"department",scopes:["所属部门及下级部门"]},order:{level:"department",scopes:["所属部门及下级部门"]}},systemPermissions:{config:["基础配置"],security:["密码策略"]}},{id:"2",name:"客服专员模板",description:"客服专员角色权限模板",permissionCount:12,status:"conflict",permissions:{customer:["查看客户","编辑客户"],order:["查看订单"],service:["查看服务","创建服务","编辑服务","处理服务"],logistics:["查看物流","跟踪物流"]},dataPermissions:{customer:{level:"personal",scopes:["本人负责"]},service:{level:"department",scopes:["所属部门"]}},systemPermissions:{config:[],security:[]}},{id:"3",name:"仓库管理员模板",description:"仓库管理员角色权限模板",permissionCount:10,status:"valid",permissions:{product:["查看商品","编辑商品","库存管理"],order:["查看订单","处理订单"],logistics:["查看物流","更新物流","物流管理"]},dataPermissions:{product:{level:"category",scopes:["负责分类"]},logistics:{level:"region",scopes:["负责区域"]}},systemPermissions:{config:["库存配置"],security:[]}}]),q=w([{id:"1",message:'模板"客服专员模板"与现有模板名称冲突'},{id:"2",message:'权限配置"删除客户"超出当前用户权限范围'},{id:"3",message:'数据权限级别"全部"需要超级管理员权限'},{id:"4",message:'系统权限"数据备份"仅限系统管理员使用'}]),C=w([]),z=de(()=>U.value===0?j.value!==null:U.value===1?C.value.length>0:!0),G=de(()=>I.value.mode==="merge"?"合并模式":"替换模式"),N=de(()=>({skip:"跳过冲突项",rename:"自动重命名",overwrite:"覆盖现有项"})[I.value.conflictResolution]),ee=d=>{j.value=d.raw,setTimeout(()=>{P.success("文件解析成功")},1e3)},le=d=>{const p=["application/json","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(d.type),X=d.size/1024/1024<10;return p?(X||P.error("文件大小不能超过 10MB!"),!1):(P.error("只支持 JSON、Excel、CSV 格式文件!"),!1)},Z=d=>({valid:"success",conflict:"warning",error:"danger"})[d]||"info",L=d=>({valid:"有效",conflict:"冲突",error:"错误"})[d]||"未知",r=d=>({customer:"客户管理",order:"订单管理",report:"报表管理",service:"客服管理"})[d]||d,s=d=>{u.value=d,c.value=!0},J=()=>{U.value===0&&(C.value=T.value.filter(d=>d.status==="valid")),U.value<2&&U.value++},y=()=>{U.value>0&&U.value--},B=()=>fe(this,null,function*(){try{yield Se.confirm(`确定要导入 ${C.value.length} 个角色模板吗？`,"确认导入",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),M.value=!0,yield new Promise(d=>setTimeout(d,2e3)),P.success("角色模板导入成功"),k("imported",C.value),_()}catch(d){d!=="cancel"&&P.error("导入失败")}finally{M.value=!1}}),_=()=>{U.value=0,j.value=null,C.value=[],c.value=!1,u.value=null,k("update:modelValue",!1)};return(d,p)=>{const X=o("el-step"),F=o("el-steps"),Y=o("el-icon"),me=o("el-upload"),re=o("el-radio"),pe=o("el-radio-group"),ie=o("el-form-item"),H=o("el-option"),_e=o("el-select"),b=o("el-switch"),Q=o("el-form"),ge=o("el-alert"),ye=o("el-table-column"),S=o("el-tag"),we=o("el-button"),Ie=o("el-table"),Ce=o("el-result"),E=o("el-descriptions-item"),ae=o("el-descriptions"),Ee=o("el-dialog");return i(),D(Ee,{modelValue:m.value,"onUpdate:modelValue":p[4]||(p[4]=he=>m.value=he),title:"导入角色模板",width:"700px",onClose:_},{footer:l(()=>[t("div",Us,[e(we,{onClick:_},{default:l(()=>[...p[14]||(p[14]=[a("取消",-1)])]),_:1}),U.value>0?(i(),D(we,{key:0,onClick:y},{default:l(()=>[...p[15]||(p[15]=[a("上一步",-1)])]),_:1})):oe("",!0),U.value<2?(i(),D(we,{key:1,onClick:J,type:"primary",disabled:!z.value},{default:l(()=>[...p[16]||(p[16]=[a(" 下一步 ",-1)])]),_:1},8,["disabled"])):oe("",!0),U.value===2?(i(),D(we,{key:2,onClick:B,type:"primary",loading:M.value},{default:l(()=>[...p[17]||(p[17]=[a(" 确认导入 ",-1)])]),_:1},8,["loading"])):oe("",!0)])]),default:l(()=>{var he;return[t("div",vs,[e(F,{active:U.value,"finish-status":"success","align-center":""},{default:l(()=>[e(X,{title:"选择文件"}),e(X,{title:"预览数据"}),e(X,{title:"确认导入"})]),_:1},8,["active"]),U.value===0?(i(),R("div",fs,[t("div",_s,[e(me,{ref_key:"uploadRef",ref:O,class:"upload-demo",drag:"","auto-upload":!1,"on-change":ee,"before-upload":le,accept:".json,.xlsx,.csv",limit:1},{tip:l(()=>[...p[5]||(p[5]=[t("div",{class:"el-upload__tip"}," 支持 JSON、Excel、CSV 格式文件，文件大小不超过 10MB ",-1)])]),default:l(()=>[e(Y,{class:"el-icon--upload"},{default:l(()=>[e($(et))]),_:1}),p[6]||(p[6]=t("div",{class:"el-upload__text"},[a(" 将文件拖到此处，或"),t("em",null,"点击上传")],-1))]),_:1},512),j.value?(i(),R("div",gs,[p[10]||(p[10]=t("h4",null,"导入选项",-1)),e(Q,{model:I.value,"label-width":"120px"},{default:l(()=>[e(ie,{label:"导入模式"},{default:l(()=>[e(pe,{modelValue:I.value.mode,"onUpdate:modelValue":p[0]||(p[0]=ce=>I.value.mode=ce)},{default:l(()=>[e(re,{value:"merge"},{default:l(()=>[...p[7]||(p[7]=[a("合并模式（保留现有模板）",-1)])]),_:1}),e(re,{value:"replace"},{default:l(()=>[...p[8]||(p[8]=[a("替换模式（覆盖同名模板）",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ie,{label:"冲突处理"},{default:l(()=>[e(_e,{modelValue:I.value.conflictResolution,"onUpdate:modelValue":p[1]||(p[1]=ce=>I.value.conflictResolution=ce),placeholder:"选择冲突处理方式"},{default:l(()=>[e(H,{label:"跳过冲突项",value:"skip"}),e(H,{label:"自动重命名",value:"rename"}),e(H,{label:"覆盖现有项",value:"overwrite"})]),_:1},8,["modelValue"])]),_:1}),e(ie,{label:"验证权限"},{default:l(()=>[e(b,{modelValue:I.value.validatePermissions,"onUpdate:modelValue":p[2]||(p[2]=ce=>I.value.validatePermissions=ce)},null,8,["modelValue"]),p[9]||(p[9]=t("span",{class:"form-tip"},"验证导入的权限是否在系统中存在",-1))]),_:1})]),_:1},8,["model"])])):oe("",!0)])])):oe("",!0),U.value===1?(i(),R("div",bs,[t("div",ys,[t("div",ws,[e(ge,{title:`共解析到 ${T.value.length} 个角色模板`,type:"info",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"])]),e(Ie,{data:T.value,style:{width:"100%"},"max-height":"400"},{default:l(()=>[e(ye,{type:"selection",width:"55"}),e(ye,{prop:"name",label:"模板名称",width:"150"}),e(ye,{prop:"description",label:"描述"}),e(ye,{prop:"permissionCount",label:"权限数量",width:"100"}),e(ye,{label:"状态",width:"120"},{default:l(({row:ce})=>[e(S,{type:Z(ce.status)},{default:l(()=>[a(g(L(ce.status)),1)]),_:2},1032,["type"])]),_:1}),e(ye,{label:"操作",width:"100"},{default:l(({row:ce})=>[e(we,{onClick:Ne=>s(ce),size:"small",type:"primary",link:""},{default:l(()=>[...p[11]||(p[11]=[a(" 查看权限 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),q.value.length>0?(i(),R("div",Vs,[p[12]||(p[12]=t("h4",null,"验证结果",-1)),(i(!0),R(te,null,se(q.value,ce=>(i(),D(ge,{key:ce.id,title:ce.message,type:"warning",closable:!1,style:{"margin-bottom":"10px"}},null,8,["title"]))),128))])):oe("",!0)])])):oe("",!0),U.value===2?(i(),R("div",ks,[t("div",Cs,[e(Ce,{icon:"success",title:"准备导入","sub-title":`将导入 ${C.value.length} 个角色模板`},null,8,["sub-title"]),t("div",xs,[e(ae,{column:2,border:""},{default:l(()=>[e(E,{label:"导入模式"},{default:l(()=>[a(g(G.value),1)]),_:1}),e(E,{label:"冲突处理"},{default:l(()=>[a(g(N.value),1)]),_:1}),e(E,{label:"模板数量"},{default:l(()=>[a(g(C.value.length),1)]),_:1}),e(E,{label:"权限验证"},{default:l(()=>[a(g(I.value.validatePermissions?"已启用":"已禁用"),1)]),_:1})]),_:1})]),t("div",$s,[p[13]||(p[13]=t("h4",null,"将要导入的模板：",-1)),(i(!0),R(te,null,se(C.value,ce=>(i(),D(S,{key:ce.id,style:{margin:"5px"},type:"primary"},{default:l(()=>[a(g(ce.name),1)]),_:2},1024))),128))])])])):oe("",!0)]),e(Ee,{modelValue:c.value,"onUpdate:modelValue":p[3]||(p[3]=ce=>c.value=ce),title:`权限预览 - ${(he=u.value)==null?void 0:he.name}`,width:"500px"},{default:l(()=>{var ce;return[t("div",Ps,[(i(!0),R(te,null,se((ce=u.value)==null?void 0:ce.permissions,(Ne,Ye)=>(i(),R("div",{key:Ye},[t("h5",null,g(r(Ye)),1),(i(!0),R(te,null,se(Ne,He=>(i(),D(S,{key:He,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(He),1)]),_:2},1024))),128))]))),128))])]}),_:1},8,["modelValue","title"])]}),_:1},8,["modelValue"])}}}),Ss=$e(Ts,[["__scopeId","data-v-1f8ebde5"]]),Ds={key:0,class:"preview-content"},Rs={class:"template-info"},Ls={class:"permissions-detail"},As={class:"permission-grid"},zs={class:"module-header"},Is={class:"permission-list"},Ms={class:"data-permissions"},hs={class:"scope-permissions"},Bs={class:"scope-conditions"},Os={class:"condition-field"},js={class:"condition-value"},Fs={class:"system-permissions"},qs={class:"system-section"},Es={class:"system-section"},Ns={class:"permission-matrix"},Ys={key:0,class:"usage-stats"},Hs={class:"dialog-footer"},Js=xe({__name:"RoleTemplatePreviewDialog",props:{modelValue:{type:Boolean},template:{}},emits:["update:modelValue","apply","export"],setup(V,{emit:K}){const x=V,k=K,U=w("functional"),M=w([]),O=w([]),j=de({get:()=>x.modelValue,set:L=>k("update:modelValue",L)}),c=de(()=>({customer:[{code:"customer_view",name:"查看客户",level:"basic"},{code:"customer_create",name:"创建客户",level:"basic"},{code:"customer_edit",name:"编辑客户",level:"intermediate"},{code:"customer_delete",name:"删除客户",level:"advanced"},{code:"customer_export",name:"导出客户",level:"intermediate"},{code:"customer_assign",name:"分配客户",level:"advanced"},{code:"customer_transfer",name:"转移客户",level:"advanced"},{code:"customer_merge",name:"合并客户",level:"advanced"}],order:[{code:"order_view",name:"查看订单",level:"basic"},{code:"order_create",name:"创建订单",level:"basic"},{code:"order_edit",name:"编辑订单",level:"intermediate"},{code:"order_cancel",name:"取消订单",level:"advanced"},{code:"order_audit",name:"审核订单",level:"advanced"},{code:"order_export",name:"导出订单",level:"intermediate"},{code:"order_refund",name:"退款处理",level:"advanced"},{code:"order_price_adjust",name:"价格调整",level:"advanced"}],product:[{code:"product_view",name:"查看商品",level:"basic"},{code:"product_create",name:"创建商品",level:"intermediate"},{code:"product_edit",name:"编辑商品",level:"intermediate"},{code:"product_delete",name:"删除商品",level:"advanced"},{code:"product_publish",name:"上架商品",level:"intermediate"},{code:"product_unpublish",name:"下架商品",level:"intermediate"},{code:"product_category",name:"分类管理",level:"advanced"},{code:"product_inventory",name:"库存管理",level:"intermediate"}],service:[{code:"service_view",name:"查看服务",level:"basic"},{code:"service_create",name:"创建服务",level:"basic"},{code:"service_edit",name:"编辑服务",level:"intermediate"},{code:"service_close",name:"关闭服务",level:"intermediate"},{code:"service_assign",name:"分配服务",level:"advanced"},{code:"service_escalate",name:"升级服务",level:"advanced"}],logistics:[{code:"logistics_view",name:"查看物流",level:"basic"},{code:"logistics_track",name:"跟踪物流",level:"basic"},{code:"logistics_update",name:"更新物流",level:"intermediate"},{code:"logistics_manage",name:"物流管理",level:"advanced"}],report:[{code:"report_view",name:"查看报表",level:"basic"},{code:"report_export",name:"导出报表",level:"intermediate"},{code:"report_custom",name:"自定义报表",level:"advanced"},{code:"report_share",name:"分享报表",level:"intermediate"},{code:"report_schedule",name:"定时报表",level:"advanced"}],system:[{code:"system_user_manage",name:"用户管理",level:"advanced"},{code:"system_permission_manage",name:"权限管理",level:"advanced"},{code:"system_config",name:"系统配置",level:"advanced"},{code:"system_log_view",name:"日志查看",level:"intermediate"},{code:"system_backup",name:"数据备份",level:"advanced"},{code:"system_monitor",name:"系统监控",level:"advanced"}]})),u=de(()=>({customer:{level:"department",permissions:["查看","编辑","分配","导出"],conditions:[{field:"部门",value:"所属部门及下级部门"},{field:"状态",value:"有效客户"},{field:"创建时间",value:"近一年"}]},order:{level:"personal",permissions:["查看","处理","审核"],conditions:[{field:"负责人",value:"本人创建或分配"},{field:"订单状态",value:"待处理、处理中"}]},product:{level:"category",permissions:["查看","编辑","上下架"],conditions:[{field:"分类",value:"负责分类及子分类"},{field:"状态",value:"正常状态"}]},service:{level:"department",permissions:["查看","处理","分配"],conditions:[{field:"部门",value:"所属部门"},{field:"优先级",value:"普通、紧急"}]},logistics:{level:"region",permissions:["查看","跟踪","更新"],conditions:[{field:"区域",value:"负责区域"},{field:"状态",value:"运输中、待配送"}]},report:{level:"department",permissions:["查看","导出","分享"],conditions:[{field:"数据范围",value:"部门数据"},{field:"时间范围",value:"近三个月"}]}})),m=de(()=>[{module:"客户管理",view:!0,create:!0,edit:!0,delete:!1,export:!0,special:["客户分配","客户转移","客户合并"]},{module:"订单管理",view:!0,create:!0,edit:!0,delete:!1,export:!0,special:["订单审核","价格调整","退款处理"]},{module:"商品管理",view:!0,create:!0,edit:!0,delete:!1,export:!1,special:["上架商品","下架商品","分类管理","库存管理"]},{module:"服务管理",view:!0,create:!0,edit:!0,delete:!1,export:!1,special:["服务分配","服务升级","服务关闭"]},{module:"物流管理",view:!0,create:!1,edit:!0,delete:!1,export:!1,special:["物流跟踪","状态更新","配送管理"]},{module:"报表管理",view:!0,create:!1,edit:!1,delete:!1,export:!0,special:["自定义报表","报表分享","定时报表"]},{module:"系统管理",view:!0,create:!1,edit:!1,delete:!1,export:!1,special:["用户管理","权限管理","系统配置","数据备份"]},{module:"商品管理",view:!0,create:!1,edit:!1,delete:!1,export:!1,special:[]},{module:"报表管理",view:!0,create:!1,edit:!1,delete:!1,export:!0,special:["自定义报表"]}]),I=de(()=>Object.values(c.value).reduce((L,r)=>L+r.length,0)),T=L=>({customer:je,order:st,product:at,report:tt,service:Fe,logistics:lt,system:al})[L]||Ge,q=L=>({customer:"客户管理",order:"订单管理",product:"商品管理",report:"报表管理",service:"客服管理",logistics:"物流管理",system:"系统管理"})[L]||L,C=L=>({basic:"success",intermediate:"warning",advanced:"danger"})[L]||"info",z=L=>({customer:"客户数据",order:"订单数据",product:"商品数据",report:"报表数据"})[L]||L,G=L=>({all:"danger",department:"warning",personal:"success"})[L]||"info",N=L=>({all:"全部数据",department:"部门数据",personal:"个人数据"})[L]||L,ee=()=>{P.success("模板导出成功"),k("export",x.template)},le=()=>{P.success("模板应用成功"),k("apply",x.template),Z()},Z=()=>{k("update:modelValue",!1)};return(L,r)=>{var _e;const s=o("el-descriptions-item"),J=o("el-descriptions"),y=o("el-icon"),B=o("el-tag"),_=o("el-tab-pane"),d=o("el-checkbox"),p=o("el-checkbox-group"),X=o("el-col"),F=o("el-row"),Y=o("el-table-column"),me=o("el-table"),re=o("el-tabs"),pe=o("el-statistic"),ie=o("el-button"),H=o("el-dialog");return i(),D(H,{modelValue:j.value,"onUpdate:modelValue":r[3]||(r[3]=b=>j.value=b),title:`预览角色模板 - ${(_e=V.template)==null?void 0:_e.name}`,width:"900px",onClose:Z},{footer:l(()=>[t("div",Hs,[e(ie,{onClick:Z},{default:l(()=>[...r[8]||(r[8]=[a("关闭",-1)])]),_:1}),e(ie,{onClick:ee,type:"primary"},{default:l(()=>[...r[9]||(r[9]=[a("导出模板",-1)])]),_:1}),e(ie,{onClick:le,type:"success"},{default:l(()=>[...r[10]||(r[10]=[a("应用模板",-1)])]),_:1})])]),default:l(()=>[V.template?(i(),R("div",Ds,[t("div",Rs,[e(J,{column:2,border:""},{default:l(()=>[e(s,{label:"模板名称"},{default:l(()=>[a(g(V.template.name),1)]),_:1}),e(s,{label:"创建时间"},{default:l(()=>[a(g(V.template.createTime),1)]),_:1}),e(s,{label:"描述",span:2},{default:l(()=>[a(g(V.template.description),1)]),_:1}),e(s,{label:"权限总数"},{default:l(()=>[a(g(I.value),1)]),_:1}),e(s,{label:"适用角色"},{default:l(()=>{var b;return[a(g(((b=V.template.applicableRoles)==null?void 0:b.join(", "))||"通用"),1)]}),_:1})]),_:1})]),t("div",Ls,[r[6]||(r[6]=t("h3",null,"权限配置详情",-1)),e(re,{modelValue:U.value,"onUpdate:modelValue":r[2]||(r[2]=b=>U.value=b),type:"border-card"},{default:l(()=>[e(_,{label:"功能权限",name:"functional"},{default:l(()=>[t("div",As,[(i(!0),R(te,null,se(c.value,(b,Q)=>(i(),R("div",{key:Q,class:"permission-module"},[t("div",zs,[e(y,null,{default:l(()=>[(i(),D(Kl(T(Q))))]),_:2},1024),t("span",null,g(q(Q)),1),e(B,{size:"small",type:"info"},{default:l(()=>[a(g(b.length),1)]),_:2},1024)]),t("div",Is,[(i(!0),R(te,null,se(b,ge=>(i(),D(B,{key:ge.code,type:C(ge.level),size:"small",class:"permission-tag"},{default:l(()=>[a(g(ge.name),1)]),_:2},1032,["type"]))),128))])]))),128))])]),_:1}),e(_,{label:"数据权限",name:"data"},{default:l(()=>[t("div",Ms,[(i(!0),R(te,null,se(u.value,(b,Q)=>(i(),R("div",{key:Q,class:"data-scope"},[t("h4",null,g(z(Q)),1),e(J,{column:1,size:"small",border:""},{default:l(()=>[e(s,{label:"访问范围"},{default:l(()=>[e(B,{type:G(b.level)},{default:l(()=>[a(g(N(b.level)),1)]),_:2},1032,["type"])]),_:2},1024),e(s,{label:"具体权限"},{default:l(()=>[t("div",hs,[(i(!0),R(te,null,se(b.permissions,ge=>(i(),D(B,{key:ge,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(ge),1)]),_:2},1024))),128))])]),_:2},1024),b.conditions?(i(),D(s,{key:0,label:"限制条件"},{default:l(()=>[t("div",Bs,[(i(!0),R(te,null,se(b.conditions,ge=>(i(),R("div",{key:ge.field},[t("span",Os,g(ge.field)+":",1),t("span",js,g(ge.value),1)]))),128))])]),_:2},1024)):oe("",!0)]),_:2},1024)]))),128))])]),_:1}),e(_,{label:"系统权限",name:"system"},{default:l(()=>[t("div",Fs,[e(F,{gutter:20},{default:l(()=>[e(X,{span:12},{default:l(()=>[t("div",qs,[r[4]||(r[4]=t("h4",null,"系统配置",-1)),e(p,{modelValue:M.value,"onUpdate:modelValue":r[0]||(r[0]=b=>M.value=b),disabled:""},{default:l(()=>{var b;return[(i(!0),R(te,null,se(((b=V.template.systemPermissions)==null?void 0:b.config)||[],Q=>(i(),D(d,{key:Q.code,label:Q.code},{default:l(()=>[a(g(Q.name),1)]),_:2},1032,["label"]))),128))]}),_:1},8,["modelValue"])])]),_:1}),e(X,{span:12},{default:l(()=>[t("div",Es,[r[5]||(r[5]=t("h4",null,"安全设置",-1)),e(p,{modelValue:O.value,"onUpdate:modelValue":r[1]||(r[1]=b=>O.value=b),disabled:""},{default:l(()=>{var b;return[(i(!0),R(te,null,se(((b=V.template.systemPermissions)==null?void 0:b.security)||[],Q=>(i(),D(d,{key:Q.code,label:Q.code},{default:l(()=>[a(g(Q.name),1)]),_:2},1032,["label"]))),128))]}),_:1},8,["modelValue"])])]),_:1})]),_:1})])]),_:1}),e(_,{label:"权限矩阵",name:"matrix"},{default:l(()=>[t("div",Ns,[e(me,{data:m.value,style:{width:"100%"},border:""},{default:l(()=>[e(Y,{prop:"module",label:"功能模块",width:"150",fixed:""}),e(Y,{prop:"view",label:"查看",width:"80",align:"center"},{default:l(({row:b})=>[b.view?(i(),D(y,{key:0,color:"#67C23A"},{default:l(()=>[e($(Ae))]),_:1})):(i(),D(y,{key:1,color:"#F56C6C"},{default:l(()=>[e($(ze))]),_:1}))]),_:1}),e(Y,{prop:"create",label:"创建",width:"80",align:"center"},{default:l(({row:b})=>[b.create?(i(),D(y,{key:0,color:"#67C23A"},{default:l(()=>[e($(Ae))]),_:1})):(i(),D(y,{key:1,color:"#F56C6C"},{default:l(()=>[e($(ze))]),_:1}))]),_:1}),e(Y,{prop:"edit",label:"编辑",width:"80",align:"center"},{default:l(({row:b})=>[b.edit?(i(),D(y,{key:0,color:"#67C23A"},{default:l(()=>[e($(Ae))]),_:1})):(i(),D(y,{key:1,color:"#F56C6C"},{default:l(()=>[e($(ze))]),_:1}))]),_:1}),e(Y,{prop:"delete",label:"删除",width:"80",align:"center"},{default:l(({row:b})=>[b.delete?(i(),D(y,{key:0,color:"#67C23A"},{default:l(()=>[e($(Ae))]),_:1})):(i(),D(y,{key:1,color:"#F56C6C"},{default:l(()=>[e($(ze))]),_:1}))]),_:1}),e(Y,{prop:"export",label:"导出",width:"80",align:"center"},{default:l(({row:b})=>[b.export?(i(),D(y,{key:0,color:"#67C23A"},{default:l(()=>[e($(Ae))]),_:1})):(i(),D(y,{key:1,color:"#F56C6C"},{default:l(()=>[e($(ze))]),_:1}))]),_:1}),e(Y,{prop:"special",label:"特殊权限","min-width":"200"},{default:l(({row:b})=>[(i(!0),R(te,null,se(b.special,Q=>(i(),D(B,{key:Q,size:"small",style:{margin:"2px"}},{default:l(()=>[a(g(Q),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1},8,["modelValue"])]),V.template.usageStats?(i(),R("div",Ys,[r[7]||(r[7]=t("h3",null,"应用统计",-1)),e(F,{gutter:20},{default:l(()=>[e(X,{span:6},{default:l(()=>[e(pe,{title:"应用次数",value:V.template.usageStats.applyCount},null,8,["value"])]),_:1}),e(X,{span:6},{default:l(()=>[e(pe,{title:"当前使用",value:V.template.usageStats.currentUsers},null,8,["value"])]),_:1}),e(X,{span:6},{default:l(()=>[e(pe,{title:"最后应用",value:V.template.usageStats.lastApplied},null,8,["value"])]),_:1}),e(X,{span:6},{default:l(()=>[e(pe,{title:"成功率",value:V.template.usageStats.successRate,suffix:"%"},null,8,["value"])]),_:1})]),_:1})])):oe("",!0)])):oe("",!0)]),_:1},8,["modelValue","title"])}}}),Ks=$e(Js,[["__scopeId","data-v-698dec14"]]),Gs={class:"super-admin-panel"},Zs={class:"header"},Qs={class:"header-title"},Ws={class:"header-stats"},Xs={class:"header-actions"},eo={class:"tab-content"},lo={class:"filters"},to={class:"pagination"},ao={class:"tab-content"},so={class:"template-actions"},oo={class:"card-header"},no={class:"template-info"},io={class:"template-actions-bottom"},uo={class:"tab-content"},ro={class:"department-actions"},mo={class:"tab-content"},po={class:"audit-filters"},co={class:"pagination"},vo={class:"tab-content"},fo={class:"config-actions"},_o=xe({__name:"SuperAdminPermissionPanel",setup(V){const K=w("users"),x=w({users:!1,departments:!1,audit:!1}),k=w({userPermission:!1,roleTemplate:!1,department:!1,departmentMembers:!1,departmentPermissions:!1,batchAssignPermissions:!1,userDetail:!1,roleTemplateImport:!1,roleTemplatePreview:!1}),U=w(null),M=w(null),O=w(null),j=w(null),c=w([]),u=w(""),m=w(""),I=w(""),T=w([]),q=w(null),C=w(""),z=w(""),G=w({startDate:"",endDate:"",user:"",action:"",resource:"",result:""}),N=w({currentPage:1,pageSize:20,total:0}),ee=w([]),le=w([]),Z=w({currentPage:1,pageSize:20,total:0}),L=w({defaultPermissionLevel:"read_only",enforcePasswordPolicy:!0,requireTwoFactor:!1,sessionTimeout:120,enableAuditLog:!0,auditLogRetentionDays:90,notifySensitiveOperations:!0,autoBackupConfig:!0}),r=w({total:0,activeRoles:0,todayChanges:0}),s=de(()=>c.value.filter(f=>{const n=!u.value||f.name.includes(u.value)||f.email.includes(u.value),ue=!m.value||f.role===m.value,h=!I.value||f.departmentId===I.value;return n&&ue&&h})),J=()=>fe(this,null,function*(){yield Promise.all([y(),B(),_(),d()]),p()}),y=()=>fe(this,null,function*(){x.value.users=!0;try{yield new Promise(f=>setTimeout(f,1e3)),c.value=[{id:"user_001",name:"张管理员",email:"admin@example.com",department:"管理部",departmentId:"admin",role:"super_admin",dataScope:"all",permissionLevel:"full_access",status:"active",lastLogin:"2024-01-15 10:30:00",createdAt:"2024-01-01 09:00:00"},{id:"user_002",name:"李部长",email:"manager@example.com",department:"销售一部",departmentId:"sales_1",role:"department_manager",dataScope:"department",permissionLevel:"partial_access",status:"active",lastLogin:"2024-01-15 09:15:00",createdAt:"2024-01-02 10:00:00"}],N.value.total=c.value.length}finally{x.value.users=!1}}),B=()=>fe(this,null,function*(){ee.value=[{id:"template_001",name:"销售经理模板",description:"适用于销售部门经理的权限配置",permissions:["customer_view","customer_edit","order_view","order_edit"],userCount:5,createdAt:"2024-01-01 09:00:00"},{id:"template_002",name:"客服专员模板",description:"适用于客服部门专员的权限配置",permissions:["customer_view","service_view","service_edit"],userCount:12,createdAt:"2024-01-02 10:00:00"}]}),_=()=>fe(this,null,function*(){x.value.departments=!0;try{yield new Promise(f=>setTimeout(f,800)),le.value=[{id:"dept_001",name:"销售一部",manager:"李部长",memberCount:15,permissionLevel:"partial_access",dataScope:"department",description:"负责华东地区销售业务"},{id:"dept_002",name:"客服部",manager:"王主管",memberCount:8,permissionLevel:"read_only",dataScope:"department",description:"负责客户服务和售后支持"}],console.log("部门数据已刷新")}catch(f){P.error("加载部门数据失败")}finally{x.value.departments=!1}}),d=()=>fe(this,null,function*(){x.value.audit=!0;try{yield new Promise(f=>setTimeout(f,600)),T.value=[{id:"audit_001",timestamp:"2024-01-15 10:30:00",operator:"张管理员",action:"assign",target:"李部长",description:"分配销售经理权限",ipAddress:"192.168.1.100",status:"success"},{id:"audit_002",timestamp:"2024-01-15 09:15:00",operator:"张管理员",action:"user_create",target:"新用户王小明",description:"创建新用户账户",ipAddress:"192.168.1.100",status:"success"}],Z.value.total=T.value.length}finally{x.value.audit=!1}}),p=()=>{r.value={total:c.value.length,activeRoles:new Set(c.value.map(f=>f.role)).size,todayChanges:Math.floor(Math.random()*10)+1}},X=f=>({super_admin:"超级管理员",department_manager:"部门负责人",sales_staff:"销售员",customer_service:"客服"})[f]||"未知",F=f=>({super_admin:"danger",department_manager:"warning",sales_staff:"primary",customer_service:"info"})[f]||"",Y=f=>({all:"全部数据",department:"部门数据",personal:"个人数据"})[f]||"未知",me=f=>({all:"danger",department:"warning",personal:"info"})[f]||"",re=f=>({full_access:"完全权限",partial_access:"部分权限",read_only:"只读权限"})[f]||"未知",pe=f=>({full_access:"danger",partial_access:"warning",read_only:"info"})[f]||"",ie=f=>({assign:"权限分配",revoke:"权限撤销",role_change:"角色变更",user_create:"用户创建",user_delete:"用户删除"})[f]||"未知操作",H=f=>({assign:"success",revoke:"warning",role_change:"primary",user_create:"info",user_delete:"danger"})[f]||"",_e=f=>new Date(f).toLocaleDateString(),b=f=>new Date(f).toLocaleString(),Q=()=>fe(this,null,function*(){yield J(),P.success("数据刷新成功")}),ge=()=>{try{const f={exportInfo:{exportTime:new Date().toISOString(),exportBy:"超级管理员",version:"1.0",description:"系统权限配置完整导出"},users:c.value.map(W=>({id:W.id,username:W.username,name:W.name,email:W.email,role:W.role,department:W.department,status:W.status,permissions:W.permissions||[],createTime:W.createTime,lastLogin:W.lastLogin})),departments:le.value.map(W=>({id:W.id,name:W.name,description:W.description,parentId:W.parentId,permissions:W.permissions||[],members:W.members||[],createTime:W.createTime})),roleTemplates:ee.value.map(W=>({id:W.id,name:W.name,description:W.description,permissions:W.permissions||[],applicableRoles:W.applicableRoles||[],createTime:W.createTime,usageCount:W.usageCount||0})),systemPermissions:{functionalPermissions:[{module:"customer",permissions:["查看","创建","编辑","删除","导出","分配"]},{module:"order",permissions:["查看","创建","编辑","取消","审核","导出"]},{module:"product",permissions:["查看","创建","编辑","删除","上架","下架"]},{module:"report",permissions:["查看","导出","自定义","分享"]},{module:"system",permissions:["用户管理","权限管理","系统配置","日志查看"]}],dataPermissions:[{resource:"customer",scopes:["全部","部门","个人"]},{resource:"order",scopes:["全部","部门","个人"]},{resource:"product",scopes:["全部","分类"]},{resource:"report",scopes:["全部","部门","个人"]}]},auditLogs:T.value.slice(0,100).map(W=>({id:W.id,user:W.user,action:W.action,resource:W.resource,details:W.details,timestamp:W.timestamp,ip:W.ip,result:W.result}))},n=new Blob([JSON.stringify(f,null,2)],{type:"application/json;charset=utf-8"}),ue=URL.createObjectURL(n),h=document.createElement("a");h.href=ue,h.download=`permission-config-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(ue),P.success("权限配置导出成功");const ve={id:Date.now().toString(),user:"超级管理员",action:"导出权限配置",resource:"系统配置",details:`导出了包含 ${c.value.length} 个用户、${le.value.length} 个部门、${ee.value.length} 个角色模板的完整权限配置`,timestamp:new Date().toISOString(),ip:"127.0.0.1",result:"成功"};T.value.unshift(ve)}catch(f){console.error("导出权限配置失败:",f),P.error("导出权限配置失败，请重试")}},ye=()=>{y()},S=()=>{U.value=null,k.value.userPermission=!0},we=()=>{P.info("批量导入用户功能开发中")},Ie=f=>{U.value=f,k.value.userPermission=!0},Ce=f=>{U.value=f,k.value.userDetail=!0},E=f=>fe(this,null,function*(){try{yield Se.confirm(`确定要重置用户 ${f.name} 的密码吗？`,"确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),P.success(`已重置用户 ${f.name} 的密码`)}catch(n){P.info("已取消重置")}}),ae=f=>{const n=f.status==="active"?"启用":"禁用";P.success(`已${n}用户 ${f.name}`)},Ee=f=>{P.success("用户权限更新成功"),y()},he=f=>{N.value.pageSize=f,y()},ce=f=>{N.value.currentPage=f,y()},Ne=()=>{M.value=null,k.value.roleTemplate=!0},Ye=()=>{k.value.roleTemplateImport=!0},He=()=>{const f={templates:ee.value,exportTime:new Date().toISOString(),version:"1.0"},n=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),ue=URL.createObjectURL(n),h=document.createElement("a");h.href=ue,h.download=`role-templates-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(ue),P.success("角色模板导出成功")},pl=f=>{const{action:n,template:ue}=f;switch(n){case"edit":M.value=ue,k.value.roleTemplate=!0;break;case"copy":P.info(`复制模板: ${ue.name}`);break;case"delete":Se.confirm(`确定要删除模板 ${ue.name} 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{P.success("删除成功")}).catch(()=>{P.info("已取消删除")});break}},cl=f=>{P.info(`应用模板: ${f.name}`)},vl=f=>{j.value=f,k.value.roleTemplatePreview=!0},fl=f=>{P.success("角色模板更新成功"),B()},_l=()=>{O.value=null,k.value.department=!0},gl=()=>{k.value.batchAssignPermissions=!0},bl=()=>fe(this,null,function*(){try{P.info("正在同步部门数据..."),yield new Promise(f=>setTimeout(f,2e3)),P.success("部门数据同步成功"),yield _()}catch(f){P.error("部门数据同步失败")}}),yl=f=>{O.value=f,k.value.department=!0},wl=f=>{O.value=f,k.value.departmentMembers=!0},Vl=f=>{O.value=f,k.value.departmentPermissions=!0},kl=()=>{k.value.department=!1,_(),P.success("部门信息保存成功")},Cl=()=>{k.value.departmentMembers=!1,_(),P.success("部门成员更新成功")},xl=f=>{const n=le.value.findIndex(ue=>ue.id===f.id);n>-1&&(le.value[n]=f),P.success("部门权限更新成功")},$l=()=>{k.value.batchAssignPermissions=!1,_(),P.success("批量权限分配成功")},Ul=f=>{k.value.userDetail=!1,U.value=f,k.value.userPermission=!0},Pl=f=>{P.success(`成功导入 ${f.length} 个角色模板`),B()},Tl=f=>{P.success(`角色模板 "${f.name}" 应用成功`)},Sl=f=>{const n={template:f,exportTime:new Date().toISOString(),version:"1.0"},ue=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),h=URL.createObjectURL(ue),ve=document.createElement("a");ve.href=h,ve.download=`role-template-${f.name}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ve),ve.click(),document.body.removeChild(ve),URL.revokeObjectURL(h),P.success(`角色模板 "${f.name}" 导出成功`)},Dl=()=>fe(this,null,function*(){try{x.value.audit=!0;const f={exportInfo:{title:"权限审计日志导出",exportTime:new Date().toISOString(),exportUser:"当前用户",totalRecords:T.value.length,dateRange:{start:G.value.startDate||"全部",end:G.value.endDate||"全部"},filters:{user:G.value.user||"全部用户",action:G.value.action||"全部操作",resource:G.value.resource||"全部资源",result:G.value.result||"全部结果"}},auditLogs:T.value.map(A=>({id:A.id,timestamp:A.timestamp,user:A.user,action:A.action,resource:A.resource,details:A.details,ip:A.ip,userAgent:A.userAgent||"Unknown",result:A.result,duration:A.duration||0,errorMessage:A.errorMessage||"",sessionId:A.sessionId||"",requestId:A.requestId||""})),summary:{totalActions:T.value.length,successfulActions:T.value.filter(A=>A.result==="success").length,failedActions:T.value.filter(A=>A.result==="failure").length,uniqueUsers:[...new Set(T.value.map(A=>A.user))].length,actionTypes:[...new Set(T.value.map(A=>A.action))],resourceTypes:[...new Set(T.value.map(A=>A.resource))],timeRange:{earliest:T.value.length>0?Math.min(...T.value.map(A=>new Date(A.timestamp).getTime())):null,latest:T.value.length>0?Math.max(...T.value.map(A=>new Date(A.timestamp).getTime())):null}},statistics:{actionsByType:T.value.reduce((A,Ve)=>(A[Ve.action]=(A[Ve.action]||0)+1,A),{}),actionsByUser:T.value.reduce((A,Ve)=>(A[Ve.user]=(A[Ve.user]||0)+1,A),{}),actionsByResource:T.value.reduce((A,Ve)=>(A[Ve.resource]=(A[Ve.resource]||0)+1,A),{}),actionsByResult:T.value.reduce((A,Ve)=>(A[Ve.result]=(A[Ve.result]||0)+1,A),{})}},n=new Blob([JSON.stringify(f,null,2)],{type:"application/json;charset=utf-8"}),ue=URL.createObjectURL(n),h=document.createElement("a");h.href=ue,h.download=`audit-logs-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(ue);const ve=["时间","用户","操作","资源","详情","IP地址","结果","持续时间(ms)","错误信息"],W=T.value.map(A=>[A.timestamp,A.user,A.action,A.resource,A.details.replace(/,/g,";"),A.ip,A.result,A.duration||0,(A.errorMessage||"").replace(/,/g,";")]),be=[ve.join(","),...W.map(A=>A.join(","))].join(`
`),Be=new Blob(["\uFEFF"+be],{type:"text/csv;charset=utf-8"}),ne=URL.createObjectURL(Be),ke=document.createElement("a");ke.href=ne,ke.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),URL.revokeObjectURL(ne);const De={id:Date.now().toString(),timestamp:new Date().toISOString(),user:"当前用户",action:"导出审计日志",resource:"审计日志",details:`导出了 ${T.value.length} 条审计日志记录`,ip:"127.0.0.1",result:"success",duration:1e3};T.value.unshift(De),P.success(`审计日志导出成功！已导出 ${T.value.length} 条记录`)}catch(f){console.error("导出审计日志失败:",f),P.error("导出审计日志失败，请重试")}finally{x.value.audit=!1}}),Rl=()=>{var f,n,ue,h;G.value={startDate:((n=(f=q.value)==null?void 0:f[0])==null?void 0:n.toISOString().split("T")[0])||"",endDate:((h=(ue=q.value)==null?void 0:ue[1])==null?void 0:h.toISOString().split("T")[0])||"",user:z.value,action:C.value,resource:"",result:""},d(),P.success("搜索完成")},Ll=f=>{Z.value.pageSize=f,d()},Al=f=>{Z.value.currentPage=f,d()},zl=()=>{P.success("系统配置保存成功")},Il=()=>{P.info("重置系统配置功能开发中")},Ml=()=>{P.info("导出系统配置功能开发中")};return Gl(()=>{J()}),(f,n)=>{const ue=o("el-statistic"),h=o("el-button"),ve=o("el-icon"),W=o("el-input"),be=o("el-option"),Be=o("el-select"),ne=o("el-table-column"),ke=o("el-tag"),De=o("el-switch"),A=o("el-table"),Ve=o("el-pagination"),Oe=o("el-tab-pane"),We=o("el-dropdown-item"),hl=o("el-dropdown-menu"),Bl=o("el-dropdown"),Xe=o("el-card"),el=o("el-col"),sl=o("el-row"),Ol=o("el-date-picker"),Re=o("el-form-item"),ol=o("el-input-number"),nl=o("el-form"),jl=o("el-tabs"),Fl=o("el-alert"),ll=ml("loading");return i(),R("div",Gs,[t("div",Zs,[t("div",Qs,[n[28]||(n[28]=t("h1",{class:"page-title"},"超级管理员权限配置面板",-1)),t("div",Ws,[e(ue,{title:"管理用户总数",value:r.value.total},null,8,["value"]),e(ue,{title:"活跃角色数",value:r.value.activeRoles},null,8,["value"]),e(ue,{title:"今日权限变更",value:r.value.todayChanges},null,8,["value"])])]),t("div",Xs,[e(h,{onClick:Q,type:"primary"},{default:l(()=>[...n[29]||(n[29]=[a("刷新数据",-1)])]),_:1}),e(h,{onClick:ge,type:"success"},{default:l(()=>[...n[30]||(n[30]=[a("导出权限配置",-1)])]),_:1})])]),e(jl,{modelValue:K.value,"onUpdate:modelValue":n[18]||(n[18]=v=>K.value=v),type:"card",class:"admin-tabs"},{default:l(()=>[e(Oe,{label:"用户权限管理",name:"users"},{default:l(()=>[t("div",eo,[t("div",lo,[e(W,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=v=>u.value=v),placeholder:"搜索用户姓名或邮箱",style:{width:"200px","margin-right":"10px"},clearable:""},{prefix:l(()=>[e(ve,null,{default:l(()=>[e($(Qe))]),_:1})]),_:1},8,["modelValue"]),e(Be,{modelValue:m.value,"onUpdate:modelValue":n[1]||(n[1]=v=>m.value=v),placeholder:"用户角色",style:{width:"150px","margin-right":"10px"},clearable:""},{default:l(()=>[e(be,{label:"全部",value:""}),e(be,{label:"超级管理员",value:"super_admin"}),e(be,{label:"部门负责人",value:"department_manager"}),e(be,{label:"销售员",value:"sales_staff"}),e(be,{label:"客服",value:"customer_service"})]),_:1},8,["modelValue"]),e(Be,{modelValue:I.value,"onUpdate:modelValue":n[2]||(n[2]=v=>I.value=v),placeholder:"部门",style:{width:"150px","margin-right":"10px"},clearable:""},{default:l(()=>[e(be,{label:"全部",value:""}),e(be,{label:"管理部",value:"admin"}),e(be,{label:"销售一部",value:"sales_1"}),e(be,{label:"销售二部",value:"sales_2"}),e(be,{label:"客服部",value:"service"})]),_:1},8,["modelValue"]),e(h,{onClick:ye,type:"primary"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(Qe))]),_:1}),n[31]||(n[31]=a(" 搜索 ",-1))]),_:1}),e(h,{onClick:S,type:"success"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(Ze))]),_:1}),n[32]||(n[32]=a(" 新增用户 ",-1))]),_:1}),e(h,{onClick:we,type:"warning"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(ul))]),_:1}),n[33]||(n[33]=a(" 批量导入 ",-1))]),_:1})]),Ke((i(),D(A,{data:s.value,style:{width:"100%"}},{default:l(()=>[e(ne,{type:"selection",width:"55"}),e(ne,{prop:"name",label:"姓名",width:"120"}),e(ne,{prop:"email",label:"邮箱",width:"200"}),e(ne,{prop:"department",label:"部门",width:"120"}),e(ne,{label:"角色",width:"120"},{default:l(({row:v})=>[e(ke,{type:F(v.role)},{default:l(()=>[a(g(X(v.role)),1)]),_:2},1032,["type"])]),_:1}),e(ne,{label:"数据权限",width:"120"},{default:l(({row:v})=>[e(ke,{type:me(v.dataScope),size:"small"},{default:l(()=>[a(g(Y(v.dataScope)),1)]),_:2},1032,["type"])]),_:1}),e(ne,{label:"状态",width:"100"},{default:l(({row:v})=>[e(De,{modelValue:v.status,"onUpdate:modelValue":Ue=>v.status=Ue,"active-value":"active","inactive-value":"inactive",onChange:Ue=>ae(v)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(ne,{label:"最后登录",width:"150"},{default:l(({row:v})=>[a(g(_e(v.lastLogin)),1)]),_:1}),e(ne,{label:"操作",width:"280"},{default:l(({row:v})=>[e(h,{onClick:Ue=>Ie(v),size:"small",type:"primary"},{default:l(()=>[...n[34]||(n[34]=[a(" 编辑权限 ",-1)])]),_:1},8,["onClick"]),e(h,{onClick:Ue=>Ce(v),size:"small"},{default:l(()=>[...n[35]||(n[35]=[a(" 查看详情 ",-1)])]),_:1},8,["onClick"]),e(h,{onClick:Ue=>E(v),size:"small",type:"warning"},{default:l(()=>[...n[36]||(n[36]=[a(" 重置密码 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ll,x.value.users]]),t("div",to,[e(Ve,{"current-page":N.value.currentPage,"onUpdate:currentPage":n[3]||(n[3]=v=>N.value.currentPage=v),"page-size":N.value.pageSize,"onUpdate:pageSize":n[4]||(n[4]=v=>N.value.pageSize=v),"page-sizes":[10,20,50,100],total:N.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:he,onCurrentChange:ce},null,8,["current-page","page-size","total"])])])]),_:1}),e(Oe,{label:"角色权限模板",name:"roles"},{default:l(()=>[t("div",ao,[t("div",so,[e(h,{onClick:Ne,type:"primary"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(Ze))]),_:1}),n[37]||(n[37]=a(" 创建角色模板 ",-1))]),_:1}),e(h,{onClick:Ye,type:"success"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(ul))]),_:1}),n[38]||(n[38]=a(" 导入模板 ",-1))]),_:1}),e(h,{onClick:He,type:"warning"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(rl))]),_:1}),n[39]||(n[39]=a(" 导出模板 ",-1))]),_:1})]),e(sl,{gutter:20},{default:l(()=>[(i(!0),R(te,null,se(ee.value,v=>(i(),D(el,{span:8,key:v.id},{default:l(()=>[e(Xe,{class:"role-template-card"},{header:l(()=>[t("div",oo,[t("span",null,g(v.name),1),e(Bl,{onCommand:pl},{dropdown:l(()=>[e(hl,null,{default:l(()=>[e(We,{command:{action:"edit",template:v}},{default:l(()=>[...n[40]||(n[40]=[a("编辑",-1)])]),_:1},8,["command"]),e(We,{command:{action:"copy",template:v}},{default:l(()=>[...n[41]||(n[41]=[a("复制",-1)])]),_:1},8,["command"]),e(We,{command:{action:"delete",template:v},divided:""},{default:l(()=>[...n[42]||(n[42]=[a("删除",-1)])]),_:1},8,["command"])]),_:2},1024)]),default:l(()=>[e(h,{type:"text"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(ot))]),_:1})]),_:1})]),_:2},1024)])]),default:l(()=>[t("div",no,[t("p",null,[n[43]||(n[43]=t("strong",null,"描述：",-1)),a(g(v.description),1)]),t("p",null,[n[44]||(n[44]=t("strong",null,"权限数量：",-1)),a(g(v.permissions.length),1)]),t("p",null,[n[45]||(n[45]=t("strong",null,"使用人数：",-1)),a(g(v.userCount),1)]),t("p",null,[n[46]||(n[46]=t("strong",null,"创建时间：",-1)),a(g(_e(v.createdAt)),1)])]),t("div",io,[e(h,{onClick:Ue=>cl(v),type:"primary",size:"small"},{default:l(()=>[...n[47]||(n[47]=[a("应用模板",-1)])]),_:1},8,["onClick"]),e(h,{onClick:Ue=>vl(v),size:"small"},{default:l(()=>[...n[48]||(n[48]=[a("预览权限",-1)])]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1}),e(Oe,{label:"部门权限管理",name:"departments"},{default:l(()=>[t("div",uo,[t("div",ro,[e(h,{onClick:_l,type:"primary"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(Ze))]),_:1}),n[49]||(n[49]=a(" 新增部门 ",-1))]),_:1}),e(h,{onClick:gl,type:"success"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(al))]),_:1}),n[50]||(n[50]=a(" 批量分配权限 ",-1))]),_:1}),e(h,{onClick:bl,type:"warning"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(nt))]),_:1}),n[51]||(n[51]=a(" 同步部门数据 ",-1))]),_:1})]),Ke((i(),D(A,{data:le.value,style:{width:"100%"}},{default:l(()=>[e(ne,{prop:"name",label:"部门名称",width:"200"}),e(ne,{prop:"manager",label:"部门负责人",width:"150"}),e(ne,{prop:"memberCount",label:"成员数量",width:"120"}),e(ne,{label:"权限级别",width:"150"},{default:l(({row:v})=>[e(ke,{type:pe(v.permissionLevel)},{default:l(()=>[a(g(re(v.permissionLevel)),1)]),_:2},1032,["type"])]),_:1}),e(ne,{label:"数据范围",width:"150"},{default:l(({row:v})=>[e(ke,{type:me(v.dataScope),size:"small"},{default:l(()=>[a(g(Y(v.dataScope)),1)]),_:2},1032,["type"])]),_:1}),e(ne,{prop:"description",label:"描述"}),e(ne,{label:"操作",width:"250"},{default:l(({row:v})=>[e(h,{onClick:Ue=>yl(v),size:"small",type:"primary"},{default:l(()=>[...n[52]||(n[52]=[a("编辑",-1)])]),_:1},8,["onClick"]),e(h,{onClick:Ue=>wl(v),size:"small"},{default:l(()=>[...n[53]||(n[53]=[a("成员管理",-1)])]),_:1},8,["onClick"]),e(h,{onClick:Ue=>Vl(v),size:"small"},{default:l(()=>[...n[54]||(n[54]=[a("权限详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ll,x.value.departments]])])]),_:1}),e(Oe,{label:"权限审计日志",name:"audit"},{default:l(()=>[t("div",mo,[t("div",po,[e(Ol,{modelValue:q.value,"onUpdate:modelValue":n[5]||(n[5]=v=>q.value=v),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{"margin-right":"10px"}},null,8,["modelValue"]),e(Be,{modelValue:C.value,"onUpdate:modelValue":n[6]||(n[6]=v=>C.value=v),placeholder:"操作类型",style:{width:"150px","margin-right":"10px"},clearable:""},{default:l(()=>[e(be,{label:"全部",value:""}),e(be,{label:"权限分配",value:"assign"}),e(be,{label:"权限撤销",value:"revoke"}),e(be,{label:"角色变更",value:"role_change"}),e(be,{label:"用户创建",value:"user_create"}),e(be,{label:"用户删除",value:"user_delete"})]),_:1},8,["modelValue"]),e(W,{modelValue:z.value,"onUpdate:modelValue":n[7]||(n[7]=v=>z.value=v),placeholder:"操作人员",style:{width:"150px","margin-right":"10px"},clearable:""},null,8,["modelValue"]),e(h,{onClick:Rl,type:"primary"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(Qe))]),_:1}),n[55]||(n[55]=a(" 搜索 ",-1))]),_:1}),e(h,{onClick:Dl,type:"success"},{default:l(()=>[e(ve,null,{default:l(()=>[e($(rl))]),_:1}),n[56]||(n[56]=a(" 导出日志 ",-1))]),_:1})]),Ke((i(),D(A,{data:T.value,style:{width:"100%"}},{default:l(()=>[e(ne,{prop:"timestamp",label:"时间",width:"180"},{default:l(({row:v})=>[a(g(b(v.timestamp)),1)]),_:1}),e(ne,{prop:"operator",label:"操作人员",width:"120"}),e(ne,{label:"操作类型",width:"120"},{default:l(({row:v})=>[e(ke,{type:H(v.action)},{default:l(()=>[a(g(ie(v.action)),1)]),_:2},1032,["type"])]),_:1}),e(ne,{prop:"target",label:"操作对象",width:"150"}),e(ne,{prop:"description",label:"操作描述"}),e(ne,{prop:"ipAddress",label:"IP地址",width:"130"}),e(ne,{label:"状态",width:"100"},{default:l(({row:v})=>[e(ke,{type:v.status==="success"?"success":"danger",size:"small"},{default:l(()=>[a(g(v.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[ll,x.value.audit]]),t("div",co,[e(Ve,{"current-page":Z.value.currentPage,"onUpdate:currentPage":n[8]||(n[8]=v=>Z.value.currentPage=v),"page-size":Z.value.pageSize,"onUpdate:pageSize":n[9]||(n[9]=v=>Z.value.pageSize=v),"page-sizes":[10,20,50,100],total:Z.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ll,onCurrentChange:Al},null,8,["current-page","page-size","total"])])])]),_:1}),e(Oe,{label:"系统配置",name:"system"},{default:l(()=>[t("div",vo,[e(sl,{gutter:20},{default:l(()=>[e(el,{span:12},{default:l(()=>[e(Xe,{title:"权限配置"},{header:l(()=>[...n[57]||(n[57]=[t("span",null,"权限配置",-1)])]),default:l(()=>[e(nl,{model:L.value,"label-width":"120px"},{default:l(()=>[e(Re,{label:"默认权限级别"},{default:l(()=>[e(Be,{modelValue:L.value.defaultPermissionLevel,"onUpdate:modelValue":n[10]||(n[10]=v=>L.value.defaultPermissionLevel=v)},{default:l(()=>[e(be,{label:"只读权限",value:"read_only"}),e(be,{label:"部分权限",value:"partial_access"}),e(be,{label:"完全权限",value:"full_access"})]),_:1},8,["modelValue"])]),_:1}),e(Re,{label:"密码策略"},{default:l(()=>[e(De,{modelValue:L.value.enforcePasswordPolicy,"onUpdate:modelValue":n[11]||(n[11]=v=>L.value.enforcePasswordPolicy=v)},null,8,["modelValue"])]),_:1}),e(Re,{label:"双因子认证"},{default:l(()=>[e(De,{modelValue:L.value.requireTwoFactor,"onUpdate:modelValue":n[12]||(n[12]=v=>L.value.requireTwoFactor=v)},null,8,["modelValue"])]),_:1}),e(Re,{label:"会话超时(分钟)"},{default:l(()=>[e(ol,{modelValue:L.value.sessionTimeout,"onUpdate:modelValue":n[13]||(n[13]=v=>L.value.sessionTimeout=v),min:5,max:480},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),e(el,{span:12},{default:l(()=>[e(Xe,{title:"审计配置"},{header:l(()=>[...n[58]||(n[58]=[t("span",null,"审计配置",-1)])]),default:l(()=>[e(nl,{model:L.value,"label-width":"120px"},{default:l(()=>[e(Re,{label:"启用审计日志"},{default:l(()=>[e(De,{modelValue:L.value.enableAuditLog,"onUpdate:modelValue":n[14]||(n[14]=v=>L.value.enableAuditLog=v)},null,8,["modelValue"])]),_:1}),e(Re,{label:"日志保留天数"},{default:l(()=>[e(ol,{modelValue:L.value.auditLogRetentionDays,"onUpdate:modelValue":n[15]||(n[15]=v=>L.value.auditLogRetentionDays=v),min:30,max:365},null,8,["modelValue"])]),_:1}),e(Re,{label:"敏感操作通知"},{default:l(()=>[e(De,{modelValue:L.value.notifySensitiveOperations,"onUpdate:modelValue":n[16]||(n[16]=v=>L.value.notifySensitiveOperations=v)},null,8,["modelValue"])]),_:1}),e(Re,{label:"自动备份配置"},{default:l(()=>[e(De,{modelValue:L.value.autoBackupConfig,"onUpdate:modelValue":n[17]||(n[17]=v=>L.value.autoBackupConfig=v)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),t("div",fo,[e(h,{onClick:zl,type:"primary"},{default:l(()=>[...n[59]||(n[59]=[a("保存配置",-1)])]),_:1}),e(h,{onClick:Il,type:"warning"},{default:l(()=>[...n[60]||(n[60]=[a("重置配置",-1)])]),_:1}),e(h,{onClick:Ml,type:"success"},{default:l(()=>[...n[61]||(n[61]=[a("导出配置",-1)])]),_:1})])])]),_:1})]),_:1},8,["modelValue"]),e(Fl,{title:"超级管理员权限面板说明",type:"info",closable:!1,"show-icon":"",style:{"margin-top":"20px"}},{default:l(()=>[...n[62]||(n[62]=[t("div",{class:"panel-description"},[t("p",null,[t("strong",null,"功能说明："),a("此面板专为超级管理员设计，提供高级权限管理功能")]),t("p",null,[t("strong",null,"与角色权限页面的区别：")]),t("ul",null,[t("li",null,[a("• "),t("strong",null,"角色权限页面"),a("：管理基础角色和权限分配，适用于日常权限管理")]),t("li",null,[a("• "),t("strong",null,"超级管理员面板"),a("：提供批量管理、模板配置、审计监控等高级功能")]),t("li",null,[a("• "),t("strong",null,"客服权限管理"),a("：专门针对客服业务场景的权限配置")])]),t("p",null,[t("strong",null,"使用场景："),a("系统初始化、批量用户导入、权限模板管理、安全审计等")])],-1)])]),_:1}),e(ta,{modelValue:k.value.userPermission,"onUpdate:modelValue":n[19]||(n[19]=v=>k.value.userPermission=v),user:U.value,onConfirm:Ee},null,8,["modelValue","user"]),e(da,{modelValue:k.value.roleTemplate,"onUpdate:modelValue":n[20]||(n[20]=v=>k.value.roleTemplate=v),template:M.value,onConfirm:fl},null,8,["modelValue","template"]),e(ra,{modelValue:k.value.department,"onUpdate:modelValue":n[21]||(n[21]=v=>k.value.department=v),department:O.value,onSaved:kl},null,8,["modelValue","department"]),e(fa,{modelValue:k.value.departmentMembers,"onUpdate:modelValue":n[22]||(n[22]=v=>k.value.departmentMembers=v),department:O.value,onUpdated:Cl},null,8,["modelValue","department"]),e(Ta,{modelValue:k.value.departmentPermissions,"onUpdate:modelValue":n[23]||(n[23]=v=>k.value.departmentPermissions=v),department:O.value,onUpdate:xl},null,8,["modelValue","department"]),e(Ha,{modelValue:k.value.batchAssignPermissions,"onUpdate:modelValue":n[24]||(n[24]=v=>k.value.batchAssignPermissions=v),onAssigned:$l},null,8,["modelValue"]),e(cs,{modelValue:k.value.userDetail,"onUpdate:modelValue":n[25]||(n[25]=v=>k.value.userDetail=v),user:U.value,onEdit:Ul},null,8,["modelValue","user"]),e(Ss,{modelValue:k.value.roleTemplateImport,"onUpdate:modelValue":n[26]||(n[26]=v=>k.value.roleTemplateImport=v),onImported:Pl},null,8,["modelValue"]),e(Ks,{modelValue:k.value.roleTemplatePreview,"onUpdate:modelValue":n[27]||(n[27]=v=>k.value.roleTemplatePreview=v),template:j.value,onApply:Tl,onExport:Sl},null,8,["modelValue","template"])])}}}),go=$e(_o,[["__scopeId","data-v-5cc62d57"]]),Co=Object.freeze(Object.defineProperty({__proto__:null,default:go},Symbol.toStringTag,{value:"Module"}));export{ko as P,Co as S};
