import{k as e,w as c}from"./utils-DfI7e5Rl.js";const t=(t,r="订单列表",o=!1)=>{if(!t||0===t.length)throw new Error("没有可导出的数据");const h=new Set,s={};t.forEach(e=>{e.customFields&&Object.keys(e.customFields).forEach(e=>{if(h.add(e),!s[e])try{const c=localStorage.getItem("crm_order_field_config");if(c){const t=JSON.parse(c),r=t.customFields?.find(c=>c.fieldKey===e);s[e]=r?r.fieldName:e}else s[e]=e}catch{s[e]=e}})});const a=Array.from(h).sort(),w=["订单号","客户姓名","客户电话","收货人","收货电话","收货地址","商品信息","总数量","订单金额","定金","COD金额","客户年龄","身高","体重","病史","服务微信","标记类型","负责销售","支付方式","订单来源",...a.map(e=>s[e]),"备注","下单时间","订单状态","发货状态"],n=["订单号","收货人","收货电话","收货地址","商品信息","总数量","订单金额","定金","COD金额","标记类型","负责销售","支付方式","订单来源",...a.map(e=>s[e]),"备注","下单时间","订单状态","发货状态"],m=o?w:n,i=t.map(e=>o?[e.orderNumber,e.customerName,e.customerPhone,e.receiverName,e.receiverPhone,e.receiverAddress,e.products,e.totalQuantity,e.totalAmount,e.depositAmount,e.codAmount,e.customerAge||"",e.customerHeight||"",e.customerWeight||"",e.medicalHistory||"",e.serviceWechat||"",e.markType||"",e.salesPersonName||"",e.paymentMethod||"",e.orderSource||"",...a.map(c=>e.customFields?.[c]||""),e.remark||"",e.createTime,e.status,e.shippingStatus||""]:[e.orderNumber,e.receiverName,e.receiverPhone,e.receiverAddress,e.products,e.totalQuantity,e.totalAmount,e.depositAmount,e.codAmount,e.markType||"",e.salesPersonName||"",e.paymentMethod||"",e.orderSource||"",...a.map(c=>e.customFields?.[c]||""),e.remark||"",e.createTime,e.status,e.shippingStatus||""]),l=e.book_new(),d=[m,...i],u=e.aoa_to_sheet(d),p=[{wch:15},{wch:12},{wch:15},{wch:12},{wch:15},{wch:30},{wch:25},{wch:8},{wch:12},{wch:10},{wch:10},{wch:8},{wch:8},{wch:8},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12},{wch:15},...a.map(()=>({wch:15})),{wch:20},{wch:18},{wch:10},{wch:10}],g=[{wch:15},{wch:12},{wch:15},{wch:30},{wch:25},{wch:8},{wch:12},{wch:10},{wch:10},{wch:12},{wch:12},{wch:12},{wch:15},...a.map(()=>({wch:15})),{wch:20},{wch:18},{wch:10},{wch:10}],b=o?p:g;u["!cols"]=b,e.book_append_sheet(l,u,"订单列表");const f=`${r}_${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;return c(l,f),setTimeout(()=>{document.querySelectorAll('a[href^="blob:"]').forEach(e=>{const c=e.getAttribute("href");c&&c.startsWith("blob:")&&(URL.revokeObjectURL(c),e.parentNode&&e.parentNode.removeChild(e))})},1e3),f},r=(e,c=!1)=>t([e],`订单_${e.orderNumber}`,c),o=(e,c=!1)=>t(e,`批量订单_${e.length}条`,c),h=(t,r=!1)=>((t,r="客户列表",o=!1)=>{if(!t||0===t.length)throw new Error("没有可导出的数据");const h=o?["客户编码","客户姓名","手机号码","年龄","地址","客户等级","客户状态","负责销售","订单数量","创建时间","创建人","微信号","邮箱","公司","职位","客户来源","标签","备注"]:["客户编码","客户姓名","手机号码(脱敏)","客户等级","客户状态","负责销售","订单数量","创建时间"],s=t.map(e=>{return o?[e.code,e.name,e.phone,e.age,e.address,e.level,e.status,e.salesPersonName||e.salesPersonId,e.orderCount,e.createTime,e.createdBy,e.wechatId||"",e.email||"",e.company||"",e.position||"",e.source||"",e.tags?e.tags.join(", "):"",e.remarks||""]:[e.code,e.name,(c=e.phone,!c||c.length<7?c:c.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")),e.level,e.status,e.salesPersonName||e.salesPersonId,e.orderCount,e.createTime];var c}),a=e.book_new(),w=[h,...s],n=e.aoa_to_sheet(w),m=o?[{wch:15},{wch:12},{wch:15},{wch:8},{wch:30},{wch:10},{wch:10},{wch:12},{wch:10},{wch:18},{wch:12},{wch:15},{wch:20},{wch:20},{wch:15},{wch:12},{wch:20},{wch:25}]:[{wch:15},{wch:12},{wch:18},{wch:10},{wch:10},{wch:12},{wch:10},{wch:18}];n["!cols"]=m,e.book_append_sheet(a,n,"客户列表");const i=`${r}_${(new Date).toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;return c(a,i),setTimeout(()=>{document.querySelectorAll('a[href^="blob:"]').forEach(e=>{const c=e.getAttribute("href");c&&c.startsWith("blob:")&&(URL.revokeObjectURL(c),e.parentNode&&e.parentNode.removeChild(e))})},1e3),i})(t,`批量客户_${t.length}条`,r);export{o as a,r as b,h as e};
