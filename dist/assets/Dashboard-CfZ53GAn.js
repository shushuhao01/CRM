import{l as e,af as a,s as t,A as s,_ as r,e as l,a as n,w as o,d as i,b as c,z as d,n as u,B as m,u as v,aA as g,r as p,Y as f,ag as h,aq as y,m as b,q as _,p as C,U as A,F as k,a9 as w,P as D,M as E,O,I as S,R as x,T,J as F,Q as z,S as I,a2 as M}from"./vendor-BtukhyiH.js";import{u as R,b as $,d as U,e as L,E as j,c as P,m as V,f as B,_ as H}from"./index-BGtT17ll.js";import{z as N,A as Y,E as q,b as W}from"./elementPlus-DxaqjplL.js";import{i as G,t as J,u as Q,b as Z,c as K,d as X,e as ee,f as ae,g as te,h as se,j as re}from"./utils-DfI7e5Rl.js";const le=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function ne(e){return function(){const a=Object.create(null);return le.forEach(t=>{a[t]=function(a){return(...t)=>{if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[a].apply(e.value,t)}}(t)}),a}()}const oe={autoresize:[Boolean,Object]},ie=/^on[^a-z]/,ce=e=>ie.test(e);function de(e,a){const t=m(e)?v(e):e;return t&&"object"==typeof t&&"value"in t?t.value||a:t||a}const ue={loading:Boolean,loadingOptions:Object};let me=null;const ve="x-vue-echarts";document.head.appendChild(document.createElement("style")).textContent="x-vue-echarts{display:block;width:100%;height:100%;min-width:0}\n";const ge=function(){if(null!=me)return me;if("undefined"==typeof HTMLElement||"undefined"==typeof customElements)return me=!1;try{new Function("tag","class EChartsElement extends HTMLElement{__dispose=null;disconnectedCallback(){this.__dispose&&(this.__dispose(),this.__dispose=null)}}customElements.get(tag)==null&&customElements.define(tag,EChartsElement);")(ve)}catch(e){return me=!1}return me=!0}(),pe=/(^&?~?!?)native:/;var fe=e({name:"echarts",props:{option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean,...oe,...ue},emits:{},inheritAttrs:!1,setup(e,{attrs:a}){const m=t(),v=t(),g=t(),p=s("ecTheme",null),f=s("ecInitOptions",null),h=s("ecUpdateOptions",null),{autoresize:y,manualUpdate:b,loading:_,loadingOptions:C}=r(e),A=l(()=>g.value||e.option||null),k=l(()=>e.theme||de(p,{})),w=l(()=>e.initOptions||de(f,{})),D=l(()=>e.updateOptions||de(h,{})),E=l(()=>function(e){const a={};for(const t in e)ce(t)||(a[t]=e[t]);return a}(a)),O={},S=n().proxy.$listeners,x={};function T(a){if(!m.value)return;const t=v.value=G(m.value,k.value,w.value);function s(){const e=a||A.value;e&&t.setOption(e,D.value)}e.group&&(t.group=e.group),Object.keys(x).forEach(e=>{let a=x[e];if(!a)return;let s=e.toLowerCase();"~"===s.charAt(0)&&(s=s.substring(1),a.__once__=!0);let r=t;if(0===s.indexOf("zr:")&&(r=t.getZr(),s=s.substring(3)),a.__once__){delete a.__once__;const e=a;a=(...t)=>{e(...t),r.off(s,a)}}r.on(s,a)}),y.value?u(()=>{t&&!t.isDisposed()&&t.resize(),s()}):s()}function F(){v.value&&(v.value.dispose(),v.value=void 0)}S?Object.keys(S).forEach(e=>{pe.test(e)?O[e.replace(pe,"$1")]=S[e]:x[e]=S[e]}):Object.keys(a).filter(e=>ce(e)).forEach(e=>{let t=e.charAt(2).toLowerCase()+e.slice(3);if(0===t.indexOf("native:")){const s=`on${t.charAt(7).toUpperCase()}${t.slice(8)}`;return void(O[s]=a[e])}"Once"===t.substring(t.length-4)&&(t=`~${t.substring(0,t.length-4)}`),x[t]=a[e]});let z=null;o(b,a=>{"function"==typeof z&&(z(),z=null),a||(z=o(()=>e.option,(e,a)=>{e&&(v.value?v.value.setOption(e,{notMerge:e!==a,...D.value}):T())},{deep:!0}))},{immediate:!0}),o([k,w],()=>{F(),T()},{deep:!0}),i(()=>{e.group&&v.value&&(v.value.group=e.group)});const I=ne(v);return function(e,a,t){const r=s("ecLoadingOptions",{}),n=l(()=>({...de(r,{}),...t?.value}));i(()=>{const t=e.value;t&&(a.value?t.showLoading(n.value):t.hideLoading())})}(v,_,C),function(e,a,t){o([t,e,a],([e,a,t],s,r)=>{let l=null;if(e&&a&&t){const{offsetWidth:s,offsetHeight:r}=e,n=!0===t?{}:t,{throttle:o=100,onResize:i}=n;let c=!1;const d=()=>{a.resize(),i?.()},u=o?J(d,o):d;l=new ResizeObserver(()=>{(c||(c=!0,e.offsetWidth!==s||e.offsetHeight!==r))&&u()}),l.observe(e)}r(()=>{l&&(l.disconnect(),l=null)})})}(v,y,m),c(()=>{T()}),d(()=>{ge&&m.value?m.value.__dispose=F:F()}),{chart:v,root:m,setOption:function(a,t){e.manualUpdate&&(g.value=a),v.value?v.value.setOption(a,t||{}):T(a)},nonEventAttrs:E,nativeListeners:O,...I}},render(){const e={...this.nonEventAttrs,...this.nativeListeners};return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",a(ve,e)}});const he={class:"dashboard"},ye={class:"metrics-grid"},be={class:"metric-content"},_e={class:"metric-info"},Ce={class:"metric-value"},Ae={class:"metric-label"},ke={class:"charts-grid"},we={class:"chart-header"},De={class:"chart-controls"},Ee={class:"chart-container"},Oe={key:1,class:"empty-chart"},Se={class:"chart-container"},xe={key:1,class:"empty-chart"},Te={class:"bottom-grid"},Fe={class:"chart-header"},ze={class:"chart-title"},Ie={class:"ranking-list"},Me={class:"ranking-position"},Re={class:"ranking-info"},$e={class:"ranking-name"},Ue={class:"ranking-department"},Le={class:"ranking-performance"},je={class:"performance-value"},Pe={class:"performance-orders"},Ve={class:"quick-actions"},Be=["onClick"],He={class:"action-label"},Ne={class:"chart-header"},Ye={class:"message-actions"},qe={class:"message-list"},We=["onClick"],Ge={class:"message-content"},Je={class:"message-title"},Qe={class:"message-time"},Ze={class:"message-dialog"},Ke={class:"message-dialog-header"},Xe={class:"message-dialog-list"},ea=["onClick"],aa={class:"message-dialog-content"},ta={class:"message-dialog-title"},sa={class:"message-dialog-desc"},ra={class:"message-dialog-time"},la={class:"message-dialog-actions"},na={key:0,class:"message-detail"},oa={class:"message-detail-content"},ia={class:"message-detail-info"},ca=H(e({name:"DashboardView",__name:"Dashboard",setup(e){Q([Z,K,X,ee,ae,te,se,re]);const a=g(),t=P(a),s=R(),r=$(),n=U(),i=p("day"),d=p(!1),u=p(!1),m=p(null),H=l(()=>r.messages||[]),G=l(()=>r.unreadCount),J=l(()=>[...r.messages||[]].sort((e,a)=>{const t=new Date(e.time).getTime();return new Date(a.time).getTime()-t}).slice(0,5)),le=()=>{const e=s.currentUser;if(!e)return"本月业绩排名";const a="super_admin"===e.role||"admin"===e.role,t="department_manager"===e.role||"manager"===e.role;return a?"本月业绩排名（全部）":t?"本月业绩排名（部门）":"本月业绩排名（个人）"},ne=p([{key:"orders",label:"今日订单",value:"0",change:"+0%",trend:"up",icon:"ShoppingCart",color:"#409EFF"},{key:"customers",label:"新增客户",value:"0",change:"+0%",trend:"up",icon:"User",color:"#67C23A"},{key:"revenue",label:"今日业绩",value:"¥0",change:"+0%",trend:"up",icon:"TrendCharts",color:"#E6A23C"},{key:"monthly-orders",label:"本月单数",value:"0",change:"+0%",trend:"up",icon:"DataBoard",color:"#722ED1"},{key:"monthly-revenue",label:"本月业绩",value:"¥0",change:"+0%",trend:"up",icon:"Coin",color:"#13C2C2"},{key:"service",label:"待处理售后",value:"0",change:"+0%",trend:"up",icon:"CustomerService",color:"#F56C6C",gradient:"linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)"},{key:"audit",label:"待审核订单",value:"0",change:"+0%",trend:"up",icon:"DocumentChecked",color:"#909399"},{key:"logistics",label:"待发货订单",value:"0",change:"+0%",trend:"up",icon:"Van",color:"#9C27B0"}]),oe=p(!1),ie=p({sales:[],products:[]});p([]);const ce=p([{key:"add-customer",label:"新增客户",icon:"UserFilled",route:"/customer/add",color:"#409EFF"},{key:"add-order",label:"新增订单",icon:"DocumentAdd",route:"/order/add",color:"#67C23A"},{key:"search-customer",label:"客户查询",icon:"Search",route:"/data/search",color:"#E6A23C"},{key:"search-logistics",label:"物流查询",icon:"Van",route:"/logistics/list",color:"#F56C6C"}]),de=p({xAxisData:[],orderData:[],signData:[],title:"业绩趋势"}),ue=l(()=>({tooltip:{trigger:"axis",axisPointer:{type:"cross"},formatter:function(e){let a=`${e[0].axisValue}<br/>`;return e.forEach(e=>{const t="day"===i.value?`${e.value}单`:`¥${e.value.toLocaleString()}`;a+=`${e.marker}${e.seriesName}: ${t}<br/>`}),a}},legend:{data:["下单业绩","签收业绩"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:de.value.xAxisData,axisLabel:{rotate:"day"===i.value?45:0}},yAxis:{type:"value",axisLabel:{formatter:"day"===i.value?"{value}单":"¥{value}"}},series:[{name:"下单业绩",type:"line",data:de.value.orderData,smooth:!0,itemStyle:{color:"#409EFF"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}]}}},{name:"签收业绩",type:"line",data:de.value.signData,smooth:!0,itemStyle:{color:"#67C23A"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(103, 194, 58, 0.3)"},{offset:1,color:"rgba(103, 194, 58, 0.1)"}]}}}]})),me=p([]),ve=l(()=>({tooltip:{trigger:"item",formatter:e=>{const a=e.data;return`${e.name}: ${a.value}<br/>金额: ¥${a.amount.toLocaleString()}`}},legend:{orient:"vertical",left:"left",formatter:e=>{const a=me.value.find(a=>a.name===e);return a?`${e}: ${a.value}`:e}},series:[{name:"订单状态",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"normal"}},labelLine:{show:!1},data:me.value}]})),ge=()=>{t.push("/performance/team")},pe=()=>{m.value&&r.markAsRead(m.value.id),u.value=!1},ca=async()=>{try{(await V.markAllMessagesAsRead()).success?(r.markAllAsRead(),q.success("所有消息已标记为已读")):q.error("标记消息失败")}catch(e){console.error("标记所有消息为已读失败:",e),q.error("标记消息失败，请稍后重试")}},da=async()=>{try{await W.confirm("确定要清空所有消息吗？此操作不可恢复。","清空消息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),r.clearAllMessages(),q.success("已清空所有消息"),d.value=!1}catch{}},ua=()=>{d.value=!1},ma=async()=>{try{oe.value=!0,va(),ga(),pa()}catch(e){console.error("加载仪表板数据失败:",e),q.error("加载数据失败，请稍后重试")}finally{oe.value=!1}},va=()=>{const e=s.currentUser?.id;let a=n.orders.filter(e=>"approved"===e.auditStatus);if(s.isAdmin||s.isManager){if(s.isManager&&!s.isAdmin){const e=s.users?.filter(e=>e.departmentId===s.currentUser?.departmentId).map(e=>e.id)||[];a=a.filter(a=>e.includes(a.salesPersonId))}}else a=a.filter(a=>a.salesPersonId===e);const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),l=r+864e5-1,o=new Date(t.getFullYear(),t.getMonth(),1).getTime(),i=a.filter(e=>{const a=new Date(e.createTime).getTime();return a>=r&&a<=l}),c=a.filter(e=>new Date(e.createTime).getTime()>=o),d=(()=>{const e=s.currentUser;if(!e)return{};const a="super_admin"===e.role||"admin"===e.role,t="department_manager"===e.role||"manager"===e.role;return a?{orders:"今日订单（全部）",customers:"新增客户（全部）",revenue:"今日业绩（全部）",monthlyOrders:"本月单数（全部）",monthlyRevenue:"本月业绩（全部）",service:"待处理售后（全部）"}:t?{orders:"今日订单（部门）",customers:"新增客户（部门）",revenue:"今日业绩（部门）",monthlyOrders:"本月单数（部门）",monthlyRevenue:"本月业绩（部门）",service:"待处理售后（部门）"}:{orders:"今日订单（个人）",customers:"新增客户（个人）",revenue:"今日业绩（个人）",monthlyOrders:"本月单数（个人）",monthlyRevenue:"本月业绩（个人）",service:"待处理售后（个人）"}})();if(ne.value[0].value=i.length.toString(),ne.value[0].label=d.orders||"今日订单",ne.value[1].value="0",ne.value[1].label=d.customers||"新增客户",ne.value[2].value=`¥${i.reduce((e,a)=>e+a.totalAmount,0).toLocaleString()}`,ne.value[2].label=d.revenue||"今日业绩",ne.value[3].value=c.length.toString(),ne.value[3].label=d.monthlyOrders||"本月单数",ne.value[4]&&(ne.value[4].value=`¥${c.reduce((e,a)=>e+a.totalAmount,0).toLocaleString()}`,ne.value[4].label=d.monthlyRevenue||"本月业绩"),ne.value[5]){const e=a.filter(e=>"after_sales_created"===e.status).length;ne.value[5].value=e.toString(),ne.value[5].label=d.service||"待处理售后"}},ga=()=>{let e=n.orders.filter(e=>"approved"===e.auditStatus);if(s.isManager&&!s.isAdmin){const a=s.users?.filter(e=>e.departmentId===s.currentUser?.departmentId).map(e=>e.id)||[];e=e.filter(e=>a.includes(e.salesPersonId))}const a=new Date,t=new Date(a.getFullYear(),a.getMonth(),1).getTime(),r=e.filter(e=>new Date(e.createTime).getTime()>=t),l=new Map;r.forEach(e=>{const a=e.salesPersonId;if(l.has(a)){const t=l.get(a);l.set(a,{...t,orders:t.orders+1,revenue:t.revenue+e.totalAmount,sharedAmount:t.sharedAmount||0,receivedAmount:t.receivedAmount||0})}else{let t="未知",r="",n="";const o=s.users.find(e=>String(e.id)===String(a)||e.username===a);o?(t=o.realName||o.name||o.username||"未知",r=o.avatar||"",n=o.departmentName||o.department||"",console.log(`[业绩排名] 找到用户: ${t}, 部门: ${n}`)):console.warn(`[业绩排名] 未找到用户: ${a}`),l.set(a,{id:a,name:t,avatar:r,department:n,orders:1,revenue:e.totalAmount,sharedAmount:0,receivedAmount:0})}});const o=B();o.performanceShares&&o.performanceShares.forEach(e=>{if("active"!==e.status)return;if(r.find(a=>a.orderNumber===e.orderNumber)){if(l.has(e.createdById)){const a=l.get(e.createdById);a.sharedAmount=(a.sharedAmount||0)+e.orderAmount,a.sharedOrderCount||(a.sharedOrderCount=0),a.sharedOrderCount+=1}e.shareMembers.forEach(a=>{if(!l.has(a.userId)){let e=a.userName||"未知",t="",r="";const n=s.users.find(e=>String(e.id)===String(a.userId));n&&(e=n.realName||n.name||n.username||e,t=n.avatar||"",r=n.departmentName||n.department||""),l.set(a.userId,{id:a.userId,name:e,avatar:t,department:r,orders:0,revenue:0,sharedAmount:0,receivedAmount:0,sharedOrderCount:0,receivedOrderCount:0})}const t=l.get(a.userId),r=a.percentage/100;t.receivedAmount=(t.receivedAmount||0)+e.orderAmount*r,t.receivedOrderCount||(t.receivedOrderCount=0),t.receivedOrderCount+=r})}});const i=Array.from(l.values()).map(e=>({...e,revenue:e.revenue-(e.sharedAmount||0)+(e.receivedAmount||0),orders:Math.max(0,e.orders-(e.sharedOrderCount||0)+(e.receivedOrderCount||0))})).sort((e,a)=>a.revenue-e.revenue).slice(0,10);ie.value={sales:i,products:[]}},pa=()=>{const e=s.currentUser?.id;let a=n.orders.filter(e=>"approved"===e.auditStatus);if(s.isAdmin||s.isManager){if(s.isManager&&!s.isAdmin){const e=s.users?.filter(e=>e.departmentId===s.currentUser?.departmentId).map(e=>e.id)||[];a=a.filter(a=>e.includes(a.salesPersonId))}}else a=a.filter(a=>a.salesPersonId===e);const t=new Date,r=new Map;if("day"===i.value){for(let a=0;a<24;a++)r.set(a,{label:`${a}:00`,amount:0,orders:0});const e=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();a.filter(a=>new Date(a.createTime).getTime()>=e).forEach(e=>{const a=new Date(e.createTime).getHours(),t=r.get(a);t&&(t.amount+=e.totalAmount,t.orders+=1)})}else if("week"===i.value){for(let e=6;e>=0;e--){const a=new Date(t.getTime()-24*e*60*60*1e3),s=a.toISOString().split("T")[0],l=`${a.getMonth()+1}/${a.getDate()}`;r.set(s,{label:l,amount:0,orders:0})}a.forEach(e=>{const a=new Date(e.createTime).toISOString().split("T")[0];if(r.has(a)){const t=r.get(a);t.amount+=e.totalAmount,t.orders+=1}})}else{const e=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();for(let a=1;a<=e;a++){const e=new Date(t.getFullYear(),t.getMonth(),a).toISOString().split("T")[0];r.set(e,{label:`${a}日`,amount:0,orders:0})}const s=new Date(t.getFullYear(),t.getMonth(),1).getTime();a.filter(e=>new Date(e.createTime).getTime()>=s).forEach(e=>{const a=new Date(e.createTime).toISOString().split("T")[0];if(r.has(a)){const t=r.get(a);t.amount+=e.totalAmount,t.orders+=1}})}const l=[],o=[],c=[];r.forEach(e=>{l.push(e.label),o.push(e.amount),c.push(e.orders)}),de.value={xAxisData:l,orderData:o,signData:c,title:fa()};const d=new Map,u={pending_transfer:"待流转",pending_audit:"待审核",audit_rejected:"审核拒绝",pending_shipment:"待发货",shipped:"已发货",delivered:"已签收",logistics_returned:"物流部退回",logistics_cancelled:"物流部取消",package_exception:"包裹异常",rejected:"拒收",rejected_returned:"拒收已退回",after_sales_created:"已建售后",pending_cancel:"待取消",cancel_failed:"取消失败",cancelled:"已取消",draft:"草稿",refunded:"已退款",pending:"待审核",paid:"已付款",completed:"已完成",signed:"已签收"};a.forEach(e=>{const a=u[e.status]||e.status;if(d.has(a)){const t=d.get(a);d.set(a,{count:t.count+1,amount:t.amount+e.totalAmount})}else d.set(a,{count:1,amount:e.totalAmount})});const m=[];d.forEach((e,a)=>{var t;m.push({value:e.count,name:a,amount:e.amount,itemStyle:{color:(t=a,{"已签收":"#67C23A","待发货":"#409EFF","已发货":"#E6A23C","运输中":"#E6A23C","待审核":"#909399","待流转":"#C0C4CC","审核拒绝":"#F56C6C","已取消":"#F56C6C","物流部退回":"#F78989","物流部取消":"#F56C6C","包裹异常":"#E6A23C","拒收":"#F56C6C","拒收已退回":"#F78989","已建售后":"#E6A23C","待取消":"#909399","取消失败":"#F56C6C","草稿":"#C0C4CC","已退款":"#909399","已付款":"#67C23A","已完成":"#67C23A",delivered:"#67C23A",pending_shipment:"#409EFF",shipped:"#E6A23C",in_transit:"#E6A23C",pending_audit:"#909399",cancelled:"#F56C6C"}[t]||"#909399")}})}),me.value=m},fa=()=>{switch(i.value){case"day":return"今日不同时段成交趋势";case"week":return"最近7天成交趋势";case"month":return"本月成交趋势";default:return"业绩趋势"}};o(i,()=>{try{oe.value=!0,pa()}catch(e){console.error("重新加载图表数据失败:",e),q.error("加载图表数据失败")}finally{oe.value=!1}});const ha=()=>{console.log("[数据看板] 收到订单状态变化事件，刷新数据"),ma()};return c(async()=>{await s.loadUsers();try{await Promise.all([n.loadOrdersFromAPI?.()||Promise.resolve()]),console.log("[Dashboard] 数据刷新完成")}catch(e){console.warn("[Dashboard] 数据刷新失败:",e)}ma(),L.on(j.ORDER_STATUS_CHANGED,ha),L.on(j.REFRESH_ORDER_LIST,ha)}),f(()=>{L.off(j.ORDER_STATUS_CHANGED,ha),L.off(j.REFRESH_ORDER_LIST,ha)}),(e,a)=>{const s=h("el-icon"),l=h("ArrowUp"),n=h("ArrowDown"),o=h("Minus"),c=h("el-card"),g=h("el-radio-button"),p=h("el-radio-group"),f=h("el-empty"),R=h("el-button"),$=h("el-tag"),U=h("el-avatar"),L=h("el-tooltip"),j=h("el-badge"),P=h("el-dialog"),B=y("loading");return _(),b("div",he,[C("div",ye,[(_(!0),b(k,null,w(ne.value,e=>D((_(),E(c,{class:"metric-card",key:e.key},{default:O(()=>[C("div",be,[C("div",{class:"metric-icon",style:S({background:e.gradient||e.color})},[A(s,{size:24},{default:O(()=>[(_(),E(x(e.icon)))]),_:2},1024)],4),C("div",_e,[C("div",Ce,T(e.value),1),C("div",Ae,T(e.label),1),C("div",{class:F(["metric-change",e.trend])},[A(s,{size:12},{default:O(()=>["up"===e.trend?(_(),E(l,{key:0})):z("",!0),"down"===e.trend?(_(),E(n,{key:1})):z("",!0),"stable"===e.trend?(_(),E(o,{key:2})):z("",!0)]),_:2},1024),C("span",null,T(e.change),1)],2)])])]),_:2},1024)),[[B,oe.value]])),128))]),C("div",ke,[A(c,{class:"chart-card"},{header:O(()=>[C("div",we,[a[8]||(a[8]=C("span",{class:"chart-title"},"业绩趋势",-1)),C("div",De,[A(p,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),size:"small"},{default:O(()=>[A(g,{label:"day"},{default:O(()=>[...a[5]||(a[5]=[I("日",-1)])]),_:1}),A(g,{label:"week"},{default:O(()=>[...a[6]||(a[6]=[I("周",-1)])]),_:1}),A(g,{label:"month"},{default:O(()=>[...a[7]||(a[7]=[I("月",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),default:O(()=>[C("div",Ee,[de.value.xAxisData&&de.value.xAxisData.length>0?(_(),E(v(fe),{key:0,option:ue.value,autoresize:""},null,8,["option"])):(_(),b("div",Oe,[A(f,{description:"暂无业绩数据"})]))])]),_:1}),A(c,{class:"chart-card"},{header:O(()=>[...a[9]||(a[9]=[C("span",{class:"chart-title"},"订单状态分布",-1)])]),default:O(()=>[C("div",Se,[me.value&&me.value.length>0?(_(),E(v(fe),{key:0,option:ve.value,autoresize:""},null,8,["option"])):(_(),b("div",xe,[A(f,{description:"暂无订单数据"})]))])]),_:1})]),C("div",Te,[D((_(),E(c,{class:"ranking-card"},{header:O(()=>[C("div",Fe,[C("span",ze,T(le()),1),A(R,{type:"text",size:"small",onClick:ge},{default:O(()=>[...a[10]||(a[10]=[I("查看更多",-1)])]),_:1})])]),default:O(()=>[C("div",Ie,[(_(!0),b(k,null,w(ie.value.sales||[],(e,a)=>(_(),b("div",{class:"ranking-item",key:e.id},[C("div",Me,[A($,{type:a<3?"warning":"info",size:"small",effect:"plain"},{default:O(()=>[I(T(a+1),1)]),_:2},1032,["type"])]),A(U,{size:32,src:e.avatar||void 0},{default:O(()=>[I(T(e.name?e.name.charAt(0):"?"),1)]),_:2},1032,["src"]),C("div",Re,[C("div",$e,T(e.name),1),C("div",Ue,T(e.department||"未分配部门"),1)]),C("div",Le,[C("div",je,"¥"+T(e.revenue.toLocaleString()),1),C("div",Pe,T("number"==typeof e.orders?e.orders%1==0?e.orders:e.orders.toFixed(1):e.orders)+"单",1)])]))),128))])]),_:1})),[[B,oe.value]]),A(c,{class:"quick-actions-card"},{header:O(()=>[...a[11]||(a[11]=[C("span",{class:"chart-title"},"快捷操作",-1)])]),default:O(()=>[C("div",Ve,[(_(!0),b(k,null,w(ce.value||[],e=>(_(),b("div",{class:"action-item",key:e.key,onClick:a=>(e=>{t.push(e.route)})(e)},[C("div",{class:"action-icon",style:S({background:e.gradient||e.color})},[A(s,{size:20},{default:O(()=>[(_(),E(x(e.icon)))]),_:2},1024)],4),C("div",He,T(e.label),1)],8,Be))),128))])]),_:1}),A(c,{class:"message-card"},{header:O(()=>[C("div",Ne,[a[13]||(a[13]=C("span",{class:"chart-title"},"消息提醒",-1)),C("div",Ye,[A(L,{content:"全部已读",placement:"top"},{default:O(()=>[A(R,{type:"text",size:"small",onClick:ca,disabled:0===G.value,class:"action-icon-btn"},{default:O(()=>[A(s,{size:18},{default:O(()=>[A(v(N))]),_:1})]),_:1},8,["disabled"])]),_:1}),A(L,{content:"清空消息",placement:"top"},{default:O(()=>[A(R,{type:"text",size:"small",onClick:da,class:"action-icon-btn"},{default:O(()=>[A(s,{size:18},{default:O(()=>[A(v(Y))]),_:1})]),_:1})]),_:1}),A(j,{value:G.value>99?"99+":G.value,hidden:0===G.value},{default:O(()=>[A(R,{type:"text",size:"small",onClick:a[1]||(a[1]=e=>d.value=!0)},{default:O(()=>[...a[12]||(a[12]=[I(" 查看全部 ",-1)])]),_:1})]),_:1},8,["value","hidden"])])])]),default:O(()=>[C("div",qe,[(_(!0),b(k,null,w(J.value,e=>(_(),b("div",{class:"message-item",key:e.id,onClick:a=>(e=>{m.value=e,u.value=!0})(e)},[C("div",{class:"message-icon",style:S({backgroundColor:e.color})},[A(s,{size:16},{default:O(()=>[(_(),E(x(e.icon)))]),_:2},1024)],4),C("div",Ge,[C("div",Je,T(e.title),1),C("div",Qe,T(e.time),1)]),A(j,{"is-dot":!e.read,class:"message-badge"},null,8,["is-dot"])],8,We))),128))])]),_:1})]),A(P,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=e=>d.value=e),title:"系统消息",width:"600px","before-close":ua},{default:O(()=>[C("div",Ze,[C("div",Ke,[A(R,{type:"primary",size:"small",onClick:ca,disabled:0===G.value},{default:O(()=>[...a[14]||(a[14]=[I(" 全部已读 ",-1)])]),_:1},8,["disabled"]),A(R,{type:"danger",size:"small",onClick:da},{default:O(()=>[...a[15]||(a[15]=[I(" 清空消息 ",-1)])]),_:1})]),C("div",Xe,[(_(!0),b(k,null,w(H.value,e=>(_(),b("div",{class:F(["message-dialog-item",{unread:!e.read}]),key:e.id,onClick:a=>(e=>{m.value=e,u.value=!0})(e)},[C("div",{class:"message-dialog-icon",style:S({backgroundColor:e.color})},[A(s,{size:18},{default:O(()=>[(_(),E(x(e.icon)))]),_:2},1024)],4),C("div",aa,[C("div",ta,T(e.title),1),C("div",sa,T(e.content),1),C("div",ra,T(e.time),1)]),C("div",la,[A(j,{"is-dot":!e.read},null,8,["is-dot"]),e.read?z("",!0):(_(),E(R,{key:0,type:"text",size:"small",onClick:M(a=>(async e=>{try{(await V.markMessageAsRead(e.id)).success?r.markAsRead(e.id):q.error("标记消息失败")}catch(a){console.error("标记消息为已读失败:",a),q.error("标记消息失败，请稍后重试")}})(e),["stop"])},{default:O(()=>[...a[16]||(a[16]=[I(" 标记已读 ",-1)])]),_:1},8,["onClick"]))])],10,ea))),128))])])]),_:1},8,["modelValue"]),A(P,{modelValue:u.value,"onUpdate:modelValue":a[4]||(a[4]=e=>u.value=e),title:m.value?.title,width:"500px"},{footer:O(()=>[A(R,{onClick:a[3]||(a[3]=e=>u.value=!1)},{default:O(()=>[...a[17]||(a[17]=[I("关闭",-1)])]),_:1}),m.value&&!m.value.read?(_(),E(R,{key:0,type:"primary",onClick:pe},{default:O(()=>[...a[18]||(a[18]=[I(" 标记已读 ",-1)])]),_:1})):z("",!0)]),default:O(()=>[m.value?(_(),b("div",na,[C("div",oa,[C("p",null,T(m.value.content),1),C("div",ia,[C("span",null,"时间："+T(m.value.time),1),C("span",null,"类型："+T(m.value.type),1)])])])):z("",!0)]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-8fcf2a95"]]);export{ca as default};
