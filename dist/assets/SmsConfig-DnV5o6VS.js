import{G as e,e as l,r as a,E as t,b as o}from"./elementPlus-DxaqjplL.js";import{l as s,r as i,Z as r,b as d,ag as n,m as u,q as p,p as m,U as c,O as f,S as y,M as g,Q as v,u as b}from"./vendor-BtukhyiH.js";import{_ as h}from"./index-DkAJPKqn.js";import"./utils-DfI7e5Rl.js";const V={class:"sms-config"},_={class:"form-actions"},x={class:"form-actions"},w={class:"form-actions"},L={class:"form-actions"},k={class:"import-export-section"},U={class:"import-export-actions"},A=h(s({__name:"SmsConfig",setup(s){const h=i("basic"),A=i(!1),R=i(!1),K=i(),F=i(),I=i(),C=i(),O=r({provider:"aliyun",accessKeyId:"",accessKeySecret:"",signName:"",region:"cn-hangzhou",batchLimit:100,rateLimit:10,retryCount:3,timeout:30}),T={provider:[{required:!0,message:"请选择服务商",trigger:"change"}],accessKeyId:[{required:!0,message:"请输入AccessKey ID",trigger:"blur"}],accessKeySecret:[{required:!0,message:"请输入AccessKey Secret",trigger:"blur"}],signName:[{required:!0,message:"请输入签名名称",trigger:"blur"}]},j=r({enabled:!0,autoApprovalLimit:10,approvalTimeout:24,approvers:["admin"],notifyOnApproval:!0,notifyMethods:["email","system"]}),S={autoApprovalLimit:[{required:!0,message:"请设置自动审核阈值",trigger:"blur"}],approvalTimeout:[{required:!0,message:"请设置审核超时时间",trigger:"blur"}]},W=r({ipWhitelist:"127.0.0.1\n192.168.1.0/24",apiKey:"sk-1234567890abcdef",keyExpiration:90,sensitiveWordFilter:!0,sensitiveWords:"赌博\n色情\n暴力\n政治",contentLengthLimit:200}),P={apiKey:[{required:!0,message:"请生成API密钥",trigger:"blur"}],contentLengthLimit:[{required:!0,message:"请设置内容长度限制",trigger:"blur"}]},q=r({enableLogging:!0,logLevel:"info",logRetentionDays:30,enableAlerts:!0,failureRateThreshold:10,alertReceivers:"admin@example.com"}),D={logRetentionDays:[{required:!0,message:"请设置日志保留时间",trigger:"blur"}],failureRateThreshold:[{required:!0,message:"请设置失败率阈值",trigger:"blur"}]},N=async()=>{if(K.value)try{await K.value.validate(),A.value=!0,await new Promise(e=>setTimeout(e,1e3)),t.success("基础配置保存成功")}catch(e){t.error("保存失败，请检查配置项")}finally{A.value=!1}},E=async()=>{R.value=!0;try{await new Promise(e=>setTimeout(e,2e3)),Math.random()>.3?t.success("连接测试成功"):t.error("连接测试失败，请检查配置")}finally{R.value=!1}},M=()=>{K.value?.resetFields()},z=async()=>{if(F.value)try{await F.value.validate(),A.value=!0,await new Promise(e=>setTimeout(e,1e3)),t.success("审核配置保存成功")}catch(e){t.error("保存失败，请检查配置项")}finally{A.value=!1}},B=()=>{F.value?.resetFields()},G=async()=>{if(I.value)try{await I.value.validate(),A.value=!0,await new Promise(e=>setTimeout(e,1e3)),t.success("安全配置保存成功")}catch(e){t.error("保存失败，请检查配置项")}finally{A.value=!1}},J=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let l="sk-";for(let a=0;a<32;a++)l+=e.charAt(Math.floor(62*Math.random()));W.apiKey=l,t.success("API密钥已重新生成")},Q=()=>{I.value?.resetFields()},Z=async()=>{if(C.value)try{await C.value.validate(),A.value=!0,await new Promise(e=>setTimeout(e,1e3)),t.success("监控配置保存成功")}catch(e){t.error("保存失败，请检查配置项")}finally{A.value=!1}},H=()=>{C.value?.resetFields()},X=()=>{const e={basic:O,approval:j,security:{...W,apiKey:"***"},monitoring:q},l=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(l),o=document.createElement("a");o.href=a,o.download=`sms-config-${(new Date).toISOString().split("T")[0]}.json`,o.click(),URL.revokeObjectURL(a),t.success("配置导出成功")},Y=e=>{const l=new FileReader;return l.onload=e=>{try{const l=JSON.parse(e.target?.result);l.basic&&Object.assign(O,l.basic),l.approval&&Object.assign(j,l.approval),l.security&&Object.assign(W,l.security),l.monitoring&&Object.assign(q,l.monitoring),t.success("配置导入成功")}catch(l){t.error("配置文件格式错误")}},l.readAsText(e),!1},$=async()=>{try{await o.confirm("确定要恢复所有配置到默认值吗？","确认重置",{type:"warning"}),K.value?.resetFields(),F.value?.resetFields(),I.value?.resetFields(),C.value?.resetFields(),t.success("所有配置已恢复默认值")}catch(e){}};return d(()=>{}),(t,o)=>{const s=n("el-option"),i=n("el-select"),r=n("el-form-item"),d=n("el-input"),ee=n("el-card"),le=n("el-input-number"),ae=n("el-button"),te=n("el-form"),oe=n("el-tab-pane"),se=n("el-switch"),ie=n("el-checkbox"),re=n("el-checkbox-group"),de=n("el-tabs"),ne=n("el-icon"),ue=n("el-upload");return p(),u("div",V,[o[68]||(o[68]=m("div",{class:"page-header"},[m("h2",null,"短信配置管理"),m("p",null,"管理短信服务的各项配置参数")],-1)),c(de,{modelValue:h.value,"onUpdate:modelValue":o[27]||(o[27]=e=>h.value=e),type:"border-card"},{default:f(()=>[c(oe,{label:"基础配置",name:"basic"},{default:f(()=>[c(te,{model:O,rules:T,ref_key:"basicFormRef",ref:K,"label-width":"120px",class:"config-form"},{default:f(()=>[c(ee,{class:"config-card"},{header:f(()=>[...o[28]||(o[28]=[m("span",null,"服务商配置",-1)])]),default:f(()=>[c(r,{label:"服务商",prop:"provider"},{default:f(()=>[c(i,{modelValue:O.provider,"onUpdate:modelValue":o[0]||(o[0]=e=>O.provider=e),style:{width:"300px"}},{default:f(()=>[c(s,{label:"阿里云短信",value:"aliyun"}),c(s,{label:"腾讯云短信",value:"tencent"}),c(s,{label:"华为云短信",value:"huawei"}),c(s,{label:"网易云信",value:"netease"})]),_:1},8,["modelValue"])]),_:1}),c(r,{label:"AccessKey ID",prop:"accessKeyId"},{default:f(()=>[c(d,{modelValue:O.accessKeyId,"onUpdate:modelValue":o[1]||(o[1]=e=>O.accessKeyId=e),placeholder:"请输入AccessKey ID",style:{width:"400px"},"show-password":""},null,8,["modelValue"])]),_:1}),c(r,{label:"AccessKey Secret",prop:"accessKeySecret"},{default:f(()=>[c(d,{modelValue:O.accessKeySecret,"onUpdate:modelValue":o[2]||(o[2]=e=>O.accessKeySecret=e),placeholder:"请输入AccessKey Secret",style:{width:"400px"},"show-password":""},null,8,["modelValue"])]),_:1}),c(r,{label:"签名名称",prop:"signName"},{default:f(()=>[c(d,{modelValue:O.signName,"onUpdate:modelValue":o[3]||(o[3]=e=>O.signName=e),placeholder:"请输入短信签名",style:{width:"300px"}},null,8,["modelValue"]),o[29]||(o[29]=m("div",{class:"form-tip"},"短信签名需要在服务商平台申请并审核通过",-1))]),_:1}),c(r,{label:"服务地域",prop:"region"},{default:f(()=>[c(i,{modelValue:O.region,"onUpdate:modelValue":o[4]||(o[4]=e=>O.region=e),style:{width:"200px"}},{default:f(()=>[c(s,{label:"华东1（杭州）",value:"cn-hangzhou"}),c(s,{label:"华北2（北京）",value:"cn-beijing"}),c(s,{label:"华南1（深圳）",value:"cn-shenzhen"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),c(ee,{class:"config-card"},{header:f(()=>[...o[30]||(o[30]=[m("span",null,"发送配置",-1)])]),default:f(()=>[c(r,{label:"单次发送上限",prop:"batchLimit"},{default:f(()=>[c(le,{modelValue:O.batchLimit,"onUpdate:modelValue":o[5]||(o[5]=e=>O.batchLimit=e),min:1,max:1e3,style:{width:"200px"}},null,8,["modelValue"]),o[31]||(o[31]=m("span",{class:"unit-text"},"条",-1))]),_:1}),c(r,{label:"发送频率限制",prop:"rateLimit"},{default:f(()=>[c(le,{modelValue:O.rateLimit,"onUpdate:modelValue":o[6]||(o[6]=e=>O.rateLimit=e),min:1,max:100,style:{width:"200px"}},null,8,["modelValue"]),o[32]||(o[32]=m("span",{class:"unit-text"},"条/分钟",-1))]),_:1}),c(r,{label:"重试次数",prop:"retryCount"},{default:f(()=>[c(le,{modelValue:O.retryCount,"onUpdate:modelValue":o[7]||(o[7]=e=>O.retryCount=e),min:0,max:5,style:{width:"200px"}},null,8,["modelValue"]),o[33]||(o[33]=m("span",{class:"unit-text"},"次",-1))]),_:1}),c(r,{label:"超时时间",prop:"timeout"},{default:f(()=>[c(le,{modelValue:O.timeout,"onUpdate:modelValue":o[8]||(o[8]=e=>O.timeout=e),min:5,max:60,style:{width:"200px"}},null,8,["modelValue"]),o[34]||(o[34]=m("span",{class:"unit-text"},"秒",-1))]),_:1})]),_:1}),m("div",_,[c(ae,{type:"primary",onClick:N,loading:A.value},{default:f(()=>[...o[35]||(o[35]=[y(" 保存配置 ",-1)])]),_:1},8,["loading"]),c(ae,{onClick:E,loading:R.value},{default:f(()=>[...o[36]||(o[36]=[y(" 测试连接 ",-1)])]),_:1},8,["loading"]),c(ae,{onClick:M},{default:f(()=>[...o[37]||(o[37]=[y(" 重置 ",-1)])]),_:1})])]),_:1},8,["model"])]),_:1}),c(oe,{label:"审核配置",name:"approval"},{default:f(()=>[c(te,{model:j,rules:S,ref_key:"approvalFormRef",ref:F,"label-width":"120px",class:"config-form"},{default:f(()=>[c(ee,{class:"config-card"},{header:f(()=>[...o[38]||(o[38]=[m("span",null,"审核流程",-1)])]),default:f(()=>[c(r,{label:"启用审核",prop:"enabled"},{default:f(()=>[c(se,{modelValue:j.enabled,"onUpdate:modelValue":o[9]||(o[9]=e=>j.enabled=e)},null,8,["modelValue"]),o[39]||(o[39]=m("div",{class:"form-tip"},"开启后，所有短信发送都需要审核",-1))]),_:1}),j.enabled?(p(),g(r,{key:0,label:"自动审核阈值",prop:"autoApprovalLimit"},{default:f(()=>[c(le,{modelValue:j.autoApprovalLimit,"onUpdate:modelValue":o[10]||(o[10]=e=>j.autoApprovalLimit=e),min:0,max:100,style:{width:"200px"}},null,8,["modelValue"]),o[40]||(o[40]=m("span",{class:"unit-text"},"条",-1)),o[41]||(o[41]=m("div",{class:"form-tip"},"低于此数量的发送申请将自动审核通过",-1))]),_:1})):v("",!0),j.enabled?(p(),g(r,{key:1,label:"审核超时时间",prop:"approvalTimeout"},{default:f(()=>[c(le,{modelValue:j.approvalTimeout,"onUpdate:modelValue":o[11]||(o[11]=e=>j.approvalTimeout=e),min:1,max:72,style:{width:"200px"}},null,8,["modelValue"]),o[42]||(o[42]=m("span",{class:"unit-text"},"小时",-1))]),_:1})):v("",!0),j.enabled?(p(),g(r,{key:2,label:"审核人员",prop:"approvers"},{default:f(()=>[c(i,{modelValue:j.approvers,"onUpdate:modelValue":o[12]||(o[12]=e=>j.approvers=e),multiple:"",placeholder:"请选择审核人员",style:{width:"400px"}},{default:f(()=>[c(s,{label:"管理员",value:"admin"}),c(s,{label:"部门主管",value:"manager"}),c(s,{label:"运营人员",value:"operator"})]),_:1},8,["modelValue"])]),_:1})):v("",!0)]),_:1}),c(ee,{class:"config-card"},{header:f(()=>[...o[43]||(o[43]=[m("span",null,"通知设置",-1)])]),default:f(()=>[c(r,{label:"审核通知",prop:"notifyOnApproval"},{default:f(()=>[c(se,{modelValue:j.notifyOnApproval,"onUpdate:modelValue":o[13]||(o[13]=e=>j.notifyOnApproval=e)},null,8,["modelValue"]),o[44]||(o[44]=m("div",{class:"form-tip"},"审核结果将通知申请人",-1))]),_:1}),j.notifyOnApproval?(p(),g(r,{key:0,label:"通知方式",prop:"notifyMethods"},{default:f(()=>[c(re,{modelValue:j.notifyMethods,"onUpdate:modelValue":o[14]||(o[14]=e=>j.notifyMethods=e)},{default:f(()=>[c(ie,{label:"email"},{default:f(()=>[...o[45]||(o[45]=[y("邮件",-1)])]),_:1}),c(ie,{label:"sms"},{default:f(()=>[...o[46]||(o[46]=[y("短信",-1)])]),_:1}),c(ie,{label:"system"},{default:f(()=>[...o[47]||(o[47]=[y("系统通知",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):v("",!0)]),_:1}),m("div",x,[c(ae,{type:"primary",onClick:z,loading:A.value},{default:f(()=>[...o[48]||(o[48]=[y(" 保存配置 ",-1)])]),_:1},8,["loading"]),c(ae,{onClick:B},{default:f(()=>[...o[49]||(o[49]=[y(" 重置 ",-1)])]),_:1})])]),_:1},8,["model"])]),_:1}),c(oe,{label:"安全配置",name:"security"},{default:f(()=>[c(te,{model:W,rules:P,ref_key:"securityFormRef",ref:I,"label-width":"120px",class:"config-form"},{default:f(()=>[c(ee,{class:"config-card"},{header:f(()=>[...o[50]||(o[50]=[m("span",null,"访问控制",-1)])]),default:f(()=>[c(r,{label:"IP白名单",prop:"ipWhitelist"},{default:f(()=>[c(d,{modelValue:W.ipWhitelist,"onUpdate:modelValue":o[15]||(o[15]=e=>W.ipWhitelist=e),type:"textarea",rows:4,placeholder:"请输入IP地址，每行一个，支持CIDR格式",style:{width:"500px"}},null,8,["modelValue"]),o[51]||(o[51]=m("div",{class:"form-tip"},"只有白名单内的IP才能调用短信接口",-1))]),_:1}),c(r,{label:"API密钥",prop:"apiKey"},{default:f(()=>[c(d,{modelValue:W.apiKey,"onUpdate:modelValue":o[16]||(o[16]=e=>W.apiKey=e),placeholder:"API密钥",style:{width:"400px"},readonly:""},{append:f(()=>[c(ae,{onClick:J},{default:f(()=>[...o[52]||(o[52]=[y("重新生成",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),c(r,{label:"密钥过期时间",prop:"keyExpiration"},{default:f(()=>[c(le,{modelValue:W.keyExpiration,"onUpdate:modelValue":o[17]||(o[17]=e=>W.keyExpiration=e),min:1,max:365,style:{width:"200px"}},null,8,["modelValue"]),o[53]||(o[53]=m("span",{class:"unit-text"},"天",-1))]),_:1})]),_:1}),c(ee,{class:"config-card"},{header:f(()=>[...o[54]||(o[54]=[m("span",null,"内容安全",-1)])]),default:f(()=>[c(r,{label:"敏感词过滤",prop:"sensitiveWordFilter"},{default:f(()=>[c(se,{modelValue:W.sensitiveWordFilter,"onUpdate:modelValue":o[18]||(o[18]=e=>W.sensitiveWordFilter=e)},null,8,["modelValue"])]),_:1}),W.sensitiveWordFilter?(p(),g(r,{key:0,label:"敏感词库",prop:"sensitiveWords"},{default:f(()=>[c(d,{modelValue:W.sensitiveWords,"onUpdate:modelValue":o[19]||(o[19]=e=>W.sensitiveWords=e),type:"textarea",rows:6,placeholder:"请输入敏感词，每行一个",style:{width:"500px"}},null,8,["modelValue"])]),_:1})):v("",!0),c(r,{label:"内容长度限制",prop:"contentLengthLimit"},{default:f(()=>[c(le,{modelValue:W.contentLengthLimit,"onUpdate:modelValue":o[20]||(o[20]=e=>W.contentLengthLimit=e),min:10,max:500,style:{width:"200px"}},null,8,["modelValue"]),o[55]||(o[55]=m("span",{class:"unit-text"},"字符",-1))]),_:1})]),_:1}),m("div",w,[c(ae,{type:"primary",onClick:G,loading:A.value},{default:f(()=>[...o[56]||(o[56]=[y(" 保存配置 ",-1)])]),_:1},8,["loading"]),c(ae,{onClick:Q},{default:f(()=>[...o[57]||(o[57]=[y(" 重置 ",-1)])]),_:1})])]),_:1},8,["model"])]),_:1}),c(oe,{label:"监控配置",name:"monitoring"},{default:f(()=>[c(te,{model:q,rules:D,ref_key:"monitoringFormRef",ref:C,"label-width":"120px",class:"config-form"},{default:f(()=>[c(ee,{class:"config-card"},{header:f(()=>[...o[58]||(o[58]=[m("span",null,"日志配置",-1)])]),default:f(()=>[c(r,{label:"启用日志",prop:"enableLogging"},{default:f(()=>[c(se,{modelValue:q.enableLogging,"onUpdate:modelValue":o[21]||(o[21]=e=>q.enableLogging=e)},null,8,["modelValue"])]),_:1}),q.enableLogging?(p(),g(r,{key:0,label:"日志级别",prop:"logLevel"},{default:f(()=>[c(i,{modelValue:q.logLevel,"onUpdate:modelValue":o[22]||(o[22]=e=>q.logLevel=e),style:{width:"200px"}},{default:f(()=>[c(s,{label:"DEBUG",value:"debug"}),c(s,{label:"INFO",value:"info"}),c(s,{label:"WARN",value:"warn"}),c(s,{label:"ERROR",value:"error"})]),_:1},8,["modelValue"])]),_:1})):v("",!0),q.enableLogging?(p(),g(r,{key:1,label:"日志保留时间",prop:"logRetentionDays"},{default:f(()=>[c(le,{modelValue:q.logRetentionDays,"onUpdate:modelValue":o[23]||(o[23]=e=>q.logRetentionDays=e),min:1,max:365,style:{width:"200px"}},null,8,["modelValue"]),o[59]||(o[59]=m("span",{class:"unit-text"},"天",-1))]),_:1})):v("",!0)]),_:1}),c(ee,{class:"config-card"},{header:f(()=>[...o[60]||(o[60]=[m("span",null,"告警配置",-1)])]),default:f(()=>[c(r,{label:"启用告警",prop:"enableAlerts"},{default:f(()=>[c(se,{modelValue:q.enableAlerts,"onUpdate:modelValue":o[24]||(o[24]=e=>q.enableAlerts=e)},null,8,["modelValue"])]),_:1}),q.enableAlerts?(p(),g(r,{key:0,label:"失败率阈值",prop:"failureRateThreshold"},{default:f(()=>[c(le,{modelValue:q.failureRateThreshold,"onUpdate:modelValue":o[25]||(o[25]=e=>q.failureRateThreshold=e),min:1,max:100,style:{width:"200px"}},null,8,["modelValue"]),o[61]||(o[61]=m("span",{class:"unit-text"},"%",-1))]),_:1})):v("",!0),q.enableAlerts?(p(),g(r,{key:1,label:"告警接收人",prop:"alertReceivers"},{default:f(()=>[c(d,{modelValue:q.alertReceivers,"onUpdate:modelValue":o[26]||(o[26]=e=>q.alertReceivers=e),placeholder:"请输入邮箱地址，多个用逗号分隔",style:{width:"400px"}},null,8,["modelValue"])]),_:1})):v("",!0)]),_:1}),m("div",L,[c(ae,{type:"primary",onClick:Z,loading:A.value},{default:f(()=>[...o[62]||(o[62]=[y(" 保存配置 ",-1)])]),_:1},8,["loading"]),c(ae,{onClick:H},{default:f(()=>[...o[63]||(o[63]=[y(" 重置 ",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"]),m("div",k,[c(ee,null,{header:f(()=>[...o[64]||(o[64]=[m("span",null,"配置管理",-1)])]),default:f(()=>[m("div",U,[c(ae,{type:"primary",onClick:X},{default:f(()=>[c(ne,null,{default:f(()=>[c(b(e))]),_:1}),o[65]||(o[65]=y(" 导出配置 ",-1))]),_:1}),c(ue,{"before-upload":Y,"show-file-list":!1,accept:".json"},{default:f(()=>[c(ae,{type:"success"},{default:f(()=>[c(ne,null,{default:f(()=>[c(b(l))]),_:1}),o[66]||(o[66]=y(" 导入配置 ",-1))]),_:1})]),_:1}),c(ae,{type:"warning",onClick:$},{default:f(()=>[c(ne,null,{default:f(()=>[c(b(a))]),_:1}),o[67]||(o[67]=y(" 恢复默认 ",-1))]),_:1})])]),_:1})])])}}}),[["__scopeId","data-v-2c3a19d7"]]);export{A as default};
