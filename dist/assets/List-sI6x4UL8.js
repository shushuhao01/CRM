const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/uploadService-CL6v6DXe.js","assets/index-C4IdUW1A.js","assets/vendor-BtukhyiH.js","assets/elementPlus-DxaqjplL.js","assets/utils-DfI7e5Rl.js","assets/index-Cj-RrGL6.css"])))=>i.map(i=>d[i]);
import{a as e,b as a,c as t,l,_ as o}from"./index-C4IdUW1A.js";import{l as i,aA as s,aC as r,r as n,Z as d,e as c,w as u,b as p,ag as m,m as v,q as f,p as g,U as y,M as h,Q as w,O as _,S as b,u as k,T as C,F as V,a9 as P,J as x,af as T}from"./vendor-BtukhyiH.js";import{s as S,e as U,G as D,C as O,k as $,I as z,al as I,F as E,r as N,d as R,b as q,E as j}from"./elementPlus-DxaqjplL.js";import{u as A}from"./product-DXlSdbN8.js";import{D as B}from"./DynamicTable-DpwT2Ioj.js";import"./utils-DfI7e5Rl.js";import"./env-DLalhsF6.js";import"./TableColumnSettings-NQCH9NUW.js";const F={class:"product-list"},L={class:"page-header"},G={class:"header-actions"},H={class:"stats-section"},M={class:"stat-content"},Y={class:"stat-icon primary-icon"},J={class:"stat-info"},K={class:"stat-number primary-number"},Q={class:"stat-content"},W={class:"stat-icon warning-icon"},Z={class:"stat-info"},X={class:"stat-number warning-number"},ee={class:"stat-content"},ae={class:"stat-icon danger-icon"},te={class:"stat-info"},le={class:"stat-number danger-number"},oe={class:"price-range-wrapper"},ie={class:"table-header"},se={class:"header-left"},re={class:"status-tabs"},ne={class:"header-right"},de={class:"price"},ce={class:"action-buttons"},ue={key:1,class:"deleted-actions"},pe={class:"pagination-container"},me={class:"table-count"},ve={class:"dialog-footer"},fe={key:0},ge={class:"dialog-footer"},ye={class:"category-management"},he={class:"category-actions"},we={class:"dialog-footer"},_e={class:"quick-add-section"},be=["src"],ke={class:"excel-import-section"},Ce={class:"import-actions"},Ve={key:0,class:"file-info"},Pe={key:1,class:"preview-section"},xe={style:{"margin-top":"8px",color:"#909399"}},Te={class:"dialog-footer"},Se=o(i({__name:"List",setup(o){const i=s(),Se=r(),Ue=t(i),De=e(),Oe=a(),$e=A(),ze=n(!1),Ie=n(!1),Ee=n(!1),Ne=n(!1),Re=n(!1),qe=n("quick"),je=n([]),Ae=n(""),Be=n([]),Fe=n(),Le=n(!1),Ge=n(!1),He=n(!1),Me=n(!1),Ye=n("add"),Je=d({name:"",code:"",categoryId:"",status:"",stockStatus:"",minPrice:null,maxPrice:null}),Ke=n("all"),Qe=d({currentPage:1,pageSize:20,total:0}),We=n([]),Ze=n([]),Xe=n(null),ea=n(!1),aa=n([]),ta=n(0),la=d({type:"increase",quantity:0,reason:"",remark:""}),oa=d({originalPrice:0,newPrice:0,reason:"",remark:""}),ia=c(()=>($e.categories||[]).map(e=>({id:e.id,name:e.name}))),sa=n([]),ra=d({name:"",code:"",sort:0,status:"active",description:""}),na={type:[{required:!0,message:"请选择调整类型",trigger:"change"}],quantity:[{required:!0,message:"请输入调整数量",trigger:"blur"}],reason:[{required:!0,message:"请选择调整原因",trigger:"change"}]},da={newPrice:[{required:!0,message:"请输入新价格",trigger:"blur"},{type:"number",min:.01,message:"价格必须大于0",trigger:"blur"}],reason:[{required:!0,message:"请选择改价原因",trigger:"change"}]},ca={name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],code:[{required:!0,message:"请输入分类编码",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]},ua=n(),pa=n(),ma=n(),va=c(()=>$e.stats.totalProducts),fa=c(()=>$e.stats.lowStockCount),ga=c(()=>$e.stats.outOfStockCount),ya=c(()=>[{prop:"image",label:"商品图片",width:100,visible:!0,sortable:!1,showOverflowTooltip:!1},{prop:"code",label:"商品编码",width:120,visible:!0,sortable:!0,showOverflowTooltip:!0},{prop:"name",label:"商品名称",minWidth:200,visible:!0,sortable:!0,showOverflowTooltip:!0},{prop:"categoryName",label:"分类",width:120,visible:!0,sortable:!0,showOverflowTooltip:!0},{prop:"specification",label:"规格",width:120,visible:!0,sortable:!1,showOverflowTooltip:!0},{prop:"price",label:"价格",width:120,visible:!0,sortable:!0,showOverflowTooltip:!1},{prop:"stock",label:"库存",width:100,visible:!0,sortable:!0,showOverflowTooltip:!1},{prop:"salesCount",label:"销量",width:100,visible:!0,sortable:!0,showOverflowTooltip:!1},{prop:"status",label:"状态",width:100,visible:!0,sortable:!1,showOverflowTooltip:!1},{prop:"createTime",label:"创建时间",width:180,visible:!0,sortable:!0,showOverflowTooltip:!0},{prop:"updateTime",label:"更新时间",width:180,visible:!1,sortable:!0,showOverflowTooltip:!0}]),ha=(e,a)=>{const t=De.productConfig.lowStockThreshold;return 0===e?"stock-out":e<=t?"stock-warning":"stock-normal"},wa=e=>({active:"上架",inactive:"下架",out_of_stock:"缺货"}[e]||e),_a=()=>{Qe.currentPage=1,tt()},ba=()=>{Object.assign(Je,{name:"",code:"",categoryId:"",status:"",stockStatus:"",minPrice:null,maxPrice:null}),_a()},ka=e=>{Ze.value=e},Ca=({column:e,prop:a,order:t})=>{console.log("排序变化:",{column:e,prop:a,order:t}),t?(searchParams.sortField=a,searchParams.sortOrder="ascending"===t?"asc":"desc"):(searchParams.sortField="",searchParams.sortOrder=""),tt()},Va=e=>{Qe.pageSize=e,tt()},Pa=e=>{Qe.currentPage=e,tt()},xa=()=>{ea.value=!1,aa.value=[],ta.value=0},Ta=({row:e})=>e.deleted?"deleted-row":"",Sa=()=>{Ue.push("/product/add")},Ua=e=>{Ue.push(`/product/detail/${e.id}`)},Da=e=>{Ue.push(`/product/add?copy=${e.id}`)},Oa=async e=>{const a="active"===e.status?"下架":"上架";try{await q.confirm(`确定要${a}商品"${e.name}"吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,500)),e.status="active"===e.status?"inactive":"active",j.success(`${a}成功`),Oe.addNotification({type:"PRODUCT_STATUS_CHANGED",title:`商品${a}`,content:`商品"${e.name}"已${a}`,data:{productId:e.id,productName:e.name,productCode:e.code,status:e.status,action:a,timestamp:(new Date).toISOString()},link:`/product/detail/${e.id}`})}catch(t){}},$a=async e=>{try{await q.confirm(`确定要删除商品"${e.name}"吗？删除后不可恢复！`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});if(!$e.deleteProduct(e.id))return void j.error("删除失败");j.success("删除成功"),Oe.addNotification({type:"PRODUCT_DELETED",title:"商品删除",content:`商品"${e.name}"已删除`,data:{productId:e.id,productName:e.name,productCode:e.code,timestamp:(new Date).toISOString()},link:"/product/list"}),tt()}catch(a){}},za=async()=>{if(Ze.value&&0!==Ze.value.length)try{await q.confirm(`确定要删除选中的 ${Ze.value.length} 个商品吗？删除后不可恢复！`,"确认批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),Ze.value.forEach(e=>{$e.deleteProduct(e.id)}),await new Promise(e=>setTimeout(e,500)),j.success("批量删除成功"),Oe.addNotification({type:"PRODUCT_BATCH_DELETED",title:"批量删除商品",content:`已批量删除 ${Ze.value.length} 个商品`,data:{count:Ze.value.length,productNames:Ze.value.map(e=>e.name),timestamp:(new Date).toISOString()},link:"/product/list"}),tt()}catch(e){}else j.warning("请先选择要删除的商品")},Ia=async()=>{if(Ze.value&&0!==Ze.value.length)try{const{value:e}=await q({title:"批量状态更新",message:T("div",[T("p",{style:"margin-bottom: 10px;"},`确定要批量更新选中的 ${Ze.value.length} 个商品的状态吗？`),T("div",{style:"margin-bottom: 10px;"},[T("label",{style:"display: block; margin-bottom: 5px;"},"请选择状态："),T("select",{id:"status-select",style:"width: 100%; padding: 8px; border: 1px solid #dcdfe6; border-radius: 4px;",onChange:e=>{const a=e.target;q.inputValue=a.value}},[T("option",{value:"active"},"上架"),T("option",{value:"inactive"},"下架")])])]),showInput:!0,inputValue:"active",confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:(e,a,t)=>{if("confirm"===e){const e=document.getElementById("status-select");e&&(a.inputValue=e.value)}t()}});Ze.value.forEach(a=>{$e.updateProduct(a.id,{status:e})}),await new Promise(e=>setTimeout(e,500)),j.success("批量状态更新成功");const a="active"===e?"上架":"下架";Oe.addNotification({type:"PRODUCT_BATCH_STATUS_CHANGED",title:"批量状态更新",content:`已批量${a} ${Ze.value.length} 个商品`,data:{count:Ze.value.length,status:e,statusText:a,productNames:Ze.value.map(e=>e.name),timestamp:(new Date).toISOString()},link:"/product/list"}),tt()}catch(e){}else j.warning("请先选择要更新状态的商品")},Ea=()=>{j.info("批量库存调整功能开发中...")},Na=()=>{lt(),Ge.value=!0},Ra=()=>{Ne.value=!0,qe.value="quick",0===je.value.length&&qa()},qa=()=>{je.value.push({name:"",code:`P${Date.now()}`,categoryId:"",image:"",unit:"件",price:0,costPrice:0,stock:0,status:"active"})},ja=()=>{const e=["商品名称*","商品编码","分类","单位","销售价*","成本价","库存*","状态"],a=[["示例商品1","P001","体重管理","件","100","70","50","上架"],["示例商品2","P002","体重管理","盒","200","140","30","上架"]];l(()=>import("./utils-DfI7e5Rl.js").then(e=>e.x),[]).then(t=>{const l=t.utils.book_new(),o=[e,...a],i=t.utils.aoa_to_sheet(o);i["!cols"]=[{wch:20},{wch:15},{wch:15},{wch:10},{wch:12},{wch:12},{wch:10},{wch:10}],t.utils.book_append_sheet(l,i,"商品导入模板"),t.writeFile(l,"商品导入模板.xlsx"),j.success("模板下载成功")}).catch(()=>{j.error("下载失败，请重试")})},Aa=e=>{Ae.value=e.name;const a=new FileReader;a.onload=e=>{try{l(()=>import("./utils-DfI7e5Rl.js").then(e=>e.x),[]).then(a=>{const t=new Uint8Array(e.target?.result),l=a.read(t,{type:"array"}),o=l.Sheets[l.SheetNames[0]],i=a.utils.sheet_to_json(o,{header:1}),s=[];for(let e=1;e<i.length;e++){const a=i[e];a&&0!==a.length&&s.push({name:String(a[0]||"").trim(),code:String(a[1]||"").trim()||`P${Date.now()+e}`,categoryName:String(a[2]||"").trim(),unit:String(a[3]||"").trim()||"件",price:parseFloat(a[4])||0,costPrice:parseFloat(a[5])||0,stock:parseInt(a[6])||0,status:"上架"===String(a[7]||"").trim()?"上架":"下架"})}Be.value=s,j.success(`文件解析成功，共${s.length}条数据`)}).catch(e=>{console.error("文件解析失败:",e),j.error("文件格式错误，请使用xlsx格式")})}catch(a){console.error("文件读取失败:",a),j.error("文件读取失败")}},a.readAsArrayBuffer(e.raw)},Ba=()=>{Ae.value="",Be.value=[]},Fa=()=>{Ne.value=!1,je.value=[],Ae.value="",Be.value=[]},La=async()=>{try{Re.value=!0;let e=[];if("quick"===qe.value){if(e=je.value.filter(e=>e.name&&e.price>0),0===e.length)return j.warning("请至少填写一个商品的名称和价格"),void(Re.value=!1)}else{if(0===Be.value.length)return j.warning("请先选择并解析Excel文件"),void(Re.value=!1);e=Be.value}for(const a of e){const e=a.categoryId||ia.value[0]?.id||"1",t={code:a.code||`P${Date.now()}`,name:a.name,categoryId:e,categoryName:ia.value.find(a=>a.id===e)?.name||"未分类",brand:"",specification:"",image:"https://via.placeholder.com/100",price:a.price,costPrice:a.costPrice||.7*a.price,stock:a.stock||0,minStock:10,maxStock:9999,unit:a.unit||"件",weight:0,dimensions:"",description:"",status:"active"===a.status||"上架"===a.status?"active":"inactive",salesCount:0,updateTime:(new Date).toISOString()};await $e.addProduct(t)}j.success(`成功导入${e}个商品`),Fa(),tt()}catch(e){j.error("批量导入失败")}finally{Re.value=!1}},Ga=async()=>{try{const e=We.value;if(0===e.length)return void j.warning("没有可导出的数据");const a=["商品编码","商品名称","分类","规格","单位","销售价","成本价","库存","销量","状态","创建时间"],t=e.map(e=>[e.code,e.name,e.categoryName,e.specification||"",e.unit||"件",e.price.toFixed(2),(e.costPrice||.7*e.price).toFixed(2),e.stock,e.salesCount||0,"active"===e.status?"上架":"下架",e.createTime]),l=[a.join(","),...t.map(e=>e.join(","))].join("\n"),o=new Blob(["\ufeff"+l],{type:"text/csv;charset=utf-8;"}),i=window.URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`商品数据_${(new Date).toISOString().slice(0,10)}.csv`,s.click(),window.URL.revokeObjectURL(i),j.success(`导出成功，共导出${e.length}条数据`)}catch(e){console.error("导出失败:",e),j.error("导出失败")}},Ha=e=>{switch(Ke.value=e,Je.status="",Je.stockStatus="",Je.showDeleted=!1,Je.onlyDeleted=!1,e){case"all":Je.showDeleted=!0;break;case"active":Je.status="active";break;case"inactive":Je.status="inactive";break;case"deleted":Je.onlyDeleted=!0;break;case"low_stock":Je.stockStatus="warning";break;case"out_of_stock":Je.stockStatus="out_of_stock"}Qe.currentPage=1,tt()},Ma=()=>{tt(),j.success("数据已刷新")},Ya=async()=>{try{await q.confirm(`确定要将选中的 ${Ze.value.length} 个商品设为推荐商品吗？`,"确认批量推荐",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),await new Promise(e=>setTimeout(e,1e3)),j.success("批量推荐设置成功"),Oe.addNotification({type:"PRODUCT_BATCH_RECOMMENDED",title:"批量推荐设置",content:`已将 ${Ze.value.length} 个商品设为推荐商品`,data:{count:Ze.value.length,productNames:Ze.value.map(e=>e.name),timestamp:(new Date).toISOString()},link:"/product/list"}),tt()}catch(e){}},Ja=async()=>{try{await(ua.value?.validate()),Ie.value=!0,await new Promise(e=>setTimeout(e,1e3));const e=Xe.value,a=e.stock,t=la.quantity;let l=a;"increase"===la.type?l=a+t:"decrease"===la.type?l=a-t:"set"===la.type&&(l=t);const o=Math.max(0,l);$e.updateProduct(e.id,{stock:o}),j.success("库存调整成功");const i="increase"===la.type?"增加":"decrease"===la.type?"减少":"设置";Oe.addNotification({type:"PRODUCT_STOCK_ADJUSTED",title:"库存调整",content:`商品"${Xe.value.name}"库存已${i} ${la.quantity} 件`,data:{productId:Xe.value.id,productName:Xe.value.name,productCode:Xe.value.code,adjustType:i,quantity:la.quantity,reason:la.reason,remark:la.remark,timestamp:(new Date).toISOString()},link:`/product/detail/${Xe.value.id}`}),setTimeout(()=>{Ie.value=!1,Ka(),tt()},1e3)}catch(e){console.error("表单验证失败:",e),Ie.value=!1}},Ka=()=>{Le.value=!1,ua.value?.clearValidate(),Xe.value=null},Qa=async()=>{try{await(pa.value?.validate()),Ie.value=!0,await new Promise(e=>setTimeout(e,1e3));const e=Xe.value,a=e.price,t=oa.newPrice;$e.updateProduct(e.id,{price:t}),j.success("改价成功");const l=t-a,o=l>0?"上调":"下调";Oe.addNotification({type:"PRODUCT_PRICE_CHANGED",title:"商品改价",content:`商品"${e.name}"价格已${o}，从¥${a.toFixed(2)}调整为¥${t.toFixed(2)}`,data:{productId:e.id,productName:e.name,productCode:e.code,oldPrice:a,newPrice:t,priceChange:l,changeType:o,reason:oa.reason,remark:oa.remark,timestamp:(new Date).toISOString()},link:`/product/detail/${e.id}`}),setTimeout(()=>{Ie.value=!1,Wa(),tt()},1e3)}catch(e){console.error("表单验证失败:",e),Ie.value=!1}},Wa=()=>{He.value=!1,pa.value?.clearValidate(),Xe.value=null},Za=()=>{Ye.value="add",Object.assign(ra,{name:"",code:"",sort:0,status:"active",description:""}),Me.value=!0},Xa=async()=>{try{await(ma.value?.validate()),Ee.value=!0;const e="add"===Ye.value;e?await $e.addCategory({name:ra.name,code:ra.code,level:1,parentId:"0",sort:ra.sort,status:"active"===ra.status?1:0,description:ra.description,productCount:0}):await $e.updateCategory(ra.id,{name:ra.name,code:ra.code,sort:ra.sort,status:"active"===ra.status?1:0,description:ra.description}),j.success(e?"添加成功":"更新成功"),Oe.addNotification({type:e?"PRODUCT_CATEGORY_CREATED":"PRODUCT_CATEGORY_UPDATED",title:e?"分类添加":"分类更新",content:`商品分类"${ra.name}"已${e?"添加":"更新"}`,data:{categoryId:ra.id,categoryName:ra.name,categoryCode:ra.code,action:e?"添加":"更新",timestamp:(new Date).toISOString()},link:"/product/list"}),at(),await lt()}catch(e){console.error("操作失败:",e),j.error("操作失败，请重试")}finally{Ee.value=!1}},et=()=>{Ge.value=!1},at=()=>{Me.value=!1,ma.value?.clearValidate()},tt=async()=>{ze.value=!0;try{await new Promise(e=>setTimeout(e,300)),$e.setSearchForm(Je);const e=$e.getFilteredProducts||[],a=(Qe.currentPage-1)*Qe.pageSize,t=a+Qe.pageSize,l=e.slice(a,t);We.value=l,Qe.total=e.length}catch(e){j.error("加载数据失败")}finally{ze.value=!1}},lt=async()=>{try{await $e.loadCategories(),sa.value=($e.categories||[]).map(e=>{const a=($e.products||[]).filter(a=>a.categoryId===e.id).length;return{id:e.id,name:e.name,code:e.code,sort:e.sort||1,productCount:a,status:1===e.status?"active":"inactive",description:e.description||e.name}})}catch(e){console.error("加载分类列表失败:",e),j.error("加载分类列表失败")}},ot=e=>{console.log("列设置变化:",e)};return u(()=>Se.path,(e,a)=>{"/product/list"===e&&a&&"/product/list"!==a&&(console.log("路由变化，刷新商品列表数据",{newPath:e,oldPath:a}),tt())},{immediate:!1}),u(()=>Se.query,(e,a)=>{"/product/list"===Se.path&&"true"===e.refresh&&(console.log("检测到刷新参数，重新加载数据"),tt(),Ue.replace({path:"/product/list"}))},{immediate:!1}),p(async()=>{try{await $e.loadProducts(),await $e.loadCategories()}catch(e){console.error("从API加载商品数据失败:",e),$e.products&&0!==$e.products.length||$e.initData()}tt()}),(e,a)=>{const t=m("el-button"),o=m("el-icon"),i=m("el-card"),s=m("el-col"),r=m("el-row"),n=m("el-input"),d=m("el-form-item"),c=m("el-option"),u=m("el-select"),p=m("el-input-number"),T=m("el-form"),A=m("el-button-group"),Se=m("el-divider"),De=m("el-image"),it=m("el-link"),st=m("el-tag"),rt=m("el-dropdown-item"),nt=m("el-dropdown-menu"),dt=m("el-dropdown"),ct=m("el-pagination"),ut=m("el-radio"),pt=m("el-radio-group"),mt=m("el-dialog"),vt=m("el-table-column"),ft=m("el-table"),gt=m("el-image-viewer"),yt=m("el-upload"),ht=m("el-tab-pane"),wt=m("el-alert"),_t=m("el-tabs");return f(),v("div",F,[g("div",L,[a[36]||(a[36]=g("div",{class:"header-left"},[g("h2",null,"商品管理")],-1)),g("div",G,[y(t,{onClick:Na,icon:k(S)},{default:_(()=>[...a[32]||(a[32]=[b(" 分类管理 ",-1)])]),_:1},8,["icon"]),y(t,{onClick:Ra,icon:k(U)},{default:_(()=>[...a[33]||(a[33]=[b(" 批量导入 ",-1)])]),_:1},8,["icon"]),y(t,{onClick:Ga,icon:k(D)},{default:_(()=>[...a[34]||(a[34]=[b(" 导出数据 ",-1)])]),_:1},8,["icon"]),y(t,{onClick:Sa,type:"primary",icon:k(O)},{default:_(()=>[...a[35]||(a[35]=[b(" 添加商品 ",-1)])]),_:1},8,["icon"])])]),g("div",H,[y(r,{gutter:20},{default:_(()=>[y(s,{span:8},{default:_(()=>[y(i,{class:"stat-card primary-stat",shadow:"hover"},{default:_(()=>[g("div",M,[g("div",Y,[y(o,null,{default:_(()=>[y(k($))]),_:1})]),g("div",J,[g("div",K,C(va.value),1),a[37]||(a[37]=g("div",{class:"stat-title"},"总商品数",-1)),a[38]||(a[38]=g("div",{class:"stat-desc"},"当前系统中的商品总数量",-1))])])]),_:1})]),_:1}),y(s,{span:8},{default:_(()=>[y(i,{class:"stat-card warning-stat",shadow:"hover"},{default:_(()=>[g("div",Q,[g("div",W,[y(o,null,{default:_(()=>[y(k(z))]),_:1})]),g("div",Z,[g("div",X,C(fa.value),1),a[39]||(a[39]=g("div",{class:"stat-title"},"库存预警",-1)),a[40]||(a[40]=g("div",{class:"stat-desc"},"库存低于预警线的商品",-1))])])]),_:1})]),_:1}),y(s,{span:8},{default:_(()=>[y(i,{class:"stat-card danger-stat",shadow:"hover"},{default:_(()=>[g("div",ee,[g("div",ae,[y(o,null,{default:_(()=>[y(k(I))]),_:1})]),g("div",te,[g("div",le,C(ga.value),1),a[41]||(a[41]=g("div",{class:"stat-title"},"缺货商品",-1)),a[42]||(a[42]=g("div",{class:"stat-desc"},"当前库存为零的商品",-1))])])]),_:1})]),_:1})]),_:1})]),y(i,{class:"search-card"},{default:_(()=>[y(T,{model:Je,inline:""},{default:_(()=>[y(d,{label:"商品名称"},{default:_(()=>[y(n,{modelValue:Je.name,"onUpdate:modelValue":a[0]||(a[0]=e=>Je.name=e),placeholder:"请输入商品名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),y(d,{label:"商品编码"},{default:_(()=>[y(n,{modelValue:Je.code,"onUpdate:modelValue":a[1]||(a[1]=e=>Je.code=e),placeholder:"请输入商品编码",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),y(d,{label:"商品分类"},{default:_(()=>[y(u,{modelValue:Je.categoryId,"onUpdate:modelValue":a[2]||(a[2]=e=>Je.categoryId=e),placeholder:"请选择分类",clearable:"",style:{width:"200px"}},{default:_(()=>[(f(!0),v(V,null,P(ia.value,e=>(f(),h(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"商品状态"},{default:_(()=>[y(u,{modelValue:Je.status,"onUpdate:modelValue":a[3]||(a[3]=e=>Je.status=e),placeholder:"请选择状态",clearable:"",style:{width:"150px"}},{default:_(()=>[y(c,{label:"上架",value:"active"}),y(c,{label:"下架",value:"inactive"}),y(c,{label:"缺货",value:"out_of_stock"})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"库存状态"},{default:_(()=>[y(u,{modelValue:Je.stockStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>Je.stockStatus=e),placeholder:"请选择库存状态",clearable:"",style:{width:"150px"}},{default:_(()=>[y(c,{label:"正常",value:"normal"}),y(c,{label:"预警",value:"warning"}),y(c,{label:"缺货",value:"out_of_stock"})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"价格范围",class:"price-range-item"},{default:_(()=>[g("div",oe,[y(p,{modelValue:Je.minPrice,"onUpdate:modelValue":a[5]||(a[5]=e=>Je.minPrice=e),placeholder:"最低价",min:0,precision:2,style:{width:"160px"},"controls-position":"right"},null,8,["modelValue"]),a[43]||(a[43]=g("span",{class:"price-separator"},"至",-1)),y(p,{modelValue:Je.maxPrice,"onUpdate:modelValue":a[6]||(a[6]=e=>Je.maxPrice=e),placeholder:"最高价",min:0,precision:2,style:{width:"160px"},"controls-position":"right"},null,8,["modelValue"])])]),_:1}),y(d,null,{default:_(()=>[y(t,{onClick:_a,type:"primary",icon:k(E)},{default:_(()=>[...a[44]||(a[44]=[b(" 搜索 ",-1)])]),_:1},8,["icon"]),y(t,{onClick:ba,icon:k(N)},{default:_(()=>[...a[45]||(a[45]=[b(" 重置 ",-1)])]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),y(B,{data:We.value,columns:ya.value,"storage-key":"product-list-columns",loading:ze.value,"show-selection":!0,"show-header":!0,"show-column-settings":!0,"show-actions":!0,"row-class-name":Ta,pagination:{currentPage:Qe.currentPage,pageSize:Qe.pageSize,total:Qe.total,pageSizes:[10,20,50,100]},onSelectionChange:ka,onSortChange:Ca,onSizeChange:Va,onCurrentChange:Pa,onColumnSettingsChange:ot,ref_key:"dynamicTableRef",ref:Fe},{"header-actions":_(()=>[g("div",ie,[g("div",se,[g("div",re,[y(A,{size:"small"},{default:_(()=>[y(t,{onClick:a[7]||(a[7]=e=>Ha("all")),type:"all"===Ke.value?"primary":""},{default:_(()=>[...a[46]||(a[46]=[b(" 全部 ",-1)])]),_:1},8,["type"]),y(t,{onClick:a[8]||(a[8]=e=>Ha("active")),type:"active"===Ke.value?"primary":""},{default:_(()=>[...a[47]||(a[47]=[b(" 在售 ",-1)])]),_:1},8,["type"]),y(t,{onClick:a[9]||(a[9]=e=>Ha("inactive")),type:"inactive"===Ke.value?"primary":""},{default:_(()=>[...a[48]||(a[48]=[b(" 下架 ",-1)])]),_:1},8,["type"]),y(t,{onClick:a[10]||(a[10]=e=>Ha("out_of_stock")),type:"out_of_stock"===Ke.value?"primary":""},{default:_(()=>[...a[49]||(a[49]=[b(" 缺货 ",-1)])]),_:1},8,["type"]),y(t,{onClick:a[11]||(a[11]=e=>Ha("deleted")),type:"deleted"===Ke.value?"primary":""},{default:_(()=>[...a[50]||(a[50]=[b(" 删除 ",-1)])]),_:1},8,["type"])]),_:1})])]),g("div",ne,[y(t,{onClick:Ya,disabled:!Ze.value||!Ze.value.length,type:"success",size:"small"},{default:_(()=>[...a[51]||(a[51]=[b(" 批量推荐 ",-1)])]),_:1},8,["disabled"]),y(t,{onClick:za,type:"danger",disabled:!Ze.value||!Ze.value.length,size:"small"},{default:_(()=>[...a[52]||(a[52]=[b(" 批量删除 ",-1)])]),_:1},8,["disabled"]),y(t,{onClick:Ia,disabled:!Ze.value||!Ze.value.length,size:"small"},{default:_(()=>[...a[53]||(a[53]=[b(" 批量上下架 ",-1)])]),_:1},8,["disabled"]),y(t,{onClick:Ea,disabled:!Ze.value||!Ze.value.length,size:"small"},{default:_(()=>[...a[54]||(a[54]=[b(" 批量调库存 ",-1)])]),_:1},8,["disabled"]),y(Se,{direction:"vertical"}),y(t,{onClick:Ma,icon:k(N),size:"small",title:"刷新数据"},null,8,["icon"])])])]),"column-image":_(({row:e})=>[y(De,{src:e.image,style:{width:"60px",height:"60px","border-radius":"4px",cursor:"pointer"},fit:"cover",onClick:a=>{return t=e.image,aa.value=[t],ta.value=0,void(ea.value=!0);var t}},null,8,["src","onClick"])]),"column-code":_(({row:e})=>[y(it,{onClick:a=>Ua(e),type:"primary",underline:!1,class:"product-code-link"},{default:_(()=>[b(C(e.code),1)]),_:2},1032,["onClick"])]),"column-price":_(({row:e})=>[g("span",de,"¥"+C(e.price),1)]),"column-stock":_(({row:e})=>[g("span",{class:x(ha(e.stock,e.minStock))},C(e.stock),3)]),"column-status":_(({row:e})=>{return[y(st,{type:(a=e.status,{active:"success",inactive:"info",out_of_stock:"danger"}[a]||""),size:"small"},{default:_(()=>[b(C(wa(e.status)),1)]),_:2},1032,["type"])];var a}),"table-actions":_(({row:e})=>[g("div",ce,[y(t,{onClick:a=>Ua(e),type:"primary",link:"",size:"small"},{default:_(()=>[...a[55]||(a[55]=[b(" 查看 ",-1)])]),_:1},8,["onClick"]),e.deleted?(f(),v("div",ue,[y(st,{type:"danger",size:"small"},{default:_(()=>[...a[62]||(a[62]=[b("已删除",-1)])]),_:1}),y(t,{onClick:a=>(async e=>{try{if(await q.confirm(`确定要恢复商品"${e.name}"吗？`,"确认恢复",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),!$e.restoreProduct(e.id))return void j.error("恢复失败");j.success("恢复成功"),Oe.addNotification({type:"PRODUCT_RESTORED",title:"商品恢复",content:`商品"${e.name}"已恢复`,data:{productId:e.id,productName:e.name,productCode:e.code,timestamp:(new Date).toISOString()},link:`/product/detail/${e.id}`}),tt()}catch(a){}})(e),type:"success",link:"",size:"small",style:{"margin-left":"8px"}},{default:_(()=>[...a[63]||(a[63]=[b(" 恢复 ",-1)])]),_:1},8,["onClick"]),y(t,{onClick:a=>(async e=>{try{if(await q.confirm(`确定要彻底删除商品"${e.name}"吗？彻底删除后将无法恢复，且不会在任何列表中显示！`,"确认彻底删除",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"error",dangerouslyUseHTMLString:!0,message:`<div style="color: #f56c6c; font-weight: bold;">⚠️ 警告：此操作不可逆！</div><br/>确定要彻底删除商品"${e.name}"吗？<br/><br/>彻底删除后：<br/>• 商品将从所有列表中移除<br/>• 无法通过任何方式恢复<br/>• 相关数据将被永久清除`}),!$e.permanentDeleteProduct(e.id))return void j.error("彻底删除失败");j.success("彻底删除成功"),Oe.addNotification({type:"PRODUCT_PERMANENT_DELETED",title:"商品彻底删除",content:`商品"${e.name}"已彻底删除`,data:{productId:e.id,productName:e.name,productCode:e.code,timestamp:(new Date).toISOString()},link:"/product/list"}),tt()}catch(a){}})(e),type:"danger",link:"",size:"small"},{default:_(()=>[...a[64]||(a[64]=[b(" 彻底删除 ",-1)])]),_:1},8,["onClick"])])):(f(),v(V,{key:0},[y(t,{onClick:a=>(e=>{Ue.push(`/product/edit/${e.id}`)})(e),type:"primary",link:"",size:"small"},{default:_(()=>[...a[56]||(a[56]=[b(" 编辑 ",-1)])]),_:1},8,["onClick"]),y(t,{onClick:a=>(e=>{Xe.value=e,Object.assign(oa,{originalPrice:e.price,newPrice:e.price,reason:"",remark:""}),He.value=!0})(e),type:"success",link:"",size:"small"},{default:_(()=>[...a[57]||(a[57]=[b(" 改价 ",-1)])]),_:1},8,["onClick"]),y(t,{onClick:a=>(e=>{Xe.value=e,Object.assign(la,{type:"increase",quantity:0,reason:"",remark:""}),Le.value=!0})(e),type:"warning",link:"",size:"small"},{default:_(()=>[...a[58]||(a[58]=[b(" 调库存 ",-1)])]),_:1},8,["onClick"]),y(t,{onClick:a=>Oa(e),type:"active"===e.status?"info":"success",link:"",size:"small"},{default:_(()=>[b(C("active"===e.status?"下架":"上架"),1)]),_:2},1032,["onClick","type"]),y(dt,{onCommand:a=>((e,a)=>{switch(e){case"copy":Da(a);break;case"toggle":Oa(a);break;case"delete":$a(a)}})(a,e),trigger:"click"},{dropdown:_(()=>[y(nt,null,{default:_(()=>[y(rt,{command:"copy"},{default:_(()=>[...a[60]||(a[60]=[b("复制商品",-1)])]),_:1}),y(rt,{command:"delete",class:"danger-item",divided:!0},{default:_(()=>[...a[61]||(a[61]=[b(" 删除 ",-1)])]),_:1})]),_:1})]),default:_(()=>[y(t,{type:"primary",link:"",size:"small"},{default:_(()=>[a[59]||(a[59]=b(" 更多",-1)),y(o,{class:"el-icon--right"},{default:_(()=>[y(k(R))]),_:1})]),_:1})]),_:1},8,["onCommand"])],64))])]),pagination:_(()=>[g("div",pe,[g("span",me,"共 "+C(Qe.total)+" 条记录",1),y(ct,{"current-page":Qe.currentPage,"onUpdate:currentPage":a[12]||(a[12]=e=>Qe.currentPage=e),"page-size":Qe.pageSize,"onUpdate:pageSize":a[13]||(a[13]=e=>Qe.pageSize=e),"page-sizes":[10,20,50,100],total:Qe.total,layout:"sizes, prev, pager, next, jumper",onSizeChange:Va,onCurrentChange:Pa},null,8,["current-page","page-size","total"])])]),_:1},8,["data","columns","loading","pagination"]),y(mt,{modelValue:Le.value,"onUpdate:modelValue":a[18]||(a[18]=e=>Le.value=e),title:"库存调整",width:"500px","before-close":Ka},{footer:_(()=>[g("span",ve,[y(t,{onClick:Ka},{default:_(()=>[...a[68]||(a[68]=[b("取消",-1)])]),_:1}),y(t,{onClick:Ja,type:"primary",loading:Ie.value},{default:_(()=>[...a[69]||(a[69]=[b(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:_(()=>[y(T,{ref_key:"stockFormRef",ref:ua,model:la,rules:na,"label-width":"100px"},{default:_(()=>[y(d,{label:"商品名称"},{default:_(()=>[g("span",null,C(Xe.value?.name),1)]),_:1}),y(d,{label:"当前库存"},{default:_(()=>[g("span",null,C(Xe.value?.stock),1)]),_:1}),y(d,{label:"调整类型",prop:"type"},{default:_(()=>[y(pt,{modelValue:la.type,"onUpdate:modelValue":a[14]||(a[14]=e=>la.type=e)},{default:_(()=>[y(ut,{label:"increase"},{default:_(()=>[...a[65]||(a[65]=[b("增加",-1)])]),_:1}),y(ut,{label:"decrease"},{default:_(()=>[...a[66]||(a[66]=[b("减少",-1)])]),_:1}),y(ut,{label:"set"},{default:_(()=>[...a[67]||(a[67]=[b("设置",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"调整数量",prop:"quantity"},{default:_(()=>[y(p,{modelValue:la.quantity,"onUpdate:modelValue":a[15]||(a[15]=e=>la.quantity=e),min:"decrease"===la.type?1:0,max:"decrease"===la.type?Xe.value?.stock:99999,style:{width:"100%"}},null,8,["modelValue","min","max"])]),_:1}),y(d,{label:"调整原因",prop:"reason"},{default:_(()=>[y(u,{modelValue:la.reason,"onUpdate:modelValue":a[16]||(a[16]=e=>la.reason=e),placeholder:"请选择调整原因",style:{width:"100%"}},{default:_(()=>[y(c,{label:"采购入库",value:"purchase"}),y(c,{label:"销售出库",value:"sale"}),y(c,{label:"盘点调整",value:"inventory"}),y(c,{label:"损耗报废",value:"loss"}),y(c,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"备注",prop:"remark"},{default:_(()=>[y(n,{modelValue:la.remark,"onUpdate:modelValue":a[17]||(a[17]=e=>la.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),y(mt,{modelValue:He.value,"onUpdate:modelValue":a[22]||(a[22]=e=>He.value=e),title:"商品改价",width:"500px","before-close":Wa},{footer:_(()=>[g("span",ge,[y(t,{onClick:Wa},{default:_(()=>[...a[70]||(a[70]=[b("取消",-1)])]),_:1}),y(t,{onClick:Qa,type:"primary",loading:Ie.value},{default:_(()=>[...a[71]||(a[71]=[b(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:_(()=>[y(T,{ref_key:"priceFormRef",ref:pa,model:oa,rules:da,"label-width":"100px"},{default:_(()=>[y(d,{label:"商品名称"},{default:_(()=>[g("span",null,C(Xe.value?.name),1)]),_:1}),y(d,{label:"商品编码"},{default:_(()=>[g("span",null,C(Xe.value?.code),1)]),_:1}),y(d,{label:"当前价格"},{default:_(()=>[g("span",null,"¥"+C(Xe.value?.price?.toFixed(2)),1)]),_:1}),y(d,{label:"新价格",prop:"newPrice"},{default:_(()=>[y(p,{modelValue:oa.newPrice,"onUpdate:modelValue":a[19]||(a[19]=e=>oa.newPrice=e),min:.01,precision:2,style:{width:"100%"},placeholder:"请输入新价格"},null,8,["modelValue"])]),_:1}),y(d,{label:"价格变化"},{default:_(()=>[oa.newPrice&&oa.originalPrice?(f(),v("span",fe,[y(st,{type:oa.newPrice>oa.originalPrice?"success":"danger",size:"small"},{default:_(()=>[b(C(oa.newPrice>oa.originalPrice?"+":"")+" ¥"+C((oa.newPrice-oa.originalPrice).toFixed(2))+" ("+C(((oa.newPrice-oa.originalPrice)/oa.originalPrice*100).toFixed(1))+"%) ",1)]),_:1},8,["type"])])):w("",!0)]),_:1}),y(d,{label:"改价原因",prop:"reason"},{default:_(()=>[y(u,{modelValue:oa.reason,"onUpdate:modelValue":a[20]||(a[20]=e=>oa.reason=e),placeholder:"请选择改价原因",style:{width:"100%"}},{default:_(()=>[y(c,{label:"成本变化",value:"cost_change"}),y(c,{label:"市场调价",value:"market_adjust"}),y(c,{label:"促销活动",value:"promotion"}),y(c,{label:"竞争调价",value:"competition"}),y(c,{label:"季节调整",value:"seasonal"}),y(c,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"备注",prop:"remark"},{default:_(()=>[y(n,{modelValue:oa.remark,"onUpdate:modelValue":a[21]||(a[21]=e=>oa.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),y(mt,{modelValue:Ge.value,"onUpdate:modelValue":a[23]||(a[23]=e=>Ge.value=e),title:"分类管理",width:"800px","before-close":et},{default:_(()=>[g("div",ye,[g("div",he,[y(t,{onClick:Za,type:"primary",icon:k(O)},{default:_(()=>[...a[72]||(a[72]=[b(" 添加分类 ",-1)])]),_:1},8,["icon"])]),y(ft,{data:sa.value,style:{width:"100%"}},{default:_(()=>[y(vt,{prop:"name",label:"分类名称"}),y(vt,{prop:"code",label:"分类编码"}),y(vt,{prop:"sort",label:"排序",width:"80"}),y(vt,{prop:"productCount",label:"商品数量",width:"100"}),y(vt,{label:"状态",width:"100"},{default:_(({row:e})=>[y(st,{type:"active"===e.status?"success":"info",size:"small"},{default:_(()=>[b(C("active"===e.status?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),y(vt,{label:"操作",width:"150"},{default:_(({row:e})=>[y(t,{onClick:a=>(e=>{Ye.value="edit",Object.assign(ra,{id:e.id,name:e.name,code:e.code,sort:e.sort,status:e.status,description:e.description}),Me.value=!0})(e),type:"primary",link:"",size:"small"},{default:_(()=>[...a[73]||(a[73]=[b(" 编辑 ",-1)])]),_:1},8,["onClick"]),y(t,{onClick:a=>(async e=>{if(e.productCount>0)j.warning("该分类下还有商品，无法删除");else try{await q.confirm(`确定要删除分类"${e.name}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await $e.deleteCategory(e.id),j.success("删除成功"),Oe.addNotification({type:"PRODUCT_CATEGORY_DELETED",title:"分类删除",content:`商品分类"${e.name}"已删除`,data:{categoryId:e.id,categoryName:e.name,categoryCode:e.code,timestamp:(new Date).toISOString()},link:"/product/list"}),await lt()}catch(a){"cancel"!==a&&(console.error("删除分类失败:",a),j.error("删除失败，请重试"))}})(e),type:"danger",link:"",size:"small"},{default:_(()=>[...a[74]||(a[74]=[b(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"]),y(mt,{modelValue:Me.value,"onUpdate:modelValue":a[29]||(a[29]=e=>Me.value=e),title:"add"===Ye.value?"添加分类":"编辑分类",width:"500px","before-close":at},{footer:_(()=>[g("span",we,[y(t,{onClick:at},{default:_(()=>[...a[77]||(a[77]=[b("取消",-1)])]),_:1}),y(t,{onClick:Xa,type:"primary",loading:Ee.value},{default:_(()=>[...a[78]||(a[78]=[b(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:_(()=>[y(T,{ref_key:"categoryFormRef",ref:ma,model:ra,rules:ca,"label-width":"100px"},{default:_(()=>[y(d,{label:"分类名称",prop:"name"},{default:_(()=>[y(n,{modelValue:ra.name,"onUpdate:modelValue":a[24]||(a[24]=e=>ra.name=e),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),y(d,{label:"分类编码",prop:"code"},{default:_(()=>[y(n,{modelValue:ra.code,"onUpdate:modelValue":a[25]||(a[25]=e=>ra.code=e),placeholder:"请输入分类编码"},null,8,["modelValue"])]),_:1}),y(d,{label:"排序",prop:"sort"},{default:_(()=>[y(p,{modelValue:ra.sort,"onUpdate:modelValue":a[26]||(a[26]=e=>ra.sort=e),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),y(d,{label:"状态",prop:"status"},{default:_(()=>[y(pt,{modelValue:ra.status,"onUpdate:modelValue":a[27]||(a[27]=e=>ra.status=e)},{default:_(()=>[y(ut,{value:"active"},{default:_(()=>[...a[75]||(a[75]=[b("启用",-1)])]),_:1}),y(ut,{value:"inactive"},{default:_(()=>[...a[76]||(a[76]=[b("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),y(d,{label:"描述",prop:"description"},{default:_(()=>[y(n,{modelValue:ra.description,"onUpdate:modelValue":a[28]||(a[28]=e=>ra.description=e),type:"textarea",rows:3,placeholder:"请输入分类描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),ea.value?(f(),h(gt,{key:0,"url-list":aa.value,"initial-index":ta.value,onClose:xa},null,8,["url-list","initial-index"])):w("",!0),y(mt,{modelValue:Ne.value,"onUpdate:modelValue":a[31]||(a[31]=e=>Ne.value=e),title:"批量导入商品",width:"80%",top:"5vh","before-close":Fa},{footer:_(()=>[g("div",Te,[y(t,{onClick:Fa},{default:_(()=>[...a[86]||(a[86]=[b("取消",-1)])]),_:1}),y(t,{type:"primary",onClick:La,loading:Re.value},{default:_(()=>[...a[87]||(a[87]=[b("确定导入",-1)])]),_:1},8,["loading"])])]),default:_(()=>[y(_t,{modelValue:qe.value,"onUpdate:modelValue":a[30]||(a[30]=e=>qe.value=e)},{default:_(()=>[y(ht,{label:"在线快速添加",name:"quick"},{default:_(()=>[g("div",_e,[y(t,{type:"primary",onClick:qa,icon:k(O),size:"small",style:{"margin-bottom":"16px"}},{default:_(()=>[...a[79]||(a[79]=[b(" 新增一行 ",-1)])]),_:1},8,["icon"]),y(ft,{data:je.value,border:"",style:{width:"100%"}},{default:_(()=>[y(vt,{type:"index",label:"序号",width:"60"}),y(vt,{label:"商品图片",width:"100"},{default:_(({row:e,$index:a})=>[y(yt,{class:"avatar-uploader","show-file-list":!1,"before-upload":e=>(async(e,a)=>{try{const{uploadImage:t}=await l(async()=>{const{uploadImage:e}=await import("./uploadService-CL6v6DXe.js");return{uploadImage:e}},__vite__mapDeps([0,1,2,3,4,5])),o=await t(e,"product");o.success&&o.url?(je.value[a].image=o.url,j.success("图片上传成功")):j.error(o.message||"图片上传失败")}catch(t){console.error("图片上传失败:",t),j.error("图片上传失败，请重试")}return!1})(e,a),accept:"image/*"},{default:_(()=>[e.image?(f(),v("img",{key:0,src:e.image,class:"avatar"},null,8,be)):(f(),h(o,{key:1,class:"avatar-uploader-icon"},{default:_(()=>[y(k(O))]),_:1}))]),_:2},1032,["before-upload"])]),_:1}),y(vt,{label:"商品名称","min-width":"180"},{default:_(({row:e})=>[y(n,{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,placeholder:"请输入",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"商品编码","min-width":"140"},{default:_(({row:e})=>[y(n,{modelValue:e.code,"onUpdate:modelValue":a=>e.code=a,placeholder:"自动生成",size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"分类","min-width":"140"},{default:_(({row:e})=>[y(u,{modelValue:e.categoryId,"onUpdate:modelValue":a=>e.categoryId=a,placeholder:"请选择",size:"small",style:{width:"100%"}},{default:_(()=>[(f(!0),v(V,null,P(ia.value,e=>(f(),h(c,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"单位","min-width":"120"},{default:_(({row:e})=>[y(u,{modelValue:e.unit,"onUpdate:modelValue":a=>e.unit=a,placeholder:"请选择",size:"small","allow-create":"",filterable:"",style:{width:"100%"}},{default:_(()=>[y(c,{label:"件",value:"件"}),y(c,{label:"盒",value:"盒"}),y(c,{label:"瓶",value:"瓶"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"销售价","min-width":"120"},{default:_(({row:e})=>[y(p,{modelValue:e.price,"onUpdate:modelValue":a=>e.price=a,min:0,precision:2,size:"small",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"成本价","min-width":"120"},{default:_(({row:e})=>[y(p,{modelValue:e.costPrice,"onUpdate:modelValue":a=>e.costPrice=a,min:0,precision:2,size:"small",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"库存","min-width":"100"},{default:_(({row:e})=>[y(p,{modelValue:e.stock,"onUpdate:modelValue":a=>e.stock=a,min:0,size:"small",style:{width:"100%"},"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"状态","min-width":"110"},{default:_(({row:e})=>[y(u,{modelValue:e.status,"onUpdate:modelValue":a=>e.status=a,size:"small",style:{width:"100%"}},{default:_(()=>[y(c,{label:"上架",value:"active"}),y(c,{label:"下架",value:"inactive"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),y(vt,{label:"操作",width:"80",fixed:"right"},{default:_(({$index:e})=>[y(t,{type:"danger",link:"",size:"small",onClick:a=>{return t=e,void je.value.splice(t,1);var t}},{default:_(()=>[...a[80]||(a[80]=[b(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),y(ht,{label:"表格导入",name:"excel"},{default:_(()=>[g("div",ke,[y(wt,{title:"导入说明",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:_(()=>[...a[81]||(a[81]=[g("p",null,"1. 请先下载模板文件，按照模板格式填写商品信息",-1),g("p",null,"2. 支持.xlsx格式的Excel文件",-1),g("p",null,"3. 必填字段：商品名称、销售价、库存",-1)])]),_:1}),g("div",Ce,[y(t,{type:"success",onClick:ja,icon:k(D)},{default:_(()=>[...a[82]||(a[82]=[b("下载模板",-1)])]),_:1},8,["icon"]),y(yt,{"auto-upload":!1,"on-change":Aa,"show-file-list":!1,accept:".xlsx"},{default:_(()=>[y(t,{type:"primary",icon:k(U)},{default:_(()=>[...a[83]||(a[83]=[b("选择文件",-1)])]),_:1},8,["icon"])]),_:1})]),Ae.value?(f(),v("div",Ve,[y(st,{type:"success"},{default:_(()=>[b(C(Ae.value),1)]),_:1}),y(t,{type:"text",onClick:Ba},{default:_(()=>[...a[84]||(a[84]=[b("清除",-1)])]),_:1})])):w("",!0),Be.value.length>0?(f(),v("div",Pe,[a[85]||(a[85]=g("h4",null,"数据预览（前10条）",-1)),y(ft,{data:Be.value.slice(0,10),border:"",style:{width:"100%"}},{default:_(()=>[y(vt,{prop:"name",label:"商品名称"}),y(vt,{prop:"code",label:"商品编码"}),y(vt,{prop:"unit",label:"单位"}),y(vt,{prop:"price",label:"销售价"}),y(vt,{prop:"stock",label:"库存"})]),_:1},8,["data"]),g("p",xe,"共 "+C(Be.value.length)+" 条数据",1)])):w("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-029e797b"]]);export{Se as default};
