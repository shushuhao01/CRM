import{aw as e,r as l,e as a,l as t,w as s,b as r,ag as o,M as n,q as d,O as i,p as u,U as c,a7 as m,S as p,m as v,F as g,a9 as f,u as h,J as y,Q as b,T as w,aC as _,aA as V,Z as A,a8 as x,P as k,V as D}from"./vendor-BtukhyiH.js";import{E as U,b as E,H as q,I,J as T,s as G,K as C}from"./elementPlus-DxaqjplL.js";import{_ as O,u as S,h as P,i as z,b as $,j as M,c as N,k as B}from"./index-BGtT17ll.js";import{c as H}from"./customerTags-DhzQtIp-.js";import{g as F,a as j,b as R,c as Y}from"./addressData-BYEdhjmU.js";import"./utils-DfI7e5Rl.js";const L=e("improvementGoals",()=>{const e=l([{id:"1",label:"å‡è‚¥ç˜¦èº«",value:"å‡è‚¥ç˜¦èº«",isDefault:!0,order:1,createdAt:new Date,updatedAt:new Date},{id:"2",label:"å¢è‚Œå¡‘å½¢",value:"å¢è‚Œå¡‘å½¢",isDefault:!0,order:2,createdAt:new Date,updatedAt:new Date},{id:"3",label:"æ”¹å–„ç¡çœ ",value:"æ”¹å–„ç¡çœ ",isDefault:!0,order:3,createdAt:new Date,updatedAt:new Date},{id:"4",label:"æé«˜å…ç–«åŠ›",value:"æé«˜å…ç–«åŠ›",isDefault:!0,order:4,createdAt:new Date,updatedAt:new Date},{id:"5",label:"è°ƒç†è‚ èƒƒ",value:"è°ƒç†è‚ èƒƒ",isDefault:!0,order:5,createdAt:new Date,updatedAt:new Date},{id:"6",label:"ç¾å®¹å…»é¢œ",value:"ç¾å®¹å…»é¢œ",isDefault:!0,order:6,createdAt:new Date,updatedAt:new Date},{id:"7",label:"å…¶ä»–",value:"å…¶ä»–",isDefault:!0,order:7,createdAt:new Date,updatedAt:new Date}]),t=a(()=>e.value.sort((e,l)=>e.order-l.order)),s=a(()=>e.value.filter(e=>!e.isDefault).sort((e,l)=>e.order-l.order)),r=a(()=>e.value.filter(e=>e.isDefault).sort((e,l)=>e.order-l.order)),o=()=>{try{localStorage.setItem("improvement-goals",JSON.stringify(e.value))}catch(l){console.error("ä¿å­˜æ”¹å–„é—®é¢˜é€‰é¡¹å¤±è´¥:",l)}};return{goals:e,allGoals:t,customGoals:s,defaultGoals:r,addGoal:l=>{const a=e.value.length>0?Math.max(...e.value.map(e=>e.order)):0,t={id:Date.now().toString(),label:l.trim(),value:l.trim(),isDefault:!1,order:a+1,createdAt:new Date,updatedAt:new Date};if(e.value.some(e=>e.value===t.value))throw new Error("è¯¥æ”¹å–„é—®é¢˜é€‰é¡¹å·²å­˜åœ¨");return e.value.push(t),o(),t},removeGoal:l=>{const a=e.value.findIndex(e=>e.id===l);if(-1===a)throw new Error("æ”¹å–„é—®é¢˜é€‰é¡¹ä¸å­˜åœ¨");const t=e.value[a];return e.value.splice(a,1),o(),t},updateGoal:(l,a)=>{const t=e.value.find(e=>e.id===l);if(!t)throw new Error("æ”¹å–„é—®é¢˜é€‰é¡¹ä¸å­˜åœ¨");const s=a.trim();if(e.value.some(e=>e.id!==l&&e.value===s))throw new Error("è¯¥æ”¹å–„é—®é¢˜é€‰é¡¹å·²å­˜åœ¨");return t.label=s,t.value=s,t.updatedAt=new Date,o(),t},getGoalById:l=>e.value.find(e=>e.id===l),reorderGoals:l=>{l.forEach((l,a)=>{const t=e.value.find(e=>e.id===l);t&&(t.order=a+1,t.updatedAt=new Date)}),o()},resetToDefault:()=>{e.value=e.value.filter(e=>e.isDefault)},loadFromStorage:()=>{try{const l=localStorage.getItem("improvement-goals");if(l){const a=JSON.parse(l).map((e,l)=>({...e,order:e.order||l+1,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));e.value=a}}catch(l){console.error("åŠ è½½æ”¹å–„é—®é¢˜é€‰é¡¹å¤±è´¥:",l)}},saveToStorage:o,startAutoSave:()=>{}}}),Z={PHONE:/^1[3-9]\d{9}$/,EMAIL:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,PASSWORD:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,20}$/,CHINESE_NAME:/^[\u4e00-\u9fa5a-zA-Z\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\sÂ·.'-]{2,50}$/},J={required:(e="æ­¤é¡¹ä¸ºå¿…å¡«é¡¹")=>({required:!0,message:e,trigger:"blur"}),phone:(e="è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·")=>({pattern:Z.PHONE,message:e,trigger:"blur"}),email:(e="è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±åœ°å€")=>({pattern:Z.EMAIL,message:e,trigger:"blur"}),password:(e="å¯†ç å¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—ï¼Œé•¿åº¦8-20ä½")=>({pattern:Z.PASSWORD,message:e,trigger:"blur"}),chineseName:(e="è¯·è¾“å…¥æ­£ç¡®çš„å§“åï¼ˆ2-50ä¸ªå­—ç¬¦ï¼‰")=>({pattern:Z.CHINESE_NAME,message:e,trigger:"blur"}),length:(e,l,a)=>({min:e,max:l,message:a||`é•¿åº¦åº”åœ¨${e}-${l}ä¸ªå­—ç¬¦ä¹‹é—´`,trigger:"blur"}),number:(e,l)=>({type:"number",min:e,max:l,message:`è¯·è¾“å…¥${void 0!==e?`${e}åˆ°`:""}${void 0!==l?l:""}ä¹‹é—´çš„æ•°å­—`,trigger:"blur"})},K={class:"manager-content"},Q={class:"add-section"},W={class:"add-form"},X={class:"goals-list"},ee={class:"goals-grid"},le=["onDragstart","onDrop"],ae={class:"goal-content"},te={key:0,class:"goal-display"},se={class:"goal-label"},re={key:0,class:"default-tag"},oe={key:1,class:"goal-edit"},ne={class:"goal-actions"},de={class:"stats-section"},ie={class:"stats"},ue={class:"dialog-footer"},ce=O(t({__name:"ImprovementGoalsManager",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e,_=a,V=L(),A=l(t.modelValue),x=l(""),k=l(null),D=l(""),q=l(null),I=l(null);s(()=>t.modelValue,e=>{A.value=e}),s(A,e=>{_("update:modelValue",e)});const T=()=>{A.value=!1,O()},G=()=>{const e=x.value.trim();if(e)try{V.addGoal(e),V.saveToStorage(),x.value="",U.success("æ·»åŠ æˆåŠŸ")}catch(l){U.error(l instanceof Error?l.message:"æ·»åŠ å¤±è´¥")}else U.warning("è¯·è¾“å…¥æ”¹å–„é—®é¢˜é€‰é¡¹")},C=e=>{const l=D.value.trim();if(l)try{V.updateGoal(e,l),V.saveToStorage(),O(),U.success("ç¼–è¾‘æˆåŠŸ")}catch(a){U.error(a instanceof Error?a.message:"ç¼–è¾‘å¤±è´¥")}else U.warning("è¯·è¾“å…¥æ”¹å–„é—®é¢˜é€‰é¡¹")},O=()=>{k.value=null,D.value=""},S=async()=>{try{await E.confirm("ç¡®å®šè¦é‡ç½®ä¸ºé»˜è®¤é€‰é¡¹å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰è‡ªå®šä¹‰çš„æ”¹å–„é—®é¢˜é€‰é¡¹ã€‚","é‡ç½®ç¡®è®¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),V.resetToDefault(),V.saveToStorage(),U.success("é‡ç½®æˆåŠŸ")}catch{}},P=()=>{q.value=null,I.value=null};return r(()=>{V.loadFromStorage()}),(e,l)=>{const a=o("el-input"),t=o("el-button"),s=o("el-popconfirm"),r=o("el-divider"),_=o("el-dialog");return d(),n(_,{modelValue:A.value,"onUpdate:modelValue":l[3]||(l[3]=e=>A.value=e),title:"æ”¹å–„é—®é¢˜ç®¡ç†",width:"600px","before-close":T,class:"improvement-goals-manager"},{footer:i(()=>[u("div",ue,[c(t,{onClick:T},{default:i(()=>[...l[12]||(l[12]=[p("å…³é—­",-1)])]),_:1}),c(t,{type:"danger",onClick:S},{default:i(()=>[...l[13]||(l[13]=[p("é‡ç½®ä¸ºé»˜è®¤",-1)])]),_:1})])]),default:i(()=>[u("div",K,[u("div",Q,[l[5]||(l[5]=u("h4",null,"æ·»åŠ æ–°çš„æ”¹å–„é—®é¢˜é€‰é¡¹",-1)),u("div",W,[c(a,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value=e),placeholder:"è¯·è¾“å…¥æ–°çš„æ”¹å–„é—®é¢˜é€‰é¡¹",maxlength:"20","show-word-limit":"",onKeyup:m(G,["enter"])},null,8,["modelValue"]),c(t,{type:"primary",onClick:G,disabled:!x.value.trim()},{default:i(()=>[...l[4]||(l[4]=[p(" æ·»åŠ  ",-1)])]),_:1},8,["disabled"])])]),u("div",X,[l[11]||(l[11]=u("h4",null,[p("ç°æœ‰æ”¹å–„é—®é¢˜é€‰é¡¹ "),u("span",{class:"sort-hint"},"ï¼ˆæ‹–æ‹½å¯è°ƒæ•´é¡ºåºï¼‰")],-1)),u("div",ee,[(d(!0),v(g,null,f(h(V).allGoals,e=>(d(),v("div",{key:e.id,class:y(["goal-item",{"is-default":e.isDefault,dragging:q.value===e.id}]),draggable:"true",onDragstart:l=>((e,l)=>{q.value=l.id,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",l.id))})(l,e),onDragover:l[2]||(l[2]=e=>{return(l=e).preventDefault(),void(l.dataTransfer&&(l.dataTransfer.dropEffect="move"));var l}),onDrop:l=>((e,l)=>{e.preventDefault();const a=q.value;if(a&&a!==l.id)try{const e=V.allGoals,t=e.findIndex(e=>e.id===a),s=e.findIndex(e=>e.id===l.id);if(-1===t||-1===s)return;const r=[...e],[o]=r.splice(t,1);r.splice(s,0,o);const n=r.map(e=>e.id);V.reorderGoals(n),U.success("æ’åºå·²æ›´æ–°")}catch(t){U.error("æ’åºå¤±è´¥")}})(l,e),onDragend:P},[u("div",ae,[l[6]||(l[6]=u("div",{class:"drag-handle",title:"æ‹–æ‹½æ’åº"},[u("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},[u("circle",{cx:"4",cy:"4",r:"1"}),u("circle",{cx:"4",cy:"8",r:"1"}),u("circle",{cx:"4",cy:"12",r:"1"}),u("circle",{cx:"8",cy:"4",r:"1"}),u("circle",{cx:"8",cy:"8",r:"1"}),u("circle",{cx:"8",cy:"12",r:"1"}),u("circle",{cx:"12",cy:"4",r:"1"}),u("circle",{cx:"12",cy:"8",r:"1"}),u("circle",{cx:"12",cy:"12",r:"1"})])],-1)),k.value&&k.value===e.id?(d(),v("div",oe,[c(a,{modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=e=>D.value=e),size:"small",onKeyup:m(l=>C(e.id),["enter"]),onBlur:O},null,8,["modelValue","onKeyup"])])):(d(),v("div",te,[u("span",se,w(e.label),1),e.isDefault?(d(),v("span",re,"é»˜è®¤")):b("",!0)]))]),u("div",ne,[k.value&&k.value===e.id?b("",!0):(d(),n(t,{key:0,type:"text",size:"small",onClick:l=>(e=>{k.value=e.id,D.value=e.label})(e)},{default:i(()=>[...l[7]||(l[7]=[p(" ç¼–è¾‘ ",-1)])]),_:1},8,["onClick"])),k.value===e.id?(d(),n(t,{key:1,type:"text",size:"small",onClick:l=>C(e.id)},{default:i(()=>[...l[8]||(l[8]=[p(" ä¿å­˜ ",-1)])]),_:1},8,["onClick"])):b("",!0),k.value===e.id?(d(),n(t,{key:2,type:"text",size:"small",onClick:O},{default:i(()=>[...l[9]||(l[9]=[p(" å–æ¶ˆ ",-1)])]),_:1})):b("",!0),k.value&&k.value===e.id?b("",!0):(d(),n(s,{key:3,title:e.isDefault?"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé»˜è®¤æ”¹å–„é—®é¢˜é€‰é¡¹å—ï¼Ÿåˆ é™¤åå°†æ— æ³•æ¢å¤ã€‚":"ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ”¹å–„é—®é¢˜é€‰é¡¹å—ï¼Ÿ",onConfirm:l=>(e=>{try{V.removeGoal(e),V.saveToStorage(),U.success("åˆ é™¤æˆåŠŸ")}catch(l){U.error(l instanceof Error?l.message:"åˆ é™¤å¤±è´¥")}})(e.id)},{reference:i(()=>[c(t,{type:"text",size:"small",class:y(["delete-btn",{"default-delete":e.isDefault}])},{default:i(()=>[...l[10]||(l[10]=[p(" åˆ é™¤ ",-1)])]),_:1},8,["class"])]),_:2},1032,["title","onConfirm"]))])],42,le))),128))])]),u("div",de,[c(r),u("div",ie,[u("span",null,"æ€»è®¡ï¼š"+w(h(V).allGoals.length)+" ä¸ªé€‰é¡¹",1),u("span",null,"é»˜è®¤ï¼š"+w(h(V).defaultGoals.length)+" ä¸ª",1),u("span",null,"è‡ªå®šä¹‰ï¼š"+w(h(V).customGoals.length)+" ä¸ª",1)])])])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-0213883d"]]),me={class:"customer-form"},pe={class:"page-header"},ve={class:"form-section"},ge={class:"phone-input-group"},fe={key:0,class:"verify-success-inline"},he={key:0,class:"verify-result"},ye={key:0},be={key:1},we={key:2,class:"permission-warning"},_e={style:{color:"#e6a23c","font-weight":"500"}},Ve={style:{"margin-top":"12px"}},Ae={class:"form-section"},xe={class:"address-recognition-inline"},ke={class:"form-section"},De={class:"improvement-goals-section"},Ue={class:"form-section"},Ee={class:"form-section"},qe={class:"form-footer"},Ie=O(t({__name:"Add",setup(e){const t=_(),m=V(),y=S();P();const O=z(),Z=$(),K=L();M();const Q=N(m),W=l(!1),X=l(),ee=l(!1),le=l(!1),ae=l(null),te=a(()=>"CustomerEdit"===t.name),se=a(()=>y.isLoggedIn&&y.currentUser),re=a(()=>!te.value&&(!ne.phone||""===ne.phone.trim()||(!ae.value||("warning"===ae.value.type||("error"===ae.value.type||"success"!==ae.value.type))))),oe=a(()=>re.value?te.value?"":ne.phone&&""!==ne.phone.trim()?ae.value?"warning"===ae.value.type?'è¯¥æ‰‹æœºå·å·²å­˜åœ¨å®¢æˆ·è®°å½•ï¼Œæ— æ³•é‡å¤åˆ›å»ºã€‚è¯·ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"æŸ¥çœ‹å·²æœ‰å®¢æˆ·ä¿¡æ¯ã€‚':"error"===ae.value.type?"å®¢æˆ·éªŒè¯å¤±è´¥ï¼Œè¯·é‡æ–°éªŒè¯":"è¯·å…ˆéªŒè¯å®¢æˆ·æ‰‹æœºå·å¯ä»¥åˆ›å»º":"è¯·å…ˆéªŒè¯å®¢æˆ·æ‰‹æœºå·":"è¯·å…ˆè¾“å…¥æ‰‹æœºå·":"");se.value||te.value||(U.error("æ‚¨æ²¡æœ‰åˆ›å»ºå®¢æˆ·çš„æƒé™"),Q.push("/customer/list"));const ne=A({name:"",gender:"",phone:"",age:null,fanAcquisitionTime:"",email:"",wechat:"",height:null,weight:null,province:"",city:"",district:"",street:"",detailAddress:"",isOverseas:!1,overseasAddress:"",medicalHistory:"",improvementGoals:[],otherGoals:"",level:"bronze",status:"active",source:"",tags:[],salesPerson:y.currentUser?.name||"",remark:""}),de=l([]),ie=l([]),ue=l([]),Ie=l([]),Te=l(""),Ge=l(!1),Ce=()=>{const e=Te.value.trim();if(e){Ge.value=!0;try{const l=F();let a="",t="",s="",r=e;for(const o of l){const l=o.label.replace(/çœ|å¸‚|è‡ªæ²»åŒº|ç‰¹åˆ«è¡Œæ”¿åŒº/g,"");if(e.includes(o.label)||e.includes(l)){a=o.value,r=e.replace(o.label,"").replace(l,"");break}}if(a){const e=j(a);for(const l of e){const e=l.label.replace(/å¸‚|åœ°åŒº|è‡ªæ²»å·|ç›Ÿ/g,"");if(r.includes(l.label)||r.includes(e)){t=l.value,r=r.replace(l.label,"").replace(e,"");break}}}if(a&&t){const e=R(a,t);for(const l of e){const e=l.label.replace(/åŒº|å¿|å¸‚/g,"");if(r.includes(l.label)||r.includes(e)){s=l.value,r=r.replace(l.label,"").replace(e,"");break}}}r=r.replace(/1[3-9]\d{9}/g,""),r=r.replace(/^[\s,ï¼Œã€\-]+/,"").trim(),a?(ne.province=a,ie.value=j(a),t&&(ne.city=t,ue.value=R(a,t),s&&(ne.district=s,Ie.value=Y(a,t,s))),r&&(ne.detailAddress=r),U.success("åœ°å€è¯†åˆ«æˆåŠŸï¼Œå·²è‡ªåŠ¨å¡«å……")):U.warning("æœªèƒ½è¯†åˆ«çœä»½ä¿¡æ¯ï¼Œè¯·æ£€æŸ¥åœ°å€æ ¼å¼")}catch(l){console.error("åœ°å€è¯†åˆ«å¤±è´¥:",l),U.error("åœ°å€è¯†åˆ«å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¡«å†™")}finally{Ge.value=!1}}else U.warning("è¯·è¾“å…¥éœ€è¦è¯†åˆ«çš„åœ°å€")},Oe=e=>{ne.city="",ne.district="",ne.street="",ie.value=j(e),ue.value=[],Ie.value=[]},Se=e=>{ne.district="",ne.street="",ue.value=R(ne.province,e),Ie.value=[]},Pe=e=>{ne.street="",Ie.value=Y(ne.province,ne.city,e)},ze=e=>{e?(ne.province="",ne.city="",ne.district="",ne.street="",ne.detailAddress="",ie.value=[],ue.value=[],Ie.value=[]):ne.overseasAddress=""},$e=(e,l)=>{if(!l||!e||0===e.length)return"";const a=e.find(e=>e.value===l);return a?.label||l},Me=()=>{if(ne.isOverseas)return ne.overseasAddress||"";return[$e(de.value,ne.province),$e(ie.value,ne.city),$e(ue.value,ne.district),$e(Ie.value,ne.street),ne.detailAddress].filter(Boolean).map(e=>e.trim()).join("")};l([{label:"å¼ ä¸‰",value:"zhangsan"},{label:"æå››",value:"lisi"},{label:"ç‹äº”",value:"wangwu"},{label:"èµµå…­",value:"zhaoliu"},{label:"é’±ä¸ƒ",value:"qianqi"}]);const Ne=l([]),Be=l(!1),He={name:[J.required("è¯·è¾“å…¥å®¢æˆ·å§“å"),J.chineseName("è¯·è¾“å…¥æ­£ç¡®çš„å§“åï¼ˆæ”¯æŒä¸­è‹±æ–‡ç­‰å¤šè¯­è¨€ï¼Œ2-50ä¸ªå­—ç¬¦ï¼‰")],phone:[J.required("è¯·è¾“å…¥æ‰‹æœºå·"),J.phone("è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·æ ¼å¼")],email:[J.email("è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼")],gender:[J.required("è¯·é€‰æ‹©æ€§åˆ«")],age:[{required:!0,message:"è¯·è¾“å…¥å¹´é¾„",trigger:"blur"},{type:"number",min:1,max:120,message:"å¹´é¾„åº”åœ¨1-120ä¹‹é—´",trigger:"blur"}],fanAcquisitionTime:[J.required("è¯·é€‰æ‹©è¿›ç²‰æ—¶é—´")],height:[{required:!0,message:"è¯·è¾“å…¥èº«é«˜",trigger:"blur"},{type:"number",min:50,max:250,message:"èº«é«˜åº”åœ¨50-250cmä¹‹é—´",trigger:"blur"}],weight:[{required:!0,message:"è¯·è¾“å…¥ä½“é‡",trigger:"blur"},{type:"number",min:20,max:300,message:"ä½“é‡åº”åœ¨20-300kgä¹‹é—´",trigger:"blur"}],level:[{required:!0,message:"è¯·é€‰æ‹©å®¢æˆ·ç­‰çº§",trigger:"change"}],status:[{required:!0,message:"è¯·é€‰æ‹©å®¢æˆ·çŠ¶æ€",trigger:"change"}],medicalHistory:[{max:500,message:"ç–¾ç—…å²é•¿åº¦ä¸èƒ½è¶…è¿‡500ä¸ªå­—ç¬¦",trigger:"blur"}],salesPerson:[{required:!0,message:"è¯·é€‰æ‹©è´Ÿè´£é”€å”®",trigger:"change"}],province:[{validator:(e,l,a)=>{ne.isOverseas||l?a():a(new Error("è¯·é€‰æ‹©çœä»½"))},trigger:"change"}],city:[{validator:(e,l,a)=>{ne.isOverseas||l?a():a(new Error("è¯·é€‰æ‹©åŸå¸‚"))},trigger:"change"}],district:[{validator:(e,l,a)=>{ne.isOverseas||l?a():a(new Error("è¯·é€‰æ‹©åŒºå¿"))},trigger:"change"}],street:[{min:1,max:100,message:"è¡—é“é•¿åº¦åº”åœ¨1-100ä¸ªå­—ç¬¦ä¹‹é—´",trigger:"blur"}],detailAddress:[{validator:(e,l,a)=>{ne.isOverseas||l?!ne.isOverseas&&l&&(l.length<5||l.length>200)?a(new Error("è¯¦ç»†åœ°å€é•¿åº¦åº”åœ¨5-200ä¸ªå­—ç¬¦ä¹‹é—´")):a():a(new Error("è¯·è¾“å…¥è¯¦ç»†åœ°å€"))},trigger:"blur"}],overseasAddress:[{validator:(e,l,a)=>{ne.isOverseas&&!l?a(new Error("è¯·è¾“å…¥å¢ƒå¤–åœ°å€")):ne.isOverseas&&l&&(l.length<5||l.length>200)?a(new Error("å¢ƒå¤–åœ°å€é•¿åº¦åº”åœ¨5-200ä¸ªå­—ç¬¦ä¹‹é—´")):a()},trigger:"blur"}],address:[{min:5,max:200,message:"åœ°å€é•¿åº¦åº”åœ¨5-200ä¸ªå­—ç¬¦ä¹‹é—´",trigger:"blur"}],wechat:[{min:3,max:50,message:"å¾®ä¿¡å·é•¿åº¦åº”åœ¨3-50ä¸ªå­—ç¬¦ä¹‹é—´",trigger:"blur"}],qq:[{type:"number",min:1e4,max:9999999999,message:"è¯·è¾“å…¥æ­£ç¡®çš„QQå·",trigger:"blur"}],improvementGoals:[{required:!0,validator:(e,l,a)=>{l&&0!==l.length?a():a(new Error("è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ”¹å–„é—®é¢˜"))},trigger:"change"}],otherGoals:[{validator:(e,l,a)=>{!ne.improvementGoals.includes("å…¶ä»–")||l&&""!==l.trim()?a():a(new Error("é€‰æ‹©å…¶ä»–æ—¶ï¼Œè¯·å¡«å†™å…·ä½“çš„æ”¹å–„ç›®æ ‡"))},trigger:"blur"}]},Fe=async()=>{if(ne.phone&&11===ne.phone.length){ee.value=!0,ae.value=null;try{const e=await B.checkExists(ne.phone);if(!e.success)return console.error("APIè°ƒç”¨å¤±è´¥:",e.message),ae.value={type:"error",message:`éªŒè¯å¤±è´¥: ${e.message}`},void U.error(`éªŒè¯å¤±è´¥: ${e.message}`);if(e.data){const l=e.data;ae.value={type:"warning",message:"è¯¥æ‰‹æœºå·å·²å­˜åœ¨å®¢æˆ·è®°å½•",owner:l.creatorName||l.name,createTime:l.createTime,customerId:l.id},console.log("å®¢æˆ·å·²å­˜åœ¨:",l)}else ae.value={type:"success",message:"è¯¥æ‰‹æœºå·å¯ä»¥åˆ›å»ºæ–°å®¢æˆ·"},console.log("å®¢æˆ·ä¸å­˜åœ¨ï¼Œå¯ä»¥åˆ›å»º");console.log("=== éªŒè¯å®¢æˆ·å®Œæˆ ===")}catch(e){console.error("éªŒè¯å®¢æˆ·å¤±è´¥:",e);let l="éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•";e instanceof TypeError&&e.message.includes("Failed to fetch")?l="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•":e instanceof Error&&(l=`éªŒè¯å¤±è´¥: ${e.message}`),ae.value={type:"error",message:l},U.error(l)}finally{ee.value=!1}}else U.warning("è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·")},je=()=>{ne.phone&&Q.push({path:"/data/search",query:{keyword:ne.phone}})},Re=async()=>{ne.phone&&11===ne.phone.length?await Fe():ae.value=null},Ye=async()=>{if(X.value){console.log("ğŸ”¥ handleSubmit è¢«è°ƒç”¨");try{console.log("å¼€å§‹è¡¨å•éªŒè¯...");if(!(await X.value.validate()))return void console.log("è¡¨å•éªŒè¯å¤±è´¥");if(console.log("è¡¨å•éªŒè¯é€šè¿‡"),W.value=!0,te.value)console.log("æ›´æ–°å®¢æˆ·ä¿¡æ¯:",ne);else{console.log("=== å¼€å§‹ä¿å­˜å®¢æˆ· ==="),console.log("è¡¨å•æ•°æ®:",ne),console.log("=== æäº¤å‰æœ€ç»ˆæ£€æŸ¥ ===");const e=await B.checkExists(ne.phone);if(console.log("æœ€ç»ˆæ£€æŸ¥å®¢æˆ·æ˜¯å¦å­˜åœ¨å“åº”:",e),e.data){const l=e.data;throw console.log("å®¢æˆ·å·²å­˜åœ¨ï¼ŒæŠ›å‡ºé”™è¯¯:",l),new Error(`æ‰‹æœºå· ${ne.phone} å·²å­˜åœ¨ï¼Œå®¢æˆ·å§“åï¼š${l.name}`)}console.log("âœ… æ£€æŸ¥é€šè¿‡ï¼Œå®¢æˆ·ä¸å­˜åœ¨ï¼Œç»§ç»­ä¿å­˜");const l=Me(),a={name:ne.name,phone:ne.phone,age:ne.age||0,address:l,province:ne.province,city:ne.city,district:ne.district,street:ne.street,detailAddress:ne.detailAddress,overseasAddress:ne.overseasAddress,level:ne.level,status:ne.status,salesPersonId:y.currentUser?.id||"admin",createdBy:y.currentUser?.id||"admin",wechat:ne.wechat,wechatId:ne.wechat,email:ne.email,fanAcquisitionTime:ne.fanAcquisitionTime,company:"",position:"",source:ne.source,tags:ne.tags,remarks:ne.remark,remark:ne.remark,height:ne.height,weight:ne.weight,gender:ne.gender,medicalHistory:ne.medicalHistory,improvementGoals:ne.improvementGoals,otherGoals:ne.otherGoals};console.log("å‡†å¤‡ä¿å­˜çš„å®¢æˆ·æ•°æ®:",a),console.log("=== è°ƒç”¨ customerApi.create() ä¿å­˜å®¢æˆ·åˆ°æ•°æ®åº“ ===");const t=await B.create(a);if(console.log("APIå“åº”:",t),!t.success)throw console.error("âŒ APIä¿å­˜å¤±è´¥:",t.message),new Error(t.message||"APIè¯·æ±‚å¤±è´¥ï¼Œå®¢æˆ·æœªå†™å…¥æ•°æ®åº“");if(!t.data||!t.data.id)throw console.warn("âš ï¸ APIè¿”å›æˆåŠŸä½†æ²¡æœ‰è¿”å›å®¢æˆ·IDï¼Œå¯èƒ½ä¿å­˜å¤±è´¥"),new Error("ä¿å­˜å¤±è´¥ï¼šæœåŠ¡å™¨æœªè¿”å›å®¢æˆ·ID");console.log("âœ… å®¢æˆ·å·²æˆåŠŸå†™å…¥æ•°æ®åº“!"),console.log("âœ… å®¢æˆ·ID:",t.data.id),console.log("âœ… å®¢æˆ·å§“å:",t.data.name),console.log("âœ… å®¢æˆ·æ‰‹æœº:",t.data.phone),console.log("=== å®¢æˆ·ä¿å­˜åˆ°æ•°æ®åº“å®Œæˆ ==="),Z.sendMessage(Z.MessageType.CUSTOMER_CREATED,`å®¢æˆ· ${ne.name}ï¼ˆ${ne.phone}ï¼‰æ·»åŠ æˆåŠŸ`,{relatedId:t.data.id,relatedType:"customer",actionUrl:"/customer/list"})}console.log("âœ… å®¢æˆ·ä¿å­˜æµç¨‹å…¨éƒ¨å®Œæˆï¼Œå‡†å¤‡è·³è½¬"),U.success({message:te.value?"å®¢æˆ·ä¿¡æ¯æ›´æ–°æˆåŠŸ":"å®¢æˆ·æ·»åŠ æˆåŠŸï¼Œå³å°†è·³è½¬åˆ°åˆ—è¡¨...",duration:2e3}),console.log("ç­‰å¾…1ç§’åè·³è½¬..."),await new Promise(e=>setTimeout(e,1e3)),console.log("ğŸš€ è·³è½¬åˆ°å®¢æˆ·åˆ—è¡¨é¡µé¢"),Q.push("/customer/list?refresh=true")}catch(e){console.error("âŒ ä¿å­˜å®¢æˆ·å¤±è´¥:",e),U.error({message:e instanceof Error?e.message:"æ·»åŠ å®¢æˆ·å¤±è´¥",duration:3e3})}finally{W.value=!1}}},Le=async()=>{try{await E.confirm("ç¡®å®šè¦å–æ¶ˆå—ï¼Ÿæœªä¿å­˜çš„æ•°æ®å°†ä¸¢å¤±","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"ç»§ç»­ç¼–è¾‘",type:"warning"}),Q.push("/customer/list")}catch(e){}},Ze=async()=>{if(console.log("=== handleSaveAndOrder å¼€å§‹ ==="),console.log("shouldDisableSave:",re.value),console.log("customerVerifyResult:",ae.value),!X.value)return console.error("customerFormRef ä¸å­˜åœ¨"),void U.error("è¡¨å•å¼•ç”¨ä¸å­˜åœ¨ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");try{console.log("å¼€å§‹è¡¨å•éªŒè¯...");if(!(await X.value.validate().catch(e=>(console.log("è¡¨å•éªŒè¯é”™è¯¯:",e),!1))))return console.log("è¡¨å•éªŒè¯å¤±è´¥"),void U.warning("è¯·å¡«å†™å®Œæ•´çš„å¿…å¡«ä¿¡æ¯");console.log("è¡¨å•éªŒè¯é€šè¿‡"),W.value=!0;try{console.log("æ£€æŸ¥å®¢æˆ·æ˜¯å¦å·²å­˜åœ¨ï¼Œæ‰‹æœºå·:",ne.phone);const e=await B.checkExists(ne.phone);if(console.log("å®¢æˆ·å­˜åœ¨æ£€æŸ¥ç»“æœ:",e),e.data){const l=e.data;console.log("å®¢æˆ·å·²å­˜åœ¨ï¼Œå®¢æˆ·ä¿¡æ¯:",l),U.success("å®¢æˆ·å·²å­˜åœ¨ï¼Œæ­£åœ¨è·³è½¬åˆ°ä¸‹å•é¡µé¢...");const a=Me();return console.log("å‡†å¤‡è·³è½¬åˆ°è®¢å•é¡µé¢ï¼Œå‚æ•°:",{customerId:l.id,customerName:l.name,customerPhone:l.phone,customerAddress:l.address||a}),void Q.push({path:"/order/add",query:{customerId:l.id,customerName:l.name,customerPhone:l.phone,customerAddress:l.address||a}})}console.log("å®¢æˆ·ä¸å­˜åœ¨ï¼Œå¼€å§‹åˆ›å»ºæ–°å®¢æˆ·");const l=Me(),a=y.currentUser?.id,t=y.currentUser?.name;console.log("å½“å‰ç”¨æˆ·ä¿¡æ¯æ£€æŸ¥:",{currentUser:y.currentUser,currentUserId:a,currentUserName:t,isLoggedIn:y.isLoggedIn}),!a&&y.isLoggedIn&&(console.warn("ç”¨æˆ·å·²ç™»å½•ä½†ç”¨æˆ·IDä¸ºç©ºï¼Œå°è¯•é‡æ–°åˆå§‹åŒ–ç”¨æˆ·ä¿¡æ¯"),y.initUser());const s=y.currentUser?.id||"admin",r=y.currentUser?.name||"ç³»ç»Ÿç®¡ç†å‘˜";console.log("æœ€ç»ˆä½¿ç”¨çš„ç”¨æˆ·ä¿¡æ¯:",{finalUserId:s,finalUserName:r});const o={name:ne.name,phone:ne.phone,age:ne.age||0,address:l,level:ne.level,status:ne.status,salesPersonId:s,createdBy:s,wechatId:ne.wechat,email:ne.email,fanAcquisitionTime:ne.fanAcquisitionTime,company:"",position:"",source:ne.source,tags:ne.tags,remarks:ne.remark,height:ne.height,weight:ne.weight,gender:ne.gender,medicalHistory:ne.medicalHistory,improvementGoals:ne.improvementGoals,otherGoals:ne.otherGoals,province:ne.province,city:ne.city,district:ne.district,street:ne.street,detailAddress:ne.detailAddress,overseasAddress:ne.overseasAddress};console.log("å‡†å¤‡åˆ›å»ºå®¢æˆ·ï¼Œæ•°æ®:",o);const n=await O.createCustomer(o);console.log("å®¢æˆ·åˆ›å»ºæˆåŠŸï¼Œæ–°å®¢æˆ·ä¿¡æ¯:",n),console.log("å®¢æˆ·å·²ä¿å­˜åˆ°æœ¬åœ°storeï¼Œå½“å‰å®¢æˆ·æ•°é‡:",O.customers.length),Z.sendMessage(Z.MessageType.CUSTOMER_CREATED,`å®¢æˆ· ${ne.name}ï¼ˆ${ne.phone}ï¼‰æ·»åŠ æˆåŠŸ`,{relatedId:o.phone,relatedType:"customer",actionUrl:"/customer/list"}),U.success("å®¢æˆ·æ·»åŠ æˆåŠŸï¼"),E.confirm("å®¢æˆ·æ·»åŠ æˆåŠŸï¼æ‚¨å¸Œæœ›ï¼š","æ“ä½œé€‰æ‹©",{confirmButtonText:"ç«‹å³ä¸ºè¯¥å®¢æˆ·ä¸‹å•",cancelButtonText:"æŸ¥çœ‹å®¢æˆ·åˆ—è¡¨",type:"success",distinguishCancelAndClose:!0}).then(()=>{console.log("ç”¨æˆ·é€‰æ‹©è·³è½¬åˆ°è®¢å•é¡µé¢ï¼Œå‚æ•°:",{customerId:n.id,customerName:ne.name,customerPhone:ne.phone,customerAddress:l}),Q.push({path:"/order/add",query:{customerId:n.id,customerName:ne.name,customerPhone:ne.phone,customerAddress:l}})}).catch(e=>{"cancel"===e&&(console.log("ç”¨æˆ·é€‰æ‹©æŸ¥çœ‹å®¢æˆ·åˆ—è¡¨"),Q.push({path:"/customer/list",query:{refresh:"true",timestamp:Date.now().toString()}}))})}finally{W.value=!1}console.log("=== handleSaveAndOrder å®Œæˆ ===")}catch(e){console.error("handleSaveAndOrder å¤±è´¥:",e),W.value=!1,U.error("ä¿å­˜å®¢æˆ·ä¿¡æ¯å¤±è´¥")}};return s(()=>ne.phone,(e,l)=>{e!==l&&ae.value&&(ae.value=null)}),r(()=>{te.value||(ne.salesPerson=y.currentUser?.name||"å½“å‰ç”¨æˆ·"),de.value=F(),(async()=>{try{Be.value=!0;const e=await H.getActiveList();Ne.value=e.data}catch(e){console.error("åŠ è½½æ ‡ç­¾å¤±è´¥:",e),U.error("åŠ è½½æ ‡ç­¾å¤±è´¥")}finally{Be.value=!1}})(),(async()=>{if(!te.value)return;const e=t.params.id;W.value=!0;try{await new Promise(e=>setTimeout(e,500));const l=await O.getCustomerById(e);l?Object.assign(ne,{name:l.name,gender:l.gender,phone:l.phone,age:l.age,email:l.email,wechatId:l.wechatId,address:l.address,level:l.level,source:l.source,tags:l.tags||[],salesPerson:l.salesPersonId,remark:l.remarks}):(U.error("å®¢æˆ·ä¸å­˜åœ¨"),Q.push("/customer/list"))}catch(l){U.error("åŠ è½½å®¢æˆ·ä¿¡æ¯å¤±è´¥"),Q.push("/customer/list")}finally{W.value=!1}})()}),(e,l)=>{const a=o("el-input"),t=o("el-button"),s=o("el-icon"),r=o("el-divider"),m=o("el-alert"),_=o("el-form-item"),V=o("el-col"),A=o("el-radio"),U=o("el-radio-group"),E=o("el-row"),O=o("el-input-number"),S=o("el-date-picker"),P=o("el-option"),z=o("el-select"),$=o("el-checkbox"),M=o("el-checkbox-group"),N=o("el-tooltip"),B=o("el-form"),H=o("el-card");return d(),v("div",me,[u("div",pe,[u("h2",null,w(te.value?"ç¼–è¾‘å®¢æˆ·":"æ–°å¢å®¢æˆ·"),1)]),c(H,{class:"form-card"},{default:i(()=>[c(B,{ref_key:"customerFormRef",ref:X,model:ne,rules:He,"label-width":"100px",size:"default"},{default:i(()=>[u("div",ve,[l[36]||(l[36]=u("h3",{class:"section-title"},"åŸºæœ¬ä¿¡æ¯",-1)),c(E,{gutter:20},{default:i(()=>[c(V,{span:8},{default:i(()=>[c(_,{label:"æ‰‹æœºå·",prop:"phone"},{default:i(()=>[u("div",ge,[c(a,{modelValue:ne.phone,"onUpdate:modelValue":l[0]||(l[0]=e=>ne.phone=e),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·",clearable:"",onBlur:Re,style:{width:"200px"}},null,8,["modelValue"]),c(t,{type:"primary",size:"default",onClick:Fe,loading:ee.value,disabled:!ne.phone||11!==ne.phone.length},{default:i(()=>[...l[28]||(l[28]=[p(" éªŒè¯å®¢æˆ· ",-1)])]),_:1},8,["loading","disabled"]),ae.value&&"success"===ae.value.type?(d(),v("span",fe,[c(s,{color:"#67c23a"},{default:i(()=>[c(h(q))]),_:1}),l[29]||(l[29]=u("span",{class:"success-text"},"å¯åˆ›å»º",-1))])):b("",!0)]),ae.value&&"success"!==ae.value.type?(d(),v("div",he,[c(m,{title:ae.value.message,type:ae.value.type,closable:!1,"show-icon":""},x({_:2},["warning"===ae.value.type?{name:"default",fn:i(()=>[u("p",null,w(ae.value.message),1),ae.value.owner?(d(),v("p",ye,[l[30]||(l[30]=u("strong",null,"å½’å±äººï¼š",-1)),p(w(ae.value.owner),1)])):b("",!0),ae.value.createTime?(d(),v("p",be,[l[31]||(l[31]=u("strong",null,"åˆ›å»ºæ—¶é—´ï¼š",-1)),p(w(ae.value.createTime),1)])):b("",!0),re.value?(d(),v("div",we,[c(r),u("p",_e,[c(s,null,{default:i(()=>[c(h(I))]),_:1}),l[32]||(l[32]=p(" æƒé™æç¤ºï¼šè¯¥å®¢æˆ·ç”±å…¶ä»–æˆå‘˜åˆ›å»ºï¼Œæ‚¨æ²¡æœ‰æƒé™ä¿å­˜ä¿®æ”¹ã€‚å¦‚éœ€æ“ä½œï¼Œè¯·è”ç³»ç®¡ç†å‘˜æˆ–å®¢æˆ·åˆ›å»ºè€…ã€‚ ",-1))])])):b("",!0),u("div",Ve,[c(t,{size:"small",type:"text",onClick:je},{default:i(()=>[...l[33]||(l[33]=[p("æŸ¥çœ‹å®¢æˆ·è¯¦æƒ…",-1)])]),_:1})])]),key:"0"}:void 0]),1032,["title","type"])])):b("",!0)]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"å®¢æˆ·å§“å",prop:"name"},{default:i(()=>[c(a,{modelValue:ne.name,"onUpdate:modelValue":l[1]||(l[1]=e=>ne.name=e),placeholder:"è¯·è¾“å…¥å®¢æˆ·å§“å",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"æ€§åˆ«",prop:"gender"},{default:i(()=>[c(U,{modelValue:ne.gender,"onUpdate:modelValue":l[2]||(l[2]=e=>ne.gender=e)},{default:i(()=>[c(A,{label:"male"},{default:i(()=>[...l[34]||(l[34]=[p("ç”·",-1)])]),_:1}),c(A,{label:"female"},{default:i(()=>[...l[35]||(l[35]=[p("å¥³",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),c(E,{gutter:20},{default:i(()=>[c(V,{span:8},{default:i(()=>[c(_,{label:"å¹´é¾„",prop:"age"},{default:i(()=>[c(O,{modelValue:ne.age,"onUpdate:modelValue":l[3]||(l[3]=e=>ne.age=e),min:1,max:120,placeholder:"è¯·è¾“å…¥å¹´é¾„",style:{width:"200px"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"èº«é«˜(cm)",prop:"height"},{default:i(()=>[c(O,{modelValue:ne.height,"onUpdate:modelValue":l[4]||(l[4]=e=>ne.height=e),min:50,max:250,placeholder:"è¯·è¾“å…¥èº«é«˜",style:{width:"200px"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"ä½“é‡(kg)",prop:"weight"},{default:i(()=>[c(O,{modelValue:ne.weight,"onUpdate:modelValue":l[5]||(l[5]=e=>ne.weight=e),min:20,max:300,placeholder:"è¯·è¾“å…¥ä½“é‡",style:{width:"200px"},"controls-position":"right"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),c(E,{gutter:20},{default:i(()=>[c(V,{span:8},{default:i(()=>[c(_,{label:"è¿›ç²‰æ—¶é—´",prop:"fanAcquisitionTime"},{default:i(()=>[c(S,{modelValue:ne.fanAcquisitionTime,"onUpdate:modelValue":l[6]||(l[6]=e=>ne.fanAcquisitionTime=e),type:"date",placeholder:"è¯·é€‰æ‹©è¿›ç²‰æ—¶é—´",style:{width:"200px"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"å®¢æˆ·å¾®ä¿¡å·",prop:"wechat"},{default:i(()=>[c(a,{modelValue:ne.wechat,"onUpdate:modelValue":l[7]||(l[7]=e=>ne.wechat=e),placeholder:"è¯·è¾“å…¥å¾®ä¿¡å·",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"é‚®ç®±",prop:"email"},{default:i(()=>[c(a,{modelValue:ne.email,"onUpdate:modelValue":l[8]||(l[8]=e=>ne.email=e),placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),u("div",Ae,[l[40]||(l[40]=u("h3",{class:"section-title"},"æ”¶è´§åœ°å€",-1)),u("div",xe,[l[38]||(l[38]=u("div",{class:"recognition-label-inline"},[u("span",{class:"label-icon"},"ğŸ“"),u("span",null,"æ™ºèƒ½è¯†åˆ«")],-1)),c(a,{modelValue:Te.value,"onUpdate:modelValue":l[9]||(l[9]=e=>Te.value=e),placeholder:"ç²˜è´´å®Œæ•´åœ°å€ï¼Œè‡ªåŠ¨è¯†åˆ«çœå¸‚åŒº",clearable:"",class:"recognition-input-inline",style:{width:"55%"}},null,8,["modelValue"]),c(t,{type:"primary",onClick:Ce,loading:Ge.value,class:"recognition-btn-inline"},{default:i(()=>[Ge.value?b("",!0):(d(),n(s,{key:0},{default:i(()=>[c(h(T))]),_:1})),l[37]||(l[37]=p(" è¯†åˆ«å¡«å…… ",-1))]),_:1},8,["loading"])]),c(E,{gutter:20},{default:i(()=>[c(V,{span:6},{default:i(()=>[c(_,{label:"çœä»½",prop:"province",required:!ne.isOverseas},{default:i(()=>[c(z,{modelValue:ne.province,"onUpdate:modelValue":l[10]||(l[10]=e=>ne.province=e),placeholder:"è¯·é€‰æ‹©çœä»½",style:{width:"100%"},onChange:Oe,disabled:ne.isOverseas},{default:i(()=>[(d(!0),v(g,null,f(de.value,e=>(d(),n(P,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["required"])]),_:1}),c(V,{span:6},{default:i(()=>[c(_,{label:"åŸå¸‚",prop:"city",required:!ne.isOverseas},{default:i(()=>[c(z,{modelValue:ne.city,"onUpdate:modelValue":l[11]||(l[11]=e=>ne.city=e),placeholder:"è¯·é€‰æ‹©åŸå¸‚",style:{width:"100%"},onChange:Se,disabled:ne.isOverseas},{default:i(()=>[(d(!0),v(g,null,f(ie.value,e=>(d(),n(P,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["required"])]),_:1}),c(V,{span:6},{default:i(()=>[c(_,{label:"åŒºå¿",prop:"district",required:!ne.isOverseas},{default:i(()=>[c(z,{modelValue:ne.district,"onUpdate:modelValue":l[12]||(l[12]=e=>ne.district=e),placeholder:"è¯·é€‰æ‹©åŒºå¿",style:{width:"100%"},onChange:Pe,disabled:ne.isOverseas},{default:i(()=>[(d(!0),v(g,null,f(ue.value,e=>(d(),n(P,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["required"])]),_:1}),c(V,{span:6},{default:i(()=>[c(_,{label:"è¡—é“",prop:"street"},{default:i(()=>[c(z,{modelValue:ne.street,"onUpdate:modelValue":l[13]||(l[13]=e=>ne.street=e),placeholder:"è¯·é€‰æ‹©è¡—é“",style:{width:"100%"},disabled:ne.isOverseas},{default:i(()=>[(d(!0),v(g,null,f(Ie.value,e=>(d(),n(P,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),c(_,{label:"è¯¦ç»†åœ°å€",prop:"detailAddress",required:!ne.isOverseas},{default:i(()=>[c(a,{modelValue:ne.detailAddress,"onUpdate:modelValue":l[14]||(l[14]=e=>ne.detailAddress=e),placeholder:"è¯·è¾“å…¥è¯¦ç»†åœ°å€ï¼ˆé—¨ç‰Œå·ã€æ¥¼å±‚ç­‰ï¼‰",clearable:"",disabled:ne.isOverseas},null,8,["modelValue","disabled"])]),_:1},8,["required"]),c(_,null,{default:i(()=>[c($,{modelValue:ne.isOverseas,"onUpdate:modelValue":l[15]||(l[15]=e=>ne.isOverseas=e),onChange:ze},{default:i(()=>[...l[39]||(l[39]=[p(" ä½¿ç”¨å¢ƒå¤–åœ°å€ ",-1)])]),_:1},8,["modelValue"])]),_:1}),k(c(_,{label:"å¢ƒå¤–åœ°å€",prop:"overseasAddress",required:ne.isOverseas},{default:i(()=>[c(a,{modelValue:ne.overseasAddress,"onUpdate:modelValue":l[16]||(l[16]=e=>ne.overseasAddress=e),placeholder:"è¯·è¾“å…¥å®Œæ•´çš„å¢ƒå¤–åœ°å€",clearable:""},null,8,["modelValue"])]),_:1},8,["required"]),[[D,ne.isOverseas]])]),u("div",ke,[l[42]||(l[42]=u("h3",{class:"section-title"},"å¥åº·ä¿¡æ¯",-1)),c(_,{label:"ç–¾ç—…å²",prop:"medicalHistory",required:""},{default:i(()=>[c(a,{modelValue:ne.medicalHistory,"onUpdate:modelValue":l[17]||(l[17]=e=>ne.medicalHistory=e),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥ç–¾ç—…å²ï¼ˆå¦‚æœ‰ï¼‰"},null,8,["modelValue"])]),_:1}),c(_,{label:"æ”¹å–„é—®é¢˜",prop:"improvementGoals",required:""},{default:i(()=>[u("div",De,[c(M,{modelValue:ne.improvementGoals,"onUpdate:modelValue":l[18]||(l[18]=e=>ne.improvementGoals=e),class:"improvement-goals-group"},{default:i(()=>[(d(!0),v(g,null,f(h(K).allGoals,e=>(d(),n($,{key:e.id,label:e.value},{default:i(()=>[p(w(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),h(y).isSuperAdmin?(d(),n(t,{key:0,type:"text",size:"small",onClick:l[19]||(l[19]=e=>le.value=!0),class:"edit-goals-btn"},{default:i(()=>[c(s,null,{default:i(()=>[c(h(G))]),_:1}),l[41]||(l[41]=p(" ä¿®æ”¹ ",-1))]),_:1})):b("",!0)])]),_:1}),ne.improvementGoals.includes("å…¶ä»–")?(d(),n(_,{key:0,label:"å…¶ä»–æ”¹å–„ç›®æ ‡",prop:"otherGoals",required:""},{default:i(()=>[c(E,{gutter:20},{default:i(()=>[c(V,{span:24},{default:i(()=>[c(a,{modelValue:ne.otherGoals,"onUpdate:modelValue":l[20]||(l[20]=e=>ne.otherGoals=e),placeholder:"è¯·è¾“å…¥å…¶ä»–æ”¹å–„ç›®æ ‡",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):b("",!0)]),u("div",Ue,[l[43]||(l[43]=u("h3",{class:"section-title"},"å®¢æˆ·åˆ†ç±»",-1)),c(E,{gutter:24},{default:i(()=>[c(V,{span:6},{default:i(()=>[c(_,{label:"å®¢æˆ·ç­‰çº§",prop:"level"},{default:i(()=>[c(z,{modelValue:ne.level,"onUpdate:modelValue":l[21]||(l[21]=e=>ne.level=e),placeholder:"è¯·é€‰æ‹©å®¢æˆ·ç­‰çº§",style:{width:"160px"}},{default:i(()=>[c(P,{label:"é“œç‰Œå®¢æˆ·",value:"bronze"}),c(P,{label:"é“¶ç‰Œå®¢æˆ·",value:"silver"}),c(P,{label:"é‡‘ç‰Œå®¢æˆ·",value:"gold"}),c(P,{label:"é’»çŸ³å®¢æˆ·",value:"diamond"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"å®¢æˆ·æ¥æº",prop:"source"},{default:i(()=>[c(z,{modelValue:ne.source,"onUpdate:modelValue":l[22]||(l[22]=e=>ne.source=e),placeholder:"è¯·é€‰æ‹©å®¢æˆ·æ¥æº",style:{width:"180px"}},{default:i(()=>[c(P,{label:"çº¿ä¸Šæ¨å¹¿",value:"online"}),c(P,{label:"æœ‹å‹ä»‹ç»",value:"referral"}),c(P,{label:"ç”µè¯è¥é”€",value:"telemarketing"}),c(P,{label:"é—¨åº—åˆ°è®¿",value:"store"}),c(P,{label:"å…¶ä»–",value:"other"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),c(E,{gutter:24},{default:i(()=>[c(V,{span:6},{default:i(()=>[c(_,{label:"å®¢æˆ·çŠ¶æ€",prop:"status"},{default:i(()=>[c(z,{modelValue:ne.status,"onUpdate:modelValue":l[23]||(l[23]=e=>ne.status=e),placeholder:"è¯·é€‰æ‹©å®¢æˆ·çŠ¶æ€",style:{width:"160px"}},{default:i(()=>[c(P,{label:"æ´»è·ƒ",value:"active"}),c(P,{label:"éæ´»è·ƒ",value:"inactive"}),c(P,{label:"æ½œåœ¨å®¢æˆ·",value:"potential"}),c(P,{label:"å·²æµå¤±",value:"lost"}),c(P,{label:"é»‘åå•",value:"blacklist"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),c(V,{span:8},{default:i(()=>[c(_,{label:"å®¢æˆ·æ ‡ç­¾",prop:"tags"},{default:i(()=>[c(z,{modelValue:ne.tags,"onUpdate:modelValue":l[24]||(l[24]=e=>ne.tags=e),multiple:"",placeholder:"è¯·é€‰æ‹©å®¢æˆ·æ ‡ç­¾",style:{width:"180px"},loading:Be.value},{default:i(()=>[(d(!0),v(g,null,f(Ne.value,e=>(d(),n(P,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1}),c(V,{span:6},{default:i(()=>[c(_,{label:"è´Ÿè´£é”€å”®",prop:"salesPerson"},{default:i(()=>[c(a,{modelValue:ne.salesPerson,"onUpdate:modelValue":l[25]||(l[25]=e=>ne.salesPerson=e),placeholder:"è´Ÿè´£é”€å”®",style:{width:"140px"},readonly:""},{suffix:i(()=>[c(N,{content:"æ–°å»ºå®¢æˆ·çš„è´Ÿè´£é”€å”®é»˜è®¤ä¸ºå½“å‰åˆ›å»ºè€…ï¼Œä¸å¯ä¿®æ”¹",placement:"top"},{default:i(()=>[c(s,null,{default:i(()=>[c(h(C))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),u("div",Ee,[l[44]||(l[44]=u("h3",{class:"section-title"},"å¤‡æ³¨ä¿¡æ¯",-1)),c(_,{label:"å®¢æˆ·å¤‡æ³¨",prop:"remark"},{default:i(()=>[c(a,{modelValue:ne.remark,"onUpdate:modelValue":l[26]||(l[26]=e=>ne.remark=e),type:"textarea",rows:4,placeholder:"è¯·è¾“å…¥å®¢æˆ·å¤‡æ³¨ä¿¡æ¯"},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])]),_:1}),u("div",qe,[c(t,{onClick:Le,size:"large"},{default:i(()=>[...l[45]||(l[45]=[p("å–æ¶ˆ",-1)])]),_:1}),c(N,{content:oe.value,disabled:!re.value,placement:"top"},{default:i(()=>[c(t,{type:"primary",onClick:Ye,loading:W.value,disabled:re.value,size:"large"},{default:i(()=>[p(w(te.value?"æ›´æ–°":"ä¿å­˜"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["content","disabled"]),c(N,{content:oe.value,disabled:!re.value,placement:"top"},{default:i(()=>[te.value?b("",!0):(d(),n(t,{key:0,type:"success",onClick:Ze,loading:W.value,disabled:re.value,size:"large"},{default:i(()=>[...l[46]||(l[46]=[p(" ä¿å­˜å¹¶ä¸‹å• ",-1)])]),_:1},8,["loading","disabled"]))]),_:1},8,["content","disabled"])]),c(ce,{modelValue:le.value,"onUpdate:modelValue":l[27]||(l[27]=e=>le.value=e)},null,8,["modelValue"])])}}}),[["__scopeId","data-v-e4b52b7c"]]);export{Ie as default};
