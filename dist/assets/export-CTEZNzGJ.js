import{k as n,w as b}from"./utils-ywHRn0uI.js";const u=(c,a="订单列表",h=!1)=>{if(!c||c.length===0)throw new Error("没有可导出的数据");const r=h?["订单号","客户姓名","客户电话","收货人","收货电话","收货地址","商品信息","总数量","订单金额","定金","COD金额","客户年龄","身高","体重","病史","服务微信","备注","下单时间","订单状态","发货状态"]:["订单号","收货人","收货电话","收货地址","商品信息","总数量","订单金额","定金","COD金额","备注","下单时间","订单状态","发货状态"],d=c.map(t=>h?[t.orderNumber,t.customerName,t.customerPhone,t.receiverName,t.receiverPhone,t.receiverAddress,t.products,t.totalQuantity,t.totalAmount,t.depositAmount,t.codAmount,t.customerAge||"",t.customerHeight||"",t.customerWeight||"",t.medicalHistory||"",t.serviceWechat||"",t.remark||"",t.createTime,t.status,t.shippingStatus||""]:[t.orderNumber,t.receiverName,t.receiverPhone,t.receiverAddress,t.products,t.totalQuantity,t.totalAmount,t.depositAmount,t.codAmount,t.remark||"",t.createTime,t.status,t.shippingStatus||""]),i=n.book_new(),l=[r,...d],w=n.aoa_to_sheet(l),g=h?[{wch:15},{wch:12},{wch:15},{wch:12},{wch:15},{wch:30},{wch:25},{wch:8},{wch:12},{wch:10},{wch:10},{wch:8},{wch:8},{wch:8},{wch:15},{wch:15},{wch:20},{wch:18},{wch:10},{wch:10}]:[{wch:15},{wch:12},{wch:15},{wch:30},{wch:25},{wch:8},{wch:12},{wch:10},{wch:10},{wch:20},{wch:18},{wch:10},{wch:10}];w["!cols"]=g,n.book_append_sheet(i,w,"订单列表");const p=new Date().toISOString().slice(0,19).replace(/:/g,"-"),o=`${a}_${p}.xlsx`;return b(i,o),setTimeout(()=>{document.querySelectorAll('a[href^="blob:"]').forEach(e=>{const s=e.getAttribute("href");s&&s.startsWith("blob:")&&(URL.revokeObjectURL(s),e.parentNode&&e.parentNode.removeChild(e))})},1e3),o},N=(c,a=!1)=>u([c],`订单_${c.orderNumber}`,a),A=(c,a=!1)=>u(c,`批量订单_${c.length}条`,a),W=(c,a="客户列表",h=!1)=>{if(!c||c.length===0)throw new Error("没有可导出的数据");const r=h?["客户编码","客户姓名","手机号码","年龄","地址","客户等级","客户状态","负责销售","订单数量","创建时间","创建人","微信号","邮箱","公司","职位","客户来源","标签","备注"]:["客户编码","客户姓名","手机号码(脱敏)","客户等级","客户状态","负责销售","订单数量","创建时间"],d=e=>!e||e.length<7?e:e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),i=c.map(e=>h?[e.code,e.name,e.phone,e.age,e.address,e.level,e.status,e.salesPersonName||e.salesPersonId,e.orderCount,e.createTime,e.createdBy,e.wechatId||"",e.email||"",e.company||"",e.position||"",e.source||"",e.tags?e.tags.join(", "):"",e.remarks||""]:[e.code,e.name,d(e.phone),e.level,e.status,e.salesPersonName||e.salesPersonId,e.orderCount,e.createTime]),l=n.book_new(),w=[r,...i],f=n.aoa_to_sheet(w),p=h?[{wch:15},{wch:12},{wch:15},{wch:8},{wch:30},{wch:10},{wch:10},{wch:12},{wch:10},{wch:18},{wch:12},{wch:15},{wch:20},{wch:20},{wch:15},{wch:12},{wch:20},{wch:25}]:[{wch:15},{wch:12},{wch:18},{wch:10},{wch:10},{wch:12},{wch:10},{wch:18}];f["!cols"]=p,n.book_append_sheet(l,f,"客户列表");const o=new Date().toISOString().slice(0,19).replace(/:/g,"-"),t=`${a}_${o}.xlsx`;return b(l,t),setTimeout(()=>{document.querySelectorAll('a[href^="blob:"]').forEach(s=>{const m=s.getAttribute("href");m&&m.startsWith("blob:")&&(URL.revokeObjectURL(m),s.parentNode&&s.parentNode.removeChild(s))})},1e3),t},H=(c,a=!1)=>W(c,`批量客户_${c.length}条`,a);export{A as a,N as b,H as e};
