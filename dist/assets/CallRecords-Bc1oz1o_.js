var Le=Object.defineProperty,Ke=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var _e=(C,u,f)=>u in C?Le(C,u,{enumerable:!0,configurable:!0,writable:!0,value:f}):C[u]=f,L=(C,u)=>{for(var f in u||(u={}))Ze.call(u,f)&&_e(C,f,u[f]);if(ve)for(var f of ve(u))Ge.call(u,f)&&_e(C,f,u[f]);return C},K=(C,u)=>Ke(C,Je(u));var z=(C,u,f)=>new Promise((O,N)=>{var E=y=>{try{U(f.next(y))}catch($){N($)}},F=y=>{try{U(f.throw(y))}catch($){N($)}},U=y=>y.done?O(y.value):Promise.resolve(y.value).then(E,F);U((f=f.apply(C,u)).next())});import{u as We}from"./call-C9NCWzRc.js";import{l as Xe,az as el,r as R,Z as X,c as ll,ag as r,aq as tl,m as T,p as w,q as s,U as e,S as n,O as t,u as v,T as d,P as al,M as P,J as ol,Q as ee}from"./vendor-D8Vxqhr-.js";import{c as sl,_ as nl}from"./settings-CuxbDWOu.js";import{m as il}from"./phone-DsAzMHsn.js";import{aK as dl,n as le,r as rl,h as fe,ai as ul,s as cl,j as ge,v as pl,a5 as ml,T as vl,a7 as _l,a9 as ye,K as fl,E as _,b as be}from"./elementPlus-Bmwh7Rh8.js";import"./utils-ywHRn0uI.js";const gl={class:"call-records"},yl={class:"page-header"},bl={class:"header-content"},wl={class:"page-title"},Cl={class:"header-actions"},hl={class:"overview-section"},kl={class:"overview-content"},xl={class:"overview-icon total"},Rl={class:"overview-info"},Vl={class:"overview-value"},ql={class:"overview-change"},zl={class:"change-text positive"},Dl={class:"overview-content"},Sl={class:"overview-icon incoming"},Il={class:"overview-info"},Nl={class:"overview-value"},$l={class:"overview-change"},Tl={class:"change-text"},Ul={class:"overview-content"},Ml={class:"overview-icon outgoing"},Pl={class:"overview-info"},Ol={class:"overview-value"},El={class:"overview-change"},Fl={class:"change-text"},Yl={class:"overview-content"},jl={class:"overview-icon duration"},Bl={class:"overview-info"},Hl={class:"overview-value"},Ql={class:"overview-change"},Al={class:"change-text"},Ll={class:"search-section"},Kl={class:"table-section"},Jl={class:"table-header"},Zl={class:"table-actions"},Gl={class:"phone-info"},Wl={key:1,style:{color:"#C0C4CC"}},Xl={key:0,class:"quality-info"},et={key:1,style:{color:"#C0C4CC"}},lt={class:"pagination-wrapper"},tt={key:0,class:"call-detail"},at={key:0,class:"quality-detail"},ot={class:"quality-item"},st={class:"quality-item"},nt={class:"quality-item"},it={class:"quality-item"},dt={key:1,class:"no-quality"},rt={class:"notes-content"},ut={class:"recording-player"},ct=["src"],pt={class:"recording-actions",style:{"margin-top":"10px"}},mt=Xe({__name:"CallRecords",setup(C){const u=We(),f=el(),O=sl(f),N=R(!1),E=R(!1),F=R(!1),U=R([]),y=R([]),$=R(0),J=R(!1),Y=R(!1),i=R(null),h=R({totalCalls:0,incomingCalls:0,outgoingCalls:0,totalDuration:0,avgDuration:0,todayIncrease:0}),p=X({direction:"",status:"",customerInfo:"",dateRange:[],userId:"",durationRange:""}),D=X({page:1,size:20}),k=X({customerName:"",notes:"",qualityScore:0}),Z=R(),we={customerName:[{required:!0,message:"请输入客户姓名",trigger:"blur"}]},j=a=>new Date(a).toLocaleString("zh-CN"),B=a=>{if(a<60)return`${a}秒`;const l=Math.floor(a/3600),c=Math.floor(a%3600/60),m=a%60;return l>0?`${l}小时${c}分${m}秒`:`${c}分${m}秒`},Ce=a=>a<30?"short-duration":a<300?"medium-duration":"long-duration",te=a=>({connected:"success",missed:"warning",rejected:"danger",failed:"info"})[a]||"info",ae=a=>({connected:"已接通",missed:"未接听",rejected:"拒接",failed:"失败"})[a]||"未知",he=a=>a>=80?"#67C23A":a>=60?"#E6A23C":"#F56C6C",S=()=>z(this,null,function*(){try{N.value=!0;const a=K(L({page:D.page,size:D.size},p),{startTime:p.dateRange[0],endTime:p.dateRange[1]}),l=yield u.fetchCallRecords(a);U.value=l.records,$.value=l.total}catch(a){console.error("加载通话记录失败:",a),_.error("加载数据失败")}finally{N.value=!1}}),oe=()=>z(this,null,function*(){try{const a=yield u.fetchCallStatistics({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]});h.value={totalCalls:a.totalCalls,incomingCalls:a.incomingCalls||0,outgoingCalls:a.outgoingCalls||0,totalDuration:a.totalDuration,avgDuration:a.averageDuration,todayIncrease:a.todayIncrease||0}}catch(a){console.error("加载概览数据失败:",a)}}),se=()=>{D.page=1,S()},ke=()=>{Object.assign(p,{direction:"",status:"",customerInfo:"",dateRange:[],userId:"",durationRange:""}),se()},xe=()=>{S(),oe()},Re=a=>{y.value=a},Ve=a=>{D.size=a,S()},qe=a=>{D.page=a,S()},ze=a=>{i.value=a,J.value=!0},De=a=>{var l;i.value=a,Object.assign(k,{customerName:a.customerName||"",notes:a.notes||"",qualityScore:((l=a.quality)==null?void 0:l.score)||0}),Y.value=!0},Se=()=>z(this,null,function*(){if(!(!Z.value||!i.value))try{yield Z.value.validate(),E.value=!0,yield u.updateCallRecord(i.value.id,{customerName:k.customerName,notes:k.notes,quality:K(L({},i.value.quality),{score:k.qualityScore})}),_.success("记录已更新"),Y.value=!1,S()}catch(a){console.error("更新记录失败:",a),_.error("更新失败")}finally{E.value=!1}}),ne=a=>{if(!a.hasRecording){_.warning("该通话没有录音");return}O.push(`/service-management/call/recordings?recordId=${a.id}`)},ie=a=>z(this,null,function*(){if(!a.hasRecording){_.warning("该通话没有录音");return}try{yield u.downloadRecording(a.id),_.success("录音下载成功")}catch(l){console.error("下载录音失败:",l),_.error("下载失败")}}),de=a=>{_.info("分享功能开发中")},Ie=a=>{O.push({path:"/service-management/call/follow-up-records",query:{customerId:a.customerId,callRecordId:a.id}})},Ne=a=>z(this,null,function*(){try{yield u.makeOutboundCall({customerPhone:a,customerName:"",notes:"回拨电话"}),_.success("回拨已发起")}catch(l){console.error("回拨失败:",l),_.error("回拨失败")}}),$e=a=>z(this,null,function*(){try{yield be.confirm("确定要删除这条通话记录吗？","确认删除",{type:"warning"}),yield u.deleteCallRecord(a.id),_.success("删除成功"),S()}catch(l){l!=="cancel"&&(console.error("删除记录失败:",l),_.error("删除失败"))}}),Te=()=>z(this,null,function*(){try{const a=y.value.map(l=>l.id);yield u.exportCallRecords({recordIds:a}),_.success("批量导出成功")}catch(a){console.error("批量导出失败:",a),_.error("批量导出失败")}}),Ue=()=>z(this,null,function*(){try{yield be.confirm(`确定要删除选中的 ${y.value.length} 条记录吗？`,"批量删除",{type:"warning"});const a=y.value.map(l=>l.id);yield u.batchDeleteCallRecords(a),_.success("批量删除成功"),S()}catch(a){a!=="cancel"&&(console.error("批量删除失败:",a),_.error("批量删除失败"))}}),Me=()=>z(this,null,function*(){try{F.value=!0;const a=K(L({},p),{startTime:p.dateRange[0],endTime:p.dateRange[1]});yield u.exportCallRecords(a),_.success("导出成功")}catch(a){console.error("导出失败:",a),_.error("导出失败")}finally{F.value=!1}}),Pe=a=>{O.push(`/customer-management/detail/${a}`)};return ll(()=>{S(),oe()}),(a,l)=>{const c=r("el-icon"),m=r("el-button"),V=r("el-card"),M=r("el-col"),re=r("PhoneIncoming"),ue=r("PhoneOutgoing"),ce=r("el-row"),g=r("el-option"),H=r("el-select"),q=r("el-form-item"),G=r("el-input"),Oe=r("el-date-picker"),pe=r("el-form"),b=r("el-table-column"),Q=r("el-tag"),W=r("el-rate"),A=r("el-dropdown-item"),Ee=r("el-dropdown-menu"),Fe=r("el-dropdown"),Ye=r("el-table"),je=r("el-pagination"),I=r("el-descriptions-item"),Be=r("el-descriptions"),He=r("el-progress"),Qe=r("el-empty"),me=r("el-dialog"),Ae=tl("loading");return w(),T("div",gl,[s("div",yl,[s("div",bl,[s("h1",wl,[e(c,null,{default:t(()=>[e(v(dl))]),_:1}),l[17]||(l[17]=n(" 通话记录 ",-1))]),l[18]||(l[18]=s("p",{class:"page-description"},"查看和管理所有通话记录，包括呼入和呼出通话详情",-1))]),s("div",Cl,[e(m,{onClick:Me,loading:F.value},{default:t(()=>[e(c,null,{default:t(()=>[e(v(le))]),_:1}),l[19]||(l[19]=n(" 导出记录 ",-1))]),_:1},8,["loading"]),e(m,{onClick:xe,loading:N.value},{default:t(()=>[e(c,null,{default:t(()=>[e(v(rl))]),_:1}),l[20]||(l[20]=n(" 刷新 ",-1))]),_:1},8,["loading"])])]),s("div",hl,[e(ce,{gutter:20},{default:t(()=>[e(M,{span:6},{default:t(()=>[e(V,{class:"overview-card"},{default:t(()=>[s("div",kl,[s("div",xl,[e(c,null,{default:t(()=>[e(v(fe))]),_:1})]),s("div",Rl,[s("div",Vl,d(h.value.totalCalls||0),1),l[22]||(l[22]=s("div",{class:"overview-label"},"总通话数",-1)),s("div",ql,[s("span",zl,"+"+d(h.value.todayIncrease||0),1),l[21]||(l[21]=s("span",{class:"change-label"},"今日新增",-1))])])])]),_:1})]),_:1}),e(M,{span:6},{default:t(()=>[e(V,{class:"overview-card"},{default:t(()=>[s("div",Dl,[s("div",Sl,[e(c,null,{default:t(()=>[e(re)]),_:1})]),s("div",Il,[s("div",Nl,d(h.value.incomingCalls||0),1),l[24]||(l[24]=s("div",{class:"overview-label"},"呼入通话",-1)),s("div",$l,[s("span",Tl,d((h.value.incomingCalls/h.value.totalCalls*100).toFixed(1))+"%",1),l[23]||(l[23]=s("span",{class:"change-label"},"占比",-1))])])])]),_:1})]),_:1}),e(M,{span:6},{default:t(()=>[e(V,{class:"overview-card"},{default:t(()=>[s("div",Ul,[s("div",Ml,[e(c,null,{default:t(()=>[e(ue)]),_:1})]),s("div",Pl,[s("div",Ol,d(h.value.outgoingCalls||0),1),l[26]||(l[26]=s("div",{class:"overview-label"},"呼出通话",-1)),s("div",El,[s("span",Fl,d((h.value.outgoingCalls/h.value.totalCalls*100).toFixed(1))+"%",1),l[25]||(l[25]=s("span",{class:"change-label"},"占比",-1))])])])]),_:1})]),_:1}),e(M,{span:6},{default:t(()=>[e(V,{class:"overview-card"},{default:t(()=>[s("div",Yl,[s("div",jl,[e(c,null,{default:t(()=>[e(v(ul))]),_:1})]),s("div",Bl,[s("div",Hl,d(B(h.value.totalDuration||0)),1),l[28]||(l[28]=s("div",{class:"overview-label"},"总通话时长",-1)),s("div",Ql,[s("span",Al,d(B(h.value.avgDuration||0)),1),l[27]||(l[27]=s("span",{class:"change-label"},"平均时长",-1))])])])]),_:1})]),_:1})]),_:1})]),s("div",Ll,[e(V,null,{default:t(()=>[e(pe,{model:p,inline:""},{default:t(()=>[e(q,{label:"通话类型"},{default:t(()=>[e(H,{modelValue:p.direction,"onUpdate:modelValue":l[0]||(l[0]=o=>p.direction=o),placeholder:"请选择类型",clearable:"",style:{width:"150px"}},{default:t(()=>[e(g,{label:"全部",value:""}),e(g,{label:"呼入",value:"incoming"}),e(g,{label:"呼出",value:"outgoing"})]),_:1},8,["modelValue"])]),_:1}),e(q,{label:"通话状态"},{default:t(()=>[e(H,{modelValue:p.status,"onUpdate:modelValue":l[1]||(l[1]=o=>p.status=o),placeholder:"请选择状态",clearable:"",style:{width:"150px"}},{default:t(()=>[e(g,{label:"全部",value:""}),e(g,{label:"已接通",value:"connected"}),e(g,{label:"未接听",value:"missed"}),e(g,{label:"拒接",value:"rejected"}),e(g,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),e(q,{label:"客户信息"},{default:t(()=>[e(G,{modelValue:p.customerInfo,"onUpdate:modelValue":l[2]||(l[2]=o=>p.customerInfo=o),placeholder:"客户姓名/电话",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(q,{label:"通话时间"},{default:t(()=>[e(Oe,{modelValue:p.dateRange,"onUpdate:modelValue":l[3]||(l[3]=o=>p.dateRange=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"320px"}},null,8,["modelValue"])]),_:1}),e(q,{label:"通话人员"},{default:t(()=>[e(H,{modelValue:p.userId,"onUpdate:modelValue":l[4]||(l[4]=o=>p.userId=o),placeholder:"请选择人员",clearable:"",style:{width:"150px"}},{default:t(()=>[e(g,{label:"全部",value:""}),e(g,{label:"张三",value:"1"}),e(g,{label:"李四",value:"2"}),e(g,{label:"王五",value:"3"})]),_:1},8,["modelValue"])]),_:1}),e(q,{label:"时长筛选"},{default:t(()=>[e(H,{modelValue:p.durationRange,"onUpdate:modelValue":l[5]||(l[5]=o=>p.durationRange=o),placeholder:"请选择时长",clearable:"",style:{width:"150px"}},{default:t(()=>[e(g,{label:"全部",value:""}),e(g,{label:"30秒以下",value:"0-30"}),e(g,{label:"30秒-2分钟",value:"30-120"}),e(g,{label:"2-5分钟",value:"120-300"}),e(g,{label:"5分钟以上",value:"300+"})]),_:1},8,["modelValue"])]),_:1}),e(q,null,{default:t(()=>[e(m,{type:"primary",onClick:se},{default:t(()=>[e(c,null,{default:t(()=>[e(v(cl))]),_:1}),l[29]||(l[29]=n(" 搜索 ",-1))]),_:1}),e(m,{onClick:ke},{default:t(()=>[...l[30]||(l[30]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),s("div",Kl,[e(V,null,{header:t(()=>[s("div",Jl,[s("span",null,"通话记录 (共 "+d($.value)+" 条)",1),s("div",Zl,[e(m,{size:"small",disabled:!y.value.length,onClick:Te},{default:t(()=>[...l[31]||(l[31]=[n(" 批量导出 ",-1)])]),_:1},8,["disabled"]),e(m,{size:"small",disabled:!y.value.length,onClick:Ue},{default:t(()=>[...l[32]||(l[32]=[n(" 批量删除 ",-1)])]),_:1},8,["disabled"])])])]),default:t(()=>[al((w(),P(Ye,{data:U.value,onSelectionChange:Re,style:{width:"100%"},"row-key":"id"},{default:t(()=>[e(b,{type:"selection",width:"55"}),e(b,{prop:"direction",label:"类型",width:"80"},{default:t(({row:o})=>[e(Q,{type:o.direction==="incoming"?"success":"primary",size:"small"},{default:t(()=>[e(c,null,{default:t(()=>[o.direction==="incoming"?(w(),P(re,{key:0})):(w(),P(ue,{key:1}))]),_:2},1024),n(" "+d(o.direction==="incoming"?"呼入":"呼出"),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"customerName",label:"客户姓名",width:"120"},{default:t(({row:o})=>[e(m,{text:"",onClick:x=>Pe(o.customerId)},{default:t(()=>[n(d(o.customerName||"未知客户"),1)]),_:2},1032,["onClick"])]),_:1}),e(b,{prop:"customerPhone",label:"客户电话",width:"140"},{default:t(({row:o})=>[s("div",Gl,[s("span",null,d(v(il)(o.customerPhone)),1),e(m,{text:"",type:"primary",size:"small",onClick:x=>Ne(o.customerPhone),style:{"margin-left":"8px"}},{default:t(()=>[e(c,null,{default:t(()=>[e(v(fe))]),_:1})]),_:1},8,["onClick"])])]),_:1}),e(b,{prop:"userName",label:"通话人员",width:"100"}),e(b,{prop:"startTime",label:"开始时间",width:"160"},{default:t(({row:o})=>[n(d(j(o.startTime)),1)]),_:1}),e(b,{prop:"endTime",label:"结束时间",width:"160"},{default:t(({row:o})=>[n(d(o.endTime?j(o.endTime):"-"),1)]),_:1}),e(b,{prop:"duration",label:"通话时长",width:"100",sortable:""},{default:t(({row:o})=>[s("span",{class:ol(Ce(o.duration))},d(B(o.duration)),3)]),_:1}),e(b,{prop:"status",label:"通话状态",width:"100"},{default:t(({row:o})=>[e(Q,{type:te(o.status),size:"small"},{default:t(()=>[n(d(ae(o.status)),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"hasRecording",label:"录音",width:"80"},{default:t(({row:o})=>[o.hasRecording?(w(),P(m,{key:0,text:"",size:"small",onClick:x=>ne(o)},{default:t(()=>[e(c,{color:"#67C23A"},{default:t(()=>[e(v(ge))]),_:1})]),_:1},8,["onClick"])):(w(),T("span",Wl,"无"))]),_:1}),e(b,{prop:"quality",label:"通话质量",width:"100"},{default:t(({row:o})=>[o.quality?(w(),T("div",Xl,[e(W,{modelValue:o.quality.score,"onUpdate:modelValue":x=>o.quality.score=x,disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}",size:"small"},null,8,["modelValue","onUpdate:modelValue"])])):(w(),T("span",et,"未评分"))]),_:1}),e(b,{prop:"notes",label:"备注","min-width":"150","show-overflow-tooltip":""}),e(b,{label:"操作",width:"200",fixed:"right"},{default:t(({row:o})=>[e(m,{text:"",size:"small",onClick:x=>ze(o)},{default:t(()=>[e(c,null,{default:t(()=>[e(v(pl))]),_:1}),l[33]||(l[33]=n(" 详情 ",-1))]),_:1},8,["onClick"]),e(m,{text:"",size:"small",onClick:x=>ne(o),disabled:!o.hasRecording},{default:t(()=>[e(c,null,{default:t(()=>[e(v(ge))]),_:1}),l[34]||(l[34]=n(" 录音 ",-1))]),_:1},8,["onClick","disabled"]),e(m,{text:"",size:"small",onClick:x=>Ie(o)},{default:t(()=>[e(c,null,{default:t(()=>[e(v(ml))]),_:1}),l[35]||(l[35]=n(" 跟进 ",-1))]),_:1},8,["onClick"]),e(Fe,null,{dropdown:t(()=>[e(Ee,null,{default:t(()=>[e(A,{onClick:x=>De(o)},{default:t(()=>[e(c,null,{default:t(()=>[e(v(_l))]),_:1}),l[37]||(l[37]=n(" 编辑记录 ",-1))]),_:1},8,["onClick"]),e(A,{onClick:x=>ie(o),disabled:!o.hasRecording},{default:t(()=>[e(c,null,{default:t(()=>[e(v(le))]),_:1}),l[38]||(l[38]=n(" 下载录音 ",-1))]),_:1},8,["onClick","disabled"]),e(A,{onClick:x=>de(o)},{default:t(()=>[e(c,null,{default:t(()=>[e(v(ye))]),_:1}),l[39]||(l[39]=n(" 分享记录 ",-1))]),_:1},8,["onClick"]),e(A,{onClick:x=>$e(o),divided:""},{default:t(()=>[e(c,null,{default:t(()=>[e(v(fl))]),_:1}),l[40]||(l[40]=n(" 删除记录 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),default:t(()=>[e(m,{text:"",size:"small"},{default:t(()=>[l[36]||(l[36]=n(" 更多",-1)),e(c,null,{default:t(()=>[e(v(vl))]),_:1})]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[Ae,N.value]]),s("div",lt,[e(je,{"current-page":D.page,"onUpdate:currentPage":l[6]||(l[6]=o=>D.page=o),"page-size":D.size,"onUpdate:pageSize":l[7]||(l[7]=o=>D.size=o),"page-sizes":[10,20,50,100],total:$.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ve,onCurrentChange:qe},null,8,["current-page","page-size","total"])])]),_:1})]),e(me,{modelValue:J.value,"onUpdate:modelValue":l[11]||(l[11]=o=>J.value=o),title:"通话记录详情",width:"800px"},{default:t(()=>[i.value?(w(),T("div",tt,[e(ce,{gutter:20},{default:t(()=>[e(M,{span:12},{default:t(()=>[e(V,null,{header:t(()=>[...l[41]||(l[41]=[s("span",null,"基本信息",-1)])]),default:t(()=>[e(Be,{column:1,border:""},{default:t(()=>[e(I,{label:"通话类型"},{default:t(()=>[e(Q,{type:i.value.direction==="incoming"?"success":"primary"},{default:t(()=>[n(d(i.value.direction==="incoming"?"呼入":"呼出"),1)]),_:1},8,["type"])]),_:1}),e(I,{label:"客户姓名"},{default:t(()=>[n(d(i.value.customerName||"未知客户"),1)]),_:1}),e(I,{label:"客户电话"},{default:t(()=>[n(d(i.value.customerPhone),1)]),_:1}),e(I,{label:"通话人员"},{default:t(()=>[n(d(i.value.userName),1)]),_:1}),e(I,{label:"开始时间"},{default:t(()=>[n(d(j(i.value.startTime)),1)]),_:1}),e(I,{label:"结束时间"},{default:t(()=>[n(d(i.value.endTime?j(i.value.endTime):"未结束"),1)]),_:1}),e(I,{label:"通话时长"},{default:t(()=>[n(d(B(i.value.duration)),1)]),_:1}),e(I,{label:"通话状态"},{default:t(()=>[e(Q,{type:te(i.value.status)},{default:t(()=>[n(d(ae(i.value.status)),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),e(M,{span:12},{default:t(()=>[e(V,null,{header:t(()=>[...l[42]||(l[42]=[s("span",null,"通话质量",-1)])]),default:t(()=>[i.value.quality?(w(),T("div",at,[s("div",ot,[l[43]||(l[43]=s("span",{class:"quality-label"},"整体评分：",-1)),e(W,{modelValue:i.value.quality.score,"onUpdate:modelValue":l[8]||(l[8]=o=>i.value.quality.score=o),disabled:"","show-score":"","text-color":"#ff9900"},null,8,["modelValue"])]),s("div",st,[l[44]||(l[44]=s("span",{class:"quality-label"},"音频质量：",-1)),e(He,{percentage:i.value.quality.audioQuality,color:he(i.value.quality.audioQuality)},null,8,["percentage","color"])]),s("div",nt,[l[45]||(l[45]=s("span",{class:"quality-label"},"网络延迟：",-1)),s("span",null,d(i.value.quality.latency)+"ms",1)]),s("div",it,[l[46]||(l[46]=s("span",{class:"quality-label"},"丢包率：",-1)),s("span",null,d(i.value.quality.packetLoss)+"%",1)])])):(w(),T("div",dt,[e(Qe,{description:"暂无质量数据","image-size":80})]))]),_:1})]),_:1})]),_:1}),i.value.notes?(w(),P(V,{key:0,style:{"margin-top":"20px"}},{header:t(()=>[...l[47]||(l[47]=[s("span",null,"通话备注",-1)])]),default:t(()=>[s("div",rt,d(i.value.notes),1)]),_:1})):ee("",!0),i.value.hasRecording?(w(),P(V,{key:1,style:{"margin-top":"20px"}},{header:t(()=>[...l[48]||(l[48]=[s("span",null,"录音播放",-1)])]),default:t(()=>[s("div",ut,[s("audio",{ref:"audioPlayer",controls:"",style:{width:"100%"},src:i.value.recordingUrl}," 您的浏览器不支持音频播放 ",8,ct),s("div",pt,[e(m,{size:"small",onClick:l[9]||(l[9]=o=>ie(i.value))},{default:t(()=>[e(c,null,{default:t(()=>[e(v(le))]),_:1}),l[49]||(l[49]=n(" 下载录音 ",-1))]),_:1}),e(m,{size:"small",onClick:l[10]||(l[10]=o=>de(i.value))},{default:t(()=>[e(c,null,{default:t(()=>[e(v(ye))]),_:1}),l[50]||(l[50]=n(" 分享录音 ",-1))]),_:1})])])]),_:1})):ee("",!0)])):ee("",!0)]),_:1},8,["modelValue"]),e(me,{modelValue:Y.value,"onUpdate:modelValue":l[16]||(l[16]=o=>Y.value=o),title:"编辑通话记录",width:"600px","close-on-click-modal":!1},{footer:t(()=>[e(m,{onClick:l[15]||(l[15]=o=>Y.value=!1)},{default:t(()=>[...l[51]||(l[51]=[n("取消",-1)])]),_:1}),e(m,{type:"primary",onClick:Se,loading:E.value},{default:t(()=>[...l[52]||(l[52]=[n(" 保存 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(pe,{model:k,rules:we,ref_key:"editFormRef",ref:Z,"label-width":"100px"},{default:t(()=>[e(q,{label:"客户姓名",prop:"customerName"},{default:t(()=>[e(G,{modelValue:k.customerName,"onUpdate:modelValue":l[12]||(l[12]=o=>k.customerName=o),placeholder:"请输入客户姓名"},null,8,["modelValue"])]),_:1}),e(q,{label:"通话备注",prop:"notes"},{default:t(()=>[e(G,{modelValue:k.notes,"onUpdate:modelValue":l[13]||(l[13]=o=>k.notes=o),type:"textarea",rows:4,placeholder:"请输入通话备注"},null,8,["modelValue"])]),_:1}),e(q,{label:"通话质量"},{default:t(()=>[e(W,{modelValue:k.qualityScore,"onUpdate:modelValue":l[14]||(l[14]=o=>k.qualityScore=o),"show-text":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Ct=nl(mt,[["__scopeId","data-v-286363ce"]]);export{Ct as default};
