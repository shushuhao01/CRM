import{aS as e,K as l,E as a}from"./elementPlus-DxaqjplL.js";import{u as t,K as s,L as i,S as u,_ as r}from"./index-C4IdUW1A.js";import{d}from"./sensitiveInfo-CTSC2tj2.js";import{userApiService as o}from"./userApiService-Cw6X63cB.js";import{getDepartmentList as n}from"./department-BD2tZLj3.js";import{l as c,r as v,e as m,b as p,ag as y,m as f,q as h,p as w,U as b,O as g,S as _,u as k,T as S,Q as T,F as E,a9 as C,M as V,az as I,n as A}from"./vendor-BtukhyiH.js";import"./utils-DfI7e5Rl.js";const x={class:"customer-service-permission-manager"},P={class:"header"},U={class:"header-title"},L={class:"header-stats"},R={class:"header-actions"},N={class:"filters"},O={class:"custom-permissions"},D={key:0,class:"no-permissions"},G={class:"permission-tree"},M={class:"permission-description"},z={key:0},K={key:1},F={key:2},$={key:3},j={key:4},q={class:"dialog-footer"},H={key:0,class:"permission-details"},Q={class:"custom-permissions-detail",style:{"margin-top":"20px"}},B={key:0},J={key:1,class:"no-permissions"},W={class:"batch-config"},X={class:"add-customer-service"},Y={style:{display:"flex","flex-direction":"column"}},Z={style:{"font-size":"12px",color:"#999","margin-top":"2px"}},ee={class:"permission-config-container"},le={class:"permission-header"},ae={class:"permission-actions"},te={class:"permission-count"},se={class:"permission-tree-wrapper"},ie={class:"permission-node"},ue={class:"permission-label"},re={key:0,class:"permission-key"},de={class:"permission-tips"},oe={class:"member-details"},ne={key:0,class:"no-members"},ce={class:"bottom-info",style:{"margin-top":"30px"}},ve={class:"info-content"},me={class:"info-title"},pe=r(c({__name:"CustomerServicePermissionManager",setup(r){const c=t(),pe=v([]),ye=v([]),fe=v([]),he=v(""),we=v(""),be=v(!1),ge=v(!1),_e=v(!1),ke=v("aftersale"),Se=v([]),Te=v({total:0,online:0,configRate:0}),Ee=v({targetType:"",template:"",dataScope:""}),Ce=v(!1),Ve=v(!1),Ie=v(null),Ae=v({customerServiceType:i.GENERAL,dataScope:s.CUSTOM,departmentIds:[],customPermissions:[]}),xe=v(),Pe=v(),Ue=v({userId:"",customerServiceType:i.GENERAL,dataScope:s.PERSONAL,departmentId:"",permissionTemplate:"",customPermissions:[]}),Le=v([{id:"basic",name:"基础权限",description:"适用于新手客服，包含基本的查看和编辑权限",permissions:["customer:list:view","order:list:view","service:list:view"]},{id:"standard",name:"标准权限",description:"适用于经验丰富的客服，包含大部分常用权限",permissions:["customer:list:view","customer:list:edit","order:list:view","order:list:edit","service:list:view","service:list:edit","logistics:shipping:view"]},{id:"advanced",name:"高级权限",description:"适用于资深客服，包含完整的业务权限",permissions:["customer:list:view","customer:list:edit","customer:list:create","customer:list:assign","order:list:view","order:list:edit","order:add:create","order:audit:view","service:list:view","service:list:edit","service:afterSales:view","service:afterSales:edit","logistics:shipping:view","logistics:shipping:edit","product:list:view"]},{id:"aftersales_specialist",name:"售后专员",description:"专门处理售后服务的客服权限",permissions:["customer:list:view","order:list:view","order:detail:cancel","service:list:view","service:list:edit","service:afterSales:view","service:afterSales:edit","logistics:shipping:view"]},{id:"audit_specialist",name:"审核专员",description:"专门负责订单审核的客服权限",permissions:["customer:list:view","order:list:view","order:audit:view","order:audit:approve","service:list:view","product:list:view"]},{id:"logistics_specialist",name:"物流专员",description:"专门处理物流相关事务的客服权限",permissions:["customer:list:view","order:list:view","logistics:shipping:view","logistics:shipping:edit","logistics:shipping:batchExport","service:list:view"]},{id:"product_specialist",name:"商品专员",description:"专门处理商品相关事务的客服权限",permissions:["customer:list:view","order:list:view","product:list:view","product:list:edit","product:add:create","product:inventory:manage","service:list:view"]}]),Re=[{key:"customer",name:"客户管理",children:[{key:"customer:list:view",name:"查看客户列表"},{key:"customer:list:edit",name:"编辑客户信息"},{key:"customer:list:create",name:"创建客户"},{key:"customer:list:assign",name:"分配客户"}]},{key:"order",name:"订单管理",children:[{key:"order:list:view",name:"查看订单列表"},{key:"order:list:edit",name:"编辑订单"},{key:"order:add:create",name:"创建订单"},{key:"order:audit:view",name:"查看审核订单"},{key:"order:audit:approve",name:"审核订单"},{key:"order:detail:cancel",name:"取消订单"}]},{key:"service",name:"客服管理",children:[{key:"service:list:view",name:"查看服务列表"},{key:"service:list:edit",name:"编辑服务记录"},{key:"service:afterSales:view",name:"查看售后服务"},{key:"service:afterSales:edit",name:"处理售后服务"}]},{key:"logistics",name:"物流管理",children:[{key:"logistics:shipping:view",name:"查看发货列表"},{key:"logistics:shipping:edit",name:"编辑发货信息"},{key:"logistics:shipping:batchExport",name:"批量导出"}]},{key:"product",name:"商品管理",children:[{key:"product:list:view",name:"查看商品列表"},{key:"product:list:edit",name:"编辑商品信息"},{key:"product:add:create",name:"添加商品"},{key:"product:inventory:manage",name:"库存管理"}]}],Ne=m(()=>pe.value.filter(e=>{const l=!he.value||e.name.includes(he.value),a=!we.value||e.customerServiceType===we.value;return l&&a})),Oe=e=>{switch(e){case i.AFTER_SALES:return"售后客服";case i.AUDIT:return"审核客服";case i.LOGISTICS:return"物流客服";case i.PRODUCT:return"商品客服";case i.GENERAL:return"通用客服";default:return"未知"}},De=e=>{switch(e){case i.AFTER_SALES:return"warning";case i.AUDIT:return"info";case i.LOGISTICS:return"success";case i.PRODUCT:return"primary";case i.GENERAL:default:return""}},Ge=e=>{switch(e){case s.ALL:return"全部数据";case s.DEPARTMENT:return"部门数据";case s.SELF:return"个人数据";case s.CUSTOM:return"自定义范围";default:return"未知"}},Me=e=>{switch(e){case s.ALL:return"danger";case s.DEPARTMENT:return"warning";case s.SELF:return"info";case s.CUSTOM:return"primary";default:return""}},ze=e=>({"customer:list:view":"查看客户列表","customer:list:edit":"编辑客户信息","customer:list:create":"创建客户","customer:list:assign":"分配客户","order:list:view":"查看订单列表","order:list:edit":"编辑订单","order:add:create":"创建订单","order:audit:view":"查看审核订单","order:audit:approve":"审核订单","order:detail:cancel":"取消订单","service:list:view":"查看服务列表","service:list:edit":"编辑服务记录","service:afterSales:view":"查看售后服务","service:afterSales:edit":"处理售后服务","logistics:shipping:view":"查看发货列表","logistics:shipping:edit":"编辑发货信息","logistics:shipping:batchExport":"批量导出","product:list:view":"查看商品列表","product:list:edit":"编辑商品信息","product:add:create":"添加商品","product:inventory:manage":"库存管理"}[e]||e),Ke=async()=>{await al(),el(),a.success("数据刷新成功")},Fe=()=>{a.info("导出权限配置功能开发中")},$e=()=>{be.value=!0},je=()=>{Ue.value={userId:"",customerServiceType:i.GENERAL,dataScope:s.PERSONAL,departmentId:"",permissionTemplate:"",customPermissions:[]},ge.value=!0},qe=e=>{if(!e)return Ue.value.customPermissions=[],void A(()=>{Pe.value?.setCheckedKeys([])});const l=Le.value.find(l=>l.id===e);l&&(Ue.value.customPermissions=[...l.permissions],A(()=>{Pe.value?.setCheckedKeys(l.permissions)}),a.success(`已应用 ${l.name} 模板`))},He=()=>{const e=[],l=a=>{a.forEach(a=>{e.push(a.key),a.children&&l(a.children)})};l(Re),Pe.value?.setCheckedKeys(e),Ue.value.customPermissions=e,a.success("已选择全部权限")},Qe=()=>{Pe.value?.setCheckedKeys([]),Ue.value.customPermissions=[],a.success("已清空权限选择")},Be=()=>{const e=[],l=a=>{a.forEach(a=>{a.children&&a.children.length>0&&(e.push(a.key),l(a.children))})};l(Re),e.forEach(e=>{const l=Pe.value?.getNode(e);l&&l.expand()})},Je=()=>{const e=[],l=a=>{a.forEach(a=>{a.children&&a.children.length>0&&(e.push(a.key),l(a.children))})};l(Re),e.forEach(e=>{const l=Pe.value?.getNode(e);l&&l.collapse()})},We=()=>{if(!Pe.value)return 0;return(Pe.value.getCheckedKeys()||[]).length},Xe=()=>{const e=Pe.value?.getCheckedKeys()||[],l=Pe.value?.getHalfCheckedKeys()||[];Ue.value.customPermissions=[...e,...l]},Ye=async()=>{if(Ue.value.userId&&Ue.value.customerServiceType)try{const e=Pe.value?.getCheckedKeys()||[],l=Pe.value?.getHalfCheckedKeys()||[],t=[...e,...l],s=fe.value.find(e=>e.id===Ue.value.userId);if(!s)return void a.error("未找到选中的用户");const i={id:`cs_${Date.now()}`,name:s.name,email:s.email,department:s.department,departmentId:Ue.value.departmentId||"dept_cs",customerServiceType:Ue.value.customerServiceType,dataScope:Ue.value.dataScope,customPermissions:t,status:"active"};pe.value.push(i);const u=fe.value.findIndex(e=>e.id===Ue.value.userId);u>-1&&fe.value.splice(u,1),a.success("新增客服成功"),ge.value=!1,el()}catch(e){a.error("新增客服失败"),console.error("Add customer service error:",e)}else a.warning("请选择成员和客服类型")},Ze=async()=>{if(Ee.value.targetType&&Ee.value.template)try{a.success("批量配置成功"),be.value=!1,Ke()}catch(e){a.error("批量配置失败")}else a.warning("请选择客服类型和权限模板")},el=()=>{const e=pe.value.length,l=pe.value.filter(e=>"active"===e.status).length,a=pe.value.filter(e=>e.customPermissions&&e.customPermissions.length>0).length;Te.value={total:e,online:l,configRate:e>0?Math.round(a/e*100):0}},ll=()=>{a.info("搜索完成")},al=async()=>{try{pe.value=[];try{const e=await n();ye.value=(e.data||[]).map(e=>({id:e.id,name:e.name,code:e.code||e.id,description:e.description||""}))}catch(e){console.warn("加载部门数据失败:",e),a.warning("加载部门数据失败，请检查网络连接"),ye.value=[]}try{const e=(await o.getUsers()).data||[],l=pe.value.map(e=>e.email);fe.value=e.filter(e=>!l.includes(e.email)).map(e=>({id:e.id.toString(),name:e.realName,email:e.email,department:e.department?.name||"未分配",role:e.role}))}catch(l){console.warn("加载用户数据失败:",l),a.warning("加载用户数据失败，请检查网络连接"),fe.value=[]}}catch(t){a.error("加载客服数据失败"),console.error("Load customer services error:",t)}},tl=e=>{Ie.value=e,Ae.value={customerServiceType:e.customerServiceType,dataScope:e.dataScope,departmentIds:e.departmentIds||[],customPermissions:e.customPermissions||[]},Ce.value=!0},sl=()=>{xe.value&&(Ae.value.customPermissions=xe.value.getCheckedKeys())},il=async()=>{try{if(!Ie.value)return;await new Promise(e=>setTimeout(e,500));const e=pe.value.findIndex(e=>e.id===Ie.value.id);e>-1&&(pe.value[e]={...pe.value[e],customerServiceType:Ae.value.customerServiceType,dataScope:Ae.value.dataScope,departmentIds:Ae.value.departmentIds,customPermissions:Ae.value.customPermissions}),Ce.value=!1,a.success("权限配置保存成功")}catch(e){a.error("保存权限配置失败"),console.error("Save permissions error:",e)}};return p(()=>{al(),el()}),(a,t)=>{const r=y("el-statistic"),o=y("el-button"),n=y("el-input"),v=y("el-option"),m=y("el-select"),p=y("el-table-column"),A=y("el-tag"),el=y("el-link"),al=y("el-table"),ul=y("el-form-item"),rl=y("el-form"),dl=y("el-dialog"),ol=y("el-descriptions-item"),nl=y("el-descriptions"),cl=y("el-alert"),vl=y("el-empty"),ml=y("el-icon");return h(),f("div",x,[w("div",P,[w("div",U,[t[22]||(t[22]=w("h1",{class:"page-title"},"客服权限管理",-1)),t[23]||(t[23]=w("p",{class:"page-subtitle"},"专门针对客服团队的权限管理工具，按业务类型进行权限配置",-1)),w("div",L,[b(r,{title:"客服总数",value:Te.value.total},null,8,["value"]),b(r,{title:"在线客服",value:Te.value.online},null,8,["value"]),b(r,{title:"权限配置完成率",value:Te.value.configRate,suffix:"%"},null,8,["value"])])]),w("div",R,[b(o,{onClick:je,type:"primary",icon:"Plus"},{default:g(()=>[...t[24]||(t[24]=[_("新增客服",-1)])]),_:1}),b(o,{onClick:Ke,type:"default"},{default:g(()=>[...t[25]||(t[25]=[_("刷新数据",-1)])]),_:1}),b(o,{onClick:Fe,type:"success"},{default:g(()=>[...t[26]||(t[26]=[_("导出配置",-1)])]),_:1}),b(o,{onClick:$e,type:"warning"},{default:g(()=>[...t[27]||(t[27]=[_("批量配置",-1)])]),_:1})])]),w("div",N,[b(n,{modelValue:he.value,"onUpdate:modelValue":t[0]||(t[0]=e=>he.value=e),placeholder:"搜索客服姓名",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),b(m,{modelValue:we.value,"onUpdate:modelValue":t[1]||(t[1]=e=>we.value=e),placeholder:"客服类型",style:{width:"150px","margin-right":"10px"},clearable:""},{default:g(()=>[b(v,{label:"全部",value:""}),b(v,{label:"售后客服",value:k(i).AFTER_SALES},null,8,["value"]),b(v,{label:"审核客服",value:k(i).AUDIT},null,8,["value"]),b(v,{label:"物流客服",value:k(i).LOGISTICS},null,8,["value"]),b(v,{label:"商品客服",value:k(i).PRODUCT},null,8,["value"]),b(v,{label:"通用客服",value:k(i).GENERAL},null,8,["value"])]),_:1},8,["modelValue"]),b(o,{onClick:ll,type:"primary"},{default:g(()=>[...t[28]||(t[28]=[_("搜索",-1)])]),_:1})]),b(al,{data:Ne.value,style:{width:"100%"}},{default:g(()=>[b(p,{prop:"name",label:"姓名",width:"120"}),b(p,{label:"邮箱",width:"200"},{default:g(({row:e})=>[_(S(k(d)(e.email,k(u).EMAIL,k(c).currentUser?.id)),1)]),_:1}),b(p,{prop:"department",label:"部门",width:"120"}),b(p,{label:"客服类型",width:"120"},{default:g(({row:e})=>[b(A,{type:De(e.customerServiceType)},{default:g(()=>[_(S(Oe(e.customerServiceType)),1)]),_:2},1032,["type"])]),_:1}),b(p,{label:"成员数量",width:"100"},{default:g(({row:e})=>[b(el,{type:"primary",onClick:l=>{return a=e.customerServiceType,ke.value=a,Se.value=pe.value.filter(e=>e.customerServiceType===a),void(_e.value=!0);var a},style:{"font-weight":"bold"}},{default:g(()=>{return[_(S((l=e.customerServiceType,pe.value.filter(e=>e.customerServiceType===l).length)),1)];var l}),_:2},1032,["onClick"])]),_:1}),b(p,{label:"数据范围",width:"120"},{default:g(({row:e})=>[b(A,{type:Me(e.dataScope)},{default:g(()=>[_(S(Ge(e.dataScope)),1)]),_:2},1032,["type"])]),_:1}),b(p,{label:"自定义权限","min-width":"200"},{default:g(({row:e})=>[w("div",O,[(h(!0),f(E,null,C(e.customPermissions,e=>(h(),V(A,{key:e,size:"small",style:{"margin-right":"5px","margin-bottom":"2px"}},{default:g(()=>[_(S(ze(e)),1)]),_:2},1024))),128)),e.customPermissions?.length?T("",!0):(h(),f("span",D," 无自定义权限 "))])]),_:1}),b(p,{prop:"status",label:"状态",width:"80"},{default:g(({row:e})=>[b(A,{type:"active"===e.status?"success":"danger"},{default:g(()=>[_(S("active"===e.status?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),b(p,{label:"操作",width:"200",fixed:"right"},{default:g(({row:e})=>[b(o,{onClick:l=>tl(e),size:"small",type:"primary"},{default:g(()=>[...t[29]||(t[29]=[_(" 配置权限 ",-1)])]),_:1},8,["onClick"]),b(o,{onClick:l=>{return a=e,Ie.value=a,void(Ve.value=!0);var a},size:"small"},{default:g(()=>[...t[30]||(t[30]=[_(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),b(dl,{modelValue:Ce.value,"onUpdate:modelValue":t[6]||(t[6]=e=>Ce.value=e),title:`配置客服权限 - ${Ie.value?.name}`,width:"800px"},{footer:g(()=>[w("span",q,[b(o,{onClick:t[5]||(t[5]=e=>Ce.value=!1)},{default:g(()=>[...t[36]||(t[36]=[_("取消",-1)])]),_:1}),b(o,{type:"primary",onClick:il},{default:g(()=>[...t[37]||(t[37]=[_("保存",-1)])]),_:1})])]),default:g(()=>[b(rl,{model:Ae.value,"label-width":"120px"},{default:g(()=>[b(ul,{label:"客服类型"},{default:g(()=>[b(m,{modelValue:Ae.value.customerServiceType,"onUpdate:modelValue":t[2]||(t[2]=e=>Ae.value.customerServiceType=e),style:{width:"100%"}},{default:g(()=>[b(v,{label:"售后客服",value:k(i).AFTER_SALES},null,8,["value"]),b(v,{label:"审核客服",value:k(i).AUDIT},null,8,["value"]),b(v,{label:"物流客服",value:k(i).LOGISTICS},null,8,["value"]),b(v,{label:"商品客服",value:k(i).PRODUCT},null,8,["value"]),b(v,{label:"通用客服",value:k(i).GENERAL},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"数据范围"},{default:g(()=>[b(m,{modelValue:Ae.value.dataScope,"onUpdate:modelValue":t[3]||(t[3]=e=>Ae.value.dataScope=e),style:{width:"100%"}},{default:g(()=>[b(v,{label:"自定义范围",value:k(s).CUSTOM},null,8,["value"]),b(v,{label:"个人数据",value:k(s).SELF},null,8,["value"]),b(v,{label:"部门数据",value:k(s).DEPARTMENT},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),Ae.value.dataScope===k(s).DEPARTMENT?(h(),V(ul,{key:0,label:"可访问部门"},{default:g(()=>[b(m,{modelValue:Ae.value.departmentIds,"onUpdate:modelValue":t[4]||(t[4]=e=>Ae.value.departmentIds=e),multiple:"",placeholder:"选择可访问的部门",style:{width:"100%"}},{default:g(()=>[(h(!0),f(E,null,C(ye.value,e=>(h(),V(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):T("",!0),b(ul,{label:"自定义权限"},{default:g(()=>[w("div",G,[b(k(e),{ref_key:"permissionTreeRef",ref:xe,data:Re,props:{children:"children",label:"name"},"show-checkbox":"","node-key":"key","default-checked-keys":Ae.value.customPermissions,onCheck:sl},null,8,["default-checked-keys"])])]),_:1}),b(ul,{label:"权限说明"},{default:g(()=>[w("div",M,[Ae.value.customerServiceType===k(i).AFTER_SALES?(h(),f("div",z,[...t[31]||(t[31]=[w("p",null,[w("strong",null,"售后客服权限说明：")],-1),w("ul",null,[w("li",null,"可以查看和处理所有售后订单"),w("li",null,"可以查看退款、退货相关订单"),w("li",null,"可以处理客户投诉和售后问题")],-1)])])):Ae.value.customerServiceType===k(i).AUDIT?(h(),f("div",K,[...t[32]||(t[32]=[w("p",null,[w("strong",null,"审核客服权限说明：")],-1),w("ul",null,[w("li",null,"可以查看和处理待审核订单"),w("li",null,"可以审核客户信息和订单信息"),w("li",null,"可以批准或拒绝订单审核")],-1)])])):Ae.value.customerServiceType===k(i).LOGISTICS?(h(),f("div",F,[...t[33]||(t[33]=[w("p",null,[w("strong",null,"物流客服权限说明：")],-1),w("ul",null,[w("li",null,"可以查看和处理物流订单"),w("li",null,"可以更新物流状态和跟踪信息"),w("li",null,"可以处理配送相关问题")],-1)])])):Ae.value.customerServiceType===k(i).PRODUCT?(h(),f("div",$,[...t[34]||(t[34]=[w("p",null,[w("strong",null,"商品客服权限说明：")],-1),w("ul",null,[w("li",null,"可以查看和管理商品列表"),w("li",null,"可以处理商品相关咨询"),w("li",null,"可以查看所有订单信息")],-1)])])):Ae.value.customerServiceType===k(i).GENERAL?(h(),f("div",j,[...t[35]||(t[35]=[w("p",null,[w("strong",null,"通用客服权限说明：")],-1),w("ul",null,[w("li",null,"根据自定义权限配置访问数据"),w("li",null,"可以处理一般性客户咨询"),w("li",null,"权限范围由管理员具体配置")],-1)])])):T("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),b(dl,{modelValue:Ve.value,"onUpdate:modelValue":t[7]||(t[7]=e=>Ve.value=e),title:`权限详情 - ${Ie.value?.name}`,width:"600px"},{default:g(()=>[Ie.value?(h(),f("div",H,[b(nl,{column:2,border:""},{default:g(()=>[b(ol,{label:"姓名"},{default:g(()=>[_(S(Ie.value.name),1)]),_:1}),b(ol,{label:"邮箱"},{default:g(()=>[_(S(Ie.value.email),1)]),_:1}),b(ol,{label:"部门"},{default:g(()=>[_(S(Ie.value.department),1)]),_:1}),b(ol,{label:"客服类型"},{default:g(()=>[b(A,{type:De(Ie.value.customerServiceType)},{default:g(()=>[_(S(Oe(Ie.value.customerServiceType)),1)]),_:1},8,["type"])]),_:1}),b(ol,{label:"数据范围"},{default:g(()=>[b(A,{type:Me(Ie.value.dataScope)},{default:g(()=>[_(S(Ge(Ie.value.dataScope)),1)]),_:1},8,["type"])]),_:1}),b(ol,{label:"状态"},{default:g(()=>[b(A,{type:"active"===Ie.value.status?"success":"danger"},{default:g(()=>[_(S("active"===Ie.value.status?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1})]),_:1}),w("div",Q,[t[38]||(t[38]=w("h4",null,"自定义权限列表：",-1)),Ie.value.customPermissions?.length?(h(),f("div",B,[(h(!0),f(E,null,C(Ie.value.customPermissions,e=>(h(),V(A,{key:e,style:{"margin-right":"8px","margin-bottom":"8px"}},{default:g(()=>[_(S(ze(e)),1)]),_:2},1024))),128))])):(h(),f("div",J," 无自定义权限 "))])])):T("",!0)]),_:1},8,["modelValue","title"]),b(dl,{modelValue:be.value,"onUpdate:modelValue":t[12]||(t[12]=e=>be.value=e),title:"批量权限配置",width:"600px"},{footer:g(()=>[b(o,{onClick:t[11]||(t[11]=e=>be.value=!1)},{default:g(()=>[...t[40]||(t[40]=[_("取消",-1)])]),_:1}),b(o,{onClick:Ze,type:"primary"},{default:g(()=>[...t[41]||(t[41]=[_("确认配置",-1)])]),_:1})]),default:g(()=>[w("div",W,[b(cl,{title:"批量配置说明",type:"warning",closable:!1,style:{"margin-bottom":"20px"}},{default:g(()=>[...t[39]||(t[39]=[_(" 选择客服类型和权限模板，可以快速为多个客服配置相同的权限设置 ",-1)])]),_:1}),b(rl,{"label-width":"120px"},{default:g(()=>[b(ul,{label:"目标客服类型"},{default:g(()=>[b(m,{modelValue:Ee.value.targetType,"onUpdate:modelValue":t[8]||(t[8]=e=>Ee.value.targetType=e),placeholder:"选择客服类型"},{default:g(()=>[b(v,{label:"售后客服",value:"after_sales"}),b(v,{label:"审核客服",value:"audit"}),b(v,{label:"物流客服",value:"logistics"}),b(v,{label:"商品客服",value:"product"}),b(v,{label:"通用客服",value:"general"})]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"权限模板"},{default:g(()=>[b(m,{modelValue:Ee.value.template,"onUpdate:modelValue":t[9]||(t[9]=e=>Ee.value.template=e),placeholder:"选择权限模板"},{default:g(()=>[b(v,{label:"基础权限",value:"basic"}),b(v,{label:"标准权限",value:"standard"}),b(v,{label:"高级权限",value:"advanced"})]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"数据范围"},{default:g(()=>[b(m,{modelValue:Ee.value.dataScope,"onUpdate:modelValue":t[10]||(t[10]=e=>Ee.value.dataScope=e),placeholder:"选择数据范围"},{default:g(()=>[b(v,{label:"个人数据",value:"personal"}),b(v,{label:"部门数据",value:"department"}),b(v,{label:"全部数据",value:"all"})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),b(dl,{modelValue:ge.value,"onUpdate:modelValue":t[19]||(t[19]=e=>ge.value=e),title:"新增客服",width:"800px"},{footer:g(()=>[b(o,{onClick:t[18]||(t[18]=e=>ge.value=!1)},{default:g(()=>[...t[49]||(t[49]=[_("取消",-1)])]),_:1}),b(o,{onClick:Ye,type:"primary"},{default:g(()=>[...t[50]||(t[50]=[_("确认添加",-1)])]),_:1})]),default:g(()=>[w("div",X,[b(cl,{title:"新增客服说明",type:"info",closable:!1,style:{"margin-bottom":"20px"}},{default:g(()=>[...t[42]||(t[42]=[_(" 选择系统成员作为客服，并配置相应的客服类型和权限 ",-1)])]),_:1}),b(rl,{model:Ue.value,"label-width":"120px"},{default:g(()=>[b(ul,{label:"选择成员",required:""},{default:g(()=>[b(m,{modelValue:Ue.value.userId,"onUpdate:modelValue":t[13]||(t[13]=e=>Ue.value.userId=e),placeholder:"选择系统成员",style:{width:"100%"},filterable:""},{default:g(()=>[(h(!0),f(E,null,C(fe.value,e=>(h(),V(v,{key:e.id,label:`${e.name} (${k(d)(e.email,k(u).EMAIL,k(c).currentUser?.id)})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"客服类型",required:""},{default:g(()=>[b(m,{modelValue:Ue.value.customerServiceType,"onUpdate:modelValue":t[14]||(t[14]=e=>Ue.value.customerServiceType=e),placeholder:"选择客服类型"},{default:g(()=>[b(v,{label:"售后客服",value:k(i).AFTER_SALES},null,8,["value"]),b(v,{label:"审核客服",value:k(i).AUDIT},null,8,["value"]),b(v,{label:"物流客服",value:k(i).LOGISTICS},null,8,["value"]),b(v,{label:"商品客服",value:k(i).PRODUCT},null,8,["value"]),b(v,{label:"通用客服",value:k(i).GENERAL},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"数据范围",required:""},{default:g(()=>[b(m,{modelValue:Ue.value.dataScope,"onUpdate:modelValue":t[15]||(t[15]=e=>Ue.value.dataScope=e),placeholder:"选择数据范围"},{default:g(()=>[b(v,{label:"个人数据",value:k(s).PERSONAL},null,8,["value"]),b(v,{label:"部门数据",value:k(s).DEPARTMENT},null,8,["value"]),b(v,{label:"全部数据",value:k(s).ALL},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"所属部门"},{default:g(()=>[b(m,{modelValue:Ue.value.departmentId,"onUpdate:modelValue":t[16]||(t[16]=e=>Ue.value.departmentId=e),placeholder:"选择部门",style:{width:"100%"}},{default:g(()=>[(h(!0),f(E,null,C(ye.value,e=>(h(),V(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),b(ul,{label:"权限模板"},{default:g(()=>[b(m,{modelValue:Ue.value.permissionTemplate,"onUpdate:modelValue":t[17]||(t[17]=e=>Ue.value.permissionTemplate=e),placeholder:"选择权限模板（可选）",style:{width:"100%"},clearable:"",onChange:qe},{default:g(()=>[(h(!0),f(E,null,C(Le.value,e=>(h(),V(v,{key:e.id,label:e.name,value:e.id},{default:g(()=>[w("div",Y,[w("span",null,S(e.name),1),w("span",Z,S(e.description),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),t[43]||(t[43]=w("div",{style:{"margin-top":"8px","font-size":"12px",color:"#666"}}," 选择模板后将自动勾选对应权限，您也可以手动调整 ",-1))]),_:1}),b(ul,{label:"自定义权限"},{default:g(()=>[w("div",ee,[w("div",le,[w("div",ae,[b(o,{size:"small",onClick:He},{default:g(()=>[...t[44]||(t[44]=[_("全选",-1)])]),_:1}),b(o,{size:"small",onClick:Qe},{default:g(()=>[...t[45]||(t[45]=[_("清空",-1)])]),_:1}),b(o,{size:"small",onClick:Be},{default:g(()=>[...t[46]||(t[46]=[_("展开全部",-1)])]),_:1}),b(o,{size:"small",onClick:Je},{default:g(()=>[...t[47]||(t[47]=[_("收起全部",-1)])]),_:1})]),w("div",te," 已选择 "+S(We())+" 项权限 ",1)]),w("div",se,[b(k(e),{ref_key:"addPermissionTreeRef",ref:Pe,data:Re,"show-checkbox":"","node-key":"key","default-checked-keys":Ue.value.customPermissions,props:{children:"children",label:"name"},"default-expand-all":!1,"check-strictly":!0,onCheck:Xe,class:"permission-tree"},{default:g(({node:e,data:l})=>[w("div",ie,[w("span",ue,S(l.name),1),l.children?T("",!0):(h(),f("span",re,S(l.key),1))])]),_:1},8,["default-checked-keys"])]),w("div",de,[b(cl,{title:"权限说明",type:"info",closable:!1,"show-icon":""},{default:g(()=>[...t[48]||(t[48]=[w("ul",null,[w("li",null,"选择权限模板可快速配置常用权限组合"),w("li",null,"您可以在模板基础上进行个性化调整"),w("li",null,"父级权限被选中时，子级权限会自动选中"),w("li",null,"建议根据客服的实际工作需要分配最小必要权限")],-1)])]),_:1})])])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),b(dl,{modelValue:_e.value,"onUpdate:modelValue":t[21]||(t[21]=e=>_e.value=e),title:`${Oe(ke.value)} - 成员详情`,width:"700px"},{footer:g(()=>[b(o,{onClick:t[20]||(t[20]=e=>_e.value=!1)},{default:g(()=>[...t[52]||(t[52]=[_("关闭",-1)])]),_:1})]),default:g(()=>[w("div",oe,[b(cl,{title:`当前共有 ${Se.value.length} 名${Oe(ke.value)}`,type:"info",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),b(al,{data:Se.value,style:{width:"100%"}},{default:g(()=>[b(p,{prop:"name",label:"姓名",width:"120"}),b(p,{label:"邮箱",width:"200"},{default:g(({row:e})=>[_(S(k(d)(e.email,k(u).EMAIL,k(c).currentUser?.id)),1)]),_:1}),b(p,{prop:"department",label:"部门",width:"120"}),b(p,{label:"数据范围",width:"100"},{default:g(({row:e})=>[b(A,{type:Me(e.dataScope),size:"small"},{default:g(()=>[_(S(Ge(e.dataScope)),1)]),_:2},1032,["type"])]),_:1}),b(p,{label:"状态",width:"80"},{default:g(({row:e})=>[b(A,{type:"active"===e.status?"success":"danger",size:"small"},{default:g(()=>[_(S("active"===e.status?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),b(p,{label:"操作",width:"120"},{default:g(({row:e})=>[b(o,{onClick:l=>tl(e),size:"small",type:"primary"},{default:g(()=>[...t[51]||(t[51]=[_(" 配置权限 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),0===Se.value.length?(h(),f("div",ne,[b(vl,{description:"暂无该类型的客服成员"})])):T("",!0)])]),_:1},8,["modelValue","title"]),w("div",ce,[w("div",ve,[w("div",me,[b(ml,null,{default:g(()=>[b(k(l))]),_:1}),t[53]||(t[53]=w("span",null,"使用说明",-1))]),t[54]||(t[54]=I('<div class="info-text" data-v-a0d60dee><p data-v-a0d60dee>专门针对客服团队的权限管理工具，支持按业务类型进行权限配置和数据范围控制</p><div class="service-types-simple" data-v-a0d60dee><span class="type-item" data-v-a0d60dee>售后客服</span><span class="type-item" data-v-a0d60dee>审核客服</span><span class="type-item" data-v-a0d60dee>物流客服</span><span class="type-item" data-v-a0d60dee>商品客服</span><span class="type-item" data-v-a0d60dee>通用客服</span></div></div>',1))])])])}}}),[["__scopeId","data-v-a0d60dee"]]);export{pe as default};
