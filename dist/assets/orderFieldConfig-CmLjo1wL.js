const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C4IdUW1A.js","assets/vendor-BtukhyiH.js","assets/elementPlus-DxaqjplL.js","assets/utils-DfI7e5Rl.js","assets/index-Cj-RrGL6.css"])))=>i.map(i=>d[i]);
import{l as e}from"./index-C4IdUW1A.js";import{aw as o,r,e as t}from"./vendor-BtukhyiH.js";import{isDevelopment as a}from"./env-DLalhsF6.js";const l={orderSource:{fieldName:"è®¢å•æ¥æº",options:[{label:"ðŸ›’ çº¿ä¸Šå•†åŸŽ",value:"online_store",icon:"ðŸ›’"},{label:"ðŸ“± å¾®ä¿¡å°ç¨‹åº",value:"wechat_mini",icon:"ðŸ“±"},{label:"ðŸ’¬ å¾®ä¿¡å®¢æœ",value:"wechat_service",icon:"ðŸ’¬"},{label:"ðŸ“ž ç”µè¯å’¨è¯¢",value:"phone_call",icon:"ðŸ“ž"},{label:"ðŸª çº¿ä¸‹é—¨åº—",value:"offline_store",icon:"ðŸª"},{label:"ðŸ‘¥ å®¢æˆ·æŽ¨è",value:"referral",icon:"ðŸ‘¥"},{label:"ðŸ“º å¹¿å‘ŠæŠ•æ”¾",value:"advertisement",icon:"ðŸ“º"},{label:"ðŸŽ¯ å…¶ä»–æ¸ é“",value:"other",icon:"ðŸŽ¯"}]},customFields:[]},s=o("orderFieldConfig",()=>{const o=r(JSON.parse(JSON.stringify(l))),s=r(!1),i=t(()=>o.value.orderSource.fieldName),d=t(()=>o.value.orderSource.options),c=t(()=>o.value.customFields),n=t(()=>o.value.customFields.filter(e=>e.showInList).sort((e,o)=>e.sortOrder-o.sortOrder)),u=async()=>{try{if(a()){const e=localStorage.getItem("crm_order_field_config");e?o.value=JSON.parse(e):m()}else try{const{api:r}=await e(async()=>{const{api:e}=await import("./index-C4IdUW1A.js").then(e=>e.T);return{api:e}},__vite__mapDeps([0,1,2,3,4])),t=await r.get("/system/order-field-config");t.data&&(o.value=t.data)}catch(r){console.warn("ä»ŽAPIåŠ è½½è®¢å•å­—æ®µé…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:",r)}}catch(r){console.error("åŠ è½½è®¢å•å­—æ®µé…ç½®å¤±è´¥:",r)}},m=async()=>{try{if(a())localStorage.setItem("crm_order_field_config",JSON.stringify(o.value));else try{const{api:r}=await e(async()=>{const{api:e}=await import("./index-C4IdUW1A.js").then(e=>e.T);return{api:e}},__vite__mapDeps([0,1,2,3,4]));await r.put("/system/order-field-config",o.value)}catch(r){throw console.error("ä¿å­˜è®¢å•å­—æ®µé…ç½®åˆ°APIå¤±è´¥:",r),r}}catch(r){throw console.error("ä¿å­˜è®¢å•å­—æ®µé…ç½®å¤±è´¥:",r),r}};return u(),{config:o,loading:s,orderSourceFieldName:i,orderSourceOptions:d,customFields:c,visibleCustomFields:n,loadConfig:u,saveConfig:m,updateOrderSourceConfig:(e,r)=>{o.value.orderSource.fieldName=e,o.value.orderSource.options=r,m()},addCustomField:e=>{const r={...e,id:`field_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sortOrder:o.value.customFields.length};return o.value.customFields.push(r),m(),r},updateCustomField:(e,r)=>{const t=o.value.customFields.findIndex(o=>o.id===e);t>-1&&(o.value.customFields[t]={...o.value.customFields[t],...r},m())},deleteCustomField:e=>{o.value.customFields=o.value.customFields.filter(o=>o.id!==e),o.value.customFields.forEach((e,o)=>{e.sortOrder=o}),m()},reorderCustomFields:e=>{const r=[];e.forEach((e,t)=>{const a=o.value.customFields.find(o=>o.id===e);a&&(a.sortOrder=t,r.push(a))}),o.value.customFields=r,m()},resetToDefault:()=>{o.value=JSON.parse(JSON.stringify(l)),m()},getFieldByKey:e=>o.value.customFields.find(o=>o.fieldKey===e)}});export{s as u};
