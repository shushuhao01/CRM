import{u as e,q as a,_ as l,s as t,d as s}from"./index-BGtT17ll.js";import{E as n,b as r,J as o,u as d,r as i,Z as u,d as c,P as p,Q as m,ao as v,T as g,H as f,a3 as y,ap as h,F as b}from"./elementPlus-DxaqjplL.js";import{l as _,e as w,b as k,ag as S,m as V,q as C,H as T,U as x,O as N,S as U,r as I,Z as D,w as P,M as $,Q as z,p as j,T as L,a9 as O,F as E,J as B,u as Y,A as H,Y as q,P as M,V as R,aq as A}from"./vendor-BtukhyiH.js";import{O as F}from"./OrderDetailDialog-Da0FfnEx.js";import"./utils-DfI7e5Rl.js";import"./sensitiveInfo-PTigg6SS.js";const J={key:0},Q={key:1,class:"no-permission"},Z=l(_({__name:"LogisticsStatusPermission",setup(l){const t=e(),s=a(),r=w(()=>!!t.isSuperAdmin||(!!t.isWhitelistMember||(!!t.permissions.includes("logistics:status")||("customer_service"===t.currentUser?.role||("manager"===t.currentUser?.role||"department_head"===t.currentUser?.role||"logistics"===t.currentUser?.department&&"supervisor"===t.currentUser?.position)))));return k(async()=>{try{await s.fetchUserPermission(),r.value||n.warning("您没有访问此功能的权限")}catch(e){console.error("获取用户权限失败:",e),n.error("权限验证失败，请重新登录")}}),(e,a)=>{const l=S("el-button"),t=S("el-result");return r.value?(C(),V("div",J,[T(e.$slots,"default",{},void 0,!0)])):(C(),V("div",Q,[x(t,{icon:"warning",title:"权限不足","sub-title":"您没有访问物流状态更新功能的权限，请联系管理员"},{extra:N(()=>[x(l,{onClick:a[0]||(a[0]=a=>e.$router.go(-1))},{default:N(()=>[...a[1]||(a[1]=[U("返回上一页",-1)])]),_:1})]),_:1})]))}}}),[["__scopeId","data-v-c33834c8"]]),W={class:"order-info"},G={style:{float:"left"}},K={style:{float:"right",color:"var(--el-text-color-secondary)"}},X={key:1,class:"batch-update-container"},ee={class:"batch-header"},ae={class:"batch-actions"},le={class:"batch-summary"},te={class:"dialog-footer"},se=l(_({__name:"StatusUpdateDialog",props:{modelValue:{type:Boolean},orderInfo:{},selectedOrders:{default:()=>[]}},emits:["update:modelValue","success"],setup(e,{emit:l}){const t=e,s=l,o=a(),d=I(),i=I(!1),u=I(""),c=I([]),p=w({get:()=>t.modelValue,set:e=>s("update:modelValue",e)}),m=w(()=>t.selectedOrders.length>0),v=D({newStatus:"",remark:""}),g=[{value:"delivered",label:"已签收",description:"客户已确认收货"},{value:"rejected",label:"拒收",description:"客户拒绝接收包裹"},{value:"rejected_returned",label:"拒收已退回",description:"拒收包裹已退回发货地"},{value:"refunded",label:"退货退款",description:"已处理退货退款"},{value:"after_sales_created",label:"已建售后",description:"已创建售后订单"},{value:"abnormal",label:"状态异常",description:"物流状态异常，需要人工处理"}],f={newStatus:[{required:!0,message:"请选择新状态",trigger:"change"}]},y=e=>{e&&(c.value.forEach(a=>{a.newStatus=e}),n.success(`已将所有订单状态统一设置为"${_(e)}"`))},h=()=>{c.value.forEach(e=>{e.newStatus="",e.remark=""}),u.value="",n.info("已清空所有状态设置")},b=()=>c.value.filter(e=>e.newStatus).length,_=e=>{const a=g.find(a=>a.value===e);return a?.label||e},k=e=>({pending_transfer:"待流转",pending_audit:"待审核",audit_rejected:"审核拒绝",pending_shipment:"待发货",shipped:"已发货",delivered:"已签收",logistics_returned:"物流部退回",logistics_cancelled:"物流部取消",package_exception:"包裹异常",rejected:"拒收",rejected_returned:"拒收已退回",after_sales_created:"已建售后",pending_cancel:"待取消",cancel_failed:"取消失败",cancelled:"已取消",draft:"草稿",picked_up:"已揽收",in_transit:"运输中",out_for_delivery:"派送中",exception:"异常",returned:"已退回",refunded:"退货退款",abnormal:"状态异常"}[e||""]||e||""),T=e=>({pending_transfer:"info",pending_audit:"warning",audit_rejected:"danger",pending_shipment:"primary",shipped:"success",delivered:"success",logistics_returned:"warning",logistics_cancelled:"info",package_exception:"danger",rejected:"danger",rejected_returned:"warning",after_sales_created:"info",pending_cancel:"warning",cancel_failed:"danger",cancelled:"info",draft:"info",picked_up:"primary",in_transit:"primary",out_for_delivery:"warning",exception:"danger",returned:"danger",refunded:"danger",abnormal:"danger"}[e||""]||"info"),B=e=>{const a=g.find(a=>a.value===e);return a?.description||""},Y=async()=>{try{if(m.value){const e=c.value.filter(e=>e.newStatus);if(0===e.length)return void n.warning("请至少为一个订单选择新状态");const a=`确定要更新 ${e.length} 个订单的状态吗？`;await r.confirm(a,"确认批量更新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i.value=!0;const l=[],t=[];for(const s of e){const e=o.updateOrderStatus(s.orderNo,s.newStatus,s.remark||void 0).then(()=>{t.push({...s,status:s.newStatus})});l.push(e)}await Promise.all(l),n.success(`成功更新 ${e.length} 个订单状态`),s("success",{orders:t,newStatus:e[0].newStatus}),H()}else{if(!d.value)return;await d.value.validate();const e=`确定要将订单"${t.orderInfo?.orderNo}"的状态更新为"${_(v.newStatus)}"吗？`;if(await r.confirm(e,"确认更新",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i.value=!0,t.orderInfo){await o.updateOrderStatus(t.orderInfo.orderNo,v.newStatus,v.remark||void 0),n.success("订单状态更新成功");const e=[{...t.orderInfo,status:v.newStatus}];s("success",{orders:e,newStatus:v.newStatus}),H()}}}catch(e){if("cancel"!==e){console.error("[StatusUpdateDialog] 更新订单状态失败:",e);const a=e?.message||e?.data?.message||"更新失败，请重试";n.error(a)}}finally{i.value=!1}},H=()=>{p.value=!1,q()},q=()=>{v.newStatus="",v.remark="",u.value="",c.value=[],d.value?.clearValidate()};return P(p,e=>{e&&(q(),m.value&&(c.value=t.selectedOrders.map(e=>({...e,newStatus:"",remark:""}))))}),(a,l)=>{const t=S("el-tag"),s=S("el-form-item"),n=S("el-option"),r=S("el-select"),o=S("el-input"),_=S("el-alert"),w=S("el-form"),I=S("el-button"),D=S("el-table-column"),P=S("el-table"),q=S("el-scrollbar"),M=S("el-dialog");return C(),$(M,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=e=>p.value=e),title:m.value?"批量更新状态":"更新订单状态",width:m.value?"800px":"500px",onClose:H},{footer:N(()=>[j("div",te,[x(I,{onClick:H},{default:N(()=>[...l[8]||(l[8]=[U("取消",-1)])]),_:1}),x(I,{type:"primary",loading:i.value,disabled:m.value&&0===b(),onClick:Y},{default:N(()=>[U(L(m.value?`批量更新 (${b()})`:"更新状态"),1)]),_:1},8,["loading","disabled"])])]),default:N(()=>[m.value?(C(),V("div",X,[j("div",ee,[x(_,{title:`选中 ${e.selectedOrders.length} 个订单`,type:"info",closable:!1,"show-icon":""},null,8,["title"]),j("div",ae,[x(r,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=e=>u.value=e),placeholder:"统一设置状态",clearable:"",style:{width:"200px","margin-right":"10px"},onChange:y},{default:N(()=>[(C(),V(E,null,O(g,e=>x(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),x(I,{onClick:h,size:"small"},{default:N(()=>[...l[7]||(l[7]=[U("清空所有状态",-1)])]),_:1})])]),x(q,{"max-height":"400px",class:"batch-order-list"},{default:N(()=>[x(P,{data:c.value,border:"",stripe:""},{default:N(()=>[x(D,{prop:"orderNo",label:"订单号",width:"150"}),x(D,{prop:"customerName",label:"客户名称",width:"120"}),x(D,{label:"当前状态",width:"100"},{default:N(({row:e})=>[x(t,{type:T(e.status),size:"small"},{default:N(()=>[U(L(k(e.status)),1)]),_:2},1032,["type"])]),_:1}),x(D,{label:"新状态",width:"180"},{default:N(({row:e})=>[x(r,{modelValue:e.newStatus,"onUpdate:modelValue":a=>e.newStatus=a,placeholder:"选择状态",size:"small",style:{width:"100%"}},{default:N(()=>[(C(),V(E,null,O(g,e=>x(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),x(D,{label:"备注","min-width":"150"},{default:N(({row:e})=>[x(o,{modelValue:e.remark,"onUpdate:modelValue":a=>e.remark=a,placeholder:"备注（可选）",size:"small",maxlength:"100"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])]),_:1}),j("div",le,[x(_,{title:`已设置状态：${b()} / ${e.selectedOrders.length}`,type:b()===e.selectedOrders.length?"success":"warning",closable:!1},null,8,["title","type"])])])):(C(),$(w,{key:0,ref_key:"formRef",ref:d,model:v,rules:f,"label-width":"100px"},{default:N(()=>[x(s,{label:"订单信息"},{default:N(()=>[j("div",W,[j("p",null,[l[4]||(l[4]=j("strong",null,"订单号：",-1)),U(L(e.orderInfo?.orderNo),1)]),j("p",null,[l[5]||(l[5]=j("strong",null,"客户：",-1)),U(L(e.orderInfo?.customerName),1)]),j("p",null,[l[6]||(l[6]=j("strong",null,"当前状态：",-1)),x(t,{type:T(e.orderInfo?.status)},{default:N(()=>[U(L(k(e.orderInfo?.status)),1)]),_:1},8,["type"])])])]),_:1}),x(s,{label:"新状态",prop:"newStatus"},{default:N(()=>[x(r,{modelValue:v.newStatus,"onUpdate:modelValue":l[0]||(l[0]=e=>v.newStatus=e),placeholder:"请选择新状态",style:{width:"100%"}},{default:N(()=>[(C(),V(E,null,O(g,e=>x(n,{key:e.value,label:e.label,value:e.value},{default:N(()=>[j("span",G,L(e.label),1),j("span",K,L(e.description),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),x(s,{label:"备注",prop:"remark"},{default:N(()=>[x(o,{modelValue:v.remark,"onUpdate:modelValue":l[1]||(l[1]=e=>v.remark=e),type:"textarea",rows:3,placeholder:"请输入更新备注（可选）",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),v.newStatus?(C(),$(s,{key:0,label:"状态说明"},{default:N(()=>[x(_,{title:B(v.newStatus),type:"info",closable:!1,"show-icon":""},null,8,["title"])]),_:1})):z("",!0)]),_:1},8,["model"]))]),_:1},8,["modelValue","title","width"])}}}),[["__scopeId","data-v-3639bcb3"]]),ne={class:"order-info"},re={style:{float:"left"}},oe={style:{float:"right",color:"var(--el-text-color-secondary)"}},de={class:"dialog-footer"},ie=l(_({__name:"TodoDialog",props:{modelValue:{type:Boolean},orderInfo:{}},emits:["update:modelValue","success"],setup(e,{emit:l}){const t=e,s=l,o=a(),d=I(),i=I(!1),u=w({get:()=>t.modelValue,set:e=>s("update:modelValue",e)}),c=D({days:null,remark:""}),p=[{value:1,label:"1天后处理",description:"明天处理"},{value:2,label:"2天后处理",description:"后天处理"},{value:3,label:"3天后处理",description:"3天后处理"},{value:5,label:"5天后处理",description:"工作日处理"},{value:7,label:"7天后处理",description:"一周后处理"},{value:10,label:"10天后处理",description:"10天后处理"}],m={days:[{required:!0,message:"请选择处理时间",trigger:"change"}]},v=e=>o.getStatusText(e||""),g=()=>{if(!c.days)return"";const e=new Date((new Date).getTime()+24*c.days*60*60*1e3);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} (${["周日","周一","周二","周三","周四","周五","周六"][e.getDay()]})`},f=async()=>{if(d.value&&t.orderInfo)try{await d.value.validate();const e=`确定要将订单"${t.orderInfo.orderNo}"设置为${c.days}天后处理吗？`;await r.confirm(e,"确认设置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i.value=!0,await o.setTodoOrder(t.orderInfo.orderNo,c.days,c.remark||void 0),n.success("待办设置成功"),s("success",{orderNo:t.orderInfo.orderNo,days:c.days,remark:c.remark||void 0}),y()}catch(e){"cancel"!==e&&(console.error("设置待办失败:",e),n.error("设置失败，请重试"))}finally{i.value=!1}},y=()=>{u.value=!1,h()},h=()=>{c.days=null,c.remark="",d.value?.clearValidate()};return P(u,e=>{e&&h()}),(a,l)=>{const t=S("el-tag"),s=S("el-form-item"),n=S("el-option"),r=S("el-select"),h=S("el-alert"),b=S("el-input"),_=S("el-form"),w=S("el-button"),k=S("el-dialog");return C(),$(k,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=e=>u.value=e),title:"设置待办",width:"450px",onClose:y},{footer:N(()=>[j("div",de,[x(w,{onClick:y},{default:N(()=>[...l[6]||(l[6]=[U("取消",-1)])]),_:1}),x(w,{type:"primary",loading:i.value,onClick:f},{default:N(()=>[...l[7]||(l[7]=[U(" 设置待办 ",-1)])]),_:1},8,["loading"])])]),default:N(()=>[x(_,{ref_key:"formRef",ref:d,model:c,rules:m,"label-width":"80px"},{default:N(()=>[x(s,{label:"订单信息"},{default:N(()=>{return[j("div",ne,[j("p",null,[l[3]||(l[3]=j("strong",null,"订单号：",-1)),U(L(e.orderInfo?.orderNo),1)]),j("p",null,[l[4]||(l[4]=j("strong",null,"客户：",-1)),U(L(e.orderInfo?.customerName),1)]),j("p",null,[l[5]||(l[5]=j("strong",null,"当前状态：",-1)),x(t,{type:(a=e.orderInfo?.status,o.getStatusType(a||""))},{default:N(()=>[U(L(v(e.orderInfo?.status)),1)]),_:1},8,["type"])])])];var a}),_:1}),x(s,{label:"处理时间",prop:"days"},{default:N(()=>[x(r,{modelValue:c.days,"onUpdate:modelValue":l[0]||(l[0]=e=>c.days=e),placeholder:"请选择处理时间",style:{width:"100%"}},{default:N(()=>[(C(),V(E,null,O(p,e=>x(n,{key:e.value,label:e.label,value:e.value},{default:N(()=>[j("span",re,L(e.label),1),j("span",oe,L(e.description),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),c.days?(C(),$(s,{key:0,label:"预计时间"},{default:N(()=>[x(h,{title:g(),type:"info",closable:!1,"show-icon":""},null,8,["title"])]),_:1})):z("",!0),x(s,{label:"备注",prop:"remark"},{default:N(()=>[x(b,{modelValue:c.remark,"onUpdate:modelValue":l[1]||(l[1]=e=>c.remark=e),type:"textarea",rows:3,placeholder:"请输入待办备注（可选）",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),x(s,null,{default:N(()=>[x(h,{title:"设置待办后，订单将在指定时间后重新显示在'待更新'列表中，并在'待办'导航栏中显示",type:"warning",closable:!1,"show-icon":""})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-d75dde9e"]]),ue={class:"tracking-header"},ce={class:"tracking-info"},pe={class:"tracking-content"},me={key:0,class:"loading-container"},ve={key:1,class:"empty-container"},ge={key:2,class:"timeline-container"},fe={class:"timeline-content"},ye={class:"timeline-description"},he={key:0,class:"timeline-location"},be={key:1,class:"timeline-operator"},_e={class:"dialog-footer"},we=l(_({__name:"TrackingDialog",props:{modelValue:{type:Boolean},trackingNo:{},logisticsCompany:{}},emits:["update:modelValue"],setup(e,{emit:l}){const t=e,s=l,r=a(),u=I(!1),c=I([]),p=w({get:()=>t.modelValue,set:e=>s("update:modelValue",e)}),m=w(()=>{if(0===c.value.length)return"";const e=c.value[0].description.toLowerCase();return e.includes("签收")||e.includes("已收货")?"delivered":e.includes("拒收")||e.includes("拒绝")?"rejected":e.includes("派送")||e.includes("配送")?"delivering":e.includes("运输")||e.includes("转运")?"shipping":e.includes("揽收")||e.includes("收件")?"picked":"unknown"}),v=w(()=>0===c.value.length?"":c.value[0].time),g=e=>({delivered:"已签收",rejected:"拒收",delivering:"派送中",shipping:"运输中",picked:"已揽收",unknown:"未知状态"}[e]||e),f=(e,a)=>{if(0===a){const a=e.description.toLowerCase();return a.includes("签收")?"success":a.includes("拒收")?"danger":a.includes("派送")?"warning":"primary"}return"info"},y=async()=>{if(t.trackingNo){u.value=!0;try{const e=await r.fetchTrackingInfo(t.trackingNo);c.value=e}catch(e){console.error("获取物流轨迹失败:",e),n.error("获取物流轨迹失败，请重试"),c.value=[]}finally{u.value=!1}}},h=()=>{y()},b=()=>{p.value=!1};return P(p,e=>{e&&t.trackingNo&&y()}),P(()=>t.trackingNo,e=>{e&&p.value&&y()}),(a,l)=>{const t=S("el-tag"),s=S("el-descriptions-item"),n=S("el-descriptions"),r=S("el-skeleton"),y=S("el-empty"),_=S("el-icon"),w=S("el-card"),k=S("el-timeline-item"),T=S("el-timeline"),I=S("el-button"),D=S("el-dialog");return C(),$(D,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=e=>p.value=e),title:"物流轨迹",width:"600px",onClose:b},{footer:N(()=>[j("div",_e,[x(I,{onClick:h,loading:u.value},{default:N(()=>[x(_,null,{default:N(()=>[x(Y(i))]),_:1}),l[1]||(l[1]=U(" 刷新 ",-1))]),_:1},8,["loading"]),x(I,{onClick:b},{default:N(()=>[...l[2]||(l[2]=[U("关闭",-1)])]),_:1})])]),default:N(()=>[j("div",ue,[j("div",ce,[x(n,{column:2,border:""},{default:N(()=>[x(s,{label:"快递单号"},{default:N(()=>[x(t,{type:"primary"},{default:N(()=>[U(L(e.trackingNo),1)]),_:1})]),_:1}),x(s,{label:"物流公司"},{default:N(()=>[U(L(e.logisticsCompany||"未知"),1)]),_:1}),x(s,{label:"当前状态"},{default:N(()=>{return[x(t,{type:(e=m.value,{delivered:"success",rejected:"danger",delivering:"warning",shipping:"info",picked:"primary",unknown:"info"}[e]||"info")},{default:N(()=>[U(L(g(m.value)),1)]),_:1},8,["type"])];var e}),_:1}),x(s,{label:"最后更新"},{default:N(()=>[U(L(v.value||"暂无数据"),1)]),_:1})]),_:1})])]),j("div",pe,[u.value?(C(),V("div",me,[x(r,{rows:5,animated:""})])):0===c.value.length?(C(),V("div",ve,[x(y,{description:"暂无物流轨迹信息"})])):(C(),V("div",ge,[x(T,null,{default:N(()=>[(C(!0),V(E,null,O(c.value,(e,a)=>(C(),$(k,{key:a,timestamp:e.time,type:f(e,a),size:0===a?"large":"normal",placement:"top"},{default:N(()=>[x(w,{class:B(["timeline-card",{latest:0===a}])},{default:N(()=>[j("div",fe,[j("div",ye,L(e.description),1),e.location?(C(),V("div",he,[x(_,null,{default:N(()=>[x(Y(o))]),_:1}),U(" "+L(e.location),1)])):z("",!0),e.operator?(C(),V("div",be,[x(_,null,{default:N(()=>[x(Y(d))]),_:1}),U(" 操作员："+L(e.operator),1)])):z("",!0)])]),_:2},1032,["class"])]),_:2},1032,["timestamp","type","size"]))),128))]),_:1})]))])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-d2a6e21c"]]),ke={class:"card-header"},Se={class:"header-left"},Ve={class:"header-right"},Ce={class:"settings-content"},Te={class:"sync-status"},xe={class:"action-buttons"},Ne={key:0,class:"sync-logs"},Ue={class:"log-content"},Ie={class:"log-summary"},De={key:0},Pe={key:1},$e={key:0,class:"log-errors"},ze=l(_({__name:"AutoSyncSettings",setup(e){const a=H("selectedCount",I(0)),l=H("handleBatchUpdate",()=>{n.warning("批量更新功能未初始化")}),s=I(!0),r=D({enabled:!1,interval:30,batchSize:50,retryCount:3,syncToPerformance:!0,syncToOrderList:!0}),o=D({isRunning:!1,lastSyncTime:"",config:{}}),d=I(!1),v=I([]),g=I(null),f=w({get:()=>{const e=[];return r.syncToPerformance&&e.push("performance"),r.syncToOrderList&&e.push("orderList"),e},set:e=>{r.syncToPerformance=e.includes("performance"),r.syncToOrderList=e.includes("orderList")}});k(()=>{y(),h(),b(),g.value=setInterval(h,3e4)}),q(()=>{g.value&&clearInterval(g.value)});const y=()=>{const e=t.getConfig();Object.assign(r,e)},h=()=>{const e=t.getStatus();Object.assign(o,e)},b=()=>{const e=localStorage.getItem("autoSyncLogs");if(e)try{v.value=JSON.parse(e).slice(-10)}catch(a){console.error("加载同步日志失败:",a)}},_=e=>{t.updateConfig({enabled:e}),h(),e?n.success("自动同步已启用"):n.info("自动同步已停用")},T=()=>{t.updateConfig(r),n.success("配置已保存")},P=()=>{t.updateConfig({syncToPerformance:r.syncToPerformance,syncToOrderList:r.syncToOrderList}),n.success("同步范围已更新")},B=async()=>{d.value=!0;try{const e=await t.manualSync();v.value.unshift(e),v.value.length>10&&(v.value=v.value.slice(0,10)),(()=>{try{localStorage.setItem("autoSyncLogs",JSON.stringify(v.value))}catch(e){console.error("保存同步日志失败:",e)}})(),h(),e.success?n.success(`手动同步完成，更新了 ${e.updatedCount} 个订单`):n.warning(`同步完成但有错误，更新了 ${e.updatedCount} 个订单，${e.errorCount} 个错误`)}catch(e){console.error("手动同步失败:",e),n.error(`手动同步失败: ${e}`)}finally{d.value=!1}},A=()=>{h(),n.success("状态已刷新")},F=e=>{if(!e)return"";try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(a){return e}};return(e,t)=>{const n=S("el-icon"),g=S("el-button"),y=S("el-switch"),h=S("el-input-number"),b=S("el-form-item"),w=S("el-checkbox"),k=S("el-checkbox-group"),I=S("el-form"),D=S("el-tag"),H=S("el-descriptions-item"),q=S("el-descriptions"),J=S("el-divider"),Q=S("el-collapse-item"),Z=S("el-collapse"),W=S("el-timeline-item"),G=S("el-timeline"),K=S("el-collapse-transition"),X=S("el-card");return C(),$(X,{class:"auto-sync-settings"},{header:N(()=>[j("div",ke,[j("div",Se,[x(g,{type:"text",onClick:t[0]||(t[0]=e=>s.value=!s.value),class:"collapse-btn"},{default:N(()=>[x(n,null,{default:N(()=>[s.value?(C(),$(Y(c),{key:0})):(C(),$(Y(p),{key:1}))]),_:1}),t[6]||(t[6]=j("span",null,"自动状态同步设置",-1))]),_:1})]),j("div",Ve,[x(g,{type:"primary",disabled:0===Y(a),onClick:Y(l),class:"batch-update-btn"},{default:N(()=>[x(n,null,{default:N(()=>[x(Y(m))]),_:1}),U(" 批量更新状态 ("+L(Y(a))+") ",1)]),_:1},8,["disabled","onClick"]),x(y,{modelValue:r.enabled,"onUpdate:modelValue":t[1]||(t[1]=e=>r.enabled=e),onChange:_,"active-text":"启用","inactive-text":"停用"},null,8,["modelValue"])])])]),default:N(()=>[x(K,null,{default:N(()=>[M(j("div",Ce,[x(I,{model:r,"label-width":"120px",disabled:!r.enabled},{default:N(()=>[x(b,{label:"检测间隔"},{default:N(()=>[x(h,{modelValue:r.interval,"onUpdate:modelValue":t[2]||(t[2]=e=>r.interval=e),min:5,max:1440,step:5,onChange:T},null,8,["modelValue"]),t[7]||(t[7]=j("span",{class:"form-text"},"分钟（建议30-60分钟）",-1))]),_:1}),x(b,{label:"批处理大小"},{default:N(()=>[x(h,{modelValue:r.batchSize,"onUpdate:modelValue":t[3]||(t[3]=e=>r.batchSize=e),min:10,max:200,step:10,onChange:T},null,8,["modelValue"]),t[8]||(t[8]=j("span",{class:"form-text"},"每次处理的订单数量",-1))]),_:1}),x(b,{label:"重试次数"},{default:N(()=>[x(h,{modelValue:r.retryCount,"onUpdate:modelValue":t[4]||(t[4]=e=>r.retryCount=e),min:1,max:10,onChange:T},null,8,["modelValue"]),t[9]||(t[9]=j("span",{class:"form-text"},"失败时的重试次数",-1))]),_:1}),x(b,{label:"同步范围"},{default:N(()=>[x(k,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=e=>f.value=e),onChange:P},{default:N(()=>[x(w,{label:"performance"},{default:N(()=>[...t[10]||(t[10]=[U("同步到业绩统计",-1)])]),_:1}),x(w,{label:"orderList"},{default:N(()=>[...t[11]||(t[11]=[U("同步到订单列表",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"]),j("div",Te,[x(q,{title:"同步状态",column:2,border:""},{default:N(()=>[x(H,{label:"服务状态"},{default:N(()=>[x(D,{type:o.isRunning?"success":"info"},{default:N(()=>[U(L(o.isRunning?"运行中":"已停止"),1)]),_:1},8,["type"])]),_:1}),x(H,{label:"最后同步"},{default:N(()=>[U(L(o.lastSyncTime?F(o.lastSyncTime):"从未同步"),1)]),_:1})]),_:1})]),j("div",xe,[x(g,{type:"primary",onClick:B,loading:d.value,disabled:!r.enabled},{default:N(()=>[x(n,null,{default:N(()=>[x(Y(i))]),_:1}),t[12]||(t[12]=U(" 手动同步 ",-1))]),_:1},8,["loading","disabled"]),x(g,{onClick:A},{default:N(()=>[x(n,null,{default:N(()=>[x(Y(u))]),_:1}),t[13]||(t[13]=U(" 刷新状态 ",-1))]),_:1})]),v.value.length>0?(C(),V("div",Ne,[x(J,{"content-position":"left"},{default:N(()=>[...t[14]||(t[14]=[U("同步日志",-1)])]),_:1}),x(G,null,{default:N(()=>[(C(!0),V(E,null,O(v.value,(e,a)=>(C(),$(W,{key:a,timestamp:F(e.lastSyncTime),type:e.success?"success":"danger"},{default:N(()=>[j("div",Ue,[j("div",Ie,[U(L(e.success?"同步成功":"同步失败")+" ",1),e.updatedCount>0?(C(),V("span",De," - 更新了 "+L(e.updatedCount)+" 个订单 ",1)):z("",!0),e.errorCount>0?(C(),V("span",Pe," - "+L(e.errorCount)+" 个错误 ",1)):z("",!0)]),e.errors.length>0?(C(),V("div",$e,[x(Z,null,{default:N(()=>[x(Q,{title:"查看错误详情"},{default:N(()=>[j("ul",null,[(C(!0),V(E,null,O(e.errors,(e,a)=>(C(),V("li",{key:a},L(e),1))),128))])]),_:2},1024)]),_:2},1024)])):z("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):z("",!0)],512),[[R,!s.value]])]),_:1})]),_:1})}}}),[["__scopeId","data-v-ff9b0cb4"]]),je={class:"logistics-status-update"},Le={class:"summary-cards"},Oe={class:"summary-header"},Ee={class:"auto-refresh-controls"},Be={key:0,class:"refresh-status"},Ye={class:"card-content"},He={class:"card-icon pending"},qe={class:"card-info"},Me={class:"card-value"},Re={class:"card-content"},Ae={class:"card-icon updated"},Fe={class:"card-info"},Je={class:"card-value"},Qe={class:"card-content"},Ze={class:"card-icon todo"},We={class:"card-info"},Ge={class:"card-value"},Ke={class:"card-content"},Xe={class:"card-icon total"},ea={class:"card-info"},aa={class:"card-value"},la={class:"quick-filters"},ta={class:"search-filters"},sa={class:"list-navigation"},na={class:"order-list"},ra={class:"empty-data"},oa={key:1},da={class:"logistics-update"},ia={key:1},ua={class:"pagination"},ca=l(_({__name:"StatusUpdate",setup(l){a();const t=s();e();const r=I(!1),o=I("pending"),d=I("today"),u=I(["",""]),c=I(""),p=I(""),m=I([]),_=I([]),w=I(null),T=D({currentPage:1,pageSize:20,total:0}),B=I(!1),H=I(!1),R=I(!1),J=I(!1),Q=I(""),W=I(""),G=I(null),K=I(3e4),X=I(!0),ee=D({pending:0,updated:0,todo:0,total:0}),ae=[{label:"今日",value:"today"},{label:"昨日",value:"yesterday"},{label:"3天前",value:"3days"},{label:"5天前",value:"5days"},{label:"10天前",value:"10days"},{label:"本周",value:"week"},{label:"30天",value:"30days"},{label:"今年",value:"year"},{label:"全部",value:"all"}],le=e=>{d.value=e;const a=new Date,l=e=>e.toISOString().split("T")[0];switch(e){case"today":u.value=[l(a),l(a)];break;case"yesterday":const e=new Date(a.getTime()-864e5);u.value=[l(e),l(e)];break;case"3days":const t=new Date(a.getTime()-2592e5);u.value=["",l(t)];break;case"5days":const s=new Date(a.getTime()-432e6);u.value=["",l(s)];break;case"10days":const n=new Date(a.getTime()-864e6);u.value=["",l(n)];break;case"week":const r=new Date(a.getTime()-24*(a.getDay()-1)*60*60*1e3);u.value=[l(r),l(a)];break;case"30days":const o=new Date(a.getTime()-2592e6);u.value=[l(o),l(a)];break;case"year":const d=new Date(a.getFullYear(),0,1);u.value=[l(d),l(a)];break;case"all":u.value=["",""]}T.currentPage=1,Ve()},te=()=>{T.currentPage=1,Ve()},ne=()=>{T.currentPage=1,Ve()},re=()=>{T.currentPage=1,Ve()},oe=e=>{o.value=e,T.currentPage=1,Ve()},de=e=>{_.value=e},ue=e=>{T.currentPage=e,Ve()},ce=e=>{T.pageSize=e,T.currentPage=1,Ve()},pe=e=>{if(n.success("状态更新成功"),Ve(),Ce(!0),_.value=[],e&&"pending"===o.value){const a=Ne(e.newStatus),l=e.orders.length;1===l?n.info(`订单已更新为"${a}"状态，可在"已更新"标签页查看`):n.info(`${l}个订单已更新为"${a}"状态，可在"已更新"标签页查看`)}window.dispatchEvent(new CustomEvent("orderStatusUpdated",{detail:{timestamp:Date.now(),updatedOrders:e?.orders||[],newStatus:e?.newStatus}}))},me=()=>{n.success("待办设置成功"),Ve(),Ce(!0),window.dispatchEvent(new CustomEvent("todoStatusUpdated",{detail:{timestamp:Date.now()}}))},ve=e=>{J.value=!1,w.value=e,_.value=[],B.value=!0},ge=e=>{J.value=!1,w.value=e,H.value=!0},fe=e=>{console.log("检测到订单发货事件:",e.detail),Ve(),Ce(!0),"pending"===o.value&&n.info("检测到新的发货订单，已自动刷新列表")},ye=e=>{const{orderId:a,oldStatus:l,newStatus:t,operator:s}=e.detail;console.log("检测到订单状态更新:",{orderId:a,oldStatus:l,newStatus:t,operator:s}),"shipped"===t?(Ve(),Ce(!0),n.success(`订单 ${a} 已发货，已同步到物流状态列表`)):["delivered","rejected","returned","abnormal"].includes(t)&&(Ve(),Ce(!0))},he=e=>{console.log("检测到外部订单状态更新:",e.detail),Ve(),Ce(!0)},be=()=>{Ve(!0),Ce(!0)},_e=()=>{G.value&&clearInterval(G.value),X.value&&(G.value=setInterval(()=>{Ce(!0)},K.value))},ke=()=>{G.value&&(clearInterval(G.value),G.value=null)},Se=()=>{X.value=!X.value,X.value?_e():ke()},Ve=async(e=!1)=>{r.value=!0;try{await new Promise(e=>setTimeout(e,300));const a=t.getOrders();let l=a.filter(e=>{if(!("shipped"===e.status||"delivered"===e.status))return!1;const a=e.trackingNumber||e.expressNo;if(!!(!a||""===a.trim()))return console.log(`[状态更新] 订单 ${e.orderNumber} 没有物流单号，跳过`),!1;return e.expressCompany&&""!==e.expressCompany.trim()?(console.log(`[状态更新] ✅ 订单 ${e.orderNumber} 通过筛选`,{status:e.status,trackingNumber:a,expressCompany:e.expressCompany}),!0):(console.log(`[状态更新] 订单 ${e.orderNumber} 没有快递公司，跳过`),!1)});if(console.log(`[状态更新] 筛选出 ${l.length} 个已发货订单（总订单数：${a.length}）`),"pending"===o.value?l=l.filter(e=>{const a=e.logisticsStatus;return!a||"shipped"===a||"pending"===a||""===a}):"updated"===o.value?l=l.filter(e=>e.logisticsStatus&&["delivered","rejected","returned","abnormal"].includes(e.logisticsStatus)):"todo"===o.value&&(l=l.filter(e=>"todo"===e.logisticsStatus)),u.value&&2===u.value.length&&u.value[0]&&u.value[1]){const[e,a]=u.value;l=l.filter(l=>{const t=(l.shippingTime||l.shipTime||l.createTime).split(" ")[0];return t>=e&&t<=a})}else if(u.value&&2===u.value.length&&u.value[1]){const e=u.value[1];l=l.filter(a=>(a.shippingTime||a.shipTime||a.createTime).split(" ")[0]<=e)}if(c.value){const e=c.value.toLowerCase();l=l.filter(a=>a.orderNumber.toLowerCase().includes(e)||a.customerName.toLowerCase().includes(e)||a.trackingNumber&&a.trackingNumber.toLowerCase().includes(e)||a.expressNo&&a.expressNo.toLowerCase().includes(e))}p.value&&(l=l.filter(e=>e.logisticsStatus===p.value)),l.sort((e,a)=>{const l=new Date(e.shippingTime||e.shipTime||e.createTime||0).getTime();return new Date(a.shippingTime||a.shipTime||a.createTime||0).getTime()-l});const s=l.map((e,a)=>({id:e.id,index:(T.currentPage-1)*T.pageSize+a+1,orderNo:e.orderNumber,customerName:e.customerName,status:e.logisticsStatus||"shipped",amount:e.totalAmount,trackingNo:e.trackingNumber||e.expressNo||"",logisticsCompany:e.expressCompany||"",latestUpdate:e.logisticsHistory&&e.logisticsHistory.length>0?e.logisticsHistory[e.logisticsHistory.length-1].description:e.statusHistory&&e.statusHistory.length>0?e.statusHistory[e.statusHistory.length-1].description:"",assignedTo:e.salesPersonId||e.createdBy||"",orderDate:e.createTime.split(" ")[0],shippingTime:e.shippingTime||e.shipTime||e.createTime,customerPhone:e.receiverPhone||e.customerPhone,productName:e.products?.map(e=>e.name).join("、")||"商品",quantity:e.products?.reduce((e,a)=>e+a.quantity,0)||1,remark:e.remark||""})),r=(T.currentPage-1)*T.pageSize,d=r+T.pageSize;m.value=s.slice(r,d),T.total=s.length,e&&n.success("数据刷新成功")}catch(a){console.error("订单列表加载失败:",a),m.value=[],T.total=0,e&&n.error("数据加载失败，请检查网络连接或联系管理员")}finally{r.value=!1}},Ce=async(e=!1)=>{try{let a=t.getOrders().filter(e=>{if(!("shipped"===e.status||"delivered"===e.status))return!1;if(!!(!e.trackingNumber&&!e.expressNo))return!1;return e.expressCompany&&""!==e.expressCompany.trim()});if(u.value&&2===u.value.length&&u.value[0]&&u.value[1]){const[e,l]=u.value;a=a.filter(a=>{const t=(a.shippingTime||a.shipTime||a.createTime).split(" ")[0];return t>=e&&t<=l})}else if(u.value&&2===u.value.length&&u.value[1]){const e=u.value[1];a=a.filter(a=>(a.shippingTime||a.shipTime||a.createTime).split(" ")[0]<=e)}const l=a.filter(e=>{const a=e.logisticsStatus;return!a||"shipped"===a||"pending"===a||""===a}).length,s=a.filter(e=>e.logisticsStatus&&["delivered","rejected","returned","abnormal"].includes(e.logisticsStatus)).length,n=a.filter(e=>"todo"===e.logisticsStatus).length,r={pending:l,updated:s,todo:n,total:a.length};if(e){const e={...ee};ee.pending=0,ee.updated=0,ee.todo=0,ee.total=0,setTimeout(()=>{Te("pending",e.pending,r.pending),Te("updated",e.updated,r.updated),Te("todo",e.todo,r.todo),Te("total",e.total,r.total)},100)}else Object.assign(ee,r)}catch(a){console.error("汇总数据加载失败:",a),ee.pending=0,ee.updated=0,ee.todo=0,ee.total=0,n.error("汇总数据加载失败")}},Te=(e,a,l)=>{const t=(l-a)/30;let s=0;const n=setInterval(()=>{s++,s>=30?(ee[e]=l,clearInterval(n)):ee[e]=Math.round(a+t*s)},1e3/30)},xe=()=>{switch(o.value){case"pending":return"暂无待更新订单";case"updated":return"暂无已发货订单";case"todo":return"暂无待办订单";default:return"暂无数据"}},Ne=e=>({pending:"待发货",shipped:"已发货",delivered:"已签收",rejected:"拒收",returned:"拒收已退回",refunded:"退货退款",abnormal:"状态异常",todo:"待办"}[e]||e);return k(()=>{le("today"),Ce(),_e(),window.addEventListener("orderStatusUpdated",he),window.addEventListener("order-status-update",ye),window.addEventListener("order-shipped",fe),window.addEventListener("logistics-status-update",fe)}),q(()=>{ke(),window.removeEventListener("orderStatusUpdated",he),window.removeEventListener("order-status-update",ye),window.removeEventListener("order-shipped",fe),window.removeEventListener("logistics-status-update",fe)}),P([u,p,c],()=>{Ce(!0)},{deep:!0}),(e,a)=>{const l=S("el-button"),t=S("el-tooltip"),s=S("el-icon"),n=S("el-card"),k=S("el-col"),I=S("el-row"),D=S("el-date-picker"),P=S("el-input"),q=S("el-option"),G=S("el-select"),K=S("el-badge"),fe=S("el-tab-pane"),ye=S("el-tabs"),he=S("el-empty"),_e=S("el-table-column"),ke=S("el-tag"),Ve=S("el-table"),Ce=S("el-pagination"),Te=A("loading");return C(),$(Z,null,{default:N(()=>[j("div",je,[j("div",Le,[j("div",Oe,[a[11]||(a[11]=j("h3",null,"数据汇总",-1)),j("div",Ee,[x(t,{content:"切换自动刷新"},{default:N(()=>[x(l,{type:X.value?"success":"info",icon:X.value?"Refresh":"VideoPause",circle:"",size:"small",onClick:Se},null,8,["type","icon"])]),_:1}),x(t,{content:"手动刷新"},{default:N(()=>[x(l,{type:"primary",icon:"Refresh",circle:"",size:"small",onClick:be})]),_:1}),X.value?(C(),V("span",Be,[x(s,{class:"refresh-icon"},{default:N(()=>[x(Y(v))]),_:1}),a[10]||(a[10]=U(" 实时更新中 ",-1))])):z("",!0)])]),x(I,{gutter:20},{default:N(()=>[x(k,{span:6},{default:N(()=>[x(n,{class:"summary-card"},{default:N(()=>[j("div",Ye,[j("div",He,[x(s,null,{default:N(()=>[x(Y(g))]),_:1})]),j("div",qe,[a[12]||(a[12]=j("div",{class:"card-title"},"待更新",-1)),j("div",Me,L(ee.pending),1)])])]),_:1})]),_:1}),x(k,{span:6},{default:N(()=>[x(n,{class:"summary-card"},{default:N(()=>[j("div",Re,[j("div",Ae,[x(s,null,{default:N(()=>[x(Y(f))]),_:1})]),j("div",Fe,[a[13]||(a[13]=j("div",{class:"card-title"},"已更新",-1)),j("div",Je,L(ee.updated),1)])])]),_:1})]),_:1}),x(k,{span:6},{default:N(()=>[x(n,{class:"summary-card"},{default:N(()=>[j("div",Qe,[j("div",Ze,[x(s,null,{default:N(()=>[x(Y(y))]),_:1})]),j("div",We,[a[14]||(a[14]=j("div",{class:"card-title"},"待办",-1)),j("div",Ge,L(ee.todo),1)])])]),_:1})]),_:1}),x(k,{span:6},{default:N(()=>[x(n,{class:"summary-card"},{default:N(()=>[j("div",Ke,[j("div",Xe,[x(s,null,{default:N(()=>[x(Y(h))]),_:1})]),j("div",ea,[a[15]||(a[15]=j("div",{class:"card-title"},"总计",-1)),j("div",aa,L(ee.total),1)])])]),_:1})]),_:1})]),_:1})]),j("div",la,[(C(),V(E,null,O(ae,e=>x(l,{key:e.value,type:d.value===e.value?"primary":"",onClick:a=>le(e.value),class:"filter-button",round:""},{default:N(()=>[U(L(e.label),1)]),_:2},1032,["type","onClick"])),64))]),j("div",ta,[x(I,{gutter:20},{default:N(()=>[x(k,{span:6},{default:N(()=>[x(D,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:te},null,8,["modelValue"])]),_:1}),x(k,{span:6},{default:N(()=>[x(P,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),placeholder:"搜索订单号、客户名称",clearable:"",onInput:ne},{prefix:N(()=>[x(s,null,{default:N(()=>[x(Y(b))]),_:1})]),_:1},8,["modelValue"])]),_:1}),x(k,{span:6},{default:N(()=>[x(G,{modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=e=>p.value=e),placeholder:"选择状态",clearable:"",onChange:re},{default:N(()=>[x(q,{label:"已发货",value:"shipped"}),x(q,{label:"已签收",value:"delivered"}),x(q,{label:"拒收",value:"rejected"}),x(q,{label:"拒收已退回",value:"returned"}),x(q,{label:"退货退款",value:"refunded"}),x(q,{label:"状态异常",value:"abnormal"})]),_:1},8,["modelValue"])]),_:1}),x(k,{span:6},{default:N(()=>[x(l,{type:"primary",onClick:be},{default:N(()=>[x(s,null,{default:N(()=>[x(Y(i))]),_:1}),a[16]||(a[16]=U(" 刷新数据 ",-1))]),_:1})]),_:1})]),_:1})]),j("div",sa,[x(ye,{modelValue:o.value,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value=e),onTabChange:oe},{default:N(()=>[x(fe,{label:"待更新",name:"pending"},{label:N(()=>[j("span",null,[a[17]||(a[17]=U("待更新 ",-1)),x(K,{value:ee.pending,class:"item pending-badge"},null,8,["value"])])]),_:1}),x(fe,{label:"已更新",name:"updated"},{label:N(()=>[...a[18]||(a[18]=[j("span",null,"已更新",-1)])]),_:1}),x(fe,{label:"待办",name:"todo"},{label:N(()=>[j("span",null,[a[19]||(a[19]=U("待办 ",-1)),x(K,{value:ee.todo,class:"item todo-badge"},null,8,["value"])])]),_:1})]),_:1},8,["modelValue"])]),x(ze),j("div",na,[M((C(),$(Ve,{data:m.value,stripe:"",onSelectionChange:de},{empty:N(()=>[j("div",ra,[x(he,{description:xe(),"image-size":120},null,8,["description"])])]),default:N(()=>[x(_e,{type:"selection",width:"55"}),x(_e,{prop:"index",label:"序号",width:"80"}),x(_e,{prop:"orderNo",label:"订单号",width:"150"}),x(_e,{prop:"customerName",label:"客户名称",width:"120"}),x(_e,{prop:"status",label:"状态",width:"100"},{default:N(({row:e})=>{return[x(ke,{type:(a=e.status,{pending:"warning",shipped:"info",delivered:"success",rejected:"warning",returned:"danger",refunded:"danger",abnormal:"danger",todo:"info"}[a]||"info")},{default:N(()=>[U(L(Ne(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),x(_e,{prop:"amount",label:"金额",width:"100"},{default:N(({row:e})=>[U(" ¥"+L(e.amount),1)]),_:1}),x(_e,{prop:"trackingNo",label:"快递单号",width:"150"},{default:N(({row:e})=>[e.trackingNo?(C(),$(l,{key:0,type:"text",onClick:a=>{return l=e,Q.value=l.trackingNo,W.value=l.logisticsCompany,void(R.value=!0);var l}},{default:N(()=>[U(L(e.trackingNo),1)]),_:2},1032,["onClick"])):(C(),V("span",oa,"-"))]),_:1}),x(_e,{prop:"latestUpdate",label:"物流最新动态",width:"200"},{default:N(({row:e})=>[e.latestUpdate?(C(),$(t,{key:0,content:e.latestUpdate,placement:"top"},{default:N(()=>[j("div",da,L(e.latestUpdate),1)]),_:2},1032,["content"])):(C(),V("span",ia,"-"))]),_:1}),x(_e,{prop:"assignedTo",label:"归属人",width:"100"}),x(_e,{prop:"orderDate",label:"下单日期",width:"120"}),x(_e,{label:"操作",width:"200",fixed:"right"},{default:N(({row:e})=>[x(l,{size:"small",onClick:a=>(e=>{w.value=e,J.value=!0})(e)},{default:N(()=>[...a[20]||(a[20]=[U("查看",-1)])]),_:1},8,["onClick"]),"pending"===o.value?(C(),$(l,{key:0,size:"small",type:"primary",onClick:a=>(e=>{w.value=e,_.value=[],B.value=!0})(e)},{default:N(()=>[...a[21]||(a[21]=[U(" 更新状态 ",-1)])]),_:1},8,["onClick"])):z("",!0),"pending"===o.value?(C(),$(l,{key:1,size:"small",type:"warning",onClick:a=>(e=>{w.value=e,H.value=!0})(e)},{default:N(()=>[...a[22]||(a[22]=[U(" 待办 ",-1)])]),_:1},8,["onClick"])):z("",!0)]),_:1})]),_:1},8,["data"])),[[Te,r.value]]),j("div",ua,[x(Ce,{"current-page":T.currentPage,"onUpdate:currentPage":a[4]||(a[4]=e=>T.currentPage=e),"page-size":T.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>T.pageSize=e),"page-sizes":[10,20,50,100],total:T.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ce,onCurrentChange:ue},null,8,["current-page","page-size","total"])])]),x(se,{modelValue:B.value,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value=e),"order-info":w.value,"selected-orders":_.value,onSuccess:pe},null,8,["modelValue","order-info","selected-orders"]),x(ie,{modelValue:H.value,"onUpdate:modelValue":a[7]||(a[7]=e=>H.value=e),"order-info":w.value,onSuccess:me},null,8,["modelValue","order-info"]),x(we,{modelValue:R.value,"onUpdate:modelValue":a[8]||(a[8]=e=>R.value=e),"tracking-no":Q.value,"logistics-company":W.value},null,8,["modelValue","tracking-no","logistics-company"]),x(F,{visible:J.value,"onUpdate:visible":a[9]||(a[9]=e=>J.value=e),order:w.value,"show-action-buttons":"pending"===o.value,onUpdateStatus:ve,onSetTodo:ge},null,8,["visible","order","show-action-buttons"])])]),_:1})}}}),[["__scopeId","data-v-06a9e22e"]]);export{ca as default};
