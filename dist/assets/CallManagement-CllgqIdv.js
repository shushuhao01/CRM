var h=(B,O,R)=>new Promise((P,q)=>{var J=Y=>{try{te(R.next(Y))}catch(j){q(j)}},ne=Y=>{try{te(R.throw(Y))}catch(j){q(j)}},te=Y=>Y.done?P(Y.value):Promise.resolve(Y.value).then(J,ne);te((R=R.apply(B,O)).next())});import{u as so,t as no,S as ze,a as io,M as ro,N as uo,O as co,Q as po,R as mo,T as fo,U as go,c as vo,_ as yo}from"./settings-CuxbDWOu.js";import{l as bo,az as wo,r as b,Z as ee,e as Co,c as _o,Y as ho,w as ko,ag as U,aq as xo,m as _,p as y,q as s,U as t,O as l,S as d,T as u,u as p,a7 as Vo,P as Pt,M as K,Q as I,F as W,a9 as ve,R as zt,I as rt}from"./vendor-D8Vxqhr-.js";import{u as So,g as Uo}from"./call-C9NCWzRc.js";import{generateQRCode as Do,getConnectionStatus as Io,getConnectedDevices as Po}from"./qr-connection-BfxN7ei6.js";import"./browser-CKYXhPt6.js";import{h as ye,i as ut,r as ct,ai as zo,ap as To,F as Tt,s as Oe,aB as Mt,n as pt,p as Rt,a5 as Mo,j as Ro,aG as At,aH as Nt,z as Ao,aI as Kt,k as be,f as Lt,a2 as Ft,E as c,ax as No,aJ as Ko}from"./elementPlus-Bmwh7Rh8.js";import{a as Te}from"./sensitiveInfo-BWt1a88R.js";import"./utils-ywHRn0uI.js";const Lo=B=>h(void 0,null,function*(){try{let O,R;B==="android"?(O="/api/v1/mobile-sdk/download/android",R="CRM-Mobile-SDK-v2.1.3.apk"):(O="/mobile-sdk/",R="CRM-Mobile-SDK-PWA");const P=document.createElement("a");return P.href=O,B==="android"?P.download=R:P.target="_blank",P.style.display="none",document.body.appendChild(P),P.click(),document.body.removeChild(P),{success:!0,message:B==="android"?"Android APK 下载已开始，请在下载完成后安装":"iOS PWA 应用已打开，请按照页面指引安装"}}catch(O){return{success:!1,error:O.message||"下载失败"}}}),$t=B=>h(void 0,null,function*(){const O=`sdk_install_status_${B}`,R=localStorage.getItem(O);if(R)try{return JSON.parse(R)}catch(P){}return{installed:!1,lastCheck:new Date().toISOString()}}),Fo=(B,O,R)=>{const P=`sdk_install_status_${B}`,q={installed:O,version:R,lastCheck:new Date().toISOString()};localStorage.setItem(P,JSON.stringify(q))},$o=B=>h(void 0,null,function*(){return(yield $t(B)).installed?new Promise(R=>{setTimeout(()=>{const P=Math.random()>.3;R(P?{success:!0,connected:!0,message:"设备连接成功",details:{deviceInfo:`${B==="android"?"Android":"iOS"} 设备`,networkStatus:"网络连接正常",permissions:["麦克风权限","通话权限","网络权限"]}}:{success:!0,connected:!1,message:"设备连接失败，请检查网络和权限设置"})},2e3)}):{success:!1,connected:!1,message:"请先安装SDK"}}),Oo={class:"call-management"},qo={class:"page-header"},Yo={class:"header-actions"},Bo={class:"stat-item"},jo={class:"stat-icon"},Eo={class:"stat-content"},Qo={class:"stat-value"},Ho={class:"stat-item"},Wo={class:"stat-icon"},Jo={class:"stat-content"},Go={class:"stat-value"},Zo={class:"stat-item"},Xo={class:"stat-icon"},ea={class:"stat-content"},ta={class:"stat-value"},la={class:"stat-item"},oa={class:"stat-icon"},aa={class:"stat-content"},sa={class:"stat-value"},na={class:"filter-section"},ia={class:"filter-row"},da={class:"filter-item"},ra={class:"filter-item"},ua={class:"filter-item"},ca={class:"filter-item"},pa={class:"search-row"},ma={class:"table-header"},fa={class:"table-actions"},ga=["onClick"],va=["onClick"],ya=["onClick"],ba=["onClick"],wa={class:"pagination-wrapper"},Ca={class:"pagination-stats"},_a={class:"stats-text"},ha={style:{display:"flex","justify-content":"space-between","align-items":"center"}},ka={style:{display:"flex","justify-content":"space-between","align-items":"center"}},xa={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Va={key:0},Sa={key:1},Ua={key:2},Da={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ia={style:{"font-weight":"500"}},Pa={style:{color:"#8492a6","font-size":"12px"}},za={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Ta={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ma={style:{"font-weight":"500"}},Ra={style:{color:"#8492a6","font-size":"12px"}},Aa={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Na={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ka={style:{flex:"1"}},La={style:{"font-weight":"500"}},Fa={style:{color:"#8492a6","font-size":"12px","margin-top":"2px"}},$a={key:0,style:{"margin-left":"8px"}},Oa={style:{color:"#409eff","font-size":"12px","font-weight":"500"}},qa={key:0,class:"customer-detail"},Ya={class:"info-item"},Ba={class:"info-item"},ja={class:"info-item"},Ea={class:"info-item"},Qa={class:"info-item"},Ha={class:"info-item"},Wa={class:"tab-content"},Ja={class:"tab-header"},Ga={class:"tab-content"},Za={class:"tab-header"},Xa={class:"tab-content"},es={class:"tab-header"},ts={class:"call-actions"},ls=["onClick"],os=["onClick"],as=["onClick"],ss={key:2,class:"no-recording"},ns={class:"tab-content"},is={class:"tab-header"},ds={class:"call-records-dialog"},rs={class:"dialog-filters"},us={class:"filter-row"},cs={class:"filter-item"},ps={class:"filter-item"},ms={key:0},fs={key:1,class:"no-recording"},gs={class:"dialog-pagination"},vs={class:"recording-player"},ys={class:"recording-info"},bs={class:"audio-player"},ws=["src"],Cs={class:"quick-followup"},_s={class:"customer-info"},hs={class:"dialog-footer"},ks={key:0,class:"incoming-call"},xs={class:"caller-info"},Vs={class:"caller-avatar"},Ss={class:"caller-details"},Us={class:"phone-number"},Ds={key:0,class:"customer-level"},Is={key:1,class:"last-call"},Ps={class:"call-actions"},zs={class:"quick-actions"},Ts={key:0,class:"call-in-progress"},Ms={class:"call-timer"},Rs={class:"timer-display"},As={class:"caller-info-mini"},Ns={class:"caller-name"},Ks={class:"caller-phone"},Ls={class:"call-controls"},Fs={class:"call-notes"},$s={key:0},Os={key:1},qs={style:{display:"flex","align-items":"center",gap:"12px"}},Ys={style:{"margin-top":"8px",padding:"8px",background:"#f5f7fa","border-radius":"4px"}},Bs={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"4px"}},js={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"8px","font-size":"12px",color:"#606266"}},Es={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Qs={style:{display:"flex",gap:"16px","align-items":"center"}},Hs={style:{display:"flex","align-items":"center",gap:"6px"}},Ws={style:{display:"flex","align-items":"center",gap:"6px"}},Js={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Gs={style:{display:"flex","align-items":"center",gap:"12px"}},Zs={style:{display:"flex","align-items":"flex-start",gap:"16px"}},Xs={style:{"text-align":"center"}},en={key:0,style:{padding:"12px",background:"white",border:"1px solid #dcdfe6","border-radius":"8px",display:"inline-block"}},tn=["src"],ln={key:1,style:{width:"120px",height:"120px",border:"2px dashed #dcdfe6","border-radius":"8px",display:"flex","align-items":"center","justify-content":"center",color:"#909399"}},on={style:{"margin-top":"8px","font-size":"12px",color:"#606266"}},an={key:2,style:{"font-size":"11px",color:"#909399","margin-top":"4px"}},sn={style:{flex:"1"}},nn={style:{display:"flex","flex-direction":"column",gap:"8px"}},dn={style:{"margin-top":"12px",padding:"8px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px","font-size":"12px",color:"#409eff"}},rn={style:{"font-weight":"500","margin-bottom":"4px"}},un={style:{border:"1px solid #ebeef5","border-radius":"6px",padding:"16px"}},cn={style:{display:"grid","grid-template-columns":"1fr 1fr 1fr",gap:"16px"}},pn={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},mn={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},fn={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},gn={key:0,style:{"font-size":"18px","font-weight":"bold",color:"#409eff","margin-bottom":"8px"}},vn={style:{"margin-top":"12px",padding:"8px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px","font-size":"12px",color:"#409eff"}},yn={style:{"font-weight":"500","margin-bottom":"4px"}},bn={style:{border:"1px solid #ebeef5","border-radius":"6px",overflow:"hidden"}},wn={style:{display:"flex","align-items":"center",gap:"12px"}},Cn={style:{"font-weight":"500",color:"#303133"}},_n={style:{"font-size":"12px",color:"#909399"}},hn={style:{display:"flex","align-items":"center",gap:"8px"}},kn={key:2},xn={class:"dialog-footer"},Vn=bo({__name:"CallManagement",setup(B){const O=wo(),R=vo(O),P=So(),q=so(),J=no(),ne=b(!1),te=b(!1),Y=b(!1),j=b(null),we=b(""),Ot=b([]),Me=b(!1),qe=b(!1),Ye=b(),ie=b("ready"),de=b(!1),Re=b(!1),N=b(null),Z=b(null),pe=b(0),Ce=b(""),Ae=b(null),_e=b(!1),Be=b(!1),qt=b(),mt=b("callMethod"),je=b(!1),D=ee({connectionId:"",qrCodeUrl:"",status:"",expiresAt:null,generating:!1,checking:!1}),g=ee({bluetooth:{status:"disconnected",deviceName:"",deviceId:""},network:{status:"disconnected",devices:[],selectedDevice:null},digital:{status:"disconnected",code:"",expiresAt:null}}),Ee=b([]),n=ee({callMethod:"system",lineId:"",workPhone:"",dialMethod:"direct",mobileConfig:{platform:"android",sdkInstalled:!1,deviceAuthorized:!1,callPermission:!1,connectionStatus:"disconnected",sdkInfo:{version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:"Android 5.0+",packageType:"APK"}},callbackConfig:{provider:"aliyun",delay:3,maxRetries:3},voipProvider:"aliyun",audioDevice:"default",audioQuality:"standard",aliyunConfig:{accessKeyId:"",accessKeySecret:"",appId:"",callerNumber:"",region:"cn-hangzhou",enableRecording:!1,recordingBucket:""},tencentConfig:{secretId:"",secretKey:"",appId:"",callerNumber:"",region:"ap-beijing"},huaweiConfig:{accessKey:"",secretKey:"",appId:"",callerNumber:"",region:"cn-north-1"},callMode:"manual",callInterval:30,maxRetries:3,callTimeout:60,enableRecording:!0,autoFollowUp:!1,concurrentCalls:1,priority:"medium",blacklistCheck:!0,showLocation:!0}),Qe=b([{id:"1",name:"主线路 - 400-1234-5678"},{id:"2",name:"备用线路 - 400-8765-4321"},{id:"3",name:"专用线路 - 400-9999-8888"}]),Q=ee({todayCalls:0,totalDuration:0,connectionRate:0,activeUsers:0}),E=ee({status:"",customerLevel:"",dateRange:[],salesPerson:""}),L=ee({currentPage:1,pageSize:20,total:0}),He=b([{id:1,customerName:"张三",phone:"13800138001",company:"北京科技有限公司",customerLevel:"gold",lastCallTime:"2024-01-15 14:30:00",callCount:5,status:"pending",salesPerson:"李销售",remark:"意向客户，需要跟进产品A"},{id:2,customerName:"李四",phone:"13800138002",company:"上海贸易集团",customerLevel:"silver",lastCallTime:"2024-01-14 16:20:00",callCount:3,status:"connected",salesPerson:"王销售",remark:"已下单，需要确认发货时间"},{id:3,customerName:"王五",phone:"13800138003",company:"深圳制造企业",customerLevel:"normal",lastCallTime:"2024-01-13 10:15:00",callCount:2,status:"no_answer",salesPerson:"张销售",remark:"多次未接听，建议更换联系时间"}]),C=b({callMethod:"network",networkConfig:{lineId:"",audioQuality:"standard"},mobileConfig:{phoneNumber:"",enableRecording:!0},selectedCustomer:null,customerPhone:"",manualPhone:"",customerId:"",notes:""}),he=b([]),Ne=b([]);b([{id:"line001",name:"阿里云线路1",provider:"aliyun",status:"active",quality:"高清"},{id:"line002",name:"阿里云线路2",provider:"aliyun",status:"active",quality:"标准"},{id:"line003",name:"腾讯云线路1",provider:"tencent",status:"active",quality:"高清"},{id:"line004",name:"华为云线路1",provider:"huawei",status:"maintenance",quality:"高清"}]);const Yt=b([{id:"phone001",number:"13800138001",name:"销售专线1",status:"active",owner:"张三"},{id:"phone002",number:"13800138002",name:"销售专线2",status:"active",owner:"李四"},{id:"phone003",number:"13800138003",name:"客服专线1",status:"busy",owner:"王五"}]),Bt={customerPhone:[{required:!0,message:"请输入客户电话号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},Ke=b(!1),M=b(null),ft=b("orders"),ke=b(!1),We=b(!1),gt=b([]),le=ee({dateRange:[],customerKeyword:""}),oe=ee({currentPage:1,pageSize:20,total:0}),Le=b(!1),re=b(null),Fe=b(null),ue=b(!1),Je=b(!1),$e=b(),F=ee({type:"call",content:"",nextFollowTime:"",intention:"",remark:""}),jt={type:[{required:!0,message:"请选择跟进类型",trigger:"change"}],content:[{required:!0,message:"请输入跟进内容",trigger:"blur"},{min:10,message:"跟进内容至少10个字符",trigger:"blur"}],intention:[{required:!0,message:"请选择客户意向",trigger:"change"}]},Et=b([{orderNo:"ORD202401150001",productName:"产品A",amount:2897,status:"pending",createTime:"2024-01-15 14:30:00"},{orderNo:"ORD202401140002",productName:"产品B",amount:1749,status:"completed",createTime:"2024-01-14 16:20:00"}]),Qt=b([{ticketNo:"AS202401150001",type:"退货",description:"产品质量问题，客户要求退货",status:"processing",createTime:"2024-01-15 10:30:00"}]),Ht=b([{callType:"outbound",duration:"5分30秒",status:"connected",startTime:"2024-01-15 14:30:00",operator:"李销售",remark:"客户对产品A很感兴趣",recordingUrl:"/recordings/call_20240115_143000.mp3"},{callType:"inbound",duration:"3分15秒",status:"connected",startTime:"2024-01-14 16:20:00",operator:"王销售",remark:"客户咨询发货时间",recordingUrl:"/recordings/call_20240114_162000.mp3"},{callType:"outbound",duration:"1分45秒",status:"no_answer",startTime:"2024-01-13 10:15:00",operator:"张销售",remark:"客户未接听",recordingUrl:null}]),Wt=b([{type:"电话跟进",content:"客户对产品A很感兴趣，需要进一步了解技术参数",nextPlan:"2024-01-16 14:00:00",operator:"李销售",createTime:"2024-01-15 14:35:00"}]);Co(()=>P.callRecords.slice(0,10));const Jt=o=>{if(o<60)return`${o}秒`;const e=Math.floor(o/60),i=o%60;return`${e}分${i}秒`},Gt=o=>{if(!o)return"暂无地址";if(o.province||o.city||o.district||o.street||o.detailAddress){const e=[o.province,o.city,o.district,o.street,o.detailAddress].filter(Boolean);if(e.length>0)return e.join(" ")}return o.address?o.address:o.company?o.company:"暂无地址"},Zt=()=>{ie.value=ie.value==="ready"?"busy":"ready";const o=ie.value==="ready"?"就绪":"忙碌";c.success(`状态已切换为：${o}`)},Xt=()=>h(this,null,function*(){var o;try{D.generating=!0;const e={userId:((o=q.userInfo)==null?void 0:o.id)||"default-user",permissions:["call","sms","contacts"]},i=yield Do(e);i.success?(D.connectionId=i.data.connectionId,i.data.qrCodeUrl?D.qrCodeUrl=i.data.qrCodeUrl:i.data.qrData&&(D.qrCodeUrl=yield el(i.data.qrData)),D.status="pending",D.expiresAt=new Date(i.data.expiresAt),c.success("二维码生成成功，请使用手机扫码连接"),Ge()):c.error(i.message||"生成二维码失败")}catch(e){console.error("生成二维码失败:",e),c.error("生成二维码失败")}finally{D.generating=!1}}),el=o=>h(this,null,function*(){try{return yield(yield io(()=>import("./browser-CKYXhPt6.js").then(V=>V.b),[])).toDataURL(o,{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(e){return console.error("生成二维码图片失败:",e),`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(o)}`}}),Ge=()=>h(this,null,function*(){if(!(!D.connectionId||D.checking))try{D.checking=!0;const o=yield Io(D.connectionId);o.success&&(D.status=o.data.status,o.data.status==="connected"?(c.success("设备连接成功！"),n.mobileConfig.connectionStatus="connected",n.mobileConfig.deviceAuthorized=!0,yield vt()):o.data.status==="expired"?c.warning("二维码已过期，请重新生成"):o.data.status==="pending"&&setTimeout(Ge,2e3))}catch(o){console.error("检查连接状态失败:",o)}finally{D.checking=!1}}),vt=()=>h(this,null,function*(){try{const o=yield Po();o.success&&(Ee.value=o.data)}catch(o){console.error("加载已连接设备失败:",o)}}),Ze=()=>{switch(n.mobileConfig.connectionStatus){case"connected":return{type:"success",text:"已连接",icon:Ko};case"connecting":return{type:"warning",text:"连接中",icon:No};case"disconnected":default:return{type:"danger",text:"未连接",icon:be}}},tl=()=>h(this,null,function*(){const o=n.mobileConfig.platform;try{c.info("正在准备下载SDK...");const e=yield Lo(o);e.success?c.success(e.message||"SDK下载已开始"):c.error(e.error||"SDK下载失败")}catch(e){console.error("SDK下载异常:",e),c.error("SDK下载异常："+(e.message||"未知错误"))}}),ll=()=>h(this,null,function*(){const o=n.mobileConfig.platform;je.value=!0,n.mobileConfig.connectionStatus="connecting";try{const e=yield $o(o);e.success&&e.connected?(n.mobileConfig.connectionStatus="connected",n.mobileConfig.deviceAuthorized=!0,n.mobileConfig.callPermission=!0,c.success(e.message),Fo(o,!0,"1.0.0"),n.mobileConfig.sdkInstalled=!0):(n.mobileConfig.connectionStatus="disconnected",c.error(e.message))}catch(e){n.mobileConfig.connectionStatus="disconnected",c.error("连接测试异常："+(e.message||"未知错误"))}finally{je.value=!1}}),Xe=()=>h(this,null,function*(){try{const o=n.mobileConfig.platform;(yield $t(o)).installed?(n.mobileConfig.sdkInstalled=!0,n.mobileConfig.connectionStatus="connected",n.mobileConfig.deviceAuthorized=!0,n.mobileConfig.callPermission=!0):(n.mobileConfig.sdkInstalled=!1,n.mobileConfig.connectionStatus="disconnected",n.mobileConfig.deviceAuthorized=!1,n.mobileConfig.callPermission=!1)}catch(o){console.error("检查SDK状态失败:",o),n.mobileConfig.sdkInstalled=!1,n.mobileConfig.connectionStatus="disconnected"}}),ol=()=>h(this,null,function*(){if(g.bluetooth.status==="connected"){try{const o=yield ro();o.success?(g.bluetooth.status="disconnected",g.bluetooth.deviceName="",g.bluetooth.deviceId="",c.success("蓝牙连接已断开")):c.error(o.message||"断开蓝牙连接失败")}catch(o){console.error("断开蓝牙连接错误:",o),c.error("断开蓝牙连接异常")}return}g.bluetooth.status="connecting";try{const o=yield uo({deviceName:"CRM-Server"});o.success?(g.bluetooth.status="connected",g.bluetooth.deviceName=o.data.deviceName,g.bluetooth.deviceId=o.data.pairingCode,c.success(`蓝牙服务已启动，配对码：${o.data.pairingCode}`)):(g.bluetooth.status="disconnected",c.error(o.message||"蓝牙连接失败"))}catch(o){g.bluetooth.status="disconnected",c.error("蓝牙连接异常："+(o.message||"未知错误")),console.error("蓝牙连接错误:",o)}}),al=()=>h(this,null,function*(){if(g.network.status==="connected"){try{const o=yield co();o.success?(g.network.status="disconnected",g.network.devices=[],g.network.selectedDevice=null,c.success("网络连接已断开")):c.error(o.message||"断开网络连接失败")}catch(o){console.error("断开网络连接错误:",o),c.error("断开网络连接异常")}return}g.network.status="discovering";try{const o=yield po({port:8080,broadcastInterval:10});if(o.success){g.network.status="connected";const e=yield mo();if(e.success){const i=e.data.filter(V=>V.connectionType==="network");g.network.devices=i,i.length>0?(g.network.selectedDevice=i[0],c.success(`网络发现已启动，发现 ${i.length} 个设备`)):c.success("网络发现已启动，等待设备连接")}else c.success(`网络发现已启动，端口：${o.data.port}`)}else g.network.status="disconnected",c.error(o.message||"网络发现失败")}catch(o){g.network.status="disconnected",c.error("网络发现异常："+(o.message||"未知错误")),console.error("网络发现错误:",o)}}),sl=()=>h(this,null,function*(){if(g.digital.status==="connected"){try{const o=yield fo();o.success?(g.digital.status="disconnected",g.digital.code="",g.digital.expiresAt=null,c.success("数字配对已停止")):c.error(o.message||"停止数字配对失败")}catch(o){console.error("停止数字配对错误:",o),c.error("停止数字配对异常")}return}g.digital.status="generating";try{const o=yield go({expireTime:10});if(o.success){g.digital.code=o.data.currentCode,g.digital.status="connected";const e=new Date(Date.now()+o.data.expireTime*60*1e3);g.digital.expiresAt=e,c.success(`数字配对码：${o.data.currentCode}，有效期${o.data.expireTime}分钟`),setTimeout(()=>{g.digital.code===o.data.currentCode&&(g.digital.code="",g.digital.status="disconnected",g.digital.expiresAt=null,c.warning("数字配对码已过期，请重新生成"))},o.data.expireTime*60*1e3)}else g.digital.status="disconnected",c.error(o.message||"生成数字配对码失败")}catch(o){g.digital.status="disconnected",c.error("生成配对码异常："+(o.message||"未知错误")),console.error("数字配对错误:",o)}}),et=o=>o.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),yt=()=>h(this,null,function*(){try{const o=n.mobileConfig.platform,e=yield getSDKInfo(o);if(e.success&&e.data){const i=e.data;n.mobileConfig.sdkInfo={version:i.version||"1.0.0",fileSize:i.fileSizeFormatted||"未知",updateTime:i.lastModified?et(new Date(i.lastModified)):"未知",supportedSystems:i.supportedSystems||(o==="android"?"Android 5.0+":"iOS 12.0+"),packageType:i.packageType||(o==="android"?"APK":"IPA")}}}catch(o){console.error("获取SDK信息失败:",o);const e=n.mobileConfig.platform;n.mobileConfig.sdkInfo={version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:e==="android"?"Android 5.0+":"iOS 12.0+",packageType:e==="android"?"APK":"IPA"}}}),tt=()=>h(this,null,function*(){try{te.value=!0,yield Promise.all([me(),P.fetchCallRecords(),St(),nl()]),c.success("数据已刷新")}catch(o){console.error("刷新数据失败:",o),c.error("刷新数据失败，请稍后重试")}finally{te.value=!1}}),nl=()=>h(this,null,function*(){ke.value&&(yield ae())}),il=()=>{dl(),_e.value=!0},dl=()=>{const o=localStorage.getItem("callConfig");if(o)try{const e=JSON.parse(o);Object.assign(n,e)}catch(e){console.error("加载呼出配置失败:",e)}},rl=()=>h(this,null,function*(){try{Be.value=!0,localStorage.setItem("callConfig",JSON.stringify(n)),c.success("呼出配置已保存"),_e.value=!1}catch(o){console.error("保存呼出配置失败:",o),c.error("保存配置失败，请稍后重试")}finally{Be.value=!1}}),bt=o=>{o==="system"?!n.lineId&&Qe.value.length>0&&(n.lineId=Qe.value[0].id):(o==="mobile"||o==="voip")&&(n.lineId="")},ul=o=>o?"success":"info",cl=o=>o?"正常":"未选择",pl=()=>{Y.value=!Y.value,Y.value?(ml(),c.success("已开启自动刷新，每30秒更新一次数据")):(fl(),c.info("已关闭自动刷新"))},ml=()=>{j.value&&clearInterval(j.value),j.value=setInterval(()=>h(this,null,function*(){te.value||(yield tt())}),3e4)},fl=()=>{j.value&&(clearInterval(j.value),j.value=null)},me=()=>h(this,null,function*(){var o;try{ne.value=!0,yield J.loadCustomers();const e=J.customers,i=(o=q.currentUser)==null?void 0:o.id,w=e.filter(r=>r.salesPersonId===i||r.createdBy===i).map(r=>{var x;return{id:r.id,customerName:r.name,phone:r.phone,customerPhone:r.phone,company:r.company||"未填写",customerLevel:r.level,lastCallTime:r.lastServiceDate||"暂无记录",callCount:0,status:"pending",salesPerson:((x=q.currentUser)==null?void 0:x.name)||"当前用户",remark:r.remarks||"",address:r.address||"",province:r.province||"",city:r.city||"",district:r.district||"",street:r.street||"",detailAddress:r.detailAddress||""}});He.value=w,L.total=w.length}catch(e){console.error("加载呼出列表失败:",e),c.error("加载呼出列表失败")}finally{ne.value=!1}}),wt=()=>h(this,null,function*(){var o;try{ne.value=!0,yield J.loadCustomers();const e=J.customers,i=(o=q.currentUser)==null?void 0:o.id;let V=e.filter(r=>r.salesPersonId===i||r.createdBy===i);if(we.value){const r=we.value.toLowerCase();V=V.filter(x=>x.name.toLowerCase().includes(r)||x.phone.includes(r)||x.company&&x.company.toLowerCase().includes(r))}E.customerLevel&&(V=V.filter(r=>r.level===E.customerLevel)),E.status&&(V=V.filter(r=>r.status===E.status));const w=V.map(r=>{var x;return{id:r.id,customerName:r.name,phone:r.phone,customerPhone:r.phone,company:r.company||"未填写",customerLevel:r.level,lastCallTime:r.lastServiceDate||"暂无记录",callCount:0,status:"pending",salesPerson:((x=q.currentUser)==null?void 0:x.name)||"当前用户",remark:r.remarks||"",address:r.address||"",province:r.province||"",city:r.city||"",district:r.district||"",street:r.street||"",detailAddress:r.detailAddress||""}});He.value=w,L.total=w.length}catch(e){console.error("搜索失败:",e),c.error("搜索失败")}finally{ne.value=!1}}),gl=()=>{we.value="",Object.assign(E,{status:"",customerLevel:"",dateRange:[],salesPerson:""}),me()},vl=o=>{Ot.value=o},yl=()=>{ke.value=!0,ae()},bl=()=>{ke.value=!1,Ct()},ae=()=>h(this,null,function*(){We.value=!0;try{yield new Promise(i=>setTimeout(i,500));let e=[{id:1,customerName:"张三",customerPhone:"13800138001",callType:"outbound",duration:"00:03:25",status:"connected",startTime:"2024-01-15 14:30:00",operator:"李销售",remark:"客户对产品A很感兴趣",recordingUrl:"https://example.com/recording1.mp3"},{id:2,customerName:"李四",customerPhone:"13800138002",callType:"inbound",duration:"00:02:15",status:"connected",startTime:"2024-01-15 10:20:00",operator:"王销售",remark:"咨询产品价格",recordingUrl:"https://example.com/recording2.mp3"},{id:3,customerName:"王五",customerPhone:"13800138003",callType:"outbound",duration:"00:00:00",status:"no_answer",startTime:"2024-01-14 16:45:00",operator:"张销售",remark:"未接听",recordingUrl:null}];if(le.customerKeyword){const i=le.customerKeyword.toLowerCase();e=e.filter(V=>V.customerName.toLowerCase().includes(i)||V.customerPhone.includes(i))}gt.value=e,oe.total=e.length}catch(o){console.error("加载通话记录失败:",o),c.error("加载通话记录失败")}finally{We.value=!1}}),Ct=()=>{le.dateRange=[],le.customerKeyword="",ae()},wl=o=>{oe.pageSize=o,ae()},Cl=o=>{oe.currentPage=o,ae()},_t=o=>{re.value=o,Le.value=!0},ht=o=>{if(!o.recordingUrl){c.warning("该通话没有录音文件");return}const e=document.createElement("a");e.href=o.recordingUrl,e.download=`录音_${o.customerName}_${o.startTime.replace(/[:\s]/g,"_")}.mp3`,document.body.appendChild(e),e.click(),document.body.removeChild(e),c.success("录音下载已开始")},_l=()=>{Fe.value&&(Fe.value.pause(),Fe.value.currentTime=0),Le.value=!1,re.value=null},hl=()=>{console.log("开始加载音频")},kl=()=>{console.log("音频可以播放")},xl=o=>{console.error("音频播放错误:",o),c.error("录音播放失败，请检查录音文件")},kt=()=>{var o;Object.assign(F,{type:"call",content:"",nextFollowTime:"",intention:"",remark:""}),(o=$e.value)==null||o.clearValidate()},Vl=()=>h(this,null,function*(){var o,e;if($e.value)try{yield $e.value.validate(),Je.value=!0;const i={callId:"",customerId:M.value.id,customerName:M.value.name,followUpType:F.type,content:F.content,nextFollowUpDate:F.nextFollowTime||void 0,priority:"medium",status:"pending",userId:((o=q.currentUser)==null?void 0:o.id)||"1",userName:((e=q.currentUser)==null?void 0:e.name)||"当前用户"};yield P.createFollowUp(i),c.success("跟进记录保存成功"),ue.value=!1,kt(),me()}catch(i){console.error("保存跟进记录失败:",i),c.error("保存跟进记录失败，请重试")}finally{Je.value=!1}}),Sl=()=>{c.info("导出数据功能开发中...")},Ul=o=>{c.success(`正在外呼客户：${o.customerName}`)},Dl=o=>{M.value=o,Ke.value=!0},Il=o=>h(this,null,function*(){const e=J.getCustomerById(o.id);e?M.value=e:M.value={id:o.id,name:o.customerName,phone:o.phone,company:o.company||"未知公司",address:o.address||"",province:o.province||"",city:o.city||"",district:o.district||"",street:o.street||"",detailAddress:o.detailAddress||""},ue.value=!0}),Pl=o=>{R.push({name:"OrderAdd",query:{customerId:o.id,customerName:o.customerName,customerPhone:o.phone,customerCompany:o.company||"",source:"call_management"}})},zl=o=>{L.pageSize=o,me()},Tl=o=>{L.currentPage=o,me()},Ml=o=>o?o.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"):"",lt=o=>({normal:"",silver:"info",gold:"warning",diamond:"success"})[o]||"",ot=o=>({normal:"普通",silver:"白银",gold:"黄金",diamond:"钻石"})[o]||"普通",at=o=>({pending:"warning",connected:"success",no_answer:"info",busy:"warning",failed:"danger"})[o]||"info",st=o=>({pending:"待外呼",connected:"已接通",no_answer:"未接听",busy:"忙线",failed:"失败"})[o]||"未知";let fe=null;const nt=b(!1),Rl=(o="")=>{fe&&clearTimeout(fe),fe=setTimeout(()=>{it(o)},300)},it=(o="")=>h(this,null,function*(){var e;try{nt.value=!0,yield J.loadCustomers();const i=J.customers,V=(e=q.currentUser)==null?void 0:e.id;let w=i.filter(r=>r.salesPersonId===V||r.createdBy===V);if(o&&o.trim()){const r=o.toLowerCase().trim(),x=o.trim();w=w.filter(A=>{const f=A.name&&A.name.toLowerCase().includes(r),z=A.code&&A.code.toLowerCase().includes(r),X=A.phone&&A.phone.includes(x),S=A.company&&A.company.toLowerCase().includes(r),v=A.phone&&A.phone.replace(/[-\s]/g,"").includes(x.replace(/[-\s]/g,"")),k=A.code&&(A.code.toLowerCase().includes(r)||A.code.toLowerCase().startsWith(r));return f||z||X||S||v||k}),w.sort((A,f)=>{const z=X=>{var xe,m;let S=0;const v=((xe=X.name)==null?void 0:xe.toLowerCase())||"",k=((m=X.code)==null?void 0:m.toLowerCase())||"",G=X.phone||"";return v===r||k===r||G===x?S+=100:v.startsWith(r)||k.startsWith(r)||G.startsWith(x)?S+=50:(v.includes(r)||k.includes(r)||G.includes(x))&&(S+=10),S};return z(f)-z(A)})}w.sort((r,x)=>(r.name||"").localeCompare(x.name||"")),he.value=w.slice(0,50),w.length===0&&o&&o.trim()&&console.log(`未找到匹配"${o}"的客户`)}catch(i){console.error("搜索客户失败:",i),c.error("加载客户列表失败"),he.value=[]}finally{nt.value=!1}}),Al=o=>{if(!o){Ne.value=[],C.value.customerPhone="",C.value.customerId="";return}C.value.customerId=o.id;const e=[];o.phone&&e.push({phone:o.phone,type:"主号码"}),o.phones&&Array.isArray(o.phones)&&o.phones.forEach(i=>{i.phone&&i.phone!==o.phone&&e.push({phone:i.phone,type:i.type||"其他"})}),Ne.value=e,e.length>0&&(C.value.customerPhone=e[0].phone)},Nl=()=>{console.log("手动输入号码:",C.value.manualPhone)},xt=()=>{Me.value=!1,Vt()},Vt=()=>{C.value={callMethod:"network",networkConfig:{lineId:"",audioQuality:"standard"},mobileConfig:{phoneNumber:"",enableRecording:!0},selectedCustomer:null,customerPhone:"",manualPhone:"",customerId:"",notes:""},he.value=[],Ne.value=[]},Kl=()=>h(this,null,function*(){Vt(),Me.value=!0,yield it()}),Ll=()=>{if(!M.value){c.warning("请先选择客户");return}ue.value=!0},Fl=()=>h(this,null,function*(){if(Ye.value)try{yield Ye.value.validate();const o=C.value.manualPhone||C.value.customerPhone;if(!o){c.warning("请选择客户号码或手动输入号码");return}qe.value=!0;const e={customerPhone:o,notes:C.value.notes,callMethod:C.value.callMethod,callConfig:C.value.callMethod==="network"?C.value.networkConfig:C.value.mobileConfig};C.value.selectedCustomer&&!C.value.manualPhone&&(e.customerId=C.value.customerId||""),yield P.makeOutboundCall(e),xt(),c.success("外呼已发起"),yield P.fetchCallRecords()}catch(o){console.error("外呼失败:",o),c.error("外呼失败，请重试")}finally{qe.value=!1}}),$l=o=>{if(ie.value==="busy"){c.warning("当前状态为忙碌，无法接收来电");return}N.value=o,de.value=!0},Ol=()=>{N.value&&(de.value=!1,Z.value=N.value,pe.value=0,Ce.value="",Re.value=!0,Bl(),c.success("通话已接通"))},ql=()=>{de.value=!1,N.value=null,c.info("已拒绝来电")},Yl=()=>h(this,null,function*(){jl();try{yield Ql(),c.success("通话已结束，记录已保存")}catch(o){console.error("保存通话记录失败:",o),c.error("保存通话记录失败")}Re.value=!1,Z.value=null,pe.value=0,Ce.value=""}),Bl=()=>{Ae.value=setInterval(()=>{pe.value++},1e3)},jl=()=>{Ae.value&&(clearInterval(Ae.value),Ae.value=null)},El=o=>{const e=Math.floor(o/3600),i=Math.floor(o%3600/60),V=o%60;return e>0?`${e.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`:`${i.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`},Ql=()=>h(this,null,function*(){if(!Z.value)return;const o={customerId:Z.value.id||"",customerName:Z.value.customerName||"未知客户",phone:Z.value.phone,direction:"incoming",duration:pe.value,status:"completed",notes:Ce.value,startTime:new Date(Date.now()-pe.value*1e3).toISOString(),endTime:new Date().toISOString()};yield P.saveCallRecord(o),yield tt()}),Hl=()=>{N.value&&(M.value=N.value,Ke.value=!0,de.value=!1)},Wl=()=>{N.value&&(M.value=N.value,ue.value=!0,de.value=!1)},Jl=()=>{$l({id:"test_001",customerName:"测试客户",phone:"13800138888",customerLevel:"gold",lastCallTime:"2024-01-10 15:30:00",company:"测试公司"})},Gl=o=>{const e=o.id||o.callId;o.customerId||o.customer_id,e?R.push(`/service-management/call/records?callId=${e}`):c.info("查看通话详情")},Zl=o=>({pending:"warning",completed:"success",cancelled:"danger"})[o]||"info",Xl=o=>({pending:"待处理",completed:"已完成",cancelled:"已取消"})[o]||"未知",eo=o=>({pending:"warning",processing:"primary",completed:"success",rejected:"danger"})[o]||"info",to=o=>({pending:"待处理",processing:"处理中",completed:"已完成",rejected:"已拒绝"})[o]||"未知",lo=o=>{c.info(`查看订单：${o.orderNo}`)},oo=o=>{c.info(`查看售后工单：${o.ticketNo}`)},ao=o=>{c.info("查看跟进记录")},St=()=>h(this,null,function*(){var o;try{const e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate()).toISOString(),V=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1).toISOString(),r=(yield Uo({startDate:i,endDate:V,groupBy:"day"})).data;Q.todayCalls=r.totalCalls||0,Q.totalDuration=r.totalDuration||0,Q.connectionRate=Math.round(r.connectionRate||0),Q.activeUsers=((o=r.userStats)==null?void 0:o.length)||0}catch(e){console.error("加载统计数据失败:",e),Q.todayCalls=0,Q.totalDuration=0,Q.connectionRate=0,Q.activeUsers=0}});return _o(()=>h(this,null,function*(){try{yield St(),yield me(),yield P.fetchCallRecords({pageSize:10}),yield P.fetchFollowUpRecords({pageSize:20}),yield Xe(),yield yt(),yield vt()}catch(o){console.error("加载数据失败:",o)}})),ho(()=>{j.value&&(clearInterval(j.value),j.value=null),fe&&(clearTimeout(fe),fe=null)}),ko(()=>n.mobileConfig.platform,o=>h(this,null,function*(){n.mobileConfig.sdkInfo={version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:o==="android"?"Android 5.0+":"iOS 12.0+",packageType:o==="android"?"APK":"IPA"},yield yt(),yield Xe()})),(o,e)=>{var It;const i=U("el-button"),V=U("el-tooltip"),w=U("el-icon"),r=U("el-card"),x=U("el-col"),A=U("el-row"),f=U("el-option"),z=U("el-select"),X=U("el-date-picker"),S=U("el-input"),v=U("el-table-column"),k=U("el-tag"),G=U("el-table"),xe=U("el-pagination"),m=U("el-form-item"),Ve=U("el-form"),se=U("el-dialog"),ce=U("el-tab-pane"),Ut=U("el-tabs"),H=U("el-radio"),Se=U("el-radio-group"),Ue=U("el-divider"),ge=U("el-input-number"),dt=U("el-alert"),De=U("el-switch"),Dt=xo("loading");return y(),_("div",Oo,[s("div",qo,[e[74]||(e[74]=s("h2",null,"通话管理",-1)),s("div",Yo,[t(i,{type:ie.value==="ready"?"success":"warning",icon:ie.value==="ready"?"Check":"Close",onClick:Zt,class:"status-button"},{default:l(()=>[d(u(ie.value==="ready"?"就绪":"忙碌"),1)]),_:1},8,["type","icon"]),t(i,{type:"primary",icon:p(ye),onClick:Kl},{default:l(()=>[...e[70]||(e[70]=[d(" 发起外呼 ",-1)])]),_:1},8,["icon"]),t(i,{type:"info",icon:p(ut),onClick:il},{default:l(()=>[...e[71]||(e[71]=[d(" 呼出配置 ",-1)])]),_:1},8,["icon"]),t(i,{icon:p(ct),onClick:tt,loading:te.value},{default:l(()=>[...e[72]||(e[72]=[d(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"]),t(V,{content:Y.value?"关闭自动刷新":"开启自动刷新"},{default:l(()=>[t(i,{type:Y.value?"success":"info",icon:Y.value?"VideoPause":"VideoPlay",onClick:pl,circle:""},null,8,["type","icon"])]),_:1},8,["content"]),t(i,{type:"info",onClick:Jl},{default:l(()=>[...e[73]||(e[73]=[d(" 测试呼入 ",-1)])]),_:1})])]),t(A,{gutter:20,class:"stats-row"},{default:l(()=>[t(x,{span:6},{default:l(()=>[t(r,{class:"stat-card"},{default:l(()=>[s("div",Bo,[s("div",jo,[t(w,null,{default:l(()=>[t(p(ye))]),_:1})]),s("div",Eo,[s("div",Qo,u(Q.todayCalls),1),e[75]||(e[75]=s("div",{class:"stat-label"},"今日通话",-1))])])]),_:1})]),_:1}),t(x,{span:6},{default:l(()=>[t(r,{class:"stat-card"},{default:l(()=>[s("div",Ho,[s("div",Wo,[t(w,null,{default:l(()=>[t(p(zo))]),_:1})]),s("div",Jo,[s("div",Go,u(Jt(Q.totalDuration)),1),e[76]||(e[76]=s("div",{class:"stat-label"},"通话时长",-1))])])]),_:1})]),_:1}),t(x,{span:6},{default:l(()=>[t(r,{class:"stat-card"},{default:l(()=>[s("div",Zo,[s("div",Xo,[t(w,null,{default:l(()=>[t(p(To))]),_:1})]),s("div",ea,[s("div",ta,u(Q.connectionRate)+"%",1),e[77]||(e[77]=s("div",{class:"stat-label"},"接通率",-1))])])]),_:1})]),_:1}),t(x,{span:6},{default:l(()=>[t(r,{class:"stat-card"},{default:l(()=>[s("div",la,[s("div",oa,[t(w,null,{default:l(()=>[t(p(Tt))]),_:1})]),s("div",aa,[s("div",sa,u(Q.activeUsers),1),e[78]||(e[78]=s("div",{class:"stat-label"},"活跃用户",-1))])])]),_:1})]),_:1})]),_:1}),t(r,{class:"filter-card"},{default:l(()=>[s("div",na,[s("div",ia,[s("div",da,[e[79]||(e[79]=s("label",null,"通话状态：",-1)),t(z,{modelValue:E.status,"onUpdate:modelValue":e[0]||(e[0]=a=>E.status=a),placeholder:"请选择状态",clearable:""},{default:l(()=>[t(f,{label:"全部",value:""}),t(f,{label:"待外呼",value:"pending"}),t(f,{label:"已接通",value:"connected"}),t(f,{label:"未接听",value:"no_answer"}),t(f,{label:"忙线",value:"busy"}),t(f,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])]),s("div",ra,[e[80]||(e[80]=s("label",null,"客户等级：",-1)),t(z,{modelValue:E.customerLevel,"onUpdate:modelValue":e[1]||(e[1]=a=>E.customerLevel=a),placeholder:"请选择等级",clearable:""},{default:l(()=>[t(f,{label:"全部",value:""}),t(f,{label:"普通客户",value:"normal"}),t(f,{label:"白银客户",value:"silver"}),t(f,{label:"黄金客户",value:"gold"}),t(f,{label:"钻石客户",value:"diamond"})]),_:1},8,["modelValue"])]),s("div",ua,[e[81]||(e[81]=s("label",null,"时间范围：",-1)),t(X,{modelValue:E.dateRange,"onUpdate:modelValue":e[2]||(e[2]=a=>E.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),s("div",ca,[e[82]||(e[82]=s("label",null,"负责人：",-1)),t(z,{modelValue:E.salesPerson,"onUpdate:modelValue":e[3]||(e[3]=a=>E.salesPerson=a),placeholder:"请选择负责人",clearable:""},{default:l(()=>[t(f,{label:"全部",value:""}),t(f,{label:"张三",value:"zhangsan"}),t(f,{label:"李四",value:"lisi"}),t(f,{label:"王五",value:"wangwu"})]),_:1},8,["modelValue"])])]),s("div",pa,[t(S,{modelValue:we.value,"onUpdate:modelValue":e[4]||(e[4]=a=>we.value=a),placeholder:"搜索客户姓名、电话号码、订单号",clearable:"",style:{width:"400px"},onKeyup:Vo(wt,["enter"])},{prefix:l(()=>[t(w,null,{default:l(()=>[t(p(Oe))]),_:1})]),_:1},8,["modelValue"]),t(i,{type:"primary",icon:p(Oe),onClick:wt},{default:l(()=>[...e[83]||(e[83]=[d("搜索",-1)])]),_:1},8,["icon"]),t(i,{icon:p(Mt),onClick:gl},{default:l(()=>[...e[84]||(e[84]=[d("重置",-1)])]),_:1},8,["icon"])])])]),_:1}),t(r,{class:"table-card"},{header:l(()=>[s("div",ma,[e[87]||(e[87]=s("span",null,"呼出列表",-1)),s("div",fa,[t(i,{type:"primary",icon:p(ye),onClick:yl},{default:l(()=>[...e[85]||(e[85]=[d("通话记录",-1)])]),_:1},8,["icon"]),t(i,{icon:p(pt),onClick:Sl},{default:l(()=>[...e[86]||(e[86]=[d("导出数据",-1)])]),_:1},8,["icon"])])])]),default:l(()=>[Pt((y(),K(G,{data:He.value,style:{width:"100%"},onSelectionChange:vl},{default:l(()=>[t(v,{type:"selection",width:"55"}),t(v,{prop:"customerName",label:"客户姓名",width:"120"}),t(v,{prop:"phone",label:"电话号码",width:"140"},{default:l(({row:a})=>[d(u(Ml(a.phone)),1)]),_:1}),t(v,{prop:"customerLevel",label:"客户等级",width:"100"},{default:l(({row:a})=>[t(k,{type:lt(a.customerLevel)},{default:l(()=>[d(u(ot(a.customerLevel)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"lastCallTime",label:"最后通话",width:"160"}),t(v,{prop:"callCount",label:"通话次数",width:"100"}),t(v,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[t(k,{type:at(a.status)},{default:l(()=>[d(u(st(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"salesPerson",label:"负责人",width:"100"}),t(v,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),t(v,{label:"操作",width:"220",fixed:"right"},{default:l(({row:a})=>[s("span",{class:"action-link",onClick:T=>Ul(a)},"外呼",8,ga),s("span",{class:"action-link",onClick:T=>Dl(a)},"详情",8,va),s("span",{class:"action-link",onClick:T=>Il(a)},"跟进",8,ya),s("span",{class:"action-link",onClick:T=>Pl(a)},"下单",8,ba)]),_:1})]),_:1},8,["data"])),[[Dt,ne.value]]),s("div",wa,[s("div",Ca,[s("span",_a," 共 "+u(L.total)+" 条记录，当前显示第 "+u((L.currentPage-1)*L.pageSize+1)+" - "+u(Math.min(L.currentPage*L.pageSize,L.total))+" 条 ",1)]),t(xe,{"current-page":L.currentPage,"onUpdate:currentPage":e[5]||(e[5]=a=>L.currentPage=a),"page-size":L.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>L.pageSize=a),"page-sizes":[10,20,50,100],total:L.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:zl,onCurrentChange:Tl},null,8,["current-page","page-size","total"])])]),_:1}),t(se,{modelValue:Me.value,"onUpdate:modelValue":e[15]||(e[15]=a=>Me.value=a),title:"发起外呼",width:"600px"},{footer:l(()=>[t(i,{onClick:xt},{default:l(()=>[...e[96]||(e[96]=[d("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:Fl,loading:qe.value},{default:l(()=>[...e[97]||(e[97]=[d(" 开始呼叫 ",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(Ve,{model:C.value,rules:Bt,ref_key:"outboundFormRef",ref:Ye,"label-width":"100px"},{default:l(()=>[t(m,{label:"外呼方式",prop:"callMethod"},{default:l(()=>[t(z,{modelValue:C.value.callMethod,"onUpdate:modelValue":e[7]||(e[7]=a=>C.value.callMethod=a),placeholder:"请选择外呼方式",style:{width:"100%"},onChange:bt},{default:l(()=>[t(f,{label:"网络电话",value:"network_phone"},{default:l(()=>[s("div",ha,[e[89]||(e[89]=s("div",null,[s("div",{style:{"font-weight":"500"}},"网络电话"),s("div",{style:{color:"#8492a6","font-size":"12px"}},"使用阿里云通信等第三方服务")],-1)),t(k,{size:"small",type:"success"},{default:l(()=>[...e[88]||(e[88]=[d("推荐",-1)])]),_:1})])]),_:1}),t(f,{label:"工作手机",value:"work_phone"},{default:l(()=>[s("div",ka,[e[91]||(e[91]=s("div",null,[s("div",{style:{"font-weight":"500"}},"工作手机"),s("div",{style:{color:"#8492a6","font-size":"12px"}},"使用绑定的工作手机拨打")],-1)),t(k,{size:"small",type:"info"},{default:l(()=>[...e[90]||(e[90]=[d("录音",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),s("div",xa,[C.value.callMethod==="network_phone"?(y(),_("span",Va," 网络电话支持自动录音，通话质量稳定 ")):C.value.callMethod==="work_phone"?(y(),_("span",Sa," 工作手机需要预先绑定，支持系统级录音 ")):(y(),_("span",Ua," 请选择合适的外呼方式 "))])]),_:1}),C.value.callMethod==="network_phone"?(y(),K(m,{key:0,label:"选择线路",prop:"selectedLine"},{default:l(()=>[t(z,{modelValue:C.value.selectedLine,"onUpdate:modelValue":e[8]||(e[8]=a=>C.value.selectedLine=a),placeholder:"请选择外呼线路",style:{width:"100%"}},{default:l(()=>[(y(!0),_(W,null,ve(o.availableLines,a=>(y(),K(f,{key:a.id,label:a.name,value:a.id},{default:l(()=>[s("div",Da,[s("div",null,[s("div",Ia,u(a.name),1),s("div",Pa,u(a.provider)+" - "+u(a.status),1)]),t(k,{size:"small",type:a.status==="正常"?"success":"warning"},{default:l(()=>[d(u(a.status),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),s("div",za,[t(i,{type:"text",size:"small",onClick:o.openLineConfig},{default:l(()=>[t(w,null,{default:l(()=>[t(p(ut))]),_:1}),e[92]||(e[92]=d(" 配置外呼线路 ",-1))]),_:1},8,["onClick"])])]),_:1})):I("",!0),C.value.callMethod==="work_phone"?(y(),K(m,{key:1,label:"工作手机",prop:"workPhone"},{default:l(()=>[t(z,{modelValue:C.value.workPhone,"onUpdate:modelValue":e[9]||(e[9]=a=>C.value.workPhone=a),placeholder:"请选择工作手机",style:{width:"100%"}},{default:l(()=>[(y(!0),_(W,null,ve(Yt.value,a=>(y(),K(f,{key:a.id,label:a.number,value:a.id},{default:l(()=>[s("div",Ta,[s("div",null,[s("div",Ma,u(a.number),1),s("div",Ra,u(a.brand)+" "+u(a.model),1)]),t(k,{size:"small",type:a.status==="已绑定"?"success":"warning"},{default:l(()=>[d(u(a.status),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),s("div",Aa,[t(i,{type:"text",size:"small",onClick:o.openPhoneConfig},{default:l(()=>[t(w,null,{default:l(()=>[t(p(ut))]),_:1}),e[93]||(e[93]=d(" 配置工作手机 ",-1))]),_:1},8,["onClick"])])]),_:1})):I("",!0),t(m,{label:"选择客户",prop:"selectedCustomer"},{default:l(()=>[t(z,{modelValue:C.value.selectedCustomer,"onUpdate:modelValue":e[10]||(e[10]=a=>C.value.selectedCustomer=a),placeholder:"请输入客户姓名、编号、电话或公司名称进行搜索",filterable:"",remote:"","remote-method":Rl,loading:nt.value||p(J).loading,style:{width:"100%"},onChange:Al,onFocus:e[11]||(e[11]=()=>{he.value.length===0&&it()}),clearable:"","no-data-text":"暂无客户数据，请输入关键词搜索","no-match-text":"未找到匹配的客户","loading-text":"正在搜索客户..."},{default:l(()=>[(y(!0),_(W,null,ve(he.value,a=>(y(),K(f,{key:a.id,label:`${a.name} (${a.code||""})`,value:a},{default:l(()=>[s("div",Na,[s("div",Ka,[s("div",La,u(a.name),1),s("div",Fa,[d(u(a.company||"未填写公司")+" ",1),a.phone?(y(),_("span",$a,u(p(Te)(a.phone,p(ze).PHONE)),1)):I("",!0)])]),s("span",Oa,u(a.code||"无编号"),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[94]||(e[94]=s("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 支持按客户姓名、编号、电话号码或公司名称搜索 ",-1))]),_:1}),t(m,{label:"选择号码",prop:"customerPhone"},{default:l(()=>[t(z,{modelValue:C.value.customerPhone,"onUpdate:modelValue":e[12]||(e[12]=a=>C.value.customerPhone=a),placeholder:"请选择号码",style:{width:"100%"},disabled:!C.value.selectedCustomer},{default:l(()=>[(y(!0),_(W,null,ve(Ne.value,a=>(y(),K(f,{key:a.phone,label:`${a.phone} (${a.type})`,value:a.phone},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(m,{label:"手动输入号码"},{default:l(()=>[t(S,{modelValue:C.value.manualPhone,"onUpdate:modelValue":e[13]||(e[13]=a=>C.value.manualPhone=a),placeholder:"或手动输入电话号码",onInput:Nl},null,8,["modelValue"]),e[95]||(e[95]=s("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 手动输入号码将优先使用，不会同步客户信息 ",-1))]),_:1}),t(m,{label:"备注"},{default:l(()=>[t(S,{modelValue:C.value.notes,"onUpdate:modelValue":e[14]||(e[14]=a=>C.value.notes=a),type:"textarea",rows:3,placeholder:"请输入通话备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(se,{modelValue:Ke.value,"onUpdate:modelValue":e[17]||(e[17]=a=>Ke.value=a),title:`客户详情 - ${(It=M.value)==null?void 0:It.customerName}`,width:"80%",top:"5vh"},{default:l(()=>[M.value?(y(),_("div",qa,[t(r,{class:"customer-info-card"},{header:l(()=>[...e[98]||(e[98]=[s("span",null,"客户基本信息",-1)])]),default:l(()=>[t(A,{gutter:20},{default:l(()=>[t(x,{span:8},{default:l(()=>[s("div",Ya,[e[99]||(e[99]=s("label",null,"客户姓名：",-1)),s("span",null,u(M.value.customerName),1)])]),_:1}),t(x,{span:8},{default:l(()=>[s("div",Ba,[e[100]||(e[100]=s("label",null,"联系电话：",-1)),s("span",null,u(p(Te)(M.value.phone,p(ze).PHONE)),1)])]),_:1}),t(x,{span:8},{default:l(()=>[s("div",ja,[e[101]||(e[101]=s("label",null,"客户等级：",-1)),t(k,{type:lt(M.value.customerLevel)},{default:l(()=>[d(u(ot(M.value.customerLevel)),1)]),_:1},8,["type"])])]),_:1}),t(x,{span:8},{default:l(()=>[s("div",Ea,[e[102]||(e[102]=s("label",null,"负责人：",-1)),s("span",null,u(M.value.salesPerson),1)])]),_:1}),t(x,{span:8},{default:l(()=>[s("div",Qa,[e[103]||(e[103]=s("label",null,"通话次数：",-1)),s("span",null,u(M.value.callCount)+" 次",1)])]),_:1}),t(x,{span:8},{default:l(()=>[s("div",Ha,[e[104]||(e[104]=s("label",null,"最后通话：",-1)),s("span",null,u(M.value.lastCallTime),1)])]),_:1})]),_:1})]),_:1}),t(r,{class:"tabs-card"},{default:l(()=>[t(Ut,{modelValue:ft.value,"onUpdate:modelValue":e[16]||(e[16]=a=>ft.value=a),type:"border-card"},{default:l(()=>[t(ce,{label:"订单记录",name:"orders"},{default:l(()=>[s("div",Wa,[s("div",Ja,[t(i,{type:"primary",size:"small",icon:p(Rt)},{default:l(()=>[...e[105]||(e[105]=[d("新建订单",-1)])]),_:1},8,["icon"])]),t(G,{data:Et.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"orderNo",label:"订单号",width:"150"}),t(v,{prop:"productName",label:"商品名称",width:"200"}),t(v,{prop:"amount",label:"订单金额",width:"120"},{default:l(({row:a})=>[d(" ¥"+u(a.amount),1)]),_:1}),t(v,{prop:"status",label:"订单状态",width:"100"},{default:l(({row:a})=>[t(k,{type:Zl(a.status)},{default:l(()=>[d(u(Xl(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"createTime",label:"下单时间",width:"160"}),t(v,{label:"操作",width:"120"},{default:l(({row:a})=>[t(i,{size:"small",type:"primary",onClick:T=>lo(a)},{default:l(()=>[...e[106]||(e[106]=[d("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),t(ce,{label:"售后记录",name:"aftersales"},{default:l(()=>[s("div",Ga,[s("div",Za,[t(i,{type:"primary",size:"small",icon:p(Rt)},{default:l(()=>[...e[107]||(e[107]=[d("新建售后",-1)])]),_:1},8,["icon"])]),t(G,{data:Qt.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"ticketNo",label:"工单号",width:"150"}),t(v,{prop:"type",label:"售后类型",width:"100"}),t(v,{prop:"description",label:"问题描述","min-width":"200","show-overflow-tooltip":""}),t(v,{prop:"status",label:"处理状态",width:"100"},{default:l(({row:a})=>[t(k,{type:eo(a.status)},{default:l(()=>[d(u(to(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"createTime",label:"创建时间",width:"160"}),t(v,{label:"操作",width:"120"},{default:l(({row:a})=>[t(i,{size:"small",type:"primary",onClick:T=>oo(a)},{default:l(()=>[...e[108]||(e[108]=[d("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),t(ce,{label:"通话记录",name:"calls"},{default:l(()=>[s("div",Xa,[s("div",es,[t(i,{type:"primary",size:"small",icon:p(ye)},{default:l(()=>[...e[109]||(e[109]=[d("发起外呼",-1)])]),_:1},8,["icon"])]),t(G,{data:Ht.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"callType",label:"呼叫类型",width:"100"},{default:l(({row:a})=>[t(k,{type:a.callType==="outbound"?"primary":"success"},{default:l(()=>[d(u(a.callType==="outbound"?"外呼":"来电"),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"duration",label:"通话时长",width:"100"}),t(v,{prop:"status",label:"通话状态",width:"100"},{default:l(({row:a})=>[t(k,{type:at(a.status)},{default:l(()=>[d(u(st(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"startTime",label:"开始时间",width:"160"}),t(v,{prop:"operator",label:"操作人员",width:"100"}),t(v,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),t(v,{label:"操作",width:"200"},{default:l(({row:a})=>[s("div",ts,[s("span",{class:"action-link",onClick:T=>Gl(a)},"详情",8,ls),a.recordingUrl?(y(),_("span",{key:0,class:"action-link",onClick:T=>_t(a)},"播放录音",8,os)):I("",!0),a.recordingUrl?(y(),_("span",{key:1,class:"action-link",onClick:T=>ht(a)},"下载录音",8,as)):(y(),_("span",ss,"无录音"))])]),_:1})]),_:1},8,["data"])])]),_:1}),t(ce,{label:"跟进记录",name:"followups"},{default:l(()=>[s("div",ns,[s("div",is,[t(i,{type:"primary",size:"small",icon:p(Mo),onClick:Ll},{default:l(()=>[...e[110]||(e[110]=[d("新建跟进",-1)])]),_:1},8,["icon"])]),t(G,{data:Wt.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"type",label:"跟进类型",width:"100"}),t(v,{prop:"content",label:"跟进内容","min-width":"200","show-overflow-tooltip":""}),t(v,{prop:"nextPlan",label:"下次计划",width:"160"}),t(v,{prop:"operator",label:"跟进人",width:"100"}),t(v,{prop:"createTime",label:"跟进时间",width:"160"}),t(v,{label:"操作",width:"120"},{default:l(({row:a})=>[t(i,{size:"small",type:"primary",onClick:T=>ao(a)},{default:l(()=>[...e[111]||(e[111]=[d("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])):I("",!0)]),_:1},8,["modelValue","title"]),t(se,{modelValue:ke.value,"onUpdate:modelValue":e[22]||(e[22]=a=>ke.value=a),title:"通话记录",width:"80%","before-close":bl},{default:l(()=>[s("div",ds,[s("div",rs,[s("div",us,[s("div",cs,[e[112]||(e[112]=s("label",null,"日期范围：",-1)),t(X,{modelValue:le.dateRange,"onUpdate:modelValue":e[18]||(e[18]=a=>le.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:ae},null,8,["modelValue"])]),s("div",ps,[e[113]||(e[113]=s("label",null,"客户搜索：",-1)),t(S,{modelValue:le.customerKeyword,"onUpdate:modelValue":e[19]||(e[19]=a=>le.customerKeyword=a),placeholder:"搜索客户姓名或电话",clearable:"",style:{width:"200px"},onInput:ae},{prefix:l(()=>[t(w,null,{default:l(()=>[t(p(Oe))]),_:1})]),_:1},8,["modelValue"])]),t(i,{type:"primary",icon:p(Oe),onClick:ae},{default:l(()=>[...e[114]||(e[114]=[d("搜索",-1)])]),_:1},8,["icon"]),t(i,{icon:p(Mt),onClick:Ct},{default:l(()=>[...e[115]||(e[115]=[d("重置",-1)])]),_:1},8,["icon"])])]),Pt((y(),K(G,{data:gt.value,style:{width:"100%"}},{default:l(()=>[t(v,{prop:"customerName",label:"客户姓名",width:"120"}),t(v,{prop:"customerPhone",label:"客户电话",width:"140"}),t(v,{prop:"callType",label:"通话类型",width:"100"},{default:l(({row:a})=>[t(k,{type:a.callType==="outbound"?"primary":"success"},{default:l(()=>[d(u(a.callType==="outbound"?"外呼":"来电"),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"duration",label:"通话时长",width:"100"}),t(v,{prop:"status",label:"通话状态",width:"100"},{default:l(({row:a})=>[t(k,{type:at(a.status)},{default:l(()=>[d(u(st(a.status)),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"startTime",label:"开始时间",width:"160"}),t(v,{prop:"operator",label:"操作人员",width:"100"}),t(v,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),t(v,{label:"录音操作",width:"160"},{default:l(({row:a})=>[a.recordingUrl?(y(),_("div",ms,[t(i,{size:"small",type:"primary",onClick:T=>_t(a),icon:p(Ro)},{default:l(()=>[...e[116]||(e[116]=[d(" 播放 ",-1)])]),_:1},8,["onClick","icon"]),t(i,{size:"small",type:"success",onClick:T=>ht(a),icon:p(pt)},{default:l(()=>[...e[117]||(e[117]=[d(" 下载 ",-1)])]),_:1},8,["onClick","icon"])])):(y(),_("span",fs,"无录音"))]),_:1})]),_:1},8,["data"])),[[Dt,We.value]]),s("div",gs,[t(xe,{"current-page":oe.currentPage,"onUpdate:currentPage":e[20]||(e[20]=a=>oe.currentPage=a),"page-size":oe.pageSize,"onUpdate:pageSize":e[21]||(e[21]=a=>oe.pageSize=a),"page-sizes":[10,20,50,100],total:oe.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:wl,onCurrentChange:Cl},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"]),t(se,{modelValue:Le.value,"onUpdate:modelValue":e[23]||(e[23]=a=>Le.value=a),title:"录音播放",width:"600px","before-close":_l},{default:l(()=>{var a,T,$,Ie,Pe;return[s("div",vs,[s("div",ys,[s("p",null,[e[118]||(e[118]=s("strong",null,"客户：",-1)),d(u((a=re.value)==null?void 0:a.customerName),1)]),s("p",null,[e[119]||(e[119]=s("strong",null,"电话：",-1)),d(u((T=re.value)==null?void 0:T.customerPhone),1)]),s("p",null,[e[120]||(e[120]=s("strong",null,"时间：",-1)),d(u(($=re.value)==null?void 0:$.startTime),1)]),s("p",null,[e[121]||(e[121]=s("strong",null,"时长：",-1)),d(u((Ie=re.value)==null?void 0:Ie.duration),1)])]),s("div",bs,[s("audio",{ref_key:"audioPlayer",ref:Fe,src:(Pe=re.value)==null?void 0:Pe.recordingUrl,controls:"",style:{width:"100%"},onLoadstart:hl,onCanplay:kl,onError:xl}," 您的浏览器不支持音频播放 ",40,ws)])])]}),_:1},8,["modelValue"]),t(se,{modelValue:ue.value,"onUpdate:modelValue":e[30]||(e[30]=a=>ue.value=a),title:"快捷跟进",width:"600px",onClose:kt},{footer:l(()=>[s("div",hs,[t(i,{onClick:e[29]||(e[29]=a=>ue.value=!1)},{default:l(()=>[...e[125]||(e[125]=[d("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:Vl,loading:Je.value},{default:l(()=>[...e[126]||(e[126]=[d(" 保存跟进 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>{var a,T;return[s("div",Cs,[s("div",_s,[s("p",null,[e[122]||(e[122]=s("strong",null,"客户：",-1)),d(u((a=M.value)==null?void 0:a.name),1)]),s("p",null,[e[123]||(e[123]=s("strong",null,"电话：",-1)),d(u(p(Te)((T=M.value)==null?void 0:T.phone,p(ze).PHONE)),1)]),s("p",null,[e[124]||(e[124]=s("strong",null,"收货地址：",-1)),d(u(Gt(M.value)),1)])]),t(Ve,{model:F,rules:jt,ref_key:"quickFollowUpFormRef",ref:$e,"label-width":"100px"},{default:l(()=>[t(m,{label:"跟进类型",prop:"type"},{default:l(()=>[t(z,{modelValue:F.type,"onUpdate:modelValue":e[24]||(e[24]=$=>F.type=$),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:l(()=>[t(f,{label:"电话跟进",value:"call"}),t(f,{label:"上门拜访",value:"visit"}),t(f,{label:"邮件跟进",value:"email"}),t(f,{label:"短信跟进",value:"message"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"跟进内容",prop:"content"},{default:l(()=>[t(S,{modelValue:F.content,"onUpdate:modelValue":e[25]||(e[25]=$=>F.content=$),type:"textarea",rows:4,placeholder:"请输入跟进内容...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(m,{label:"下次跟进",prop:"nextFollowTime"},{default:l(()=>[t(X,{modelValue:F.nextFollowTime,"onUpdate:modelValue":e[26]||(e[26]=$=>F.nextFollowTime=$),type:"datetime",placeholder:"选择下次跟进时间",style:{width:"100%"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(m,{label:"客户意向",prop:"intention"},{default:l(()=>[t(z,{modelValue:F.intention,"onUpdate:modelValue":e[27]||(e[27]=$=>F.intention=$),placeholder:"请选择客户意向",style:{width:"100%"}},{default:l(()=>[t(f,{label:"很有意向",value:"high"}),t(f,{label:"一般意向",value:"medium"}),t(f,{label:"意向较低",value:"low"}),t(f,{label:"暂无意向",value:"none"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"备注",prop:"remark"},{default:l(()=>[t(S,{modelValue:F.remark,"onUpdate:modelValue":e[28]||(e[28]=$=>F.remark=$),type:"textarea",rows:2,placeholder:"备注信息（可选）",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]}),_:1},8,["modelValue"]),t(se,{modelValue:de.value,"onUpdate:modelValue":e[31]||(e[31]=a=>de.value=a),title:"来电提醒",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},{default:l(()=>[N.value?(y(),_("div",ks,[s("div",xs,[s("div",Vs,[t(w,{size:"60"},{default:l(()=>[t(p(Tt))]),_:1})]),s("div",Ss,[s("h3",null,u(N.value.customerName||"未知客户"),1),s("p",Us,u(p(Te)(N.value.phone,p(ze).PHONE)),1),N.value.customerLevel?(y(),_("p",Ds,[t(k,{type:lt(N.value.customerLevel)},{default:l(()=>[d(u(ot(N.value.customerLevel)),1)]),_:1},8,["type"])])):I("",!0),N.value.lastCallTime?(y(),_("p",Is," 上次通话："+u(N.value.lastCallTime),1)):I("",!0)])]),s("div",Ps,[t(i,{type:"success",size:"large",icon:p(ye),onClick:Ol,class:"answer-btn"},{default:l(()=>[...e[127]||(e[127]=[d(" 接听 ",-1)])]),_:1},8,["icon"]),t(i,{type:"danger",size:"large",icon:p(At),onClick:ql,class:"reject-btn"},{default:l(()=>[...e[128]||(e[128]=[d(" 挂断 ",-1)])]),_:1},8,["icon"])]),s("div",zs,[t(i,{size:"small",onClick:Hl},{default:l(()=>[...e[129]||(e[129]=[d("查看详情",-1)])]),_:1}),t(i,{size:"small",onClick:Wl},{default:l(()=>[...e[130]||(e[130]=[d("快速跟进",-1)])]),_:1})])])):I("",!0)]),_:1},8,["modelValue"]),t(se,{modelValue:Re.value,"onUpdate:modelValue":e[33]||(e[33]=a=>Re.value=a),title:"通话中",width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},{default:l(()=>[Z.value?(y(),_("div",Ts,[s("div",Ms,[s("div",Rs,u(El(pe.value)),1),e[131]||(e[131]=s("div",{class:"call-status"},"通话中...",-1))]),s("div",As,[s("p",Ns,u(Z.value.customerName||"未知客户"),1),s("p",Ks,u(p(Te)(Z.value.phone,p(ze).PHONE)),1)]),s("div",Ls,[t(i,{type:"danger",size:"large",icon:p(At),onClick:Yl,class:"end-call-btn"},{default:l(()=>[...e[132]||(e[132]=[d(" 结束通话 ",-1)])]),_:1},8,["icon"])]),s("div",Fs,[t(S,{modelValue:Ce.value,"onUpdate:modelValue":e[32]||(e[32]=a=>Ce.value=a),type:"textarea",rows:3,placeholder:"通话备注...",maxlength:"200","show-word-limit":""},null,8,["modelValue"])])])):I("",!0)]),_:1},8,["modelValue"]),t(se,{modelValue:_e.value,"onUpdate:modelValue":e[69]||(e[69]=a=>_e.value=a),title:"呼出配置",width:"700px","close-on-click-modal":!1},{footer:l(()=>[s("div",xn,[t(i,{onClick:e[68]||(e[68]=a=>_e.value=!1)},{default:l(()=>[...e[188]||(e[188]=[d("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:rl,loading:Be.value},{default:l(()=>[...e[189]||(e[189]=[d(" 保存配置 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(Ut,{modelValue:mt.value,"onUpdate:modelValue":e[67]||(e[67]=a=>mt.value=a),type:"border-card"},{default:l(()=>[t(ce,{label:"外呼方式",name:"callMethod"},{default:l(()=>[t(Ve,{model:n,"label-width":"120px",ref_key:"callConfigFormRef",ref:qt},{default:l(()=>[t(m,{label:"外呼方式"},{default:l(()=>[t(Se,{modelValue:n.callMethod,"onUpdate:modelValue":e[34]||(e[34]=a=>n.callMethod=a),onChange:bt},{default:l(()=>[t(H,{value:"system"},{default:l(()=>[...e[133]||(e[133]=[d("系统外呼路线",-1)])]),_:1}),t(H,{value:"mobile"},{default:l(()=>[...e[134]||(e[134]=[d("工作手机外呼",-1)])]),_:1}),t(H,{value:"voip"},{default:l(()=>[...e[135]||(e[135]=[d("网络电话",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),n.callMethod==="system"?(y(),_("div",$s,[t(m,{label:"外呼线路"},{default:l(()=>[t(z,{modelValue:n.lineId,"onUpdate:modelValue":e[35]||(e[35]=a=>n.lineId=a),placeholder:"请选择外呼线路",style:{width:"100%"}},{default:l(()=>[(y(!0),_(W,null,ve(Qe.value,a=>(y(),K(f,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"线路状态"},{default:l(()=>[t(k,{type:ul(n.lineId)},{default:l(()=>[d(u(cl(n.lineId)),1)]),_:1},8,["type"])]),_:1})])):I("",!0),n.callMethod==="mobile"?(y(),_("div",Os,[t(m,{label:"工作手机号"},{default:l(()=>[t(S,{modelValue:n.workPhone,"onUpdate:modelValue":e[36]||(e[36]=a=>n.workPhone=a),placeholder:"请输入工作手机号码",maxlength:"11",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),t(m,{label:"拨号方式"},{default:l(()=>[t(Se,{modelValue:n.dialMethod,"onUpdate:modelValue":e[37]||(e[37]=a=>n.dialMethod=a)},{default:l(()=>[t(H,{value:"direct"},{default:l(()=>[...e[136]||(e[136]=[d("直接拨号",-1)])]),_:1}),t(H,{value:"callback"},{default:l(()=>[...e[137]||(e[137]=[d("回拨模式",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),n.dialMethod==="direct"?(y(),_(W,{key:0},[t(Ue,{"content-position":"left"},{default:l(()=>[...e[138]||(e[138]=[d("手机SDK配置",-1)])]),_:1}),t(m,{label:"手机平台"},{default:l(()=>[t(Se,{modelValue:n.mobileConfig.platform,"onUpdate:modelValue":e[38]||(e[38]=a=>n.mobileConfig.platform=a)},{default:l(()=>[t(H,{value:"android"},{default:l(()=>[t(w,null,{default:l(()=>[t(p(Nt))]),_:1}),e[139]||(e[139]=d(" Android ",-1))]),_:1}),t(H,{value:"ios"},{default:l(()=>[t(w,null,{default:l(()=>[t(p(Ao))]),_:1}),e[140]||(e[140]=d(" iOS ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"SDK状态"},{default:l(()=>{var a,T,$,Ie;return[s("div",qs,[t(k,{type:n.mobileConfig.sdkInstalled?"success":"warning",size:"default"},{default:l(()=>[t(w,null,{default:l(()=>[(y(),K(zt(n.mobileConfig.sdkInstalled?"CircleCheckFilled":"WarningFilled")))]),_:1}),d(" "+u(n.mobileConfig.sdkInstalled?"SDK已安装":"SDK未安装"),1)]),_:1},8,["type"]),t(i,{type:"primary",icon:p(pt),onClick:tl,size:"default"},{default:l(()=>[...e[141]||(e[141]=[d(" 下载SDK应用 ",-1)])]),_:1},8,["icon"])]),s("div",Ys,[s("div",Bs,[e[142]||(e[142]=s("span",{style:{"font-weight":"500",color:"#303133"}},"当前版本信息",-1)),t(k,{size:"small",type:"info"},{default:l(()=>{var Pe;return[d("v"+u(((Pe=n.mobileConfig.sdkInfo)==null?void 0:Pe.version)||"1.0.0"),1)]}),_:1})]),s("div",js,[s("div",null,[e[143]||(e[143]=s("span",{style:{color:"#909399"}},"文件大小：",-1)),s("span",null,u(((a=n.mobileConfig.sdkInfo)==null?void 0:a.fileSize)||(n.mobileConfig.platform==="android"?"5.3 MB":"待发布")),1)]),s("div",null,[e[144]||(e[144]=s("span",{style:{color:"#909399"}},"更新时间：",-1)),s("span",null,u(((T=n.mobileConfig.sdkInfo)==null?void 0:T.updateTime)||et(new Date)),1)]),s("div",null,[e[145]||(e[145]=s("span",{style:{color:"#909399"}},"支持系统：",-1)),s("span",null,u((($=n.mobileConfig.sdkInfo)==null?void 0:$.supportedSystems)||(n.mobileConfig.platform==="android"?"Android 5.0+":"iOS 12.0+")),1)]),s("div",null,[e[146]||(e[146]=s("span",{style:{color:"#909399"}},"安装包类型：",-1)),s("span",null,u(((Ie=n.mobileConfig.sdkInfo)==null?void 0:Ie.packageType)||(n.mobileConfig.platform==="android"?"APK":"PWA")),1)])])]),s("div",Es,u(n.mobileConfig.platform==="android"?"请下载APK文件并在Android设备上安装":"请在iOS设备的Safari浏览器中访问PWA应用"),1)]}),_:1}),t(m,{label:"系统权限"},{default:l(()=>[s("div",Qs,[s("div",Hs,[t(w,{style:rt({color:n.mobileConfig.deviceAuthorized?"#67c23a":"#909399"})},{default:l(()=>[t(p(Kt))]),_:1},8,["style"]),e[147]||(e[147]=s("span",{style:{"font-size":"14px"}},"设备授权",-1)),t(k,{type:n.mobileConfig.deviceAuthorized?"success":"info",size:"small"},{default:l(()=>[d(u(n.mobileConfig.deviceAuthorized?"已授权":"待授权"),1)]),_:1},8,["type"])]),s("div",Ws,[t(w,{style:rt({color:n.mobileConfig.callPermission?"#67c23a":"#909399"})},{default:l(()=>[t(p(ye))]),_:1},8,["style"]),e[148]||(e[148]=s("span",{style:{"font-size":"14px"}},"通话权限",-1)),t(k,{type:n.mobileConfig.callPermission?"success":"info",size:"small"},{default:l(()=>[d(u(n.mobileConfig.callPermission?"已获取":"待获取"),1)]),_:1},8,["type"])])]),s("div",Js,[t(i,{type:"text",size:"small",onClick:Xe},{default:l(()=>[t(w,null,{default:l(()=>[t(p(ct))]),_:1}),e[149]||(e[149]=d(" 刷新权限状态 ",-1))]),_:1})])]),_:1}),t(m,{label:"连接状态"},{default:l(()=>[s("div",Gs,[t(k,{type:Ze().type,size:"default"},{default:l(()=>[t(w,null,{default:l(()=>[(y(),K(zt(Ze().icon)))]),_:1}),d(" "+u(Ze().text),1)]),_:1},8,["type"]),t(i,{type:"success",icon:p(be),onClick:ll,loading:je.value,size:"default"},{default:l(()=>[...e[150]||(e[150]=[d(" 测试连接 ",-1)])]),_:1},8,["icon","loading"])]),e[151]||(e[151]=s("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 确保手机与系统在同一网络环境下 ",-1))]),_:1}),t(m,{label:"扫码连接"},{default:l(()=>[s("div",Zs,[s("div",Xs,[D.qrCodeUrl?(y(),_("div",en,[s("img",{src:D.qrCodeUrl,alt:"连接二维码",style:{width:"120px",height:"120px"}},null,8,tn)])):(y(),_("div",ln,[t(w,{size:"24"},{default:l(()=>[t(p(be))]),_:1})])),s("div",on,u(D.status==="pending"?"等待扫码连接":D.status==="connected"?"连接成功":D.status==="expired"?"二维码已过期":"点击生成二维码"),1),D.expiresAt?(y(),_("div",an,u(o.getQRExpiryText()),1)):I("",!0)]),s("div",sn,[s("div",nn,[t(i,{type:"primary",icon:p(be),onClick:Xt,loading:D.generating,size:"default"},{default:l(()=>[d(u(D.qrCodeUrl?"重新生成":"生成二维码"),1)]),_:1},8,["icon","loading"]),D.qrCodeUrl?(y(),K(i,{key:0,type:"info",icon:p(ct),onClick:Ge,loading:D.checking,size:"small"},{default:l(()=>[...e[152]||(e[152]=[d(" 检查连接状态 ",-1)])]),_:1},8,["icon","loading"])):I("",!0),D.status==="connected"?(y(),K(i,{key:1,type:"warning",icon:p(Lt),onClick:o.disconnectQRConnection,size:"small"},{default:l(()=>[...e[153]||(e[153]=[d(" 断开连接 ",-1)])]),_:1},8,["icon","onClick"])):I("",!0)]),s("div",dn,[s("div",rn,[t(w,null,{default:l(()=>[t(p(Ft))]),_:1}),e[154]||(e[154]=d(" 扫码连接说明： ",-1))]),e[155]||(e[155]=s("div",null,'1. 点击"生成二维码"按钮',-1)),e[156]||(e[156]=s("div",null,"2. 使用手机SDK应用扫描二维码",-1)),e[157]||(e[157]=s("div",null,"3. 确认连接权限并完成配置",-1)),e[158]||(e[158]=s("div",null,"4. 连接成功后可断开重连",-1))])])])]),_:1}),t(m,{label:"替代连接方式"},{default:l(()=>[s("div",un,[s("div",cn,[s("div",pn,[t(w,{size:"24",style:{color:"#409eff","margin-bottom":"8px"}},{default:l(()=>[t(p(be))]),_:1}),e[159]||(e[159]=s("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"蓝牙连接",-1)),t(k,{type:g.bluetooth.status==="connected"?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:l(()=>[d(u(g.bluetooth.status==="connected"?"已连接":g.bluetooth.status==="connecting"?"连接中":"未连接"),1)]),_:1},8,["type"]),s("div",null,[t(i,{type:"primary",size:"small",loading:g.bluetooth.status==="connecting",onClick:ol},{default:l(()=>[d(u(g.bluetooth.status==="connected"?"断开":"连接"),1)]),_:1},8,["loading"])])]),s("div",mn,[t(w,{size:"24",style:{color:"#67c23a","margin-bottom":"8px"}},{default:l(()=>[t(p(be))]),_:1}),e[160]||(e[160]=s("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"同网络连接",-1)),t(k,{type:g.network.status==="connected"?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:l(()=>[d(u(g.network.status==="connected"?"已连接":g.network.status==="discovering"?"搜索中":"未连接"),1)]),_:1},8,["type"]),s("div",null,[t(i,{type:"success",size:"small",loading:g.network.status==="discovering",onClick:al},{default:l(()=>[d(u(g.network.status==="connected"?"断开":"搜索"),1)]),_:1},8,["loading"])])]),s("div",fn,[t(w,{size:"24",style:{color:"#e6a23c","margin-bottom":"8px"}},{default:l(()=>[t(p(Kt))]),_:1}),e[161]||(e[161]=s("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"数字配对",-1)),t(k,{type:g.digital.status==="connected"?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:l(()=>[d(u(g.digital.status==="connected"?"已连接":g.digital.status==="generating"?"生成中":"未连接"),1)]),_:1},8,["type"]),g.digital.code?(y(),_("div",gn,u(g.digital.code),1)):I("",!0),s("div",null,[t(i,{type:"warning",size:"small",loading:g.digital.status==="generating",onClick:sl},{default:l(()=>[d(u(g.digital.code?"重新生成":"生成配对码"),1)]),_:1},8,["loading"])])])]),s("div",vn,[s("div",yn,[t(w,null,{default:l(()=>[t(p(Ft))]),_:1}),e[162]||(e[162]=d(" 替代连接方式说明： ",-1))]),e[163]||(e[163]=s("div",null,"• 蓝牙连接：通过蓝牙与手机设备建立连接",-1)),e[164]||(e[164]=s("div",null,"• 同网络连接：在同一WiFi网络下自动发现设备",-1)),e[165]||(e[165]=s("div",null,"• 数字配对：生成6位数字配对码进行连接",-1))])])]),_:1}),Ee.value.length>0?(y(),K(m,{key:0,label:"已连接设备"},{default:l(()=>[s("div",bn,[(y(!0),_(W,null,ve(Ee.value,a=>(y(),_("div",{key:a.id,style:{padding:"12px","border-bottom":"1px solid #f5f7fa",display:"flex","align-items":"center","justify-content":"space-between"}},[s("div",wn,[t(w,{style:rt({color:a.status==="online"?"#67c23a":"#909399"})},{default:l(()=>[t(p(Nt))]),_:1},8,["style"]),s("div",null,[s("div",Cn,u(a.deviceName),1),s("div",_n," 最后连接："+u(et(new Date(a.lastConnected))),1)])]),s("div",hn,[t(k,{type:a.status==="online"?"success":"info",size:"small"},{default:l(()=>[d(u(a.status==="online"?"在线":"离线"),1)]),_:2},1032,["type"]),t(i,{type:"text",icon:p(Lt),onClick:T=>o.removeConnectedDevice(a.id),size:"small",style:{color:"#f56c6c"}},{default:l(()=>[...e[166]||(e[166]=[d(" 移除 ",-1)])]),_:1},8,["icon","onClick"])])]))),128))])]),_:1})):I("",!0)],64)):I("",!0),n.dialMethod==="callback"?(y(),_(W,{key:1},[t(Ue,{"content-position":"left"},{default:l(()=>[...e[167]||(e[167]=[d("回拨模式配置",-1)])]),_:1}),t(m,{label:"回拨服务商"},{default:l(()=>[t(z,{modelValue:n.callbackConfig.provider,"onUpdate:modelValue":e[39]||(e[39]=a=>n.callbackConfig.provider=a),style:{width:"100%"}},{default:l(()=>[t(f,{label:"阿里云回拨",value:"aliyun"}),t(f,{label:"腾讯云回拨",value:"tencent"}),t(f,{label:"自建回拨服务",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"回拨延迟"},{default:l(()=>[t(ge,{modelValue:n.callbackConfig.delay,"onUpdate:modelValue":e[40]||(e[40]=a=>n.callbackConfig.delay=a),min:1,max:30,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[168]||(e[168]=s("span",{style:{"margin-left":"10px"}},"秒",-1))]),_:1}),t(m,{label:"最大重试"},{default:l(()=>[t(ge,{modelValue:n.callbackConfig.maxRetries,"onUpdate:modelValue":e[41]||(e[41]=a=>n.callbackConfig.maxRetries=a),min:1,max:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[169]||(e[169]=s("span",{style:{"margin-left":"10px"}},"次",-1))]),_:1})],64)):I("",!0),t(dt,{title:"工作手机外呼说明",type:"info",closable:!1,"show-icon":""},{default:l(()=>[...e[170]||(e[170]=[s("p",null,"• 直接拨号：系统调用手机端系统电话实现拨号外呼",-1),s("p",null,"• 回拨模式：系统先呼叫您的工作手机，接通后再呼叫客户",-1)])]),_:1})])):I("",!0),n.callMethod==="voip"?(y(),_("div",kn,[t(m,{label:"VoIP服务商"},{default:l(()=>[t(z,{modelValue:n.voipProvider,"onUpdate:modelValue":e[42]||(e[42]=a=>n.voipProvider=a),placeholder:"请选择VoIP服务商",style:{width:"100%"}},{default:l(()=>[t(f,{label:"阿里云通信",value:"aliyun"}),t(f,{label:"腾讯云通信",value:"tencent"}),t(f,{label:"华为云通信",value:"huawei"}),t(f,{label:"自定义SIP",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),n.voipProvider==="aliyun"?(y(),_(W,{key:0},[t(Ue,{"content-position":"left"},{default:l(()=>[...e[171]||(e[171]=[d("阿里云通信配置",-1)])]),_:1}),t(m,{label:"AccessKey ID",required:""},{default:l(()=>[t(S,{modelValue:n.aliyunConfig.accessKeyId,"onUpdate:modelValue":e[43]||(e[43]=a=>n.aliyunConfig.accessKeyId=a),placeholder:"请输入阿里云AccessKey ID","show-password":"",style:{width:"100%"}},null,8,["modelValue"]),e[172]||(e[172]=s("div",{class:"form-tip"},"从阿里云控制台获取AccessKey ID",-1))]),_:1}),t(m,{label:"AccessKey Secret",required:""},{default:l(()=>[t(S,{modelValue:n.aliyunConfig.accessKeySecret,"onUpdate:modelValue":e[44]||(e[44]=a=>n.aliyunConfig.accessKeySecret=a),placeholder:"请输入阿里云AccessKey Secret","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"]),e[173]||(e[173]=s("div",{class:"form-tip"},"从阿里云控制台获取AccessKey Secret",-1))]),_:1}),t(m,{label:"应用ID",required:""},{default:l(()=>[t(S,{modelValue:n.aliyunConfig.appId,"onUpdate:modelValue":e[45]||(e[45]=a=>n.aliyunConfig.appId=a),placeholder:"请输入语音通话应用ID",style:{width:"100%"}},null,8,["modelValue"]),e[174]||(e[174]=s("div",{class:"form-tip"},"在阿里云语音服务控制台创建应用后获取",-1))]),_:1}),t(m,{label:"主叫号码"},{default:l(()=>[t(S,{modelValue:n.aliyunConfig.callerNumber,"onUpdate:modelValue":e[46]||(e[46]=a=>n.aliyunConfig.callerNumber=a),placeholder:"请输入主叫显示号码",style:{width:"100%"}},null,8,["modelValue"]),e[175]||(e[175]=s("div",{class:"form-tip"},"客户接听时显示的号码，需在阿里云申请",-1))]),_:1}),t(m,{label:"服务区域"},{default:l(()=>[t(z,{modelValue:n.aliyunConfig.region,"onUpdate:modelValue":e[47]||(e[47]=a=>n.aliyunConfig.region=a),placeholder:"请选择服务区域",style:{width:"100%"}},{default:l(()=>[t(f,{label:"华东1（杭州）",value:"cn-hangzhou"}),t(f,{label:"华东2（上海）",value:"cn-shanghai"}),t(f,{label:"华北1（青岛）",value:"cn-qingdao"}),t(f,{label:"华北2（北京）",value:"cn-beijing"}),t(f,{label:"华南1（深圳）",value:"cn-shenzhen"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"录音配置"},{default:l(()=>[t(De,{modelValue:n.aliyunConfig.enableRecording,"onUpdate:modelValue":e[48]||(e[48]=a=>n.aliyunConfig.enableRecording=a)},null,8,["modelValue"]),e[176]||(e[176]=s("span",{style:{"margin-left":"10px"}},"启用通话录音",-1))]),_:1}),n.aliyunConfig.enableRecording?(y(),K(m,{key:0,label:"录音存储"},{default:l(()=>[t(S,{modelValue:n.aliyunConfig.recordingBucket,"onUpdate:modelValue":e[49]||(e[49]=a=>n.aliyunConfig.recordingBucket=a),placeholder:"请输入OSS存储桶名称",style:{width:"100%"}},null,8,["modelValue"]),e[177]||(e[177]=s("div",{class:"form-tip"},"录音文件将存储到指定的OSS存储桶",-1))]),_:1})):I("",!0),t(dt,{title:"阿里云通信配置说明",type:"warning",closable:!1,"show-icon":""},{default:l(()=>[...e[178]||(e[178]=[s("p",null,"• 请确保已开通阿里云语音服务并完成实名认证",-1),s("p",null,"• AccessKey需要具有语音服务的调用权限",-1),s("p",null,"• 主叫号码需要在阿里云申请并通过审核",-1),s("p",null,"• 录音功能需要额外开通OSS存储服务",-1)])]),_:1})],64)):I("",!0),n.voipProvider==="tencent"?(y(),_(W,{key:1},[t(Ue,{"content-position":"left"},{default:l(()=>[...e[179]||(e[179]=[d("腾讯云通信配置",-1)])]),_:1}),t(m,{label:"SecretId",required:""},{default:l(()=>[t(S,{modelValue:n.tencentConfig.secretId,"onUpdate:modelValue":e[50]||(e[50]=a=>n.tencentConfig.secretId=a),placeholder:"请输入腾讯云SecretId","show-password":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"SecretKey",required:""},{default:l(()=>[t(S,{modelValue:n.tencentConfig.secretKey,"onUpdate:modelValue":e[51]||(e[51]=a=>n.tencentConfig.secretKey=a),placeholder:"请输入腾讯云SecretKey","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"应用ID",required:""},{default:l(()=>[t(S,{modelValue:n.tencentConfig.appId,"onUpdate:modelValue":e[52]||(e[52]=a=>n.tencentConfig.appId=a),placeholder:"请输入语音通话应用ID",style:{width:"100%"}},null,8,["modelValue"])]),_:1})],64)):I("",!0),n.voipProvider==="huawei"?(y(),_(W,{key:2},[t(Ue,{"content-position":"left"},{default:l(()=>[...e[180]||(e[180]=[d("华为云通信配置",-1)])]),_:1}),t(m,{label:"Access Key",required:""},{default:l(()=>[t(S,{modelValue:n.huaweiConfig.accessKey,"onUpdate:modelValue":e[53]||(e[53]=a=>n.huaweiConfig.accessKey=a),placeholder:"请输入华为云Access Key","show-password":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(m,{label:"Secret Key",required:""},{default:l(()=>[t(S,{modelValue:n.huaweiConfig.secretKey,"onUpdate:modelValue":e[54]||(e[54]=a=>n.huaweiConfig.secretKey=a),placeholder:"请输入华为云Secret Key","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"])]),_:1})],64)):I("",!0),t(m,{label:"音频设备"},{default:l(()=>[t(z,{modelValue:n.audioDevice,"onUpdate:modelValue":e[55]||(e[55]=a=>n.audioDevice=a),placeholder:"请选择音频设备",style:{width:"100%"}},{default:l(()=>[t(f,{label:"默认设备",value:"default"}),t(f,{label:"耳机",value:"headset"}),t(f,{label:"扬声器",value:"speaker"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"音质设置"},{default:l(()=>[t(Se,{modelValue:n.audioQuality,"onUpdate:modelValue":e[56]||(e[56]=a=>n.audioQuality=a)},{default:l(()=>[t(H,{value:"standard"},{default:l(()=>[...e[181]||(e[181]=[d("标准音质",-1)])]),_:1}),t(H,{value:"high"},{default:l(()=>[...e[182]||(e[182]=[d("高清音质",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(dt,{title:"网络电话说明",type:"info",closable:!1,"show-icon":""},{default:l(()=>[...e[183]||(e[183]=[s("p",null,"• 请确保电脑已连接耳机或音响设备",-1),s("p",null,"• 建议使用有线网络以保证通话质量",-1),s("p",null,"• 高清音质需要更好的网络环境",-1)])]),_:1})])):I("",!0)]),_:1},8,["model"])]),_:1}),t(ce,{label:"呼叫参数",name:"callParams"},{default:l(()=>[t(Ve,{model:n,"label-width":"120px"},{default:l(()=>[t(m,{label:"呼叫模式"},{default:l(()=>[t(Se,{modelValue:n.callMode,"onUpdate:modelValue":e[57]||(e[57]=a=>n.callMode=a)},{default:l(()=>[t(H,{value:"auto"},{default:l(()=>[...e[184]||(e[184]=[d("自动外呼",-1)])]),_:1}),t(H,{value:"manual"},{default:l(()=>[...e[185]||(e[185]=[d("手动外呼",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"呼叫间隔"},{default:l(()=>[t(ge,{modelValue:n.callInterval,"onUpdate:modelValue":e[58]||(e[58]=a=>n.callInterval=a),min:5,max:300,step:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[186]||(e[186]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"秒",-1))]),_:1}),t(m,{label:"最大重试次数"},{default:l(()=>[t(ge,{modelValue:n.maxRetries,"onUpdate:modelValue":e[59]||(e[59]=a=>n.maxRetries=a),min:0,max:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),t(m,{label:"呼叫超时"},{default:l(()=>[t(ge,{modelValue:n.callTimeout,"onUpdate:modelValue":e[60]||(e[60]=a=>n.callTimeout=a),min:10,max:120,step:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),e[187]||(e[187]=s("span",{style:{"margin-left":"8px",color:"#909399"}},"秒",-1))]),_:1}),t(m,{label:"启用录音"},{default:l(()=>[t(De,{modelValue:n.enableRecording,"onUpdate:modelValue":e[61]||(e[61]=a=>n.enableRecording=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"自动跟进"},{default:l(()=>[t(De,{modelValue:n.autoFollowUp,"onUpdate:modelValue":e[62]||(e[62]=a=>n.autoFollowUp=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),p(q).isSuperAdmin?(y(),K(ce,{key:0,label:"高级设置",name:"advanced"},{default:l(()=>[t(Ve,{model:n,"label-width":"120px"},{default:l(()=>[t(m,{label:"并发呼叫数"},{default:l(()=>[t(ge,{modelValue:n.concurrentCalls,"onUpdate:modelValue":e[63]||(e[63]=a=>n.concurrentCalls=a),min:1,max:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),t(m,{label:"呼叫优先级"},{default:l(()=>[t(z,{modelValue:n.priority,"onUpdate:modelValue":e[64]||(e[64]=a=>n.priority=a),style:{width:"200px"}},{default:l(()=>[t(f,{label:"低",value:"low"}),t(f,{label:"中",value:"medium"}),t(f,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"黑名单检查"},{default:l(()=>[t(De,{modelValue:n.blacklistCheck,"onUpdate:modelValue":e[65]||(e[65]=a=>n.blacklistCheck=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"号码归属地显示"},{default:l(()=>[t(De,{modelValue:n.showLocation,"onUpdate:modelValue":e[66]||(e[66]=a=>n.showLocation=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})):I("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),An=yo(Vn,[["__scopeId","data-v-7d04da44"]]);export{An as default};
