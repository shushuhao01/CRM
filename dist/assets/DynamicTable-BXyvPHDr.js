import{T as e}from"./TableColumnSettings-CpY_V997.js";import{l as a,r as t,e as o,w as l,b as s,ag as n,aq as i,m as r,q as d,Q as p,P as u,p as c,H as g,S as h,T as m,M as v,O as f,F as w,a9 as b,K as y,U as S}from"./vendor-BtukhyiH.js";import{_ as C}from"./index-BGtT17ll.js";const x={class:"dynamic-table-container"},z={key:0,class:"table-header"},$={class:"table-title"},k={class:"table-actions"},_={key:1,class:"table-pagination"},B={class:"pagination-stats"},j={class:"stats-text"},T={class:"pagination-controls"},W=C(a({__name:"DynamicTable",props:{data:{},columns:{},storageKey:{},title:{default:""},showHeader:{type:Boolean,default:!0},showColumnSettings:{type:Boolean,default:!0},showSelection:{type:Boolean,default:!1},showActions:{type:Boolean,default:!0},actionsWidth:{default:200},actionsMinWidth:{default:150},loading:{type:Boolean,default:!1},showPagination:{type:Boolean,default:!0},total:{default:0},pageSizes:{default:()=>[10,20,50,100]}},emits:["selection-change","sort-change","size-change","current-change"],setup(a,{expose:C,emit:W}){const P=a,H=W,K=t(),M=t(1),U=t(10),q=o(()=>P.columns.map(e=>({...e,visible:!1!==e.visible}))),A=t([]),D=(e,a)=>a.includes(".")?a.split(".").reduce((e,a)=>{if(e&&"object"==typeof e)return e[a]},e):e[a],O=(e,a,t)=>(t&&a.prop.includes(".")&&(e=D(t,a.prop)),a.formatter?a.formatter(e,t||{}):null==e?"-":e),F=e=>{A.value=e.filter(e=>e.visible)},I=e=>{H("selection-change",e)},Q=e=>{H("sort-change",e)},R=e=>{U.value=e,H("size-change",e)},E=e=>{M.value=e,H("current-change",e)},G=()=>{A.value=q.value.filter(e=>e.visible)};return l(()=>P.columns,()=>{G(),K.value&&K.value.loadColumnSettings()},{immediate:!0}),s(()=>{G()}),C({resetColumns:()=>K.value?.resetColumns(),loadColumnSettings:()=>K.value?.loadColumnSettings()}),(t,o)=>{const l=n("el-table-column"),s=n("el-table"),C=n("el-pagination"),W=i("loading");return d(),r("div",x,[a.showHeader?(d(),r("div",z,[c("div",$,[g(t.$slots,"title",{},()=>[h(m(a.title),1)],!0)]),c("div",k,[g(t.$slots,"header-actions",{},void 0,!0),a.showColumnSettings?(d(),v(e,{key:0,columns:q.value,"storage-key":a.storageKey,onColumnsChange:F,ref_key:"columnSettingsRef",ref:K},null,8,["columns","storage-key"])):p("",!0)])])):p("",!0),u((d(),v(s,y({data:a.data},t.$attrs,{onSelectionChange:I,onSortChange:Q,stripe:"",border:""}),{default:f(()=>[a.showSelection?(d(),v(l,{key:0,type:"selection",width:"55"})):p("",!0),(d(!0),r(w,null,b(A.value,e=>(d(),v(l,{key:e.prop,prop:e.prop,label:e.label,width:e.width,"min-width":e.minWidth,sortable:e.sortable,align:e.align,fixed:e.fixed,"show-overflow-tooltip":e.showOverflowTooltip},{default:f(({row:a,column:o,$index:l})=>[g(t.$slots,`column-${e.prop}`,{row:a,column:e,value:e.prop.includes(".")?D(a,e.prop):a[e.prop],index:l},()=>[c("span",null,m(O(e.prop.includes(".")?D(a,e.prop):a[e.prop],e,a)),1)],!0)]),_:2},1032,["prop","label","width","min-width","sortable","align","fixed","show-overflow-tooltip"]))),128)),a.showActions?(d(),v(l,{key:1,label:"操作",width:a.actionsWidth,"min-width":a.actionsMinWidth,fixed:"right"},{default:f(({row:e,$index:a})=>[g(t.$slots,"table-actions",{row:e,index:a},void 0,!0)]),_:3},8,["width","min-width"])):p("",!0)]),_:3},16,["data"])),[[W,a.loading]]),a.showPagination?(d(),r("div",_,[c("div",B,[g(t.$slots,"pagination-stats",{},()=>[c("span",j,"共 "+m(a.total)+" 条记录",1)],!0)]),c("div",T,[g(t.$slots,"pagination",{},()=>[S(C,{"current-page":M.value,"onUpdate:currentPage":o[0]||(o[0]=e=>M.value=e),"page-size":U.value,"onUpdate:pageSize":o[1]||(o[1]=e=>U.value=e),"page-sizes":a.pageSizes,total:a.total,layout:"sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:E},null,8,["current-page","page-size","page-sizes","total"])],!0)])])):p("",!0)])}}}),[["__scopeId","data-v-a594d4e3"]]);export{W as D};
