import{u as e,i as l,S as a,l as t,c as o,_ as n}from"./index-C4IdUW1A.js";import{l as s,aA as i,r as d,Z as r,e as c,b as u,Y as p,w as m,ag as f,aq as v,m as y,q as g,p as h,U as b,O as w,S as _,T as C,u as k,F as x,a9 as V,M as S,a7 as I,P as z,Q as U,R as P,I as T}from"./vendor-BtukhyiH.js";import{u as D,g as A}from"./call-x2JnX9hE.js";import{generateQRCode as N,getConnectionStatus as K,getConnectedDevices as M}from"./qr-connection-C28yXtL2.js";import{s as R,a as L,b as q,c as O,g as F,d as j,e as $}from"./alternative-connection-BVqgabiQ.js";import"./browser-BKsVyEpb.js";import{M as Y,s as E,r as B,a3 as H,ab as W,u as Q,F as J,at as G,G as Z,C as X,O as ee,az as le,aA as ae,aB as te,aC as oe,ah as ne,ai as se,j as ie,K as de,E as re,ao as ce,aD as ue}from"./elementPlus-DxaqjplL.js";import{a as pe}from"./sensitiveInfo-CTSC2tj2.js";import"./utils-DfI7e5Rl.js";const me=async e=>{const l=`sdk_install_status_${e}`,a=localStorage.getItem(l);if(a)try{return JSON.parse(a)}catch{}return{installed:!1,lastCheck:(new Date).toISOString()}},fe={class:"call-management"},ve={class:"page-header"},ye={class:"header-actions"},ge={class:"stat-item"},he={class:"stat-icon"},be={class:"stat-content"},we={class:"stat-value"},_e={class:"stat-item"},Ce={class:"stat-icon"},ke={class:"stat-content"},xe={class:"stat-value"},Ve={class:"stat-item"},Se={class:"stat-icon"},Ie={class:"stat-content"},ze={class:"stat-value"},Ue={class:"stat-item"},Pe={class:"stat-icon"},Te={class:"stat-content"},De={class:"stat-value"},Ae={class:"filter-section"},Ne={class:"filter-row"},Ke={class:"filter-item"},Me={class:"filter-item"},Re={class:"filter-item"},Le={class:"filter-item"},qe={class:"search-row"},Oe={class:"table-header"},Fe={class:"table-actions"},je=["onClick"],$e=["onClick"],Ye=["onClick"],Ee=["onClick"],Be={class:"pagination-wrapper"},He={class:"pagination-stats"},We={class:"stats-text"},Qe={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Je={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Ge={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},Ze={key:0},Xe={key:1},el={key:2},ll={style:{display:"flex","justify-content":"space-between","align-items":"center"}},al={style:{"font-weight":"500"}},tl={style:{color:"#8492a6","font-size":"12px"}},ol={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},nl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},sl={style:{"font-weight":"500"}},il={style:{color:"#8492a6","font-size":"12px"}},dl={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},rl={style:{display:"flex","justify-content":"space-between","align-items":"center"}},cl={style:{flex:"1"}},ul={style:{"font-weight":"500"}},pl={style:{color:"#8492a6","font-size":"12px","margin-top":"2px"}},ml={key:0,style:{"margin-left":"8px"}},fl={style:{color:"#409eff","font-size":"12px","font-weight":"500"}},vl={key:0,class:"customer-detail"},yl={class:"info-item"},gl={class:"info-item"},hl={class:"info-item"},bl={class:"info-item"},wl={class:"info-item"},_l={class:"info-item"},Cl={class:"tab-content"},kl={class:"tab-header"},xl={class:"tab-content"},Vl={class:"tab-header"},Sl={class:"tab-content"},Il={class:"tab-header"},zl={class:"call-actions"},Ul=["onClick"],Pl=["onClick"],Tl=["onClick"],Dl={key:2,class:"no-recording"},Al={class:"tab-content"},Nl={class:"tab-header"},Kl={class:"call-records-dialog"},Ml={class:"dialog-filters"},Rl={class:"filter-row"},Ll={class:"filter-item"},ql={class:"filter-item"},Ol={key:0},Fl={key:1,class:"no-recording"},jl={class:"dialog-pagination"},$l={class:"recording-player"},Yl={class:"recording-info"},El={class:"audio-player"},Bl=["src"],Hl={class:"quick-followup"},Wl={class:"customer-info"},Ql={class:"dialog-footer"},Jl={key:0,class:"incoming-call"},Gl={class:"caller-info"},Zl={class:"caller-avatar"},Xl={class:"caller-details"},ea={class:"phone-number"},la={key:0,class:"customer-level"},aa={key:1,class:"last-call"},ta={class:"call-actions"},oa={class:"quick-actions"},na={key:0,class:"call-in-progress"},sa={class:"call-timer"},ia={class:"timer-display"},da={class:"caller-info-mini"},ra={class:"caller-name"},ca={class:"caller-phone"},ua={class:"call-controls"},pa={class:"call-notes"},ma={key:0},fa={key:1},va={style:{display:"flex","align-items":"center",gap:"12px"}},ya={style:{"margin-top":"8px",padding:"8px",background:"#f5f7fa","border-radius":"4px"}},ga={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"4px"}},ha={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"8px","font-size":"12px",color:"#606266"}},ba={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},wa={style:{display:"flex",gap:"16px","align-items":"center"}},_a={style:{display:"flex","align-items":"center",gap:"6px"}},Ca={style:{display:"flex","align-items":"center",gap:"6px"}},ka={style:{color:"#909399","font-size":"12px","margin-top":"4px"}},xa={style:{display:"flex","align-items":"center",gap:"12px"}},Va={style:{display:"flex","align-items":"flex-start",gap:"16px"}},Sa={style:{"text-align":"center"}},Ia={key:0,style:{padding:"12px",background:"white",border:"1px solid #dcdfe6","border-radius":"8px",display:"inline-block"}},za=["src"],Ua={key:1,style:{width:"120px",height:"120px",border:"2px dashed #dcdfe6","border-radius":"8px",display:"flex","align-items":"center","justify-content":"center",color:"#909399"}},Pa={style:{"margin-top":"8px","font-size":"12px",color:"#606266"}},Ta={key:2,style:{"font-size":"11px",color:"#909399","margin-top":"4px"}},Da={style:{flex:"1"}},Aa={style:{display:"flex","flex-direction":"column",gap:"8px"}},Na={style:{"margin-top":"12px",padding:"8px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px","font-size":"12px",color:"#409eff"}},Ka={style:{"font-weight":"500","margin-bottom":"4px"}},Ma={style:{border:"1px solid #ebeef5","border-radius":"6px",padding:"16px"}},Ra={style:{display:"grid","grid-template-columns":"1fr 1fr 1fr",gap:"16px"}},La={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},qa={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},Oa={style:{"text-align":"center",padding:"12px",border:"1px solid #e4e7ed","border-radius":"6px"}},Fa={key:0,style:{"font-size":"18px","font-weight":"bold",color:"#409eff","margin-bottom":"8px"}},ja={style:{"margin-top":"12px",padding:"8px",background:"#f0f9ff",border:"1px solid #b3d8ff","border-radius":"4px","font-size":"12px",color:"#409eff"}},$a={style:{"font-weight":"500","margin-bottom":"4px"}},Ya={style:{border:"1px solid #ebeef5","border-radius":"6px",overflow:"hidden"}},Ea={style:{display:"flex","align-items":"center",gap:"12px"}},Ba={style:{"font-weight":"500",color:"#303133"}},Ha={style:{"font-size":"12px",color:"#909399"}},Wa={style:{display:"flex","align-items":"center",gap:"8px"}},Qa={key:2},Ja={class:"dialog-footer"},Ga=n(s({__name:"CallManagement",setup(n){const s=i(),Ga=o(s),Za=D(),Xa=e(),et=l(),lt=d(!1),at=d(!1),tt=d(!1),ot=d(null),nt=d(""),st=d([]),it=d(!1),dt=d(!1),rt=d(),ct=d("ready"),ut=d(!1),pt=d(!1),mt=d(null),ft=d(null),vt=d(0),yt=d(""),gt=d(null),ht=d(!1),bt=d(!1),wt=d(),_t=d("callMethod"),Ct=d(!1),kt=r({connectionId:"",qrCodeUrl:"",status:"",expiresAt:null,generating:!1,checking:!1}),xt=r({bluetooth:{status:"disconnected",deviceName:"",deviceId:""},network:{status:"disconnected",devices:[],selectedDevice:null},digital:{status:"disconnected",code:"",expiresAt:null}}),Vt=d([]),St=r({callMethod:"system",lineId:"",workPhone:"",dialMethod:"direct",mobileConfig:{platform:"android",sdkInstalled:!1,deviceAuthorized:!1,callPermission:!1,connectionStatus:"disconnected",sdkInfo:{version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:"Android 5.0+",packageType:"APK"}},callbackConfig:{provider:"aliyun",delay:3,maxRetries:3},voipProvider:"aliyun",audioDevice:"default",audioQuality:"standard",aliyunConfig:{accessKeyId:"",accessKeySecret:"",appId:"",callerNumber:"",region:"cn-hangzhou",enableRecording:!1,recordingBucket:""},tencentConfig:{secretId:"",secretKey:"",appId:"",callerNumber:"",region:"ap-beijing"},huaweiConfig:{accessKey:"",secretKey:"",appId:"",callerNumber:"",region:"cn-north-1"},callMode:"manual",callInterval:30,maxRetries:3,callTimeout:60,enableRecording:!0,autoFollowUp:!1,concurrentCalls:1,priority:"medium",blacklistCheck:!0,showLocation:!0}),It=d([{id:"1",name:"主线路 - 400-1234-5678"},{id:"2",name:"备用线路 - 400-8765-4321"},{id:"3",name:"专用线路 - 400-9999-8888"}]),zt=r({todayCalls:0,totalDuration:0,connectionRate:0,activeUsers:0}),Ut=r({status:"",customerLevel:"",dateRange:[],salesPerson:""}),Pt=r({currentPage:1,pageSize:20,total:0}),Tt=d([{id:1,customerName:"张三",phone:"13800138001",company:"北京科技有限公司",customerLevel:"gold",lastCallTime:"2024-01-15 14:30:00",callCount:5,status:"pending",salesPerson:"李销售",remark:"意向客户，需要跟进产品A"},{id:2,customerName:"李四",phone:"13800138002",company:"上海贸易集团",customerLevel:"silver",lastCallTime:"2024-01-14 16:20:00",callCount:3,status:"connected",salesPerson:"王销售",remark:"已下单，需要确认发货时间"},{id:3,customerName:"王五",phone:"13800138003",company:"深圳制造企业",customerLevel:"normal",lastCallTime:"2024-01-13 10:15:00",callCount:2,status:"no_answer",salesPerson:"张销售",remark:"多次未接听，建议更换联系时间"}]),Dt=d({callMethod:"network",networkConfig:{lineId:"",audioQuality:"standard"},mobileConfig:{phoneNumber:"",enableRecording:!0},selectedCustomer:null,customerPhone:"",manualPhone:"",customerId:"",notes:""}),At=d([]),Nt=d([]);d([{id:"line001",name:"阿里云线路1",provider:"aliyun",status:"active",quality:"高清"},{id:"line002",name:"阿里云线路2",provider:"aliyun",status:"active",quality:"标准"},{id:"line003",name:"腾讯云线路1",provider:"tencent",status:"active",quality:"高清"},{id:"line004",name:"华为云线路1",provider:"huawei",status:"maintenance",quality:"高清"}]);const Kt=d([{id:"phone001",number:"13800138001",name:"销售专线1",status:"active",owner:"张三"},{id:"phone002",number:"13800138002",name:"销售专线2",status:"active",owner:"李四"},{id:"phone003",number:"13800138003",name:"客服专线1",status:"busy",owner:"王五"}]),Mt={customerPhone:[{required:!0,message:"请输入客户电话号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},Rt=d(!1),Lt=d(null),qt=d("orders"),Ot=d(!1),Ft=d(!1),jt=d([]),$t=r({dateRange:[],customerKeyword:""}),Yt=r({currentPage:1,pageSize:20,total:0}),Et=d(!1),Bt=d(null),Ht=d(null),Wt=d(!1),Qt=d(!1),Jt=d(),Gt=r({type:"call",content:"",nextFollowTime:"",intention:"",remark:""}),Zt={type:[{required:!0,message:"请选择跟进类型",trigger:"change"}],content:[{required:!0,message:"请输入跟进内容",trigger:"blur"},{min:10,message:"跟进内容至少10个字符",trigger:"blur"}],intention:[{required:!0,message:"请选择客户意向",trigger:"change"}]},Xt=d([{orderNo:"ORD202401150001",productName:"产品A",amount:2897,status:"pending",createTime:"2024-01-15 14:30:00"},{orderNo:"ORD202401140002",productName:"产品B",amount:1749,status:"completed",createTime:"2024-01-14 16:20:00"}]),eo=d([{ticketNo:"AS202401150001",type:"退货",description:"产品质量问题，客户要求退货",status:"processing",createTime:"2024-01-15 10:30:00"}]),lo=d([{callType:"outbound",duration:"5分30秒",status:"connected",startTime:"2024-01-15 14:30:00",operator:"李销售",remark:"客户对产品A很感兴趣",recordingUrl:"/recordings/call_20240115_143000.mp3"},{callType:"inbound",duration:"3分15秒",status:"connected",startTime:"2024-01-14 16:20:00",operator:"王销售",remark:"客户咨询发货时间",recordingUrl:"/recordings/call_20240114_162000.mp3"},{callType:"outbound",duration:"1分45秒",status:"no_answer",startTime:"2024-01-13 10:15:00",operator:"张销售",remark:"客户未接听",recordingUrl:null}]),ao=d([{type:"电话跟进",content:"客户对产品A很感兴趣，需要进一步了解技术参数",nextPlan:"2024-01-16 14:00:00",operator:"李销售",createTime:"2024-01-15 14:35:00"}]);c(()=>Za.callRecords.slice(0,10));const to=e=>{if(e<60)return`${e}秒`;return`${Math.floor(e/60)}分${e%60}秒`},oo=e=>{if(!e)return"暂无地址";if(e.province||e.city||e.district||e.street||e.detailAddress){const l=[e.province,e.city,e.district,e.street,e.detailAddress].filter(Boolean);if(l.length>0)return l.join(" ")}return e.address?e.address:e.company?e.company:"暂无地址"},no=()=>{ct.value="ready"===ct.value?"busy":"ready";const e="ready"===ct.value?"就绪":"忙碌";re.success(`状态已切换为：${e}`)},so=async()=>{try{kt.generating=!0;const e={userId:Xa.userInfo?.id||"default-user",permissions:["call","sms","contacts"]},l=await N(e);l.success?(kt.connectionId=l.data.connectionId,l.data.qrCodeUrl?kt.qrCodeUrl=l.data.qrCodeUrl:l.data.qrData&&(kt.qrCodeUrl=await io(l.data.qrData)),kt.status="pending",kt.expiresAt=new Date(l.data.expiresAt),re.success("二维码生成成功，请使用手机扫码连接"),ro()):re.error(l.message||"生成二维码失败")}catch(e){console.error("生成二维码失败:",e),re.error("生成二维码失败")}finally{kt.generating=!1}},io=async e=>{try{const l=await t(()=>import("./browser-BKsVyEpb.js").then(e=>e.b),[]);return await l.toDataURL(e,{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}})}catch(l){return console.error("生成二维码图片失败:",l),`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(e)}`}},ro=async()=>{if(kt.connectionId&&!kt.checking)try{kt.checking=!0;const e=await K(kt.connectionId);e.success&&(kt.status=e.data.status,"connected"===e.data.status?(re.success("设备连接成功！"),St.mobileConfig.connectionStatus="connected",St.mobileConfig.deviceAuthorized=!0,await co()):"expired"===e.data.status?re.warning("二维码已过期，请重新生成"):"pending"===e.data.status&&setTimeout(ro,2e3))}catch(e){console.error("检查连接状态失败:",e)}finally{kt.checking=!1}},co=async()=>{try{const e=await M();e.success&&(Vt.value=e.data)}catch(e){console.error("加载已连接设备失败:",e)}},uo=()=>{switch(St.mobileConfig.connectionStatus){case"connected":return{type:"success",text:"已连接",icon:ue};case"connecting":return{type:"warning",text:"连接中",icon:ce};default:return{type:"danger",text:"未连接",icon:se}}},po=async()=>{const e=St.mobileConfig.platform;try{re.info("正在准备下载SDK...");const l=await(async e=>{try{let l,a;"android"===e?(l="/mobile-sdk/download/android",a="CRM-Mobile-SDK-v2.1.3.apk"):(l="/mobile-sdk/",a="CRM-Mobile-SDK-PWA");const t=document.createElement("a");return t.href=l,"android"===e?t.download=a:t.target="_blank",t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),{success:!0,message:"android"===e?"Android APK 下载已开始，请在下载完成后安装":"iOS PWA 应用已打开，请按照页面指引安装"}}catch(l){return{success:!1,error:l.message||"下载失败"}}})(e);l.success?re.success(l.message||"SDK下载已开始"):re.error(l.error||"SDK下载失败")}catch(l){console.error("SDK下载异常:",l),re.error("SDK下载异常："+(l.message||"未知错误"))}},mo=async()=>{const e=St.mobileConfig.platform;Ct.value=!0,St.mobileConfig.connectionStatus="connecting";try{const l=await(async e=>(await me(e)).installed?new Promise(l=>{setTimeout(()=>{const a=Math.random()>.3;l(a?{success:!0,connected:!0,message:"设备连接成功",details:{deviceInfo:("android"===e?"Android":"iOS")+" 设备",networkStatus:"网络连接正常",permissions:["麦克风权限","通话权限","网络权限"]}}:{success:!0,connected:!1,message:"设备连接失败，请检查网络和权限设置"})},2e3)}):{success:!1,connected:!1,message:"请先安装SDK"})(e);l.success&&l.connected?(St.mobileConfig.connectionStatus="connected",St.mobileConfig.deviceAuthorized=!0,St.mobileConfig.callPermission=!0,re.success(l.message),((e,l,a)=>{const t=`sdk_install_status_${e}`,o={installed:l,version:a,lastCheck:(new Date).toISOString()};localStorage.setItem(t,JSON.stringify(o))})(e,!0,"1.0.0"),St.mobileConfig.sdkInstalled=!0):(St.mobileConfig.connectionStatus="disconnected",re.error(l.message))}catch(l){St.mobileConfig.connectionStatus="disconnected",re.error("连接测试异常："+(l.message||"未知错误"))}finally{Ct.value=!1}},fo=async()=>{try{const e=St.mobileConfig.platform;(await me(e)).installed?(St.mobileConfig.sdkInstalled=!0,St.mobileConfig.connectionStatus="connected",St.mobileConfig.deviceAuthorized=!0,St.mobileConfig.callPermission=!0):(St.mobileConfig.sdkInstalled=!1,St.mobileConfig.connectionStatus="disconnected",St.mobileConfig.deviceAuthorized=!1,St.mobileConfig.callPermission=!1)}catch(e){console.error("检查SDK状态失败:",e),St.mobileConfig.sdkInstalled=!1,St.mobileConfig.connectionStatus="disconnected"}},vo=async()=>{if("connected"!==xt.bluetooth.status){xt.bluetooth.status="connecting";try{const e=await L({deviceName:"CRM-Server"});e.success?(xt.bluetooth.status="connected",xt.bluetooth.deviceName=e.data.deviceName,xt.bluetooth.deviceId=e.data.pairingCode,re.success(`蓝牙服务已启动，配对码：${e.data.pairingCode}`)):(xt.bluetooth.status="disconnected",re.error(e.message||"蓝牙连接失败"))}catch(e){xt.bluetooth.status="disconnected",re.error("蓝牙连接异常："+(e.message||"未知错误")),console.error("蓝牙连接错误:",e)}}else try{const e=await R();e.success?(xt.bluetooth.status="disconnected",xt.bluetooth.deviceName="",xt.bluetooth.deviceId="",re.success("蓝牙连接已断开")):re.error(e.message||"断开蓝牙连接失败")}catch(e){console.error("断开蓝牙连接错误:",e),re.error("断开蓝牙连接异常")}},yo=async()=>{if("connected"!==xt.network.status){xt.network.status="discovering";try{const e=await O({port:8080,broadcastInterval:10});if(e.success){xt.network.status="connected";const l=await F();if(l.success){const e=l.data.filter(e=>"network"===e.connectionType);xt.network.devices=e,e.length>0?(xt.network.selectedDevice=e[0],re.success(`网络发现已启动，发现 ${e.length} 个设备`)):re.success("网络发现已启动，等待设备连接")}else re.success(`网络发现已启动，端口：${e.data.port}`)}else xt.network.status="disconnected",re.error(e.message||"网络发现失败")}catch(e){xt.network.status="disconnected",re.error("网络发现异常："+(e.message||"未知错误")),console.error("网络发现错误:",e)}}else try{const e=await q();e.success?(xt.network.status="disconnected",xt.network.devices=[],xt.network.selectedDevice=null,re.success("网络连接已断开")):re.error(e.message||"断开网络连接失败")}catch(e){console.error("断开网络连接错误:",e),re.error("断开网络连接异常")}},go=async()=>{if("connected"!==xt.digital.status){xt.digital.status="generating";try{const e=await $({expireTime:10});if(e.success){xt.digital.code=e.data.currentCode,xt.digital.status="connected";const l=new Date(Date.now()+60*e.data.expireTime*1e3);xt.digital.expiresAt=l,re.success(`数字配对码：${e.data.currentCode}，有效期${e.data.expireTime}分钟`),setTimeout(()=>{xt.digital.code===e.data.currentCode&&(xt.digital.code="",xt.digital.status="disconnected",xt.digital.expiresAt=null,re.warning("数字配对码已过期，请重新生成"))},60*e.data.expireTime*1e3)}else xt.digital.status="disconnected",re.error(e.message||"生成数字配对码失败")}catch(e){xt.digital.status="disconnected",re.error("生成配对码异常："+(e.message||"未知错误")),console.error("数字配对错误:",e)}}else try{const e=await j();e.success?(xt.digital.status="disconnected",xt.digital.code="",xt.digital.expiresAt=null,re.success("数字配对已停止")):re.error(e.message||"停止数字配对失败")}catch(e){console.error("停止数字配对错误:",e),re.error("停止数字配对异常")}},ho=e=>e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}),bo=async()=>{try{const e=St.mobileConfig.platform,l=await getSDKInfo(e);if(l.success&&l.data){const a=l.data;St.mobileConfig.sdkInfo={version:a.version||"1.0.0",fileSize:a.fileSizeFormatted||"未知",updateTime:a.lastModified?ho(new Date(a.lastModified)):"未知",supportedSystems:a.supportedSystems||("android"===e?"Android 5.0+":"iOS 12.0+"),packageType:a.packageType||("android"===e?"APK":"IPA")}}}catch(e){console.error("获取SDK信息失败:",e);const l=St.mobileConfig.platform;St.mobileConfig.sdkInfo={version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:"android"===l?"Android 5.0+":"iOS 12.0+",packageType:"android"===l?"APK":"IPA"}}},wo=async()=>{try{at.value=!0,await Promise.all([Po(),Za.fetchCallRecords(),Vn(),_o()]),re.success("数据已刷新")}catch(e){console.error("刷新数据失败:",e),re.error("刷新数据失败，请稍后重试")}finally{at.value=!1}},_o=async()=>{Ot.value&&await Mo()},Co=()=>{ko(),ht.value=!0},ko=()=>{const e=localStorage.getItem("callConfig");if(e)try{const l=JSON.parse(e);Object.assign(St,l)}catch(l){console.error("加载呼出配置失败:",l)}},xo=async()=>{try{bt.value=!0,localStorage.setItem("callConfig",JSON.stringify(St)),re.success("呼出配置已保存"),ht.value=!1}catch(e){console.error("保存呼出配置失败:",e),re.error("保存配置失败，请稍后重试")}finally{bt.value=!1}},Vo=e=>{"system"===e?!St.lineId&&It.value.length>0&&(St.lineId=It.value[0].id):("mobile"===e||"voip"===e)&&(St.lineId="")},So=e=>e?"正常":"未选择",Io=()=>{tt.value=!tt.value,tt.value?(zo(),re.success("已开启自动刷新，每30秒更新一次数据")):(Uo(),re.info("已关闭自动刷新"))},zo=()=>{ot.value&&clearInterval(ot.value),ot.value=setInterval(async()=>{at.value||await wo()},3e4)},Uo=()=>{ot.value&&(clearInterval(ot.value),ot.value=null)},Po=async()=>{try{lt.value=!0,await et.loadCustomers();const e=et.customers,l=Xa.currentUser?.id,a=e.filter(e=>e.salesPersonId===l||e.createdBy===l).map(e=>({id:e.id,customerName:e.name,phone:e.phone,customerPhone:e.phone,company:e.company||"未填写",customerLevel:e.level,lastCallTime:e.lastServiceDate||"暂无记录",callCount:0,status:"pending",salesPerson:Xa.currentUser?.name||"当前用户",remark:e.remarks||"",address:e.address||"",province:e.province||"",city:e.city||"",district:e.district||"",street:e.street||"",detailAddress:e.detailAddress||""}));Tt.value=a,Pt.total=a.length}catch(e){console.error("加载呼出列表失败:",e),re.error("加载呼出列表失败")}finally{lt.value=!1}},To=async()=>{try{lt.value=!0,await et.loadCustomers();const e=et.customers,l=Xa.currentUser?.id;let a=e.filter(e=>e.salesPersonId===l||e.createdBy===l);if(nt.value){const e=nt.value.toLowerCase();a=a.filter(l=>l.name.toLowerCase().includes(e)||l.phone.includes(e)||l.company&&l.company.toLowerCase().includes(e))}Ut.customerLevel&&(a=a.filter(e=>e.level===Ut.customerLevel)),Ut.status&&(a=a.filter(e=>e.status===Ut.status));const t=a.map(e=>({id:e.id,customerName:e.name,phone:e.phone,customerPhone:e.phone,company:e.company||"未填写",customerLevel:e.level,lastCallTime:e.lastServiceDate||"暂无记录",callCount:0,status:"pending",salesPerson:Xa.currentUser?.name||"当前用户",remark:e.remarks||"",address:e.address||"",province:e.province||"",city:e.city||"",district:e.district||"",street:e.street||"",detailAddress:e.detailAddress||""}));Tt.value=t,Pt.total=t.length}catch(e){console.error("搜索失败:",e),re.error("搜索失败")}finally{lt.value=!1}},Do=()=>{nt.value="",Object.assign(Ut,{status:"",customerLevel:"",dateRange:[],salesPerson:""}),Po()},Ao=e=>{st.value=e},No=()=>{Ot.value=!0,Mo()},Ko=()=>{Ot.value=!1,Ro()},Mo=async()=>{Ft.value=!0;try{await new Promise(e=>setTimeout(e,500));let e=[{id:1,customerName:"张三",customerPhone:"13800138001",callType:"outbound",duration:"00:03:25",status:"connected",startTime:"2024-01-15 14:30:00",operator:"李销售",remark:"客户对产品A很感兴趣",recordingUrl:"https://example.com/recording1.mp3"},{id:2,customerName:"李四",customerPhone:"13800138002",callType:"inbound",duration:"00:02:15",status:"connected",startTime:"2024-01-15 10:20:00",operator:"王销售",remark:"咨询产品价格",recordingUrl:"https://example.com/recording2.mp3"},{id:3,customerName:"王五",customerPhone:"13800138003",callType:"outbound",duration:"00:00:00",status:"no_answer",startTime:"2024-01-14 16:45:00",operator:"张销售",remark:"未接听",recordingUrl:null}];if($t.customerKeyword){const l=$t.customerKeyword.toLowerCase();e=e.filter(e=>e.customerName.toLowerCase().includes(l)||e.customerPhone.includes(l))}jt.value=e,Yt.total=e.length}catch(e){console.error("加载通话记录失败:",e),re.error("加载通话记录失败")}finally{Ft.value=!1}},Ro=()=>{$t.dateRange=[],$t.customerKeyword="",Mo()},Lo=e=>{Yt.pageSize=e,Mo()},qo=e=>{Yt.currentPage=e,Mo()},Oo=e=>{Bt.value=e,Et.value=!0},Fo=e=>{if(!e.recordingUrl)return void re.warning("该通话没有录音文件");const l=document.createElement("a");l.href=e.recordingUrl,l.download=`录音_${e.customerName}_${e.startTime.replace(/[:\s]/g,"_")}.mp3`,document.body.appendChild(l),l.click(),document.body.removeChild(l),re.success("录音下载已开始")},jo=()=>{Ht.value&&(Ht.value.pause(),Ht.value.currentTime=0),Et.value=!1,Bt.value=null},$o=()=>{console.log("开始加载音频")},Yo=()=>{console.log("音频可以播放")},Eo=e=>{console.error("音频播放错误:",e),re.error("录音播放失败，请检查录音文件")},Bo=()=>{Object.assign(Gt,{type:"call",content:"",nextFollowTime:"",intention:"",remark:""}),Jt.value?.clearValidate()},Ho=async()=>{if(Jt.value)try{await Jt.value.validate(),Qt.value=!0;const e={callId:"",customerId:Lt.value.id,customerName:Lt.value.name,followUpType:Gt.type,content:Gt.content,nextFollowUpDate:Gt.nextFollowTime||void 0,priority:"medium",status:"pending",userId:Xa.currentUser?.id||"1",userName:Xa.currentUser?.name||"当前用户"};await Za.createFollowUp(e),re.success("跟进记录保存成功"),Wt.value=!1,Bo(),Po()}catch(e){console.error("保存跟进记录失败:",e),re.error("保存跟进记录失败，请重试")}finally{Qt.value=!1}},Wo=()=>{re.info("导出数据功能开发中...")},Qo=e=>{Pt.pageSize=e,Po()},Jo=e=>{Pt.currentPage=e,Po()},Go=e=>({normal:"",silver:"info",gold:"warning",diamond:"success"}[e]||""),Zo=e=>({normal:"普通",silver:"白银",gold:"黄金",diamond:"钻石"}[e]||"普通"),Xo=e=>({pending:"warning",connected:"success",no_answer:"info",busy:"warning",failed:"danger"}[e]||"info"),en=e=>({pending:"待外呼",connected:"已接通",no_answer:"未接听",busy:"忙线",failed:"失败"}[e]||"未知");let ln=null;const an=d(!1),tn=(e="")=>{ln&&clearTimeout(ln),ln=setTimeout(()=>{on(e)},300)},on=async(e="")=>{try{an.value=!0,await et.loadCustomers();const l=et.customers,a=Xa.currentUser?.id;let t=l.filter(e=>e.salesPersonId===a||e.createdBy===a);if(e&&e.trim()){const l=e.toLowerCase().trim(),a=e.trim();t=t.filter(e=>{const t=e.name&&e.name.toLowerCase().includes(l),o=e.code&&e.code.toLowerCase().includes(l),n=e.phone&&e.phone.includes(a),s=e.company&&e.company.toLowerCase().includes(l),i=e.phone&&e.phone.replace(/[-\s]/g,"").includes(a.replace(/[-\s]/g,"")),d=e.code&&(e.code.toLowerCase().includes(l)||e.code.toLowerCase().startsWith(l));return t||o||n||s||i||d}),t.sort((e,t)=>{const o=e=>{let t=0;const o=e.name?.toLowerCase()||"",n=e.code?.toLowerCase()||"",s=e.phone||"";return o===l||n===l||s===a?t+=100:o.startsWith(l)||n.startsWith(l)||s.startsWith(a)?t+=50:(o.includes(l)||n.includes(l)||s.includes(a))&&(t+=10),t};return o(t)-o(e)})}t.sort((e,l)=>(e.name||"").localeCompare(l.name||"")),At.value=t.slice(0,50),0===t.length&&e&&e.trim()&&console.log(`未找到匹配"${e}"的客户`)}catch(l){console.error("搜索客户失败:",l),re.error("加载客户列表失败"),At.value=[]}finally{an.value=!1}},nn=e=>{if(!e)return Nt.value=[],Dt.value.customerPhone="",void(Dt.value.customerId="");Dt.value.customerId=e.id;const l=[];e.phone&&l.push({phone:e.phone,type:"主号码"}),e.phones&&Array.isArray(e.phones)&&e.phones.forEach(a=>{a.phone&&a.phone!==e.phone&&l.push({phone:a.phone,type:a.type||"其他"})}),Nt.value=l,l.length>0&&(Dt.value.customerPhone=l[0].phone)},sn=()=>{console.log("手动输入号码:",Dt.value.manualPhone)},dn=()=>{it.value=!1,rn()},rn=()=>{Dt.value={callMethod:"network",networkConfig:{lineId:"",audioQuality:"standard"},mobileConfig:{phoneNumber:"",enableRecording:!0},selectedCustomer:null,customerPhone:"",manualPhone:"",customerId:"",notes:""},At.value=[],Nt.value=[]},cn=async()=>{rn(),it.value=!0,await on()},un=()=>{Lt.value?Wt.value=!0:re.warning("请先选择客户")},pn=async()=>{if(rt.value)try{await rt.value.validate();const e=Dt.value.manualPhone||Dt.value.customerPhone;if(!e)return void re.warning("请选择客户号码或手动输入号码");dt.value=!0;const l={customerPhone:e,notes:Dt.value.notes,callMethod:Dt.value.callMethod,callConfig:"network"===Dt.value.callMethod?Dt.value.networkConfig:Dt.value.mobileConfig};Dt.value.selectedCustomer&&!Dt.value.manualPhone&&(l.customerId=Dt.value.customerId||""),await Za.makeOutboundCall(l),dn(),re.success("外呼已发起"),await Za.fetchCallRecords()}catch(e){console.error("外呼失败:",e),re.error("外呼失败，请重试")}finally{dt.value=!1}},mn=()=>{mt.value&&(ut.value=!1,ft.value=mt.value,vt.value=0,yt.value="",pt.value=!0,yn(),re.success("通话已接通"))},fn=()=>{ut.value=!1,mt.value=null,re.info("已拒绝来电")},vn=async()=>{gn();try{await bn(),re.success("通话已结束，记录已保存")}catch(e){console.error("保存通话记录失败:",e),re.error("保存通话记录失败")}pt.value=!1,ft.value=null,vt.value=0,yt.value=""},yn=()=>{gt.value=setInterval(()=>{vt.value++},1e3)},gn=()=>{gt.value&&(clearInterval(gt.value),gt.value=null)},hn=e=>{const l=Math.floor(e/3600),a=Math.floor(e%3600/60),t=e%60;return l>0?`${l.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},bn=async()=>{if(!ft.value)return;const e={customerId:ft.value.id||"",customerName:ft.value.customerName||"未知客户",phone:ft.value.phone,direction:"incoming",duration:vt.value,status:"completed",notes:yt.value,startTime:new Date(Date.now()-1e3*vt.value).toISOString(),endTime:(new Date).toISOString()};await Za.saveCallRecord(e),await wo()},wn=()=>{mt.value&&(Lt.value=mt.value,Rt.value=!0,ut.value=!1)},_n=()=>{mt.value&&(Lt.value=mt.value,Wt.value=!0,ut.value=!1)},Cn=()=>{var e;e={id:"test_001",customerName:"测试客户",phone:"13800138888",customerLevel:"gold",lastCallTime:"2024-01-10 15:30:00",company:"测试公司"},"busy"!==ct.value?(mt.value=e,ut.value=!0):re.warning("当前状态为忙碌，无法接收来电")},kn=e=>({pending:"待处理",completed:"已完成",cancelled:"已取消"}[e]||"未知"),xn=e=>({pending:"待处理",processing:"处理中",completed:"已完成",rejected:"已拒绝"}[e]||"未知"),Vn=async()=>{try{const e=new Date,l=new Date(e.getFullYear(),e.getMonth(),e.getDate()).toISOString(),a=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1).toISOString(),t=(await A({startDate:l,endDate:a,groupBy:"day"})).data;zt.todayCalls=t.totalCalls||0,zt.totalDuration=t.totalDuration||0,zt.connectionRate=Math.round(t.connectionRate||0),zt.activeUsers=t.userStats?.length||0}catch(e){console.error("加载统计数据失败:",e),zt.todayCalls=0,zt.totalDuration=0,zt.connectionRate=0,zt.activeUsers=0}},Sn=c(()=>Xa.users.filter(e=>["sales_staff","department_manager","admin","super_admin","customer_service"].includes(e.role)).map(e=>({id:e.id,name:e.realName||e.name||e.username})));return u(async()=>{try{await Xa.loadUsers(),await Vn(),await Po(),await Za.fetchCallRecords({pageSize:10}),await Za.fetchFollowUpRecords({pageSize:20}),await fo(),await bo(),await co()}catch(e){console.error("加载数据失败:",e)}}),p(()=>{ot.value&&(clearInterval(ot.value),ot.value=null),ln&&(clearTimeout(ln),ln=null)}),m(()=>St.mobileConfig.platform,async e=>{St.mobileConfig.sdkInfo={version:"1.0.0",fileSize:"未知",updateTime:"未知",supportedSystems:"android"===e?"Android 5.0+":"iOS 12.0+",packageType:"android"===e?"APK":"IPA"},await bo(),await fo()}),(e,l)=>{const t=f("el-button"),o=f("el-tooltip"),n=f("el-icon"),s=f("el-card"),i=f("el-col"),d=f("el-row"),r=f("el-option"),c=f("el-select"),u=f("el-date-picker"),p=f("el-input"),m=f("el-table-column"),D=f("el-tag"),A=f("el-table"),N=f("el-pagination"),K=f("el-form-item"),M=f("el-form"),R=f("el-dialog"),L=f("el-tab-pane"),q=f("el-tabs"),O=f("el-radio"),F=f("el-radio-group"),j=f("el-divider"),$=f("el-input-number"),ce=f("el-alert"),ue=f("el-switch"),me=v("loading");return g(),y("div",fe,[h("div",ve,[l[74]||(l[74]=h("h2",null,"通话管理",-1)),h("div",ye,[b(t,{type:"ready"===ct.value?"success":"warning",icon:"ready"===ct.value?"Check":"Close",onClick:no,class:"status-button"},{default:w(()=>[_(C("ready"===ct.value?"就绪":"忙碌"),1)]),_:1},8,["type","icon"]),b(t,{type:"primary",icon:k(Y),onClick:cn},{default:w(()=>[...l[70]||(l[70]=[_(" 发起外呼 ",-1)])]),_:1},8,["icon"]),b(t,{type:"info",icon:k(E),onClick:Co},{default:w(()=>[...l[71]||(l[71]=[_(" 呼出配置 ",-1)])]),_:1},8,["icon"]),b(t,{icon:k(B),onClick:wo,loading:at.value},{default:w(()=>[...l[72]||(l[72]=[_(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"]),b(o,{content:tt.value?"关闭自动刷新":"开启自动刷新"},{default:w(()=>[b(t,{type:tt.value?"success":"info",icon:tt.value?"VideoPause":"VideoPlay",onClick:Io,circle:""},null,8,["type","icon"])]),_:1},8,["content"]),b(t,{type:"info",onClick:Cn},{default:w(()=>[...l[73]||(l[73]=[_(" 测试呼入 ",-1)])]),_:1})])]),b(d,{gutter:20,class:"stats-row"},{default:w(()=>[b(i,{span:6},{default:w(()=>[b(s,{class:"stat-card"},{default:w(()=>[h("div",ge,[h("div",he,[b(n,null,{default:w(()=>[b(k(Y))]),_:1})]),h("div",be,[h("div",we,C(zt.todayCalls),1),l[75]||(l[75]=h("div",{class:"stat-label"},"今日通话",-1))])])]),_:1})]),_:1}),b(i,{span:6},{default:w(()=>[b(s,{class:"stat-card"},{default:w(()=>[h("div",_e,[h("div",Ce,[b(n,null,{default:w(()=>[b(k(H))]),_:1})]),h("div",ke,[h("div",xe,C(to(zt.totalDuration)),1),l[76]||(l[76]=h("div",{class:"stat-label"},"通话时长",-1))])])]),_:1})]),_:1}),b(i,{span:6},{default:w(()=>[b(s,{class:"stat-card"},{default:w(()=>[h("div",Ve,[h("div",Se,[b(n,null,{default:w(()=>[b(k(W))]),_:1})]),h("div",Ie,[h("div",ze,C(zt.connectionRate)+"%",1),l[77]||(l[77]=h("div",{class:"stat-label"},"接通率",-1))])])]),_:1})]),_:1}),b(i,{span:6},{default:w(()=>[b(s,{class:"stat-card"},{default:w(()=>[h("div",Ue,[h("div",Pe,[b(n,null,{default:w(()=>[b(k(Q))]),_:1})]),h("div",Te,[h("div",De,C(zt.activeUsers),1),l[78]||(l[78]=h("div",{class:"stat-label"},"活跃用户",-1))])])]),_:1})]),_:1})]),_:1}),b(s,{class:"filter-card"},{default:w(()=>[h("div",Ae,[h("div",Ne,[h("div",Ke,[l[79]||(l[79]=h("label",null,"通话状态：",-1)),b(c,{modelValue:Ut.status,"onUpdate:modelValue":l[0]||(l[0]=e=>Ut.status=e),placeholder:"请选择状态",clearable:""},{default:w(()=>[b(r,{label:"全部",value:""}),b(r,{label:"待外呼",value:"pending"}),b(r,{label:"已接通",value:"connected"}),b(r,{label:"未接听",value:"no_answer"}),b(r,{label:"忙线",value:"busy"}),b(r,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])]),h("div",Me,[l[80]||(l[80]=h("label",null,"客户等级：",-1)),b(c,{modelValue:Ut.customerLevel,"onUpdate:modelValue":l[1]||(l[1]=e=>Ut.customerLevel=e),placeholder:"请选择等级",clearable:""},{default:w(()=>[b(r,{label:"全部",value:""}),b(r,{label:"普通客户",value:"normal"}),b(r,{label:"白银客户",value:"silver"}),b(r,{label:"黄金客户",value:"gold"}),b(r,{label:"钻石客户",value:"diamond"})]),_:1},8,["modelValue"])]),h("div",Re,[l[81]||(l[81]=h("label",null,"时间范围：",-1)),b(u,{modelValue:Ut.dateRange,"onUpdate:modelValue":l[2]||(l[2]=e=>Ut.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),h("div",Le,[l[82]||(l[82]=h("label",null,"负责人：",-1)),b(c,{modelValue:Ut.salesPerson,"onUpdate:modelValue":l[3]||(l[3]=e=>Ut.salesPerson=e),placeholder:"请选择负责人",clearable:"",filterable:""},{default:w(()=>[b(r,{label:"全部",value:""}),(g(!0),y(x,null,V(Sn.value,e=>(g(),S(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),h("div",qe,[b(p,{modelValue:nt.value,"onUpdate:modelValue":l[4]||(l[4]=e=>nt.value=e),placeholder:"搜索客户姓名、电话号码、订单号",clearable:"",style:{width:"400px"},onKeyup:I(To,["enter"])},{prefix:w(()=>[b(n,null,{default:w(()=>[b(k(J))]),_:1})]),_:1},8,["modelValue"]),b(t,{type:"primary",icon:k(J),onClick:To},{default:w(()=>[...l[83]||(l[83]=[_("搜索",-1)])]),_:1},8,["icon"]),b(t,{icon:k(G),onClick:Do},{default:w(()=>[...l[84]||(l[84]=[_("重置",-1)])]),_:1},8,["icon"])])])]),_:1}),b(s,{class:"table-card"},{header:w(()=>[h("div",Oe,[l[87]||(l[87]=h("span",null,"呼出列表",-1)),h("div",Fe,[b(t,{type:"primary",icon:k(Y),onClick:No},{default:w(()=>[...l[85]||(l[85]=[_("通话记录",-1)])]),_:1},8,["icon"]),b(t,{icon:k(Z),onClick:Wo},{default:w(()=>[...l[86]||(l[86]=[_("导出数据",-1)])]),_:1},8,["icon"])])])]),default:w(()=>[z((g(),S(A,{data:Tt.value,style:{width:"100%"},onSelectionChange:Ao},{default:w(()=>[b(m,{type:"selection",width:"55"}),b(m,{prop:"customerName",label:"客户姓名",width:"120"}),b(m,{prop:"phone",label:"电话号码",width:"140"},{default:w(({row:e})=>[_(C(k(pe)(e.phone,k(a).PHONE)),1)]),_:1}),b(m,{prop:"customerLevel",label:"客户等级",width:"100"},{default:w(({row:e})=>[b(D,{type:Go(e.customerLevel)},{default:w(()=>[_(C(Zo(e.customerLevel)),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"lastCallTime",label:"最后通话",width:"160"}),b(m,{prop:"callCount",label:"通话次数",width:"100"}),b(m,{prop:"status",label:"状态",width:"100"},{default:w(({row:e})=>[b(D,{type:Xo(e.status)},{default:w(()=>[_(C(en(e.status)),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"salesPerson",label:"负责人",width:"100"}),b(m,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),b(m,{label:"操作",width:"220",fixed:"right"},{default:w(({row:e})=>[h("span",{class:"action-link",onClick:l=>(e=>{re.success(`正在外呼客户：${e.customerName}`)})(e)},"外呼",8,je),h("span",{class:"action-link",onClick:l=>(e=>{Lt.value=e,Rt.value=!0})(e)},"详情",8,$e),h("span",{class:"action-link",onClick:l=>(async e=>{const l=et.getCustomerById(e.id);Lt.value=l||{id:e.id,name:e.customerName,phone:e.phone,company:e.company||"未知公司",address:e.address||"",province:e.province||"",city:e.city||"",district:e.district||"",street:e.street||"",detailAddress:e.detailAddress||""},Wt.value=!0})(e)},"跟进",8,Ye),h("span",{class:"action-link",onClick:l=>(e=>{Ga.push({name:"OrderAdd",query:{customerId:e.id,customerName:e.customerName,customerPhone:e.phone,customerCompany:e.company||"",source:"call_management"}})})(e)},"下单",8,Ee)]),_:1})]),_:1},8,["data"])),[[me,lt.value]]),h("div",Be,[h("div",He,[h("span",We," 共 "+C(Pt.total)+" 条记录，当前显示第 "+C((Pt.currentPage-1)*Pt.pageSize+1)+" - "+C(Math.min(Pt.currentPage*Pt.pageSize,Pt.total))+" 条 ",1)]),b(N,{"current-page":Pt.currentPage,"onUpdate:currentPage":l[5]||(l[5]=e=>Pt.currentPage=e),"page-size":Pt.pageSize,"onUpdate:pageSize":l[6]||(l[6]=e=>Pt.pageSize=e),"page-sizes":[10,20,50,100],total:Pt.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Qo,onCurrentChange:Jo},null,8,["current-page","page-size","total"])])]),_:1}),b(R,{modelValue:it.value,"onUpdate:modelValue":l[15]||(l[15]=e=>it.value=e),title:"发起外呼",width:"600px"},{footer:w(()=>[b(t,{onClick:dn},{default:w(()=>[...l[96]||(l[96]=[_("取消",-1)])]),_:1}),b(t,{type:"primary",onClick:pn,loading:dt.value},{default:w(()=>[...l[97]||(l[97]=[_(" 开始呼叫 ",-1)])]),_:1},8,["loading"])]),default:w(()=>[b(M,{model:Dt.value,rules:Mt,ref_key:"outboundFormRef",ref:rt,"label-width":"100px"},{default:w(()=>[b(K,{label:"外呼方式",prop:"callMethod"},{default:w(()=>[b(c,{modelValue:Dt.value.callMethod,"onUpdate:modelValue":l[7]||(l[7]=e=>Dt.value.callMethod=e),placeholder:"请选择外呼方式",style:{width:"100%"},onChange:Vo},{default:w(()=>[b(r,{label:"网络电话",value:"network_phone"},{default:w(()=>[h("div",Qe,[l[89]||(l[89]=h("div",null,[h("div",{style:{"font-weight":"500"}},"网络电话"),h("div",{style:{color:"#8492a6","font-size":"12px"}},"使用阿里云通信等第三方服务")],-1)),b(D,{size:"small",type:"success"},{default:w(()=>[...l[88]||(l[88]=[_("推荐",-1)])]),_:1})])]),_:1}),b(r,{label:"工作手机",value:"work_phone"},{default:w(()=>[h("div",Je,[l[91]||(l[91]=h("div",null,[h("div",{style:{"font-weight":"500"}},"工作手机"),h("div",{style:{color:"#8492a6","font-size":"12px"}},"使用绑定的工作手机拨打")],-1)),b(D,{size:"small",type:"info"},{default:w(()=>[...l[90]||(l[90]=[_("录音",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue"]),h("div",Ge,["network_phone"===Dt.value.callMethod?(g(),y("span",Ze," 网络电话支持自动录音，通话质量稳定 ")):"work_phone"===Dt.value.callMethod?(g(),y("span",Xe," 工作手机需要预先绑定，支持系统级录音 ")):(g(),y("span",el," 请选择合适的外呼方式 "))])]),_:1}),"network_phone"===Dt.value.callMethod?(g(),S(K,{key:0,label:"选择线路",prop:"selectedLine"},{default:w(()=>[b(c,{modelValue:Dt.value.selectedLine,"onUpdate:modelValue":l[8]||(l[8]=e=>Dt.value.selectedLine=e),placeholder:"请选择外呼线路",style:{width:"100%"}},{default:w(()=>[(g(!0),y(x,null,V(e.availableLines,e=>(g(),S(r,{key:e.id,label:e.name,value:e.id},{default:w(()=>[h("div",ll,[h("div",null,[h("div",al,C(e.name),1),h("div",tl,C(e.provider)+" - "+C(e.status),1)]),b(D,{size:"small",type:"正常"===e.status?"success":"warning"},{default:w(()=>[_(C(e.status),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),h("div",ol,[b(t,{type:"text",size:"small",onClick:e.openLineConfig},{default:w(()=>[b(n,null,{default:w(()=>[b(k(E))]),_:1}),l[92]||(l[92]=_(" 配置外呼线路 ",-1))]),_:1},8,["onClick"])])]),_:1})):U("",!0),"work_phone"===Dt.value.callMethod?(g(),S(K,{key:1,label:"工作手机",prop:"workPhone"},{default:w(()=>[b(c,{modelValue:Dt.value.workPhone,"onUpdate:modelValue":l[9]||(l[9]=e=>Dt.value.workPhone=e),placeholder:"请选择工作手机",style:{width:"100%"}},{default:w(()=>[(g(!0),y(x,null,V(Kt.value,e=>(g(),S(r,{key:e.id,label:e.number,value:e.id},{default:w(()=>[h("div",nl,[h("div",null,[h("div",sl,C(e.number),1),h("div",il,C(e.brand)+" "+C(e.model),1)]),b(D,{size:"small",type:"已绑定"===e.status?"success":"warning"},{default:w(()=>[_(C(e.status),1)]),_:2},1032,["type"])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),h("div",dl,[b(t,{type:"text",size:"small",onClick:e.openPhoneConfig},{default:w(()=>[b(n,null,{default:w(()=>[b(k(E))]),_:1}),l[93]||(l[93]=_(" 配置工作手机 ",-1))]),_:1},8,["onClick"])])]),_:1})):U("",!0),b(K,{label:"选择客户",prop:"selectedCustomer"},{default:w(()=>[b(c,{modelValue:Dt.value.selectedCustomer,"onUpdate:modelValue":l[10]||(l[10]=e=>Dt.value.selectedCustomer=e),placeholder:"请输入客户姓名、编号、电话或公司名称进行搜索",filterable:"",remote:"","remote-method":tn,loading:an.value||k(et).loading,style:{width:"100%"},onChange:nn,onFocus:l[11]||(l[11]=()=>{0===At.value.length&&on()}),clearable:"","no-data-text":"暂无客户数据，请输入关键词搜索","no-match-text":"未找到匹配的客户","loading-text":"正在搜索客户..."},{default:w(()=>[(g(!0),y(x,null,V(At.value,e=>(g(),S(r,{key:e.id,label:`${e.name} (${e.code||""})`,value:e},{default:w(()=>[h("div",rl,[h("div",cl,[h("div",ul,C(e.name),1),h("div",pl,[_(C(e.company||"未填写公司")+" ",1),e.phone?(g(),y("span",ml,C(k(pe)(e.phone,k(a).PHONE)),1)):U("",!0)])]),h("span",fl,C(e.code||"无编号"),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),l[94]||(l[94]=h("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 支持按客户姓名、编号、电话号码或公司名称搜索 ",-1))]),_:1}),b(K,{label:"选择号码",prop:"customerPhone"},{default:w(()=>[b(c,{modelValue:Dt.value.customerPhone,"onUpdate:modelValue":l[12]||(l[12]=e=>Dt.value.customerPhone=e),placeholder:"请选择号码",style:{width:"100%"},disabled:!Dt.value.selectedCustomer},{default:w(()=>[(g(!0),y(x,null,V(Nt.value,e=>(g(),S(r,{key:e.phone,label:`${e.phone} (${e.type})`,value:e.phone},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),b(K,{label:"手动输入号码"},{default:w(()=>[b(p,{modelValue:Dt.value.manualPhone,"onUpdate:modelValue":l[13]||(l[13]=e=>Dt.value.manualPhone=e),placeholder:"或手动输入电话号码",onInput:sn},null,8,["modelValue"]),l[95]||(l[95]=h("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 手动输入号码将优先使用，不会同步客户信息 ",-1))]),_:1}),b(K,{label:"备注"},{default:w(()=>[b(p,{modelValue:Dt.value.notes,"onUpdate:modelValue":l[14]||(l[14]=e=>Dt.value.notes=e),type:"textarea",rows:3,placeholder:"请输入通话备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),b(R,{modelValue:Rt.value,"onUpdate:modelValue":l[17]||(l[17]=e=>Rt.value=e),title:`客户详情 - ${Lt.value?.customerName}`,width:"80%",top:"5vh"},{default:w(()=>[Lt.value?(g(),y("div",vl,[b(s,{class:"customer-info-card"},{header:w(()=>[...l[98]||(l[98]=[h("span",null,"客户基本信息",-1)])]),default:w(()=>[b(d,{gutter:20},{default:w(()=>[b(i,{span:8},{default:w(()=>[h("div",yl,[l[99]||(l[99]=h("label",null,"客户姓名：",-1)),h("span",null,C(Lt.value.customerName),1)])]),_:1}),b(i,{span:8},{default:w(()=>[h("div",gl,[l[100]||(l[100]=h("label",null,"联系电话：",-1)),h("span",null,C(k(pe)(Lt.value.phone,k(a).PHONE)),1)])]),_:1}),b(i,{span:8},{default:w(()=>[h("div",hl,[l[101]||(l[101]=h("label",null,"客户等级：",-1)),b(D,{type:Go(Lt.value.customerLevel)},{default:w(()=>[_(C(Zo(Lt.value.customerLevel)),1)]),_:1},8,["type"])])]),_:1}),b(i,{span:8},{default:w(()=>[h("div",bl,[l[102]||(l[102]=h("label",null,"负责人：",-1)),h("span",null,C(Lt.value.salesPerson),1)])]),_:1}),b(i,{span:8},{default:w(()=>[h("div",wl,[l[103]||(l[103]=h("label",null,"通话次数：",-1)),h("span",null,C(Lt.value.callCount)+" 次",1)])]),_:1}),b(i,{span:8},{default:w(()=>[h("div",_l,[l[104]||(l[104]=h("label",null,"最后通话：",-1)),h("span",null,C(Lt.value.lastCallTime),1)])]),_:1})]),_:1})]),_:1}),b(s,{class:"tabs-card"},{default:w(()=>[b(q,{modelValue:qt.value,"onUpdate:modelValue":l[16]||(l[16]=e=>qt.value=e),type:"border-card"},{default:w(()=>[b(L,{label:"订单记录",name:"orders"},{default:w(()=>[h("div",Cl,[h("div",kl,[b(t,{type:"primary",size:"small",icon:k(X)},{default:w(()=>[...l[105]||(l[105]=[_("新建订单",-1)])]),_:1},8,["icon"])]),b(A,{data:Xt.value,style:{width:"100%"}},{default:w(()=>[b(m,{prop:"orderNo",label:"订单号",width:"150"}),b(m,{prop:"productName",label:"商品名称",width:"200"}),b(m,{prop:"amount",label:"订单金额",width:"120"},{default:w(({row:e})=>[_(" ¥"+C(e.amount),1)]),_:1}),b(m,{prop:"status",label:"订单状态",width:"100"},{default:w(({row:e})=>{return[b(D,{type:(l=e.status,{pending:"warning",completed:"success",cancelled:"danger"}[l]||"info")},{default:w(()=>[_(C(kn(e.status)),1)]),_:2},1032,["type"])];var l}),_:1}),b(m,{prop:"createTime",label:"下单时间",width:"160"}),b(m,{label:"操作",width:"120"},{default:w(({row:e})=>[b(t,{size:"small",type:"primary",onClick:l=>(e=>{re.info(`查看订单：${e.orderNo}`)})(e)},{default:w(()=>[...l[106]||(l[106]=[_("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),b(L,{label:"售后记录",name:"aftersales"},{default:w(()=>[h("div",xl,[h("div",Vl,[b(t,{type:"primary",size:"small",icon:k(X)},{default:w(()=>[...l[107]||(l[107]=[_("新建售后",-1)])]),_:1},8,["icon"])]),b(A,{data:eo.value,style:{width:"100%"}},{default:w(()=>[b(m,{prop:"ticketNo",label:"工单号",width:"150"}),b(m,{prop:"type",label:"售后类型",width:"100"}),b(m,{prop:"description",label:"问题描述","min-width":"200","show-overflow-tooltip":""}),b(m,{prop:"status",label:"处理状态",width:"100"},{default:w(({row:e})=>{return[b(D,{type:(l=e.status,{pending:"warning",processing:"primary",completed:"success",rejected:"danger"}[l]||"info")},{default:w(()=>[_(C(xn(e.status)),1)]),_:2},1032,["type"])];var l}),_:1}),b(m,{prop:"createTime",label:"创建时间",width:"160"}),b(m,{label:"操作",width:"120"},{default:w(({row:e})=>[b(t,{size:"small",type:"primary",onClick:l=>(e=>{re.info(`查看售后工单：${e.ticketNo}`)})(e)},{default:w(()=>[...l[108]||(l[108]=[_("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),b(L,{label:"通话记录",name:"calls"},{default:w(()=>[h("div",Sl,[h("div",Il,[b(t,{type:"primary",size:"small",icon:k(Y)},{default:w(()=>[...l[109]||(l[109]=[_("发起外呼",-1)])]),_:1},8,["icon"])]),b(A,{data:lo.value,style:{width:"100%"}},{default:w(()=>[b(m,{prop:"callType",label:"呼叫类型",width:"100"},{default:w(({row:e})=>[b(D,{type:"outbound"===e.callType?"primary":"success"},{default:w(()=>[_(C("outbound"===e.callType?"外呼":"来电"),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"duration",label:"通话时长",width:"100"}),b(m,{prop:"status",label:"通话状态",width:"100"},{default:w(({row:e})=>[b(D,{type:Xo(e.status)},{default:w(()=>[_(C(en(e.status)),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"startTime",label:"开始时间",width:"160"}),b(m,{prop:"operator",label:"操作人员",width:"100"}),b(m,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),b(m,{label:"操作",width:"200"},{default:w(({row:e})=>[h("div",zl,[h("span",{class:"action-link",onClick:l=>(e=>{const l=e.id||e.callId;e.customerId||e.customer_id,l?Ga.push(`/service-management/call/records?callId=${l}`):re.info("查看通话详情")})(e)},"详情",8,Ul),e.recordingUrl?(g(),y("span",{key:0,class:"action-link",onClick:l=>Oo(e)},"播放录音",8,Pl)):U("",!0),e.recordingUrl?(g(),y("span",{key:1,class:"action-link",onClick:l=>Fo(e)},"下载录音",8,Tl)):(g(),y("span",Dl,"无录音"))])]),_:1})]),_:1},8,["data"])])]),_:1}),b(L,{label:"跟进记录",name:"followups"},{default:w(()=>[h("div",Al,[h("div",Nl,[b(t,{type:"primary",size:"small",icon:k(ee),onClick:un},{default:w(()=>[...l[110]||(l[110]=[_("新建跟进",-1)])]),_:1},8,["icon"])]),b(A,{data:ao.value,style:{width:"100%"}},{default:w(()=>[b(m,{prop:"type",label:"跟进类型",width:"100"}),b(m,{prop:"content",label:"跟进内容","min-width":"200","show-overflow-tooltip":""}),b(m,{prop:"nextPlan",label:"下次计划",width:"160"}),b(m,{prop:"operator",label:"跟进人",width:"100"}),b(m,{prop:"createTime",label:"跟进时间",width:"160"}),b(m,{label:"操作",width:"120"},{default:w(({row:e})=>[b(t,{size:"small",type:"primary",onClick:e=>{re.info("查看跟进记录")}},{default:w(()=>[...l[111]||(l[111]=[_("查看",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])):U("",!0)]),_:1},8,["modelValue","title"]),b(R,{modelValue:Ot.value,"onUpdate:modelValue":l[22]||(l[22]=e=>Ot.value=e),title:"通话记录",width:"80%","before-close":Ko},{default:w(()=>[h("div",Kl,[h("div",Ml,[h("div",Rl,[h("div",Ll,[l[112]||(l[112]=h("label",null,"日期范围：",-1)),b(u,{modelValue:$t.dateRange,"onUpdate:modelValue":l[18]||(l[18]=e=>$t.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:Mo},null,8,["modelValue"])]),h("div",ql,[l[113]||(l[113]=h("label",null,"客户搜索：",-1)),b(p,{modelValue:$t.customerKeyword,"onUpdate:modelValue":l[19]||(l[19]=e=>$t.customerKeyword=e),placeholder:"搜索客户姓名或电话",clearable:"",style:{width:"200px"},onInput:Mo},{prefix:w(()=>[b(n,null,{default:w(()=>[b(k(J))]),_:1})]),_:1},8,["modelValue"])]),b(t,{type:"primary",icon:k(J),onClick:Mo},{default:w(()=>[...l[114]||(l[114]=[_("搜索",-1)])]),_:1},8,["icon"]),b(t,{icon:k(G),onClick:Ro},{default:w(()=>[...l[115]||(l[115]=[_("重置",-1)])]),_:1},8,["icon"])])]),z((g(),S(A,{data:jt.value,style:{width:"100%"}},{default:w(()=>[b(m,{prop:"customerName",label:"客户姓名",width:"120"}),b(m,{prop:"customerPhone",label:"客户电话",width:"140"}),b(m,{prop:"callType",label:"通话类型",width:"100"},{default:w(({row:e})=>[b(D,{type:"outbound"===e.callType?"primary":"success"},{default:w(()=>[_(C("outbound"===e.callType?"外呼":"来电"),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"duration",label:"通话时长",width:"100"}),b(m,{prop:"status",label:"通话状态",width:"100"},{default:w(({row:e})=>[b(D,{type:Xo(e.status)},{default:w(()=>[_(C(en(e.status)),1)]),_:2},1032,["type"])]),_:1}),b(m,{prop:"startTime",label:"开始时间",width:"160"}),b(m,{prop:"operator",label:"操作人员",width:"100"}),b(m,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),b(m,{label:"录音操作",width:"160"},{default:w(({row:e})=>[e.recordingUrl?(g(),y("div",Ol,[b(t,{size:"small",type:"primary",onClick:l=>Oo(e),icon:k(le)},{default:w(()=>[...l[116]||(l[116]=[_(" 播放 ",-1)])]),_:1},8,["onClick","icon"]),b(t,{size:"small",type:"success",onClick:l=>Fo(e),icon:k(Z)},{default:w(()=>[...l[117]||(l[117]=[_(" 下载 ",-1)])]),_:1},8,["onClick","icon"])])):(g(),y("span",Fl,"无录音"))]),_:1})]),_:1},8,["data"])),[[me,Ft.value]]),h("div",jl,[b(N,{"current-page":Yt.currentPage,"onUpdate:currentPage":l[20]||(l[20]=e=>Yt.currentPage=e),"page-size":Yt.pageSize,"onUpdate:pageSize":l[21]||(l[21]=e=>Yt.pageSize=e),"page-sizes":[10,20,50,100],total:Yt.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Lo,onCurrentChange:qo},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"]),b(R,{modelValue:Et.value,"onUpdate:modelValue":l[23]||(l[23]=e=>Et.value=e),title:"录音播放",width:"600px","before-close":jo},{default:w(()=>[h("div",$l,[h("div",Yl,[h("p",null,[l[118]||(l[118]=h("strong",null,"客户：",-1)),_(C(Bt.value?.customerName),1)]),h("p",null,[l[119]||(l[119]=h("strong",null,"电话：",-1)),_(C(Bt.value?.customerPhone),1)]),h("p",null,[l[120]||(l[120]=h("strong",null,"时间：",-1)),_(C(Bt.value?.startTime),1)]),h("p",null,[l[121]||(l[121]=h("strong",null,"时长：",-1)),_(C(Bt.value?.duration),1)])]),h("div",El,[h("audio",{ref_key:"audioPlayer",ref:Ht,src:Bt.value?.recordingUrl,controls:"",style:{width:"100%"},onLoadstart:$o,onCanplay:Yo,onError:Eo}," 您的浏览器不支持音频播放 ",40,Bl)])])]),_:1},8,["modelValue"]),b(R,{modelValue:Wt.value,"onUpdate:modelValue":l[30]||(l[30]=e=>Wt.value=e),title:"快捷跟进",width:"600px",onClose:Bo},{footer:w(()=>[h("div",Ql,[b(t,{onClick:l[29]||(l[29]=e=>Wt.value=!1)},{default:w(()=>[...l[125]||(l[125]=[_("取消",-1)])]),_:1}),b(t,{type:"primary",onClick:Ho,loading:Qt.value},{default:w(()=>[...l[126]||(l[126]=[_(" 保存跟进 ",-1)])]),_:1},8,["loading"])])]),default:w(()=>[h("div",Hl,[h("div",Wl,[h("p",null,[l[122]||(l[122]=h("strong",null,"客户：",-1)),_(C(Lt.value?.name),1)]),h("p",null,[l[123]||(l[123]=h("strong",null,"电话：",-1)),_(C(k(pe)(Lt.value?.phone,k(a).PHONE)),1)]),h("p",null,[l[124]||(l[124]=h("strong",null,"收货地址：",-1)),_(C(oo(Lt.value)),1)])]),b(M,{model:Gt,rules:Zt,ref_key:"quickFollowUpFormRef",ref:Jt,"label-width":"100px"},{default:w(()=>[b(K,{label:"跟进类型",prop:"type"},{default:w(()=>[b(c,{modelValue:Gt.type,"onUpdate:modelValue":l[24]||(l[24]=e=>Gt.type=e),placeholder:"请选择跟进类型",style:{width:"100%"}},{default:w(()=>[b(r,{label:"电话跟进",value:"call"}),b(r,{label:"上门拜访",value:"visit"}),b(r,{label:"邮件跟进",value:"email"}),b(r,{label:"短信跟进",value:"message"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"跟进内容",prop:"content"},{default:w(()=>[b(p,{modelValue:Gt.content,"onUpdate:modelValue":l[25]||(l[25]=e=>Gt.content=e),type:"textarea",rows:4,placeholder:"请输入跟进内容...",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),b(K,{label:"下次跟进",prop:"nextFollowTime"},{default:w(()=>[b(u,{modelValue:Gt.nextFollowTime,"onUpdate:modelValue":l[26]||(l[26]=e=>Gt.nextFollowTime=e),type:"datetime",placeholder:"选择下次跟进时间",style:{width:"100%"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),b(K,{label:"客户意向",prop:"intention"},{default:w(()=>[b(c,{modelValue:Gt.intention,"onUpdate:modelValue":l[27]||(l[27]=e=>Gt.intention=e),placeholder:"请选择客户意向",style:{width:"100%"}},{default:w(()=>[b(r,{label:"很有意向",value:"high"}),b(r,{label:"一般意向",value:"medium"}),b(r,{label:"意向较低",value:"low"}),b(r,{label:"暂无意向",value:"none"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"备注",prop:"remark"},{default:w(()=>[b(p,{modelValue:Gt.remark,"onUpdate:modelValue":l[28]||(l[28]=e=>Gt.remark=e),type:"textarea",rows:2,placeholder:"备注信息（可选）",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),b(R,{modelValue:ut.value,"onUpdate:modelValue":l[31]||(l[31]=e=>ut.value=e),title:"来电提醒",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},{default:w(()=>[mt.value?(g(),y("div",Jl,[h("div",Gl,[h("div",Zl,[b(n,{size:"60"},{default:w(()=>[b(k(Q))]),_:1})]),h("div",Xl,[h("h3",null,C(mt.value.customerName||"未知客户"),1),h("p",ea,C(k(pe)(mt.value.phone,k(a).PHONE)),1),mt.value.customerLevel?(g(),y("p",la,[b(D,{type:Go(mt.value.customerLevel)},{default:w(()=>[_(C(Zo(mt.value.customerLevel)),1)]),_:1},8,["type"])])):U("",!0),mt.value.lastCallTime?(g(),y("p",aa," 上次通话："+C(mt.value.lastCallTime),1)):U("",!0)])]),h("div",ta,[b(t,{type:"success",size:"large",icon:k(Y),onClick:mn,class:"answer-btn"},{default:w(()=>[...l[127]||(l[127]=[_(" 接听 ",-1)])]),_:1},8,["icon"]),b(t,{type:"danger",size:"large",icon:k(ae),onClick:fn,class:"reject-btn"},{default:w(()=>[...l[128]||(l[128]=[_(" 挂断 ",-1)])]),_:1},8,["icon"])]),h("div",oa,[b(t,{size:"small",onClick:wn},{default:w(()=>[...l[129]||(l[129]=[_("查看详情",-1)])]),_:1}),b(t,{size:"small",onClick:_n},{default:w(()=>[...l[130]||(l[130]=[_("快速跟进",-1)])]),_:1})])])):U("",!0)]),_:1},8,["modelValue"]),b(R,{modelValue:pt.value,"onUpdate:modelValue":l[33]||(l[33]=e=>pt.value=e),title:"通话中",width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},{default:w(()=>[ft.value?(g(),y("div",na,[h("div",sa,[h("div",ia,C(hn(vt.value)),1),l[131]||(l[131]=h("div",{class:"call-status"},"通话中...",-1))]),h("div",da,[h("p",ra,C(ft.value.customerName||"未知客户"),1),h("p",ca,C(k(pe)(ft.value.phone,k(a).PHONE)),1)]),h("div",ua,[b(t,{type:"danger",size:"large",icon:k(ae),onClick:vn,class:"end-call-btn"},{default:w(()=>[...l[132]||(l[132]=[_(" 结束通话 ",-1)])]),_:1},8,["icon"])]),h("div",pa,[b(p,{modelValue:yt.value,"onUpdate:modelValue":l[32]||(l[32]=e=>yt.value=e),type:"textarea",rows:3,placeholder:"通话备注...",maxlength:"200","show-word-limit":""},null,8,["modelValue"])])])):U("",!0)]),_:1},8,["modelValue"]),b(R,{modelValue:ht.value,"onUpdate:modelValue":l[69]||(l[69]=e=>ht.value=e),title:"呼出配置",width:"700px","close-on-click-modal":!1},{footer:w(()=>[h("div",Ja,[b(t,{onClick:l[68]||(l[68]=e=>ht.value=!1)},{default:w(()=>[...l[188]||(l[188]=[_("取消",-1)])]),_:1}),b(t,{type:"primary",onClick:xo,loading:bt.value},{default:w(()=>[...l[189]||(l[189]=[_(" 保存配置 ",-1)])]),_:1},8,["loading"])])]),default:w(()=>[b(q,{modelValue:_t.value,"onUpdate:modelValue":l[67]||(l[67]=e=>_t.value=e),type:"border-card"},{default:w(()=>[b(L,{label:"外呼方式",name:"callMethod"},{default:w(()=>[b(M,{model:St,"label-width":"120px",ref_key:"callConfigFormRef",ref:wt},{default:w(()=>[b(K,{label:"外呼方式"},{default:w(()=>[b(F,{modelValue:St.callMethod,"onUpdate:modelValue":l[34]||(l[34]=e=>St.callMethod=e),onChange:Vo},{default:w(()=>[b(O,{label:"system"},{default:w(()=>[...l[133]||(l[133]=[_("系统外呼路线",-1)])]),_:1}),b(O,{label:"mobile"},{default:w(()=>[...l[134]||(l[134]=[_("工作手机外呼",-1)])]),_:1}),b(O,{label:"voip"},{default:w(()=>[...l[135]||(l[135]=[_("网络电话",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"system"===St.callMethod?(g(),y("div",ma,[b(K,{label:"外呼线路"},{default:w(()=>[b(c,{modelValue:St.lineId,"onUpdate:modelValue":l[35]||(l[35]=e=>St.lineId=e),placeholder:"请选择外呼线路",style:{width:"100%"}},{default:w(()=>[(g(!0),y(x,null,V(It.value,e=>(g(),S(r,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"线路状态"},{default:w(()=>{return[b(D,{type:(e=St.lineId,e?"success":"info")},{default:w(()=>[_(C(So(St.lineId)),1)]),_:1},8,["type"])];var e}),_:1})])):U("",!0),"mobile"===St.callMethod?(g(),y("div",fa,[b(K,{label:"工作手机号"},{default:w(()=>[b(p,{modelValue:St.workPhone,"onUpdate:modelValue":l[36]||(l[36]=e=>St.workPhone=e),placeholder:"请输入工作手机号码",maxlength:"11",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),b(K,{label:"拨号方式"},{default:w(()=>[b(F,{modelValue:St.dialMethod,"onUpdate:modelValue":l[37]||(l[37]=e=>St.dialMethod=e)},{default:w(()=>[b(O,{label:"direct"},{default:w(()=>[...l[136]||(l[136]=[_("直接拨号",-1)])]),_:1}),b(O,{label:"callback"},{default:w(()=>[...l[137]||(l[137]=[_("回拨模式",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"direct"===St.dialMethod?(g(),y(x,{key:0},[b(j,{"content-position":"left"},{default:w(()=>[...l[138]||(l[138]=[_("手机SDK配置",-1)])]),_:1}),b(K,{label:"手机平台"},{default:w(()=>[b(F,{modelValue:St.mobileConfig.platform,"onUpdate:modelValue":l[38]||(l[38]=e=>St.mobileConfig.platform=e)},{default:w(()=>[b(O,{label:"android"},{default:w(()=>[b(n,null,{default:w(()=>[b(k(te))]),_:1}),l[139]||(l[139]=_(" Android ",-1))]),_:1}),b(O,{label:"ios"},{default:w(()=>[b(n,null,{default:w(()=>[b(k(oe))]),_:1}),l[140]||(l[140]=_(" iOS ",-1))]),_:1})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"SDK状态"},{default:w(()=>[h("div",va,[b(D,{type:St.mobileConfig.sdkInstalled?"success":"warning",size:"default"},{default:w(()=>[b(n,null,{default:w(()=>[(g(),S(P(St.mobileConfig.sdkInstalled?"CircleCheckFilled":"WarningFilled")))]),_:1}),_(" "+C(St.mobileConfig.sdkInstalled?"SDK已安装":"SDK未安装"),1)]),_:1},8,["type"]),b(t,{type:"primary",icon:k(Z),onClick:po,size:"default"},{default:w(()=>[...l[141]||(l[141]=[_(" 下载SDK应用 ",-1)])]),_:1},8,["icon"])]),h("div",ya,[h("div",ga,[l[142]||(l[142]=h("span",{style:{"font-weight":"500",color:"#303133"}},"当前版本信息",-1)),b(D,{size:"small",type:"info"},{default:w(()=>[_("v"+C(St.mobileConfig.sdkInfo?.version||"1.0.0"),1)]),_:1})]),h("div",ha,[h("div",null,[l[143]||(l[143]=h("span",{style:{color:"#909399"}},"文件大小：",-1)),h("span",null,C(St.mobileConfig.sdkInfo?.fileSize||("android"===St.mobileConfig.platform?"5.3 MB":"待发布")),1)]),h("div",null,[l[144]||(l[144]=h("span",{style:{color:"#909399"}},"更新时间：",-1)),h("span",null,C(St.mobileConfig.sdkInfo?.updateTime||ho(new Date)),1)]),h("div",null,[l[145]||(l[145]=h("span",{style:{color:"#909399"}},"支持系统：",-1)),h("span",null,C(St.mobileConfig.sdkInfo?.supportedSystems||("android"===St.mobileConfig.platform?"Android 5.0+":"iOS 12.0+")),1)]),h("div",null,[l[146]||(l[146]=h("span",{style:{color:"#909399"}},"安装包类型：",-1)),h("span",null,C(St.mobileConfig.sdkInfo?.packageType||("android"===St.mobileConfig.platform?"APK":"PWA")),1)])])]),h("div",ba,C("android"===St.mobileConfig.platform?"请下载APK文件并在Android设备上安装":"请在iOS设备的Safari浏览器中访问PWA应用"),1)]),_:1}),b(K,{label:"系统权限"},{default:w(()=>[h("div",wa,[h("div",_a,[b(n,{style:T({color:St.mobileConfig.deviceAuthorized?"#67c23a":"#909399"})},{default:w(()=>[b(k(ne))]),_:1},8,["style"]),l[147]||(l[147]=h("span",{style:{"font-size":"14px"}},"设备授权",-1)),b(D,{type:St.mobileConfig.deviceAuthorized?"success":"info",size:"small"},{default:w(()=>[_(C(St.mobileConfig.deviceAuthorized?"已授权":"待授权"),1)]),_:1},8,["type"])]),h("div",Ca,[b(n,{style:T({color:St.mobileConfig.callPermission?"#67c23a":"#909399"})},{default:w(()=>[b(k(Y))]),_:1},8,["style"]),l[148]||(l[148]=h("span",{style:{"font-size":"14px"}},"通话权限",-1)),b(D,{type:St.mobileConfig.callPermission?"success":"info",size:"small"},{default:w(()=>[_(C(St.mobileConfig.callPermission?"已获取":"待获取"),1)]),_:1},8,["type"])])]),h("div",ka,[b(t,{type:"text",size:"small",onClick:fo},{default:w(()=>[b(n,null,{default:w(()=>[b(k(B))]),_:1}),l[149]||(l[149]=_(" 刷新权限状态 ",-1))]),_:1})])]),_:1}),b(K,{label:"连接状态"},{default:w(()=>[h("div",xa,[b(D,{type:uo().type,size:"default"},{default:w(()=>[b(n,null,{default:w(()=>[(g(),S(P(uo().icon)))]),_:1}),_(" "+C(uo().text),1)]),_:1},8,["type"]),b(t,{type:"success",icon:k(se),onClick:mo,loading:Ct.value,size:"default"},{default:w(()=>[...l[150]||(l[150]=[_(" 测试连接 ",-1)])]),_:1},8,["icon","loading"])]),l[151]||(l[151]=h("div",{style:{color:"#909399","font-size":"12px","margin-top":"4px"}}," 确保手机与系统在同一网络环境下 ",-1))]),_:1}),b(K,{label:"扫码连接"},{default:w(()=>[h("div",Va,[h("div",Sa,[kt.qrCodeUrl?(g(),y("div",Ia,[h("img",{src:kt.qrCodeUrl,alt:"连接二维码",style:{width:"120px",height:"120px"}},null,8,za)])):(g(),y("div",Ua,[b(n,{size:"24"},{default:w(()=>[b(k(se))]),_:1})])),h("div",Pa,C("pending"===kt.status?"等待扫码连接":"connected"===kt.status?"连接成功":"expired"===kt.status?"二维码已过期":"点击生成二维码"),1),kt.expiresAt?(g(),y("div",Ta,C(e.getQRExpiryText()),1)):U("",!0)]),h("div",Da,[h("div",Aa,[b(t,{type:"primary",icon:k(se),onClick:so,loading:kt.generating,size:"default"},{default:w(()=>[_(C(kt.qrCodeUrl?"重新生成":"生成二维码"),1)]),_:1},8,["icon","loading"]),kt.qrCodeUrl?(g(),S(t,{key:0,type:"info",icon:k(B),onClick:ro,loading:kt.checking,size:"small"},{default:w(()=>[...l[152]||(l[152]=[_(" 检查连接状态 ",-1)])]),_:1},8,["icon","loading"])):U("",!0),"connected"===kt.status?(g(),S(t,{key:1,type:"warning",icon:k(ie),onClick:e.disconnectQRConnection,size:"small"},{default:w(()=>[...l[153]||(l[153]=[_(" 断开连接 ",-1)])]),_:1},8,["icon","onClick"])):U("",!0)]),h("div",Na,[h("div",Ka,[b(n,null,{default:w(()=>[b(k(de))]),_:1}),l[154]||(l[154]=_(" 扫码连接说明： ",-1))]),l[155]||(l[155]=h("div",null,'1. 点击"生成二维码"按钮',-1)),l[156]||(l[156]=h("div",null,"2. 使用手机SDK应用扫描二维码",-1)),l[157]||(l[157]=h("div",null,"3. 确认连接权限并完成配置",-1)),l[158]||(l[158]=h("div",null,"4. 连接成功后可断开重连",-1))])])])]),_:1}),b(K,{label:"替代连接方式"},{default:w(()=>[h("div",Ma,[h("div",Ra,[h("div",La,[b(n,{size:"24",style:{color:"#409eff","margin-bottom":"8px"}},{default:w(()=>[b(k(se))]),_:1}),l[159]||(l[159]=h("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"蓝牙连接",-1)),b(D,{type:"connected"===xt.bluetooth.status?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:w(()=>[_(C("connected"===xt.bluetooth.status?"已连接":"connecting"===xt.bluetooth.status?"连接中":"未连接"),1)]),_:1},8,["type"]),h("div",null,[b(t,{type:"primary",size:"small",loading:"connecting"===xt.bluetooth.status,onClick:vo},{default:w(()=>[_(C("connected"===xt.bluetooth.status?"断开":"连接"),1)]),_:1},8,["loading"])])]),h("div",qa,[b(n,{size:"24",style:{color:"#67c23a","margin-bottom":"8px"}},{default:w(()=>[b(k(se))]),_:1}),l[160]||(l[160]=h("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"同网络连接",-1)),b(D,{type:"connected"===xt.network.status?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:w(()=>[_(C("connected"===xt.network.status?"已连接":"discovering"===xt.network.status?"搜索中":"未连接"),1)]),_:1},8,["type"]),h("div",null,[b(t,{type:"success",size:"small",loading:"discovering"===xt.network.status,onClick:yo},{default:w(()=>[_(C("connected"===xt.network.status?"断开":"搜索"),1)]),_:1},8,["loading"])])]),h("div",Oa,[b(n,{size:"24",style:{color:"#e6a23c","margin-bottom":"8px"}},{default:w(()=>[b(k(ne))]),_:1}),l[161]||(l[161]=h("div",{style:{"font-weight":"500","margin-bottom":"8px"}},"数字配对",-1)),b(D,{type:"connected"===xt.digital.status?"success":"info",size:"small",style:{"margin-bottom":"8px"}},{default:w(()=>[_(C("connected"===xt.digital.status?"已连接":"generating"===xt.digital.status?"生成中":"未连接"),1)]),_:1},8,["type"]),xt.digital.code?(g(),y("div",Fa,C(xt.digital.code),1)):U("",!0),h("div",null,[b(t,{type:"warning",size:"small",loading:"generating"===xt.digital.status,onClick:go},{default:w(()=>[_(C(xt.digital.code?"重新生成":"生成配对码"),1)]),_:1},8,["loading"])])])]),h("div",ja,[h("div",$a,[b(n,null,{default:w(()=>[b(k(de))]),_:1}),l[162]||(l[162]=_(" 替代连接方式说明： ",-1))]),l[163]||(l[163]=h("div",null,"• 蓝牙连接：通过蓝牙与手机设备建立连接",-1)),l[164]||(l[164]=h("div",null,"• 同网络连接：在同一WiFi网络下自动发现设备",-1)),l[165]||(l[165]=h("div",null,"• 数字配对：生成6位数字配对码进行连接",-1))])])]),_:1}),Vt.value.length>0?(g(),S(K,{key:0,label:"已连接设备"},{default:w(()=>[h("div",Ya,[(g(!0),y(x,null,V(Vt.value,a=>(g(),y("div",{key:a.id,style:{padding:"12px","border-bottom":"1px solid #f5f7fa",display:"flex","align-items":"center","justify-content":"space-between"}},[h("div",Ea,[b(n,{style:T({color:"online"===a.status?"#67c23a":"#909399"})},{default:w(()=>[b(k(te))]),_:1},8,["style"]),h("div",null,[h("div",Ba,C(a.deviceName),1),h("div",Ha," 最后连接："+C(ho(new Date(a.lastConnected))),1)])]),h("div",Wa,[b(D,{type:"online"===a.status?"success":"info",size:"small"},{default:w(()=>[_(C("online"===a.status?"在线":"离线"),1)]),_:2},1032,["type"]),b(t,{type:"text",icon:k(ie),onClick:l=>e.removeConnectedDevice(a.id),size:"small",style:{color:"#f56c6c"}},{default:w(()=>[...l[166]||(l[166]=[_(" 移除 ",-1)])]),_:1},8,["icon","onClick"])])]))),128))])]),_:1})):U("",!0)],64)):U("",!0),"callback"===St.dialMethod?(g(),y(x,{key:1},[b(j,{"content-position":"left"},{default:w(()=>[...l[167]||(l[167]=[_("回拨模式配置",-1)])]),_:1}),b(K,{label:"回拨服务商"},{default:w(()=>[b(c,{modelValue:St.callbackConfig.provider,"onUpdate:modelValue":l[39]||(l[39]=e=>St.callbackConfig.provider=e),style:{width:"100%"}},{default:w(()=>[b(r,{label:"阿里云回拨",value:"aliyun"}),b(r,{label:"腾讯云回拨",value:"tencent"}),b(r,{label:"自建回拨服务",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"回拨延迟"},{default:w(()=>[b($,{modelValue:St.callbackConfig.delay,"onUpdate:modelValue":l[40]||(l[40]=e=>St.callbackConfig.delay=e),min:1,max:30,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),l[168]||(l[168]=h("span",{style:{"margin-left":"10px"}},"秒",-1))]),_:1}),b(K,{label:"最大重试"},{default:w(()=>[b($,{modelValue:St.callbackConfig.maxRetries,"onUpdate:modelValue":l[41]||(l[41]=e=>St.callbackConfig.maxRetries=e),min:1,max:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),l[169]||(l[169]=h("span",{style:{"margin-left":"10px"}},"次",-1))]),_:1})],64)):U("",!0),b(ce,{title:"工作手机外呼说明",type:"info",closable:!1,"show-icon":""},{default:w(()=>[...l[170]||(l[170]=[h("p",null,"• 直接拨号：系统调用手机端系统电话实现拨号外呼",-1),h("p",null,"• 回拨模式：系统先呼叫您的工作手机，接通后再呼叫客户",-1)])]),_:1})])):U("",!0),"voip"===St.callMethod?(g(),y("div",Qa,[b(K,{label:"VoIP服务商"},{default:w(()=>[b(c,{modelValue:St.voipProvider,"onUpdate:modelValue":l[42]||(l[42]=e=>St.voipProvider=e),placeholder:"请选择VoIP服务商",style:{width:"100%"}},{default:w(()=>[b(r,{label:"阿里云通信",value:"aliyun"}),b(r,{label:"腾讯云通信",value:"tencent"}),b(r,{label:"华为云通信",value:"huawei"}),b(r,{label:"自定义SIP",value:"custom"})]),_:1},8,["modelValue"])]),_:1}),"aliyun"===St.voipProvider?(g(),y(x,{key:0},[b(j,{"content-position":"left"},{default:w(()=>[...l[171]||(l[171]=[_("阿里云通信配置",-1)])]),_:1}),b(K,{label:"AccessKey ID",required:""},{default:w(()=>[b(p,{modelValue:St.aliyunConfig.accessKeyId,"onUpdate:modelValue":l[43]||(l[43]=e=>St.aliyunConfig.accessKeyId=e),placeholder:"请输入阿里云AccessKey ID","show-password":"",style:{width:"100%"}},null,8,["modelValue"]),l[172]||(l[172]=h("div",{class:"form-tip"},"从阿里云控制台获取AccessKey ID",-1))]),_:1}),b(K,{label:"AccessKey Secret",required:""},{default:w(()=>[b(p,{modelValue:St.aliyunConfig.accessKeySecret,"onUpdate:modelValue":l[44]||(l[44]=e=>St.aliyunConfig.accessKeySecret=e),placeholder:"请输入阿里云AccessKey Secret","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"]),l[173]||(l[173]=h("div",{class:"form-tip"},"从阿里云控制台获取AccessKey Secret",-1))]),_:1}),b(K,{label:"应用ID",required:""},{default:w(()=>[b(p,{modelValue:St.aliyunConfig.appId,"onUpdate:modelValue":l[45]||(l[45]=e=>St.aliyunConfig.appId=e),placeholder:"请输入语音通话应用ID",style:{width:"100%"}},null,8,["modelValue"]),l[174]||(l[174]=h("div",{class:"form-tip"},"在阿里云语音服务控制台创建应用后获取",-1))]),_:1}),b(K,{label:"主叫号码"},{default:w(()=>[b(p,{modelValue:St.aliyunConfig.callerNumber,"onUpdate:modelValue":l[46]||(l[46]=e=>St.aliyunConfig.callerNumber=e),placeholder:"请输入主叫显示号码",style:{width:"100%"}},null,8,["modelValue"]),l[175]||(l[175]=h("div",{class:"form-tip"},"客户接听时显示的号码，需在阿里云申请",-1))]),_:1}),b(K,{label:"服务区域"},{default:w(()=>[b(c,{modelValue:St.aliyunConfig.region,"onUpdate:modelValue":l[47]||(l[47]=e=>St.aliyunConfig.region=e),placeholder:"请选择服务区域",style:{width:"100%"}},{default:w(()=>[b(r,{label:"华东1（杭州）",value:"cn-hangzhou"}),b(r,{label:"华东2（上海）",value:"cn-shanghai"}),b(r,{label:"华北1（青岛）",value:"cn-qingdao"}),b(r,{label:"华北2（北京）",value:"cn-beijing"}),b(r,{label:"华南1（深圳）",value:"cn-shenzhen"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"录音配置"},{default:w(()=>[b(ue,{modelValue:St.aliyunConfig.enableRecording,"onUpdate:modelValue":l[48]||(l[48]=e=>St.aliyunConfig.enableRecording=e)},null,8,["modelValue"]),l[176]||(l[176]=h("span",{style:{"margin-left":"10px"}},"启用通话录音",-1))]),_:1}),St.aliyunConfig.enableRecording?(g(),S(K,{key:0,label:"录音存储"},{default:w(()=>[b(p,{modelValue:St.aliyunConfig.recordingBucket,"onUpdate:modelValue":l[49]||(l[49]=e=>St.aliyunConfig.recordingBucket=e),placeholder:"请输入OSS存储桶名称",style:{width:"100%"}},null,8,["modelValue"]),l[177]||(l[177]=h("div",{class:"form-tip"},"录音文件将存储到指定的OSS存储桶",-1))]),_:1})):U("",!0),b(ce,{title:"阿里云通信配置说明",type:"warning",closable:!1,"show-icon":""},{default:w(()=>[...l[178]||(l[178]=[h("p",null,"• 请确保已开通阿里云语音服务并完成实名认证",-1),h("p",null,"• AccessKey需要具有语音服务的调用权限",-1),h("p",null,"• 主叫号码需要在阿里云申请并通过审核",-1),h("p",null,"• 录音功能需要额外开通OSS存储服务",-1)])]),_:1})],64)):U("",!0),"tencent"===St.voipProvider?(g(),y(x,{key:1},[b(j,{"content-position":"left"},{default:w(()=>[...l[179]||(l[179]=[_("腾讯云通信配置",-1)])]),_:1}),b(K,{label:"SecretId",required:""},{default:w(()=>[b(p,{modelValue:St.tencentConfig.secretId,"onUpdate:modelValue":l[50]||(l[50]=e=>St.tencentConfig.secretId=e),placeholder:"请输入腾讯云SecretId","show-password":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),b(K,{label:"SecretKey",required:""},{default:w(()=>[b(p,{modelValue:St.tencentConfig.secretKey,"onUpdate:modelValue":l[51]||(l[51]=e=>St.tencentConfig.secretKey=e),placeholder:"请输入腾讯云SecretKey","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),b(K,{label:"应用ID",required:""},{default:w(()=>[b(p,{modelValue:St.tencentConfig.appId,"onUpdate:modelValue":l[52]||(l[52]=e=>St.tencentConfig.appId=e),placeholder:"请输入语音通话应用ID",style:{width:"100%"}},null,8,["modelValue"])]),_:1})],64)):U("",!0),"huawei"===St.voipProvider?(g(),y(x,{key:2},[b(j,{"content-position":"left"},{default:w(()=>[...l[180]||(l[180]=[_("华为云通信配置",-1)])]),_:1}),b(K,{label:"Access Key",required:""},{default:w(()=>[b(p,{modelValue:St.huaweiConfig.accessKey,"onUpdate:modelValue":l[53]||(l[53]=e=>St.huaweiConfig.accessKey=e),placeholder:"请输入华为云Access Key","show-password":"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),b(K,{label:"Secret Key",required:""},{default:w(()=>[b(p,{modelValue:St.huaweiConfig.secretKey,"onUpdate:modelValue":l[54]||(l[54]=e=>St.huaweiConfig.secretKey=e),placeholder:"请输入华为云Secret Key","show-password":"",type:"password",style:{width:"100%"}},null,8,["modelValue"])]),_:1})],64)):U("",!0),b(K,{label:"音频设备"},{default:w(()=>[b(c,{modelValue:St.audioDevice,"onUpdate:modelValue":l[55]||(l[55]=e=>St.audioDevice=e),placeholder:"请选择音频设备",style:{width:"100%"}},{default:w(()=>[b(r,{label:"默认设备",value:"default"}),b(r,{label:"耳机",value:"headset"}),b(r,{label:"扬声器",value:"speaker"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"音质设置"},{default:w(()=>[b(F,{modelValue:St.audioQuality,"onUpdate:modelValue":l[56]||(l[56]=e=>St.audioQuality=e)},{default:w(()=>[b(O,{label:"standard"},{default:w(()=>[...l[181]||(l[181]=[_("标准音质",-1)])]),_:1}),b(O,{label:"high"},{default:w(()=>[...l[182]||(l[182]=[_("高清音质",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),b(ce,{title:"网络电话说明",type:"info",closable:!1,"show-icon":""},{default:w(()=>[...l[183]||(l[183]=[h("p",null,"• 请确保电脑已连接耳机或音响设备",-1),h("p",null,"• 建议使用有线网络以保证通话质量",-1),h("p",null,"• 高清音质需要更好的网络环境",-1)])]),_:1})])):U("",!0)]),_:1},8,["model"])]),_:1}),b(L,{label:"呼叫参数",name:"callParams"},{default:w(()=>[b(M,{model:St,"label-width":"120px"},{default:w(()=>[b(K,{label:"呼叫模式"},{default:w(()=>[b(F,{modelValue:St.callMode,"onUpdate:modelValue":l[57]||(l[57]=e=>St.callMode=e)},{default:w(()=>[b(O,{label:"auto"},{default:w(()=>[...l[184]||(l[184]=[_("自动外呼",-1)])]),_:1}),b(O,{label:"manual"},{default:w(()=>[...l[185]||(l[185]=[_("手动外呼",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"呼叫间隔"},{default:w(()=>[b($,{modelValue:St.callInterval,"onUpdate:modelValue":l[58]||(l[58]=e=>St.callInterval=e),min:5,max:300,step:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),l[186]||(l[186]=h("span",{style:{"margin-left":"8px",color:"#909399"}},"秒",-1))]),_:1}),b(K,{label:"最大重试次数"},{default:w(()=>[b($,{modelValue:St.maxRetries,"onUpdate:modelValue":l[59]||(l[59]=e=>St.maxRetries=e),min:0,max:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),b(K,{label:"呼叫超时"},{default:w(()=>[b($,{modelValue:St.callTimeout,"onUpdate:modelValue":l[60]||(l[60]=e=>St.callTimeout=e),min:10,max:120,step:5,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"]),l[187]||(l[187]=h("span",{style:{"margin-left":"8px",color:"#909399"}},"秒",-1))]),_:1}),b(K,{label:"启用录音"},{default:w(()=>[b(ue,{modelValue:St.enableRecording,"onUpdate:modelValue":l[61]||(l[61]=e=>St.enableRecording=e)},null,8,["modelValue"])]),_:1}),b(K,{label:"自动跟进"},{default:w(()=>[b(ue,{modelValue:St.autoFollowUp,"onUpdate:modelValue":l[62]||(l[62]=e=>St.autoFollowUp=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),k(Xa).isSuperAdmin?(g(),S(L,{key:0,label:"高级设置",name:"advanced"},{default:w(()=>[b(M,{model:St,"label-width":"120px"},{default:w(()=>[b(K,{label:"并发呼叫数"},{default:w(()=>[b($,{modelValue:St.concurrentCalls,"onUpdate:modelValue":l[63]||(l[63]=e=>St.concurrentCalls=e),min:1,max:10,"controls-position":"right",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),b(K,{label:"呼叫优先级"},{default:w(()=>[b(c,{modelValue:St.priority,"onUpdate:modelValue":l[64]||(l[64]=e=>St.priority=e),style:{width:"200px"}},{default:w(()=>[b(r,{label:"低",value:"low"}),b(r,{label:"中",value:"medium"}),b(r,{label:"高",value:"high"})]),_:1},8,["modelValue"])]),_:1}),b(K,{label:"黑名单检查"},{default:w(()=>[b(ue,{modelValue:St.blacklistCheck,"onUpdate:modelValue":l[65]||(l[65]=e=>St.blacklistCheck=e)},null,8,["modelValue"])]),_:1}),b(K,{label:"号码归属地显示"},{default:w(()=>[b(ue,{modelValue:St.showLocation,"onUpdate:modelValue":l[66]||(l[66]=e=>St.showLocation=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})):U("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d929e532"]]);export{Ga as default};
