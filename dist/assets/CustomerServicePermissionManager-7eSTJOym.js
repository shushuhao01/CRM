var we=Object.defineProperty,Ce=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var ae=(T,r,c)=>r in T?we(T,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):T[r]=c,se=(T,r)=>{for(var c in r||(r={}))Ee.call(r,c)&&ae(T,c,r[c]);if(te)for(var c of te(r))Ve.call(r,c)&&ae(T,c,r[c]);return T},ie=(T,r)=>Ce(T,he(r));var O=(T,r,c)=>new Promise((L,P)=>{var x=S=>{try{b(c.next(S))}catch(A){P(A)}},R=S=>{try{b(c.throw(S))}catch(A){P(A)}},b=S=>S.done?L(S.value):Promise.resolve(S.value).then(x,R);b((c=c.apply(T,r)).next())});import{aT as Pe,a2 as xe,E as C}from"./elementPlus-Bmwh7Rh8.js";import{a0 as f,a1 as o,_ as Ae}from"./settings-CuxbDWOu.js";import{l as Ie,r as k,e as Ue,c as De,ag as _,m as g,p as v,q as a,U as e,O as t,S as u,u as d,T as w,Q as N,F as $,a9 as z,M as F,aA as Le}from"./vendor-D8Vxqhr-.js";import"./utils-ywHRn0uI.js";const Re={class:"customer-service-permission-manager"},Me={class:"header"},Oe={class:"header-title"},Ne={class:"header-stats"},Fe={class:"header-actions"},Ge={class:"filters"},Be={class:"custom-permissions"},$e={key:0,class:"no-permissions"},ze={class:"permission-tree"},Ke={class:"permission-description"},qe={key:0},Qe={key:1},je={key:2},He={key:3},Je={key:4},We={class:"dialog-footer"},Xe={key:0,class:"permission-details"},Ye={class:"custom-permissions-detail",style:{"margin-top":"20px"}},Ze={key:0},el={key:1,class:"no-permissions"},ll={class:"batch-config"},tl={class:"bottom-info",style:{"margin-top":"30px"}},al={class:"info-content"},sl={class:"info-title"},il=Ie({__name:"CustomerServicePermissionManager",setup(T){const r=k([]),c=k([]),L=k(""),P=k(""),x=k(!1),R=k({total:0,online:0,configRate:0}),b=k({targetType:"",template:"",dataScope:""}),S=k(!1),A=k(!1),p=k(null),m=k({customerServiceType:o.GENERAL,dataScope:f.CUSTOM,departmentIds:[],customPermissions:[]}),G=k(),oe=[{key:"customer",name:"客户管理",children:[{key:"customer:list:view",name:"查看客户列表"},{key:"customer:list:edit",name:"编辑客户信息"},{key:"customer:list:create",name:"创建客户"},{key:"customer:list:assign",name:"分配客户"}]},{key:"order",name:"订单管理",children:[{key:"order:list:view",name:"查看订单列表"},{key:"order:list:edit",name:"编辑订单"},{key:"order:add:create",name:"创建订单"},{key:"order:audit:view",name:"查看审核订单"},{key:"order:audit:approve",name:"审核订单"},{key:"order:detail:cancel",name:"取消订单"}]},{key:"service",name:"客服管理",children:[{key:"service:list:view",name:"查看服务列表"},{key:"service:list:edit",name:"编辑服务记录"},{key:"service:afterSales:view",name:"查看售后服务"},{key:"service:afterSales:edit",name:"处理售后服务"}]},{key:"logistics",name:"物流管理",children:[{key:"logistics:shipping:view",name:"查看发货列表"},{key:"logistics:shipping:edit",name:"编辑发货信息"},{key:"logistics:shipping:batchExport",name:"批量导出"}]},{key:"product",name:"商品管理",children:[{key:"product:list:view",name:"查看商品列表"},{key:"product:list:edit",name:"编辑商品信息"},{key:"product:add:create",name:"添加商品"},{key:"product:inventory:manage",name:"库存管理"}]}],ne=Ue(()=>r.value.filter(i=>{const l=!L.value||i.name.includes(L.value),I=!P.value||i.customerServiceType===P.value;return l&&I})),K=i=>{switch(i){case o.AFTER_SALES:return"售后客服";case o.AUDIT:return"审核客服";case o.LOGISTICS:return"物流客服";case o.PRODUCT:return"商品客服";case o.GENERAL:return"通用客服";default:return"未知"}},q=i=>{switch(i){case o.AFTER_SALES:return"warning";case o.AUDIT:return"info";case o.LOGISTICS:return"success";case o.PRODUCT:return"primary";case o.GENERAL:return"";default:return""}},Q=i=>{switch(i){case f.ALL:return"全部数据";case f.DEPARTMENT:return"部门数据";case f.SELF:return"个人数据";case f.CUSTOM:return"自定义范围";default:return"未知"}},j=i=>{switch(i){case f.ALL:return"danger";case f.DEPARTMENT:return"warning";case f.SELF:return"info";case f.CUSTOM:return"primary";default:return""}},H=i=>({"customer:list:view":"查看客户列表","customer:list:edit":"编辑客户信息","customer:list:create":"创建客户","customer:list:assign":"分配客户","order:list:view":"查看订单列表","order:list:edit":"编辑订单","order:add:create":"创建订单","order:audit:view":"查看审核订单","order:audit:approve":"审核订单","order:detail:cancel":"取消订单","service:list:view":"查看服务列表","service:list:edit":"编辑服务记录","service:afterSales:view":"查看售后服务","service:afterSales:edit":"处理售后服务","logistics:shipping:view":"查看发货列表","logistics:shipping:edit":"编辑发货信息","logistics:shipping:batchExport":"批量导出","product:list:view":"查看商品列表","product:list:edit":"编辑商品信息","product:add:create":"添加商品","product:inventory:manage":"库存管理"})[i]||i,re=[{id:"cs_001",name:"张客服",email:"zhangcs@example.com",department:"客服部",departmentId:"dept_cs",customerServiceType:o.AFTER_SALES,dataScope:f.CUSTOM,customPermissions:["service:afterSales:view","service:afterSales:edit","order:list:view"],status:"active"},{id:"cs_002",name:"李客服",email:"lics@example.com",department:"客服部",departmentId:"dept_cs",customerServiceType:o.AUDIT,dataScope:f.CUSTOM,customPermissions:["order:audit:view","order:audit:approve","customer:list:view"],status:"active"},{id:"cs_003",name:"王客服",email:"wangcs@example.com",department:"客服部",departmentId:"dept_cs",customerServiceType:o.LOGISTICS,dataScope:f.CUSTOM,customPermissions:["logistics:shipping:view","logistics:shipping:edit","order:list:view"],status:"active"}],ue=[{id:"dept_001",name:"销售一部"},{id:"dept_002",name:"销售二部"},{id:"dept_003",name:"销售三部"},{id:"dept_cs",name:"客服部"},{id:"dept_logistics",name:"物流部"}],J=()=>O(this,null,function*(){yield X(),W(),C.success("数据刷新成功")}),de=()=>{C.info("导出权限配置功能开发中")},me=()=>{x.value=!0},ce=()=>O(this,null,function*(){if(!b.value.targetType||!b.value.template){C.warning("请选择客服类型和权限模板");return}try{C.success("批量配置成功"),x.value=!1,J()}catch(i){C.error("批量配置失败")}}),W=()=>{const i=r.value.length,l=r.value.filter(y=>y.status==="active").length,I=r.value.filter(y=>y.customPermissions&&y.customPermissions.length>0).length;R.value={total:i,online:l,configRate:i>0?Math.round(I/i*100):0}},pe=()=>{C.info("搜索完成")},X=()=>O(this,null,function*(){try{yield new Promise(i=>setTimeout(i,500)),r.value=[...re],c.value=[...ue]}catch(i){C.error("加载客服数据失败"),console.error("Load customer services error:",i)}}),ve=i=>{p.value=i,m.value={customerServiceType:i.customerServiceType,dataScope:i.dataScope,departmentIds:i.departmentIds||[],customPermissions:i.customPermissions||[]},S.value=!0},fe=i=>{p.value=i,A.value=!0},ye=()=>{G.value&&(m.value.customPermissions=G.value.getCheckedKeys())},_e=()=>O(this,null,function*(){try{if(!p.value)return;yield new Promise(l=>setTimeout(l,500));const i=r.value.findIndex(l=>l.id===p.value.id);i>-1&&(r.value[i]=ie(se({},r.value[i]),{customerServiceType:m.value.customerServiceType,dataScope:m.value.dataScope,departmentIds:m.value.departmentIds,customPermissions:m.value.customPermissions})),S.value=!1,C.success("权限配置保存成功")}catch(i){C.error("保存权限配置失败"),console.error("Save permissions error:",i)}});return De(()=>{X(),W()}),(i,l)=>{var Z,ee;const I=_("el-statistic"),y=_("el-button"),Se=_("el-input"),n=_("el-option"),U=_("el-select"),h=_("el-table-column"),E=_("el-tag"),ge=_("el-table"),V=_("el-form-item"),Y=_("el-form"),B=_("el-dialog"),M=_("el-descriptions-item"),Te=_("el-descriptions"),be=_("el-alert"),ke=_("el-icon");return v(),g("div",Re,[a("div",Me,[a("div",Oe,[l[13]||(l[13]=a("h1",{class:"page-title"},"客服权限管理",-1)),l[14]||(l[14]=a("p",{class:"page-subtitle"},"专门针对客服团队的权限管理工具，按业务类型进行权限配置",-1)),a("div",Ne,[e(I,{title:"客服总数",value:R.value.total},null,8,["value"]),e(I,{title:"在线客服",value:R.value.online},null,8,["value"]),e(I,{title:"权限配置完成率",value:R.value.configRate,suffix:"%"},null,8,["value"])])]),a("div",Fe,[e(y,{onClick:J,type:"primary"},{default:t(()=>[...l[15]||(l[15]=[u("刷新数据",-1)])]),_:1}),e(y,{onClick:de,type:"success"},{default:t(()=>[...l[16]||(l[16]=[u("导出配置",-1)])]),_:1}),e(y,{onClick:me,type:"warning"},{default:t(()=>[...l[17]||(l[17]=[u("批量配置",-1)])]),_:1})])]),a("div",Ge,[e(Se,{modelValue:L.value,"onUpdate:modelValue":l[0]||(l[0]=s=>L.value=s),placeholder:"搜索客服姓名",style:{width:"200px","margin-right":"10px"}},null,8,["modelValue"]),e(U,{modelValue:P.value,"onUpdate:modelValue":l[1]||(l[1]=s=>P.value=s),placeholder:"客服类型",style:{width:"150px","margin-right":"10px"},clearable:""},{default:t(()=>[e(n,{label:"全部",value:""}),e(n,{label:"售后客服",value:d(o).AFTER_SALES},null,8,["value"]),e(n,{label:"审核客服",value:d(o).AUDIT},null,8,["value"]),e(n,{label:"物流客服",value:d(o).LOGISTICS},null,8,["value"]),e(n,{label:"商品客服",value:d(o).PRODUCT},null,8,["value"]),e(n,{label:"通用客服",value:d(o).GENERAL},null,8,["value"])]),_:1},8,["modelValue"]),e(y,{onClick:pe,type:"primary"},{default:t(()=>[...l[18]||(l[18]=[u("搜索",-1)])]),_:1})]),e(ge,{data:ne.value,style:{width:"100%"}},{default:t(()=>[e(h,{prop:"name",label:"姓名",width:"120"}),e(h,{prop:"email",label:"邮箱",width:"200"}),e(h,{prop:"department",label:"部门",width:"120"}),e(h,{label:"客服类型",width:"120"},{default:t(({row:s})=>[e(E,{type:q(s.customerServiceType)},{default:t(()=>[u(w(K(s.customerServiceType)),1)]),_:2},1032,["type"])]),_:1}),e(h,{label:"数据范围",width:"120"},{default:t(({row:s})=>[e(E,{type:j(s.dataScope)},{default:t(()=>[u(w(Q(s.dataScope)),1)]),_:2},1032,["type"])]),_:1}),e(h,{label:"自定义权限","min-width":"200"},{default:t(({row:s})=>{var D;return[a("div",Be,[(v(!0),g($,null,z(s.customPermissions,le=>(v(),F(E,{key:le,size:"small",style:{"margin-right":"5px","margin-bottom":"2px"}},{default:t(()=>[u(w(H(le)),1)]),_:2},1024))),128)),(D=s.customPermissions)!=null&&D.length?N("",!0):(v(),g("span",$e," 无自定义权限 "))])]}),_:1}),e(h,{prop:"status",label:"状态",width:"80"},{default:t(({row:s})=>[e(E,{type:s.status==="active"?"success":"danger"},{default:t(()=>[u(w(s.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(h,{label:"操作",width:"200"},{default:t(({row:s})=>[e(y,{onClick:D=>ve(s),size:"small",type:"primary"},{default:t(()=>[...l[19]||(l[19]=[u(" 配置权限 ",-1)])]),_:1},8,["onClick"]),e(y,{onClick:D=>fe(s),size:"small"},{default:t(()=>[...l[20]||(l[20]=[u(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),e(B,{modelValue:S.value,"onUpdate:modelValue":l[6]||(l[6]=s=>S.value=s),title:`配置客服权限 - ${(Z=p.value)==null?void 0:Z.name}`,width:"800px"},{footer:t(()=>[a("span",We,[e(y,{onClick:l[5]||(l[5]=s=>S.value=!1)},{default:t(()=>[...l[26]||(l[26]=[u("取消",-1)])]),_:1}),e(y,{type:"primary",onClick:_e},{default:t(()=>[...l[27]||(l[27]=[u("保存",-1)])]),_:1})])]),default:t(()=>[e(Y,{model:m.value,"label-width":"120px"},{default:t(()=>[e(V,{label:"客服类型"},{default:t(()=>[e(U,{modelValue:m.value.customerServiceType,"onUpdate:modelValue":l[2]||(l[2]=s=>m.value.customerServiceType=s),style:{width:"100%"}},{default:t(()=>[e(n,{label:"售后客服",value:d(o).AFTER_SALES},null,8,["value"]),e(n,{label:"审核客服",value:d(o).AUDIT},null,8,["value"]),e(n,{label:"物流客服",value:d(o).LOGISTICS},null,8,["value"]),e(n,{label:"商品客服",value:d(o).PRODUCT},null,8,["value"]),e(n,{label:"通用客服",value:d(o).GENERAL},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),e(V,{label:"数据范围"},{default:t(()=>[e(U,{modelValue:m.value.dataScope,"onUpdate:modelValue":l[3]||(l[3]=s=>m.value.dataScope=s),style:{width:"100%"}},{default:t(()=>[e(n,{label:"自定义范围",value:d(f).CUSTOM},null,8,["value"]),e(n,{label:"个人数据",value:d(f).SELF},null,8,["value"]),e(n,{label:"部门数据",value:d(f).DEPARTMENT},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),m.value.dataScope===d(f).DEPARTMENT?(v(),F(V,{key:0,label:"可访问部门"},{default:t(()=>[e(U,{modelValue:m.value.departmentIds,"onUpdate:modelValue":l[4]||(l[4]=s=>m.value.departmentIds=s),multiple:"",placeholder:"选择可访问的部门",style:{width:"100%"}},{default:t(()=>[(v(!0),g($,null,z(c.value,s=>(v(),F(n,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):N("",!0),e(V,{label:"自定义权限"},{default:t(()=>[a("div",ze,[e(d(Pe),{ref_key:"permissionTreeRef",ref:G,data:oe,props:{children:"children",label:"name"},"show-checkbox":"","node-key":"key","default-checked-keys":m.value.customPermissions,onCheck:ye},null,8,["default-checked-keys"])])]),_:1}),e(V,{label:"权限说明"},{default:t(()=>[a("div",Ke,[m.value.customerServiceType===d(o).AFTER_SALES?(v(),g("div",qe,[...l[21]||(l[21]=[a("p",null,[a("strong",null,"售后客服权限说明：")],-1),a("ul",null,[a("li",null,"可以查看和处理所有售后订单"),a("li",null,"可以查看退款、退货相关订单"),a("li",null,"可以处理客户投诉和售后问题")],-1)])])):m.value.customerServiceType===d(o).AUDIT?(v(),g("div",Qe,[...l[22]||(l[22]=[a("p",null,[a("strong",null,"审核客服权限说明：")],-1),a("ul",null,[a("li",null,"可以查看和处理待审核订单"),a("li",null,"可以审核客户信息和订单信息"),a("li",null,"可以批准或拒绝订单审核")],-1)])])):m.value.customerServiceType===d(o).LOGISTICS?(v(),g("div",je,[...l[23]||(l[23]=[a("p",null,[a("strong",null,"物流客服权限说明：")],-1),a("ul",null,[a("li",null,"可以查看和处理物流订单"),a("li",null,"可以更新物流状态和跟踪信息"),a("li",null,"可以处理配送相关问题")],-1)])])):m.value.customerServiceType===d(o).PRODUCT?(v(),g("div",He,[...l[24]||(l[24]=[a("p",null,[a("strong",null,"商品客服权限说明：")],-1),a("ul",null,[a("li",null,"可以查看和管理商品列表"),a("li",null,"可以处理商品相关咨询"),a("li",null,"可以查看所有订单信息")],-1)])])):m.value.customerServiceType===d(o).GENERAL?(v(),g("div",Je,[...l[25]||(l[25]=[a("p",null,[a("strong",null,"通用客服权限说明：")],-1),a("ul",null,[a("li",null,"根据自定义权限配置访问数据"),a("li",null,"可以处理一般性客户咨询"),a("li",null,"权限范围由管理员具体配置")],-1)])])):N("",!0)])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(B,{modelValue:A.value,"onUpdate:modelValue":l[7]||(l[7]=s=>A.value=s),title:`权限详情 - ${(ee=p.value)==null?void 0:ee.name}`,width:"600px"},{default:t(()=>{var s;return[p.value?(v(),g("div",Xe,[e(Te,{column:2,border:""},{default:t(()=>[e(M,{label:"姓名"},{default:t(()=>[u(w(p.value.name),1)]),_:1}),e(M,{label:"邮箱"},{default:t(()=>[u(w(p.value.email),1)]),_:1}),e(M,{label:"部门"},{default:t(()=>[u(w(p.value.department),1)]),_:1}),e(M,{label:"客服类型"},{default:t(()=>[e(E,{type:q(p.value.customerServiceType)},{default:t(()=>[u(w(K(p.value.customerServiceType)),1)]),_:1},8,["type"])]),_:1}),e(M,{label:"数据范围"},{default:t(()=>[e(E,{type:j(p.value.dataScope)},{default:t(()=>[u(w(Q(p.value.dataScope)),1)]),_:1},8,["type"])]),_:1}),e(M,{label:"状态"},{default:t(()=>[e(E,{type:p.value.status==="active"?"success":"danger"},{default:t(()=>[u(w(p.value.status==="active"?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1})]),_:1}),a("div",Ye,[l[28]||(l[28]=a("h4",null,"自定义权限列表：",-1)),(s=p.value.customPermissions)!=null&&s.length?(v(),g("div",Ze,[(v(!0),g($,null,z(p.value.customPermissions,D=>(v(),F(E,{key:D,style:{"margin-right":"8px","margin-bottom":"8px"}},{default:t(()=>[u(w(H(D)),1)]),_:2},1024))),128))])):(v(),g("div",el," 无自定义权限 "))])])):N("",!0)]}),_:1},8,["modelValue","title"]),e(B,{modelValue:x.value,"onUpdate:modelValue":l[12]||(l[12]=s=>x.value=s),title:"批量权限配置",width:"600px"},{footer:t(()=>[e(y,{onClick:l[11]||(l[11]=s=>x.value=!1)},{default:t(()=>[...l[30]||(l[30]=[u("取消",-1)])]),_:1}),e(y,{onClick:ce,type:"primary"},{default:t(()=>[...l[31]||(l[31]=[u("确认配置",-1)])]),_:1})]),default:t(()=>[a("div",ll,[e(be,{title:"批量配置说明",type:"warning",closable:!1,style:{"margin-bottom":"20px"}},{default:t(()=>[...l[29]||(l[29]=[u(" 选择客服类型和权限模板，可以快速为多个客服配置相同的权限设置 ",-1)])]),_:1}),e(Y,{"label-width":"120px"},{default:t(()=>[e(V,{label:"目标客服类型"},{default:t(()=>[e(U,{modelValue:b.value.targetType,"onUpdate:modelValue":l[8]||(l[8]=s=>b.value.targetType=s),placeholder:"选择客服类型"},{default:t(()=>[e(n,{label:"售后客服",value:"after_sales"}),e(n,{label:"审核客服",value:"audit"}),e(n,{label:"物流客服",value:"logistics"}),e(n,{label:"商品客服",value:"product"}),e(n,{label:"通用客服",value:"general"})]),_:1},8,["modelValue"])]),_:1}),e(V,{label:"权限模板"},{default:t(()=>[e(U,{modelValue:b.value.template,"onUpdate:modelValue":l[9]||(l[9]=s=>b.value.template=s),placeholder:"选择权限模板"},{default:t(()=>[e(n,{label:"基础权限",value:"basic"}),e(n,{label:"标准权限",value:"standard"}),e(n,{label:"高级权限",value:"advanced"})]),_:1},8,["modelValue"])]),_:1}),e(V,{label:"数据范围"},{default:t(()=>[e(U,{modelValue:b.value.dataScope,"onUpdate:modelValue":l[10]||(l[10]=s=>b.value.dataScope=s),placeholder:"选择数据范围"},{default:t(()=>[e(n,{label:"个人数据",value:"personal"}),e(n,{label:"部门数据",value:"department"}),e(n,{label:"全部数据",value:"all"})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),a("div",tl,[a("div",al,[a("div",sl,[e(ke,null,{default:t(()=>[e(d(xe))]),_:1}),l[32]||(l[32]=a("span",null,"使用说明",-1))]),l[33]||(l[33]=Le('<div class="info-text" data-v-748914f4><p data-v-748914f4>专门针对客服团队的权限管理工具，支持按业务类型进行权限配置和数据范围控制</p><div class="service-types-simple" data-v-748914f4><span class="type-item" data-v-748914f4>售后客服</span><span class="type-item" data-v-748914f4>审核客服</span><span class="type-item" data-v-748914f4>物流客服</span><span class="type-item" data-v-748914f4>商品客服</span><span class="type-item" data-v-748914f4>通用客服</span></div></div>',1))])])])}}}),ml=Ae(il,[["__scopeId","data-v-748914f4"]]);export{ml as default};
