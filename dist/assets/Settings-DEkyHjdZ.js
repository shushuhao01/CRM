const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/uploadService-C3xZb1GB.js","assets/index-DkAJPKqn.js","assets/vendor-BtukhyiH.js","assets/elementPlus-DxaqjplL.js","assets/utils-DfI7e5Rl.js","assets/index-Cj-RrGL6.css","assets/qr-connection-KDiO-aU-.js"])))=>i.map(i=>d[i]);
import{a as e,_ as t,u as a,I as l,J as o,r as s,l as n}from"./index-DkAJPKqn.js";import{E as i,b as r,C as c,m as u,T as d,t as p,U as m,F as f,H as g,j as v,Z as h,r as y,Y as b,K as _,A as w,e as x,_ as S,$ as C,aa as k,M as V,s as T,az as A,l as D,ai as I,G as E,aP as O,R as z,k as P,aK as N,a4 as U,Q as M,aQ as B,aC as R,aH as $,aj as F}from"./elementPlus-DxaqjplL.js";import{O as L}from"./aliyun-oss-sdk-DCJ43jeS.js";import{l as q,r as j,Z as K,e as J,b as H,w as W,ag as Y,aq as Q,m as X,q as G,p as Z,U as ee,u as te,O as ae,S as le,T as oe,M as se,Q as ne,P as ie,F as re,a9 as ce,J as ue,s as de,z as pe,I as me,n as fe,Y as ge}from"./vendor-BtukhyiH.js";import{u as ve}from"./orderFieldConfig-C2_zIqeo.js";import{T as he,E as ye}from"./style-BM3euvlk.js";import{f as be,s as _e,a as we,b as xe,c as Se,d as Ce,e as ke,h as Ve,i as Te,g as Ae,j as De,k as Ie,l as Ee}from"./alternative-connection-D4UcSKrU.js";import"./utils-DfI7e5Rl.js";class Oe{static instance;ossClient=null;configStore=e();constructor(){this.initOSSClient()}static getInstance(){return Oe.instance||(Oe.instance=new Oe),Oe.instance}async initOSSClient(){try{const e=this.configStore.storageConfig;if("oss"!==e.storageType)return void console.log("当前存储类型不是OSS，跳过初始化");if(!(e.accessKey&&e.secretKey&&e.bucketName&&e.region))return void console.warn("OSS配置不完整，无法初始化客户端");this.ossClient=new L({region:e.region,accessKeyId:e.accessKey,accessKeySecret:e.secretKey,bucket:e.bucketName,endpoint:e.customDomain||void 0,secure:!0,cname:!!e.customDomain})}catch(e){console.error("OSS客户端初始化失败:",e),this.ossClient=null}}isOSSAvailable(){const e=this.configStore.storageConfig;return!!("oss"===e.storageType&&this.ossClient&&e.accessKey&&e.secretKey&&e.bucketName)}getOSSConfigDiagnosis(){const e=this.configStore.storageConfig,t=[];return"oss"!==e.storageType&&t.push("存储类型未设置为OSS"),e.accessKey||t.push("Access Key未配置"),e.secretKey||t.push("Secret Key未配置"),e.bucketName||t.push("Bucket名称未配置"),e.region||t.push("Region未配置"),this.ossClient||t.push("OSS客户端未初始化"),{isAvailable:this.isOSSAvailable(),issues:t,config:{storageType:e.storageType,hasAccessKey:!!e.accessKey,hasSecretKey:!!e.secretKey,hasBucketName:!!e.bucketName,hasRegion:!!e.region,hasClient:!!this.ossClient}}}async diagnoseOSSPermissions(){const e={hasListPermission:!1,hasReadPermission:!1,hasWritePermission:!1,errors:[],recommendations:[]};try{if(this.ossClient||await this.initOSSClient(),!this.ossClient)return e.errors.push("OSS客户端初始化失败"),e.recommendations.push("检查Access Key、Secret Key和Region配置"),e;try{await this.ossClient.list({"max-keys":1}),e.hasListPermission=!0,console.log("✓ List权限测试通过")}catch(t){e.errors.push(`List权限测试失败: ${t.code||t.message}`),"AccessDenied"===t.code&&e.recommendations.push("需要为Access Key添加oss:ListObjects权限")}try{await this.ossClient.get("permission-test-nonexistent-file.txt")}catch(t){"NoSuchKey"===t.code?(e.hasReadPermission=!0,console.log("✓ Read权限测试通过")):"AccessDenied"===t.code?(e.errors.push("Read权限测试失败: 访问被拒绝"),e.recommendations.push("需要为Access Key添加oss:GetObject权限")):e.errors.push(`Read权限测试失败: ${t.code||t.message}`)}try{const t="permission-test",l=`permission-test-${Date.now()}.txt`;await this.ossClient.put(l,Buffer.from(t)),e.hasWritePermission=!0,console.log("✓ Write权限测试通过");try{await this.ossClient.delete(l)}catch(a){console.warn("清理测试文件失败:",a)}}catch(t){e.errors.push(`Write权限测试失败: ${t.code||t.message}`),"AccessDenied"===t.code&&e.recommendations.push("需要为Access Key添加oss:PutObject和oss:DeleteObject权限")}}catch(t){e.errors.push(`权限诊断失败: ${t.message}`)}return e}async testOSSConnection(){try{if(this.ossClient||(console.log("OSS客户端未初始化，尝试重新初始化..."),await this.initOSSClient()),!this.ossClient)return{success:!1,error:"OSS客户端初始化失败，请检查配置"};if("function"!=typeof this.ossClient.list)return console.error("OSS客户端对象:",this.ossClient),console.error("可用方法:",Object.getOwnPropertyNames(this.ossClient)),{success:!1,error:"OSS客户端方法不可用，可能是版本兼容性问题"};const e=this.configStore.storageConfig.bucketName,t=await this.ossClient.list({"max-keys":1});return{success:!0,details:{bucketName:e,region:this.configStore.storageConfig.region,objectCount:t.objects?t.objects.length:0,isTruncated:t.isTruncated||!1}}}catch(e){let a="未知错误",l={},o="";if("RequestError"===e.name||e.message?.includes("XHR error")||e.message?.includes("ERR_FAILED"))a=`OSS错误: ${e.name} - ${e.message}`,o="这可能是CORS配置问题。请检查：\n1. OSS Bucket的CORS规则是否包含当前域名\n2. 允许的方法是否包含GET\n3. 是否使用了正确的协议(HTTPS)",l={name:e.name,message:e.message,status:e.status,code:e.code,corsAdvice:o,currentOrigin:window.location.origin,requestUrl:`https://${this.configStore.storageConfig.bucketName}.${this.configStore.storageConfig.region}.aliyuncs.com/`};else if(e.code){switch(e.code){case"InvalidAccessKeyId":a="Access Key ID无效";break;case"SignatureDoesNotMatch":a="Secret Key错误或签名不匹配";break;case"NoSuchBucket":a="Bucket不存在";break;case"AccessDenied":a="访问被拒绝，请检查权限配置";break;case"RequestTimeTooSkewed":a="请求时间偏差过大，请检查系统时间";break;default:a=`OSS错误: ${e.code} - ${e.message}`}l={code:e.code,message:e.message,requestId:e.requestId}}else a=e.message||"连接失败",l=e;let s=null;if("AccessDenied"===e.code||a.includes("访问被拒绝")){console.log("检测到权限错误，开始权限诊断...");try{s=await this.diagnoseOSSPermissions(),console.log("权限诊断结果:",s)}catch(t){console.error("权限诊断失败:",t)}}return console.error("OSS连接测试失败:",{error:a,details:l,permissionDiagnosis:s,config:{region:this.configStore.storageConfig.region,bucket:this.configStore.storageConfig.bucketName,endpoint:this.configStore.storageConfig.customDomain,hasClient:!!this.ossClient,currentOrigin:window.location.origin}}),{success:!1,error:`${a}${o?" "+o:""}`,details:{...l,permissionDiagnosis:s}}}}async uploadFile(e,t,a){try{if(!this.isOSSAvailable())return{success:!1,error:"OSS服务不可用，请检查配置"};const l=this.generateFileName(e.name),o=t?`${t}/${l}`:l;return{success:!0,url:(await this.ossClient.put(o,e,{progress:e=>{a&&a(Math.round(100*e))}})).url,key:o}}catch(l){return console.error("OSS文件上传失败:",l),{success:!1,error:l instanceof Error?l.message:"上传失败"}}}async deleteFile(e){try{if(!e||"string"!=typeof e)return console.error("OSS文件删除失败: 无效的文件key",{key:e}),!1;if(!this.isOSSAvailable())return console.warn("OSS服务不可用，无法删除文件",{key:e,diagnosis:this.getOSSConfigDiagnosis()}),!1;await this.ossClient.delete(e);return!0}catch(t){if("AccessDenied"===t.code);else{if("NoSuchKey"===t.code)return!0;"InvalidAccessKeyId"===t.code||t.code}return!1}}async listFiles(e,t=100){try{if(!this.isOSSAvailable())return{success:!1,error:"OSS服务不可用"};console.log(`开始列出OSS文件，前缀: ${e||"无"}`);const a=await this.ossClient.list({prefix:e||"","max-keys":t}),l=a.objects?.map(e=>({key:e.name,size:e.size,lastModified:new Date(e.lastModified),etag:e.etag}))||[];return console.log(`OSS文件列表获取成功，共 ${l.length} 个文件`),{success:!0,files:l}}catch(a){return console.error("OSS文件列表获取失败:",{prefix:e,error:a.message||a,code:a.code,requestId:a.requestId}),{success:!1,error:a.message||"获取文件列表失败"}}}async downloadFile(e){try{if(!e||"string"!=typeof e)return{success:!1,error:"无效的文件key"};if(!this.isOSSAvailable())return{success:!1,error:"OSS服务不可用"};console.log(`开始下载OSS文件: ${e}`);const t=await this.ossClient.get(e);if(t.content){const a=t.content.toString();return console.log(`OSS文件下载成功: ${e}，大小: ${a.length} 字符`),{success:!0,content:a,blob:new Blob([a],{type:"application/json"})}}return{success:!1,error:"文件内容为空"}}catch(t){return console.error("OSS文件下载失败:",{key:e,error:t.message||t,code:t.code,requestId:t.requestId}),"NoSuchKey"===t.code?{success:!1,error:"文件不存在"}:"AccessDenied"===t.code?{success:!1,error:"访问被拒绝，请检查权限配置"}:{success:!1,error:t.message||"下载文件失败"}}}getFileUrl(e){const t=this.configStore.storageConfig;return t.customDomain?`${t.customDomain}/${e}`:`https://${t.bucketName}.${t.region}.aliyuncs.com/${e}`}generateFileName(e){return`${Date.now()}_${Math.random().toString(36).substring(2,8)}.${e.split(".").pop()}`}validateFileType(e){const t=this.configStore.storageConfig.allowedTypes.split(",").map(e=>e.trim().toLowerCase()),a=e.name.split(".").pop()?.toLowerCase();return!!a&&t.includes(a)}validateFileSize(e){const t=1024*this.configStore.storageConfig.maxFileSize*1024;return e.size<=t}async reinitialize(){this.ossClient=null,await this.initOSSClient()}}const ze=Oe.getInstance(),Pe=Object.freeze(Object.defineProperty({__proto__:null,OSSService:Oe,ossService:ze},Symbol.toStringTag,{value:"Module"}));class Ne{static instance;configStore=e();syncStatus={isEnabled:!1,syncInProgress:!1,totalItems:0,syncedItems:0,failedItems:0,errors:[]};syncConfig={autoSync:!0,syncInterval:30,syncOnDataChange:!0,backupRetention:5};syncTimer=null;constructor(){this.initializeSync()}static getInstance(){return Ne.instance||(Ne.instance=new Ne),Ne.instance}initializeSync(){this.syncStatus.isEnabled=ze.isOSSAvailable(),this.syncStatus.isEnabled&&this.syncConfig.autoSync&&this.startAutoSync(),this.watchStorageConfig()}watchStorageConfig(){setInterval(()=>{const e=this.syncStatus.isEnabled;this.syncStatus.isEnabled=ze.isOSSAvailable(),!e&&this.syncStatus.isEnabled?this.syncConfig.autoSync&&this.startAutoSync():e&&!this.syncStatus.isEnabled&&this.stopAutoSync()},5e3)}startAutoSync(){this.syncStatus.isEnabled?(this.stopAutoSync(),this.syncTimer=window.setInterval(()=>{this.syncStatus.syncInProgress||this.syncAllData()},60*this.syncConfig.syncInterval*1e3),console.log(`自动同步已启动，间隔: ${this.syncConfig.syncInterval}分钟`)):console.warn("OSS服务不可用，无法启动自动同步")}stopAutoSync(){this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null,console.log("自动同步已停止"))}async syncAllData(){if(!this.syncStatus.isEnabled)return console.warn("OSS服务不可用，无法同步数据"),!1;if(this.syncStatus.syncInProgress)return console.warn("同步正在进行中，请稍后再试"),!1;try{this.syncStatus.syncInProgress=!0,this.syncStatus.syncedItems=0,this.syncStatus.failedItems=0,this.syncStatus.errors=[],console.log("开始同步数据到OSS...");const t=this.getAllLocalData();this.syncStatus.totalItems=t.length;for(const a of t)try{await this.syncSingleData(a),this.syncStatus.syncedItems++}catch(e){this.syncStatus.failedItems++,this.syncStatus.errors.push(`同步 ${a.key} 失败: ${e instanceof Error?e.message:"未知错误"}`)}return this.syncStatus.lastSyncTime=(new Date).toISOString(),console.log(`数据同步完成: 成功 ${this.syncStatus.syncedItems}，失败 ${this.syncStatus.failedItems}`),0===this.syncStatus.failedItems}catch(e){return console.error("数据同步失败:",e),!1}finally{this.syncStatus.syncInProgress=!1}}getAllLocalData(){const e=[];for(let a=0;a<localStorage.length;a++){const l=localStorage.key(a);if(l&&l.startsWith("crm_"))try{const t=localStorage.getItem(l);t&&e.push({key:l,data:JSON.parse(t)})}catch(t){console.warn(`解析本地数据失败: ${l}`,t)}}return e}async syncSingleData(e){const t=`backup/${e.key}_${Date.now()}.json`,a=new Blob([JSON.stringify(e.data,null,2)],{type:"application/json"}),l=new File([a],t,{type:"application/json"}),o=await ze.uploadFile(l,"crm-backup");if(!o.success)throw new Error(o.error||"上传失败")}async restoreFromOSS(){if(!this.syncStatus.isEnabled)return console.warn("OSS服务不可用，无法恢复数据"),!1;try{return console.log("开始从OSS恢复数据..."),console.log("数据恢复功能需要进一步实现"),!0}catch(e){return console.error("从OSS恢复数据失败:",e),!1}}getSyncStatus(){return{...this.syncStatus}}getSyncConfig(){return{...this.syncConfig}}updateSyncConfig(e){Object.assign(this.syncConfig,e),void 0!==e.autoSync&&(e.autoSync&&this.syncStatus.isEnabled?this.startAutoSync():this.stopAutoSync()),void 0!==e.syncInterval&&this.syncConfig.autoSync&&this.startAutoSync()}async cleanupOldBackups(){if(this.syncStatus.isEnabled)try{console.log("清理旧备份文件...")}catch(e){console.error("清理旧备份失败:",e)}}async checkDataIntegrity(){try{const e=this.getAllLocalData();return console.log(`本地数据项数量: ${e.length}`),!0}catch(e){return console.error("数据完整性检查失败:",e),!1}}}const Ue=Ne.getInstance();const Me=new class{dataSyncService=Ue;async saveData(e,t){try{localStorage.setItem(e,JSON.stringify(t));return this.dataSyncService.getSyncConfig().syncOnDataChange&&this.dataSyncService.getSyncStatus().isEnabled&&setTimeout(()=>{this.dataSyncService.syncAllData()},1e3),!0}catch(a){return console.error("保存数据失败:",a),!1}}loadData(e){try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error("加载数据失败:",t),null}}async removeData(e){try{localStorage.removeItem(e);return this.dataSyncService.getSyncConfig().syncOnDataChange&&this.dataSyncService.getSyncStatus().isEnabled&&setTimeout(()=>{this.dataSyncService.syncAllData()},1e3),!0}catch(t){return console.error("删除数据失败:",t),!1}}};const Be=new class{results=[];async runAllTests(){return this.results=[],console.log("开始数据持久性测试..."),await this.testLocalStorage(),await this.testConfigStore(),await this.testEnhancedStorage(),await this.testOSSService(),await this.testDataSyncService(),console.log("数据持久性测试完成"),this.printResults(),this.results}async testLocalStorage(){try{const e="test_local_storage",t={message:"Hello World",timestamp:Date.now()};localStorage.setItem(e,JSON.stringify(t));const a=localStorage.getItem(e),l=a?JSON.parse(a):null,o=l&&l.message===t.message;localStorage.removeItem(e),this.addResult({name:"本地存储功能",passed:o,message:o?"本地存储读写正常":"本地存储读写失败",error:{testData:t,savedData:l}})}catch(e){this.addResult({name:"本地存储功能",passed:!1,message:`本地存储测试失败: ${e instanceof Error?e.message:"未知错误"}`,error:e})}}async testConfigStore(){try{const t=e(),a={...t.systemConfig},l={...a,siteName:"Test Site Name"};t.updateSystemConfig(l);const o="Test Site Name"===t.systemConfig.siteName;t.updateSystemConfig(a),this.addResult({name:"配置存储功能",passed:o,message:o?"配置存储更新正常":"配置存储更新失败",error:{testSystemConfig:l,currentConfig:t.systemConfig}})}catch(t){this.addResult({name:"配置存储功能",passed:!1,message:`配置存储测试失败: ${t instanceof Error?t.message:"未知错误"}`,error:t})}}async testEnhancedStorage(){try{const e="test_enhanced_storage",t={type:"enhanced",value:"test data",timestamp:Date.now()},a=await Me.saveData(e,t),l=Me.loadData(e),o=a&&l&&l.value===t.value;await Me.removeData(e),this.addResult({name:"增强存储服务",passed:o,message:o?"增强存储服务正常":"增强存储服务异常",error:{testData:t,loadedData:l,saveResult:a}})}catch(e){this.addResult({name:"增强存储服务",passed:!1,message:`增强存储服务测试失败: ${e instanceof Error?e.message:"未知错误"}`,error:e})}}async testOSSService(){try{const t=ze.getOSSConfigDiagnosis();if(!t.isAvailable)return void this.addResult({name:"OSS服务可用性",passed:!1,message:`OSS服务不可用: ${t.issues.join(", ")}`,error:{diagnosis:t}});const a=await ze.testOSSConnection();if(this.addResult({name:"OSS连接测试",passed:a.success,message:a.success?"OSS连接成功":`OSS连接失败: ${a.error}`,error:a.success?null:a.details}),!a.success)return;const l=new Blob(["This is a test file for OSS upload"],{type:"text/plain"}),o=new File([l],"test-file.txt",{type:"text/plain"}),s=await ze.uploadFile(o,"test");if(this.addResult({name:"OSS文件上传",passed:s.success,message:s.success?"OSS文件上传成功":`OSS文件上传失败: ${s.error}`,error:{uploadResult:s,fileName:o.name}}),s.success&&s.key)try{const e=await ze.deleteFile(s.key);this.addResult({name:"OSS文件删除",passed:e,message:e?"OSS文件删除成功":"OSS文件删除失败",error:e?null:{fileKey:s.key,url:s.url}})}catch(e){this.addResult({name:"OSS文件删除",passed:!1,message:`OSS文件删除测试失败: ${e instanceof Error?e.message:"未知错误"}`,error:{deleteError:e,fileKey:s.key,url:s.url}})}else s.success&&!s.key&&this.addResult({name:"OSS文件删除",passed:!1,message:"OSS文件删除失败: 上传结果中缺少文件key",error:{uploadResult:s}})}catch(t){this.addResult({name:"OSS服务",passed:!1,message:`OSS服务测试失败: ${t instanceof Error?t.message:"未知错误"}`,error:t})}}async testDataSyncService(){try{const t=Ue.getSyncStatus(),a=Ue.getSyncConfig(),l=await Ue.checkDataIntegrity();if(this.addResult({name:"数据同步服务状态",passed:!0,message:"数据同步服务状态获取正常",error:{syncStatus:t,syncConfig:a,integrityCheck:l}}),t.isEnabled)try{const e=await Ue.checkDataIntegrity();this.addResult({name:"数据同步准备",passed:e,message:e?"数据同步准备就绪":"数据同步准备失败",error:{testSyncResult:e}})}catch(e){this.addResult({name:"数据同步准备",passed:!1,message:`数据同步准备失败: ${e instanceof Error?e.message:"未知错误"}`,error:e})}else this.addResult({name:"数据同步准备",passed:!1,message:"数据同步服务未启用，OSS配置可能不完整",error:{syncStatus:t}})}catch(t){this.addResult({name:"数据同步服务",passed:!1,message:`数据同步服务测试失败: ${t instanceof Error?t.message:"未知错误"}`,error:t})}}addResult(e){this.results.push(e),console.log(`[测试] ${e.name}: ${e.passed?"✅ 通过":"❌ 失败"} - ${e.message}`)}printResults(){const e=this.results.length,t=this.results.filter(e=>e.passed).length,a=e-t;console.log("\n=== 数据持久性测试结果摘要 ==="),console.log(`总测试数: ${e}`),console.log(`通过: ${t}`),console.log(`失败: ${a}`),console.log(`成功率: ${(t/e*100).toFixed(1)}%`),a>0&&(console.log("\n失败的测试:"),this.results.filter(e=>!e.passed).forEach(e=>{console.log(`- ${e.name}: ${e.message}`)}))}getResults(){return[...this.results]}getSummary(){const e=this.results.length,t=this.results.filter(e=>e.passed).length;return{total:e,passed:t,failed:e-t,successRate:e>0?t/e*100:0}}};async function Re(){return await Be.runAllTests()}"undefined"!=typeof window&&(window.testDataPersistence=Re().dataPersistenceTest=Be);const $e=new class{configStore=e();autoBackupTimer=null;getDefaultBackupConfig(){return{enabled:!1,autoBackupInterval:24,maxBackupCount:30,backupPath:"backups/data",includeStores:["crm_store_customer","crm_store_order","crm_store_product","crm_store_performance","crm_store_department","crm_store_service","crm_store_config"],excludeKeys:["test_","temp_","cache_"]}}getBackupConfig(){const e=localStorage.getItem("crm_backup_config");if(e)try{return{...this.getDefaultBackupConfig(),...JSON.parse(e)}}catch(t){console.error("备份配置解析失败:",t)}return this.getDefaultBackupConfig()}saveBackupConfig(e){localStorage.setItem("crm_backup_config",JSON.stringify(e)),this.setupAutoBackup()}async setBackupConfig(e){this.saveBackupConfig(e),this.setupAutoBackup(),console.log("备份配置已更新并重新启动自动备份")}collectBackupData(e){const t={};let a=0,l=0;for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);if(!n)continue;const i=e.includeStores.some(e=>n.startsWith(e))||n.startsWith("crm_"),r=e.excludeKeys.some(e=>n.includes(e));if(i&&!r)try{const e=localStorage.getItem(n);e&&(t[n]=JSON.parse(e),a+=n.length+e.length,l++)}catch(o){console.warn(`备份数据时跳过无效键 ${n}:`,o)}}return{version:"1.0.0",timestamp:Date.now(),data:t,metadata:{userAgent:navigator.userAgent,url:window.location.href,totalSize:a,itemCount:l}}}async performManualBackup(){try{if(!ze.isOSSAvailable())return i.error("OSS未配置或不可用，无法执行备份"),!1;const e=this.getBackupConfig(),t=this.collectBackupData(e),a=(new Date).toISOString().replace(/[:.]/g,"-"),l=`${e.backupPath}/manual-backup-${a}.json`,o=JSON.stringify(t,null,2),s=new Blob([o],{type:"application/json"}),n=new File([s],`manual-backup-${a}.json`,{type:"application/json"}),r=await ze.uploadFile(n,l);return r.success?(localStorage.setItem("crm_last_backup_time",Date.now().toString()),i.success(`手动备份成功！备份了 ${t.metadata.itemCount} 项数据`),await this.cleanupOldBackups(e),!0):(i.error(`备份失败: ${r.error}`),!1)}catch(e){return console.error("手动备份失败:",e),i.error(`备份失败: ${e instanceof Error?e.message:"未知错误"}`),!1}}async performAutoBackup(){try{if(!ze.isOSSAvailable())return console.warn("OSS未配置或不可用，跳过自动备份"),!1;const e=this.getBackupConfig();if(!e.enabled)return!1;const t=this.collectBackupData(e),a=(new Date).toISOString().replace(/[:.]/g,"-"),l=`${e.backupPath}/auto-backup-${a}.json`,o=JSON.stringify(t,null,2),s=new Blob([o],{type:"application/json"}),n=new File([s],`auto-backup-${a}.json`,{type:"application/json"}),i=await ze.uploadFile(n,l);return i.success?(localStorage.setItem("crm_last_backup_time",Date.now().toString()),console.log(`自动备份成功！备份了 ${t.metadata.itemCount} 项数据`),await this.cleanupOldBackups(e),!0):(console.error(`自动备份失败: ${i.error}`),!1)}catch(e){return console.error("自动备份失败:",e),!1}}async getBackupList(){try{if(!ze.isOSSAvailable())throw new Error("OSS未配置或不可用");const t=this.getBackupConfig(),a=await ze.listFiles(t.backupPath,1e3);if(!a.success)throw new Error(a.error||"获取备份列表失败");const l=a.files?.filter(e=>e.key.endsWith(".json")&&(e.key.includes("manual-backup-")||e.key.includes("auto-backup-")))||[],o=[];for(const s of l)try{const e=s.key.split("/").pop()||s.key,t=e.match(/(\d{4}-\d{2}-\d{2}T\d{2}-\d{2}-\d{2})/);let a=s.lastModified.getTime();if(t){const e=t[1].replace(/-/g,":").replace("T","T").slice(0,-3)+":"+t[1].slice(-3),l=new Date(e.replace(/-/g,":"));isNaN(l.getTime())||(a=l.getTime())}o.push({filename:e,timestamp:a,size:s.size,version:"1.0.0",itemCount:0})}catch(e){console.warn("解析备份文件信息失败:",s.key,e)}return o.sort((e,t)=>t.timestamp-e.timestamp),console.log(`获取到 ${o.length} 个备份文件`),o}catch(e){throw console.error("获取备份列表失败:",e),e}}async restoreFromBackup(e){try{if("confirm"!==await r.confirm("恢复备份将覆盖当前所有数据，此操作不可撤销。是否继续？","确认恢复",{confirmButtonText:"确定恢复",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!1}))return!1;if(!ze.isOSSAvailable())return i.error("OSS未配置或不可用，无法恢复备份"),!1;const a=`${this.getBackupConfig().backupPath}/${e}`,l=await ze.downloadFile(a);if(!l.success)return i.error(`下载备份文件失败: ${l.error}`),!1;if(!l.content)return i.error("备份文件内容为空"),!1;let o;try{o=JSON.parse(l.content)}catch(t){return i.error("备份文件格式错误，无法解析"),!1}if(!o.data||!o.version||!o.timestamp)return i.error("备份文件格式不正确"),!1;let s=0;for(const[e,n]of Object.entries(o.data))try{"string"==typeof n?localStorage.setItem(e,n):localStorage.setItem(e,JSON.stringify(n)),s++}catch(t){console.warn(`恢复数据项失败: ${e}`,t)}return localStorage.setItem("crm_last_restore_time",Date.now().toString()),localStorage.setItem("crm_last_restore_file",e),i.success(`数据恢复成功！恢复了 ${s} 项数据，页面将自动刷新`),setTimeout(()=>{window.location.reload()},2e3),!0}catch(t){return"cancel"===t||(console.error("恢复备份失败:",t),i.error(`恢复失败: ${t instanceof Error?t.message:"未知错误"}`)),!1}}async cleanupOldBackups(e){try{if(e.maxBackupCount<=0)return;const a=await this.getBackupList();if(a.length<=e.maxBackupCount)return void console.log(`当前备份数量 ${a.length}，未超过限制 ${e.maxBackupCount}，无需清理`);const l=a.sort((e,t)=>t.timestamp-e.timestamp).slice(e.maxBackupCount);console.log(`开始清理 ${l.length} 个旧备份`);let o=0;for(const s of l)try{const t=`${e.backupPath}/${s.filename}`;await ze.deleteFile(t)?(o++,console.log(`删除旧备份成功: ${s.filename}`)):console.warn(`删除旧备份失败: ${s.filename}`)}catch(t){console.error(`删除备份文件失败: ${s.filename}`,t)}console.log(`清理旧备份完成，成功删除 ${o} 个文件`)}catch(t){console.error("清理旧备份失败:",t)}}setupAutoBackup(){this.autoBackupTimer&&(clearInterval(this.autoBackupTimer),this.autoBackupTimer=null);const e=this.getBackupConfig();if(!e.enabled||e.autoBackupInterval<=0)return;const t=60*e.autoBackupInterval*60*1e3;this.autoBackupTimer=window.setInterval(()=>{this.performAutoBackup()},t),console.log(`自动备份已设置，间隔: ${e.autoBackupInterval} 小时`)}stopAutoBackup(){this.autoBackupTimer&&(clearInterval(this.autoBackupTimer),this.autoBackupTimer=null,console.log("自动备份已停止"))}initialize(){this.setupAutoBackup(),window.addEventListener("beforeunload",()=>{this.stopAutoBackup()})}getBackupStats(){const e=this.getBackupConfig(),t=this.collectBackupData(e),a=localStorage.getItem("crm_last_backup_time"),l=a?new Date(parseInt(a)).toLocaleString():null;return{totalItems:t.metadata.itemCount,totalSize:this.formatFileSize(t.metadata.totalSize),lastBackup:l}}formatFileSize(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]}};function Fe(){const e={test_customer_data:JSON.stringify([{id:1,name:"测试客户1",phone:"13800138001"},{id:2,name:"测试客户2",phone:"13800138002"}]),test_order_data:JSON.stringify([{id:1,customerId:1,amount:1e3,status:"已完成"},{id:2,customerId:2,amount:2e3,status:"进行中"}]),test_config:JSON.stringify({theme:"dark",language:"zh-CN",autoSave:!0}),test_user_preferences:JSON.stringify({sidebarCollapsed:!1,tablePageSize:20,notifications:!0})};Object.entries(e).forEach(([e,t])=>{localStorage.setItem(e,t)}),console.log("测试数据已创建:",e),i.success("测试数据创建成功")}async function Le(){try{console.log("开始测试手动备份功能..."),Fe();return await $e.performManualBackup()?(console.log("手动备份测试成功"),i.success("手动备份测试成功"),!0):(console.error("手动备份测试失败"),i.error("手动备份测试失败"),!1)}catch(e){return console.error("手动备份测试异常:",e),i.error(`手动备份测试异常: ${e}`),!1}}async function qe(){try{console.log("开始测试备份列表功能...");const e=await $e.getBackupList();return console.log("备份列表:",e),i.success(`获取到 ${e.length} 个备份文件`),!0}catch(e){return console.error("备份列表测试失败:",e),i.error(`备份列表测试失败: ${e}`),!1}}async function je(){try{console.log("开始测试备份配置功能...");const e=$e.getDefaultBackupConfig();console.log("默认配置:",e);const t={...e,enabled:!0,autoBackupInterval:2,maxBackupCount:5};await $e.setBackupConfig(t);const a=$e.getBackupConfig();return console.log("保存的配置:",a),a.enabled===t.enabled&&a.autoBackupInterval===t.autoBackupInterval?(console.log("备份配置测试成功"),i.success("备份配置测试成功"),!0):(console.error("备份配置测试失败: 配置不匹配"),i.error("备份配置测试失败: 配置不匹配"),!1)}catch(e){return console.error("备份配置测试异常:",e),i.error(`备份配置测试异常: ${e}`),!1}}async function Ke(){console.log("开始运行备份服务测试套件...");const e=[{name:"备份配置测试",fn:je},{name:"手动备份测试",fn:Le},{name:"备份列表测试",fn:qe}],t=[];for(const s of e)try{console.log(`\n=== ${s.name} ===`);const e=await s.fn();t.push({name:s.name,success:e}),await new Promise(e=>setTimeout(e,1e3))}catch(o){console.error(`${s.name} 执行异常:`,o),t.push({name:s.name,success:!1})}console.log("\n=== 测试结果汇总 ==="),t.forEach(e=>{console.log(`${e.name}: ${e.success?"✅ 通过":"❌ 失败"}`)});const a=t.filter(e=>e.success).length,l=t.length;a===l?i.success(`所有测试通过 (${a}/${l})`):i.warning(`部分测试失败 (${a}/${l})`),console.log(`测试完成: ${a}/${l} 通过`)}$e.initialize(),"undefined"!=typeof window&&(window.backupTests={createTestData:Fe,cleanupTestData:function(){["test_customer_data","test_order_data","test_config","test_user_preferences"].forEach(e=>{localStorage.removeItem(e)}),console.log("测试数据已清理"),i.success("测试数据清理完成")},verifyTestData:function(){const e=["test_customer_data","test_order_data","test_config","test_user_preferences"].filter(e=>!localStorage.getItem(e));return e.length>0?(console.warn("缺少测试数据:",e),i.warning(`缺少测试数据: ${e.join(", ")}`),!1):(console.log("测试数据验证通过"),i.success("测试数据验证通过"),!0)},testManualBackup:Le,testBackupList:qe,testBackupConfig:je,runAllTests:Ke},console.log("备份测试工具已加载，可在控制台使用 window.backupTests"));class Je{async exportAllData(){try{const t={customers:[],orders:[],products:[],departments:[],users:[],configs:{}},a=localStorage.getItem("customers");a&&(t.customers=JSON.parse(a));const l=localStorage.getItem("orders");l&&(t.orders=JSON.parse(l));const o=localStorage.getItem("products");o&&(t.products=JSON.parse(o));const s=localStorage.getItem("departments");s&&(t.departments=JSON.parse(s));const n=localStorage.getItem("userDatabase");n&&(t.users=JSON.parse(n));const i={};for(let u=0;u<localStorage.length;u++){const t=localStorage.key(u);if(t&&t.startsWith("crm_config_"))try{const e=localStorage.getItem(t);e&&(i[t]=JSON.parse(e))}catch(e){console.warn(`解析配置失败: ${t}`,e)}}t.configs=i;const r=JSON.stringify(t).length;t.metadata={exportTime:(new Date).toISOString(),version:"1.0.0",totalSize:r,itemCount:t.customers.length+t.orders.length+t.products.length+t.departments.length+t.users.length},console.log("[数据导出] 导出完成:",{customers:t.customers.length,orders:t.orders.length,products:t.products.length,departments:t.departments.length,users:t.users.length,configs:Object.keys(t.configs).length,totalSize:this.formatBytes(r)});const c=this.getDataStatistics(t);return this.downloadAsJson(t),{success:!0,data:t,statistics:c}}catch(e){return console.error("[数据导出] 导出失败:",e),{success:!1,error:e instanceof Error?e.message:"未知错误"}}}async validateData(){try{const e=await this.exportAllData();if(!e.success||!e.data)return{issues:["无法读取数据"],warnings:[],summary:{totalIssues:1,totalWarnings:0,isValid:!1}};const t=e.data,a=[],l=[];return t.customers.forEach((e,t)=>{e.name||a.push(`客户 ${t+1}: 缺少姓名`),e.phone||e.email||l.push(`客户 ${t+1}: 缺少联系方式`),e.id||a.push(`客户 ${t+1}: 缺少ID`)}),t.orders.forEach((e,t)=>{e.orderNumber||a.push(`订单 ${t+1}: 缺少订单号`),e.customerId||a.push(`订单 ${t+1}: 缺少客户ID`),e.products&&0!==e.products.length||a.push(`订单 ${t+1}: 缺少商品信息`),(!e.totalAmount||e.totalAmount<=0)&&l.push(`订单 ${t+1}: 订单金额异常`)}),t.products.forEach((e,t)=>{e.name||a.push(`产品 ${t+1}: 缺少产品名称`),(!e.price||e.price<=0)&&a.push(`产品 ${t+1}: 价格无效`),e.id||a.push(`产品 ${t+1}: 缺少ID`)}),t.departments.forEach((e,t)=>{e.name||a.push(`部门 ${t+1}: 缺少部门名称`),e.id||a.push(`部门 ${t+1}: 缺少ID`)}),t.users.forEach((e,t)=>{e.username||a.push(`用户 ${t+1}: 缺少用户名`),e.name||l.push(`用户 ${t+1}: 缺少姓名`),e.role||l.push(`用户 ${t+1}: 缺少角色`)}),console.log("[数据验证] 验证完成:",{totalIssues:a.length,totalWarnings:l.length,isValid:0===a.length}),{issues:a,warnings:l,summary:{totalIssues:a.length,totalWarnings:l.length,isValid:0===a.length}}}catch(e){return console.error("[数据验证] 验证失败:",e),{issues:["数据验证失败: "+(e instanceof Error?e.message:"未知错误")],warnings:[],summary:{totalIssues:1,totalWarnings:0,isValid:!1}}}}getDataStatistics(e){if(!e){e={customers:JSON.parse(localStorage.getItem("customers")||"[]"),orders:JSON.parse(localStorage.getItem("orders")||"[]"),products:JSON.parse(localStorage.getItem("products")||"[]"),departments:JSON.parse(localStorage.getItem("departments")||"[]"),users:JSON.parse(localStorage.getItem("userDatabase")||"[]"),configs:{}};for(let t=0;t<localStorage.length;t++){const l=localStorage.key(t);if(l&&l.startsWith("crm_config_"))try{const t=localStorage.getItem(l);t&&(e.configs[l]=JSON.parse(t))}catch(a){console.warn(`解析配置失败: ${l}`,a)}}}const t=JSON.stringify(e).length;return{customers:e.customers.length,orders:e.orders.length,products:e.products.length,departments:e.departments.length,users:e.users.length,configs:Object.keys(e.configs).length,totalSize:t,totalSizeFormatted:this.formatBytes(t),exportTime:(new Date).toLocaleString()}}downloadAsJson(e,t=`crm_data_export_${Date.now()}.json`){try{const a=JSON.stringify(e,null,2),l=new Blob([a],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(l),o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),setTimeout(()=>URL.revokeObjectURL(o.href),100),console.log("[数据导出] 文件下载成功:",t)}catch(a){throw console.error("[数据导出] 文件下载失败:",a),a}}formatBytes(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]}}const He={class:"sms-management"},We={class:"management-header"},Ye={class:"header-content"},Qe={class:"header-right"},Xe={class:"stats-overview"},Ge={class:"stats-grid"},Ze={class:"stat-item pending"},et={class:"stat-icon"},tt={class:"stat-content"},at={class:"stat-number"},lt={class:"stat-action"},ot={class:"stat-item sms"},st={class:"stat-icon"},nt={class:"stat-content"},it={class:"stat-number"},rt={class:"stat-action"},ct={class:"stat-item today"},ut={class:"stat-icon"},dt={class:"stat-content"},pt={class:"stat-number"},mt={class:"stat-item total"},ft={class:"stat-icon"},gt={class:"stat-content"},vt={class:"stat-number"},ht={class:"management-tabs"},yt={class:"tab-header"},bt={class:"tab-title"},_t={class:"tab-actions"},wt={class:"templates-list"},xt={class:"template-info"},St={class:"template-header"},Ct={class:"template-name"},kt={class:"template-meta"},Vt={class:"apply-time"},Tt={class:"template-content"},At={class:"content-text"},Dt={key:0,class:"variables"},It={key:0,class:"template-description"},Et={class:"desc-text"},Ot={class:"applicant-info"},zt={class:"applicant-name"},Pt={class:"applicant-dept"},Nt={class:"template-actions"},Ut={class:"tab-header"},Mt={class:"tab-title"},Bt={class:"tab-actions"},Rt={class:"sms-list"},$t={class:"sms-info"},Ft={class:"sms-header"},Lt={class:"sms-title"},qt={class:"sms-meta"},jt={class:"recipient-count"},Kt={class:"apply-time"},Jt={class:"sms-content"},Ht={class:"content-text"},Wt={class:"recipients-info"},Yt={class:"recipients-list"},Qt={key:0,class:"more-recipients"},Xt={key:0,class:"sms-reason"},Gt={class:"reason-text"},Zt={class:"applicant-info"},ea={class:"applicant-name"},ta={class:"applicant-dept"},aa={key:0,class:"sms-actions"},la={key:1,class:"sms-result"},oa={class:"result-info"},sa={class:"result-time"},na={class:"tab-header"},ia={class:"tab-actions"},ra={class:"records-table"},ca={class:"content-preview"},ua={class:"recipient-count"},da={class:"success-stats"},pa={class:"success"},ma={class:"failed"},fa={class:"pagination-section"},ga={key:0,class:"template-preview-content"},va={class:"preview-header"},ha={class:"preview-body"},ya={class:"content-section"},ba={class:"content-display"},_a={key:0,class:"variables-section"},wa={class:"variables-display"},xa={class:"meta-section"},Sa={class:"meta-item"},Ca={class:"value"},ka={class:"meta-item"},Va={class:"value"},Ta={class:"meta-item"},Aa={class:"value"},Da={key:1,class:"description-section"},Ia={class:"description-display"},Ea={key:0,class:"sms-detail-content"},Oa={class:"detail-header"},za={class:"detail-body"},Pa={class:"content-section"},Na={class:"content-display"},Ua={class:"recipients-section"},Ma={class:"recipients-table"},Ba={class:"meta-section"},Ra={class:"meta-item"},$a={class:"value"},Fa={class:"meta-item"},La={class:"value"},qa={class:"meta-item"},ja={class:"value"},Ka={key:0,class:"meta-item"},Ja={class:"value"},Ha={key:0,class:"reason-section"},Wa={class:"reason-display"},Ya=q({__name:"SmsManagement",setup(e){const t=j("templates"),a=j(!1),l=j(!1),o=j(!1),s=j(!1),n=j(!1),b=j(""),_=j(""),w=j(""),x=j(""),S=j(null),C=j(null),k=j(null),V=K({pendingTemplates:0,pendingSms:0,todaySent:0,totalSent:0}),T=j([]),A=j([]),D=j([]),I=K({currentPage:1,pageSize:20,total:0}),E=J(()=>{if(!b.value)return T.value;const e=b.value.toLowerCase();return T.value.filter(t=>t.name.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.applicantName.toLowerCase().includes(e))}),O=J(()=>{let e=A.value;if(w.value&&(e=e.filter(e=>e.status===w.value)),_.value){const t=_.value.toLowerCase();e=e.filter(e=>e.content.toLowerCase().includes(t)||e.applicantName.toLowerCase().includes(t)||e.recipients.some(e=>e.name.toLowerCase().includes(t)||e.phone.includes(t)))}return e}),z=async()=>{a.value=!0;try{await new Promise(e=>setTimeout(e,500)),T.value=[{id:"1",name:"营销推广模板",content:"【限时优惠】{name}，{product}现在只要{price}元！立即购买享受{discount}折优惠，活动截止{endTime}。",category:"marketing",variables:["name","product","price","discount","endTime"],description:"用于产品促销活动的短信推广，需要向客户发送优惠信息",applicantName:"张三",applicantDept:"市场部",createdAt:"2024-01-22 11:20:00"},{id:"2",name:"会议通知模板",content:"尊敬的{name}，您有一场会议将于{time}在{location}举行，主题：{topic}，请准时参加。",category:"notification",variables:["name","time","location","topic"],description:"用于公司内部会议通知，提醒员工参加重要会议",applicantName:"李四",applicantDept:"行政部",createdAt:"2024-01-21 15:30:00"}]}catch(e){i.error("加载待审核模板失败")}finally{a.value=!1}},P=async()=>{l.value=!0;try{await new Promise(e=>setTimeout(e,500)),A.value=[{id:"1",templateName:"验证码模板",content:"您的验证码是123456，请在5分钟内使用，请勿泄露给他人。",recipients:[{name:"王五",phone:"13800138001",department:"技术部",status:"pending"},{name:"赵六",phone:"13800138002",department:"产品部",status:"pending"}],reason:"系统测试需要发送验证码",status:"pending",applicantName:"王五",applicantDept:"技术部",createdAt:"2024-01-22 14:30:00"},{id:"2",templateName:"订单通知",content:"您的订单ORD123456已确认，金额299元，预计明天送达。",recipients:[{name:"客户A",phone:"13900139001",department:"客户",status:"pending"},{name:"客户B",phone:"13900139002",department:"客户",status:"pending"},{name:"客户C",phone:"13900139003",department:"客户",status:"pending"}],reason:"订单确认通知，需要及时告知客户",status:"approved",applicantName:"李四",applicantDept:"销售部",createdAt:"2024-01-21 16:45:00",processedAt:"2024-01-21 17:00:00"}]}catch(e){i.error("加载短信申请失败")}finally{l.value=!1}},N=async()=>{o.value=!0;try{await new Promise(e=>setTimeout(e,500)),D.value=[{id:"1",templateName:"验证码模板",content:"您的验证码是123456，请在5分钟内使用，请勿泄露给他人。",recipientCount:150,status:"success",successCount:148,failedCount:2,sentAt:"2024-01-22 10:30:00",operator:"管理员"},{id:"2",templateName:"订单通知",content:"您的订单已确认，请注意查收。",recipientCount:89,status:"success",successCount:89,failedCount:0,sentAt:"2024-01-21 15:20:00",operator:"张三"}],I.total=D.value.length}catch(e){i.error("加载发送记录失败")}finally{o.value=!1}},U=async()=>{try{V.pendingTemplates=T.value.length,V.pendingSms=A.value.filter(e=>"pending"===e.status).length,V.todaySent=1250,V.totalSent=15680}catch(e){i.error("加载统计数据失败")}},M=()=>{i.info("跳转到模板创建页面")},B=()=>{i.info("打开短信发送对话框")},R=e=>{I.pageSize=e,N()},$=e=>{I.currentPage=e,N()},F=e=>({marketing:"营销推广",notification:"系统通知",verification:"验证码",order:"订单提醒"}[e]||"其他"),L=e=>({pending:"warning",approved:"success",rejected:"danger"}[e]||"info"),q=e=>({pending:"待审核",approved:"已通过",rejected:"已拒绝"}[e]||"未知"),de=e=>({success:"发送成功",failed:"发送失败",sending:"发送中"}[e]||"未知"),pe=e=>e||"-";return H(()=>{(async()=>{await Promise.all([z(),P(),N(),U()])})()}),W(t,e=>{"records"===e&&N()}),(e,z)=>{const P=Y("el-button"),U=Y("el-icon"),j=Y("el-badge"),K=Y("el-input"),J=Y("el-tag"),H=Y("el-empty"),W=Y("el-tab-pane"),me=Y("el-option"),fe=Y("el-select"),ge=Y("el-date-picker"),ve=Y("el-table-column"),he=Y("el-table"),ye=Y("el-pagination"),be=Y("el-tabs"),_e=Y("el-card"),we=Y("el-dialog"),xe=Q("loading");return G(),X("div",He,[Z("div",We,[Z("div",Ye,[z[14]||(z[14]=Z("div",{class:"header-left"},[Z("h2",{class:"header-title"},"短信管理中心"),Z("p",{class:"header-subtitle"},"审核模板申请、管理短信发送和查看统计数据")],-1)),Z("div",Qe,[ee(P,{type:"primary",icon:te(c),onClick:M,class:"create-btn"},{default:ae(()=>[...z[12]||(z[12]=[le(" 创建模板 ",-1)])]),_:1},8,["icon"]),ee(P,{type:"success",icon:te(u),onClick:B,class:"send-btn"},{default:ae(()=>[...z[13]||(z[13]=[le(" 发送短信 ",-1)])]),_:1},8,["icon"])])])]),Z("div",Xe,[Z("div",Ge,[Z("div",Ze,[Z("div",et,[ee(U,null,{default:ae(()=>[ee(te(d))]),_:1})]),Z("div",tt,[Z("div",at,oe(V.pendingTemplates),1),z[15]||(z[15]=Z("div",{class:"stat-label"},"待审核模板",-1))]),Z("div",lt,[V.pendingTemplates>0?(G(),se(P,{key:0,size:"small",type:"warning",onClick:z[0]||(z[0]=e=>t.value="templates")},{default:ae(()=>[...z[16]||(z[16]=[le(" 立即处理 ",-1)])]),_:1})):ne("",!0)])]),Z("div",ot,[Z("div",st,[ee(U,null,{default:ae(()=>[ee(te(u))]),_:1})]),Z("div",nt,[Z("div",it,oe(V.pendingSms),1),z[17]||(z[17]=Z("div",{class:"stat-label"},"待审核短信",-1))]),Z("div",rt,[V.pendingSms>0?(G(),se(P,{key:0,size:"small",type:"primary",onClick:z[1]||(z[1]=e=>t.value="sms")},{default:ae(()=>[...z[18]||(z[18]=[le(" 立即处理 ",-1)])]),_:1})):ne("",!0)])]),Z("div",ct,[Z("div",ut,[ee(U,null,{default:ae(()=>[ee(te(p))]),_:1})]),Z("div",dt,[Z("div",pt,oe(V.todaySent),1),z[19]||(z[19]=Z("div",{class:"stat-label"},"今日发送",-1))])]),Z("div",mt,[Z("div",ft,[ee(U,null,{default:ae(()=>[ee(te(m))]),_:1})]),Z("div",gt,[Z("div",vt,oe(V.totalSent),1),z[20]||(z[20]=Z("div",{class:"stat-label"},"总发送量",-1))])])])]),Z("div",ht,[ee(_e,{class:"tabs-card"},{default:ae(()=>[ee(be,{modelValue:t.value,"onUpdate:modelValue":z[9]||(z[9]=e=>t.value=e),class:"management-tabs-content"},{default:ae(()=>[ee(W,{label:"模板审核",name:"templates"},{default:ae(()=>[Z("div",yt,[Z("div",bt,[z[21]||(z[21]=Z("h3",null,"模板审核",-1)),T.value.length>0?(G(),se(j,{key:0,value:T.value.length,class:"badge"},null,8,["value"])):ne("",!0)]),Z("div",_t,[ee(K,{modelValue:b.value,"onUpdate:modelValue":z[2]||(z[2]=e=>b.value=e),placeholder:"搜索模板","prefix-icon":te(f),clearable:"",style:{width:"250px"}},null,8,["modelValue","prefix-icon"])])]),ie((G(),X("div",wt,[(G(!0),X(re,null,ce(E.value,e=>(G(),X("div",{key:e.id,class:"template-item"},[Z("div",xt,[Z("div",St,[Z("h4",Ct,oe(e.name),1),Z("div",kt,[ee(J,{size:"small",type:"info"},{default:ae(()=>[le(oe(F(e.category)),1)]),_:2},1024),Z("span",Vt,oe(pe(e.createdAt)),1)])]),Z("div",Tt,[Z("p",At,oe(e.content),1),e.variables?.length?(G(),X("div",Dt,[z[22]||(z[22]=Z("span",{class:"variables-label"},"变量：",-1)),(G(!0),X(re,null,ce(e.variables,e=>(G(),se(J,{key:e,size:"small",class:"variable-tag"},{default:ae(()=>[le(oe(e),1)]),_:2},1024))),128))])):ne("",!0)]),e.description?(G(),X("div",It,[z[23]||(z[23]=Z("span",{class:"desc-label"},"申请说明：",-1)),Z("p",Et,oe(e.description),1)])):ne("",!0),Z("div",Ot,[z[24]||(z[24]=Z("span",{class:"applicant-label"},"申请人：",-1)),Z("span",zt,oe(e.applicantName),1),Z("span",Pt,oe(e.applicantDept),1)])]),Z("div",Nt,[ee(P,{type:"success",icon:te(g),onClick:t=>(async e=>{try{await r.confirm("确定要审核通过这个模板吗？","确认审核",{type:"warning"}),await new Promise(e=>setTimeout(e,1e3));const t=T.value.findIndex(t=>t.id===e.id);t>-1&&(T.value.splice(t,1),V.pendingTemplates--),i.success("模板审核通过")}catch(t){}})(e),class:"approve-btn"},{default:ae(()=>[...z[25]||(z[25]=[le(" 通过 ",-1)])]),_:1},8,["icon","onClick"]),ee(P,{type:"danger",icon:te(v),onClick:t=>(async e=>{try{const{value:t}=await r.prompt("请输入拒绝原因","审核拒绝",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{5,}/,inputErrorMessage:"拒绝原因至少5个字符"});await new Promise(e=>setTimeout(e,1e3));const a=T.value.findIndex(t=>t.id===e.id);a>-1&&(T.value.splice(a,1),V.pendingTemplates--),i.success("模板已拒绝")}catch(t){}})(e),class:"reject-btn"},{default:ae(()=>[...z[26]||(z[26]=[le(" 拒绝 ",-1)])]),_:1},8,["icon","onClick"]),ee(P,{type:"info",icon:te(h),onClick:t=>(e=>{C.value=e,s.value=!0})(e),class:"preview-btn"},{default:ae(()=>[...z[27]||(z[27]=[le(" 预览 ",-1)])]),_:1},8,["icon","onClick"])])]))),128)),0!==E.value.length||a.value?ne("",!0):(G(),se(H,{key:0,description:"暂无待审核模板","image-size":120}))])),[[xe,a.value]])]),_:1}),ee(W,{label:"短信审核",name:"sms"},{default:ae(()=>[Z("div",Ut,[Z("div",Mt,[z[28]||(z[28]=Z("h3",null,"短信审核",-1)),A.value.length>0?(G(),se(j,{key:0,value:A.value.length,class:"badge"},null,8,["value"])):ne("",!0)]),Z("div",Bt,[ee(fe,{modelValue:w.value,"onUpdate:modelValue":z[3]||(z[3]=e=>w.value=e),placeholder:"状态筛选",style:{width:"120px","margin-right":"12px"}},{default:ae(()=>[ee(me,{label:"全部",value:""}),ee(me,{label:"待审核",value:"pending"}),ee(me,{label:"已通过",value:"approved"}),ee(me,{label:"已拒绝",value:"rejected"})]),_:1},8,["modelValue"]),ee(K,{modelValue:_.value,"onUpdate:modelValue":z[4]||(z[4]=e=>_.value=e),placeholder:"搜索内容或接收人","prefix-icon":te(f),clearable:"",style:{width:"250px"}},null,8,["modelValue","prefix-icon"])])]),ie((G(),X("div",Rt,[(G(!0),X(re,null,ce(O.value,e=>(G(),X("div",{key:e.id,class:ue(["sms-item",{approved:"approved"===e.status,rejected:"rejected"===e.status}])},[Z("div",$t,[Z("div",Ft,[Z("div",Lt,[Z("h4",null,oe(e.templateName||"自定义内容"),1),ee(J,{type:L(e.status),size:"small"},{default:ae(()=>[le(oe(q(e.status)),1)]),_:2},1032,["type"])]),Z("div",qt,[Z("span",jt,oe(e.recipients.length)+" 人",1),Z("span",Kt,oe(pe(e.createdAt)),1)])]),Z("div",Jt,[Z("p",Ht,oe(e.content),1)]),Z("div",Wt,[z[29]||(z[29]=Z("span",{class:"recipients-label"},"接收人：",-1)),Z("div",Yt,[(G(!0),X(re,null,ce(e.recipients.slice(0,5),(e,t)=>(G(),se(J,{key:t,size:"small",class:"recipient-tag"},{default:ae(()=>[le(oe(e.name)+" ("+oe(e.phone)+") ",1)]),_:2},1024))),128)),e.recipients.length>5?(G(),X("span",Qt," 等 "+oe(e.recipients.length)+" 人 ",1)):ne("",!0)])]),e.reason?(G(),X("div",Xt,[z[30]||(z[30]=Z("span",{class:"reason-label"},"发送原因：",-1)),Z("p",Gt,oe(e.reason),1)])):ne("",!0),Z("div",Zt,[z[31]||(z[31]=Z("span",{class:"applicant-label"},"申请人：",-1)),Z("span",ea,oe(e.applicantName),1),Z("span",ta,oe(e.applicantDept),1)])]),"pending"===e.status?(G(),X("div",aa,[ee(P,{type:"success",icon:te(g),onClick:t=>(async e=>{try{await r.confirm("确定要审核通过这条短信申请吗？","确认审核",{type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.status="approved",e.processedAt=(new Date).toLocaleString(),V.pendingSms--,i.success("短信申请已通过，将立即发送")}catch(t){}})(e),class:"approve-btn"},{default:ae(()=>[...z[32]||(z[32]=[le(" 通过 ",-1)])]),_:1},8,["icon","onClick"]),ee(P,{type:"danger",icon:te(v),onClick:t=>(async e=>{try{const{value:t}=await r.prompt("请输入拒绝原因","审核拒绝",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{5,}/,inputErrorMessage:"拒绝原因至少5个字符"});await new Promise(e=>setTimeout(e,1e3)),e.status="rejected",e.processedAt=(new Date).toLocaleString(),e.rejectReason=t,V.pendingSms--,i.success("短信申请已拒绝")}catch(t){}})(e),class:"reject-btn"},{default:ae(()=>[...z[33]||(z[33]=[le(" 拒绝 ",-1)])]),_:1},8,["icon","onClick"]),ee(P,{type:"info",icon:te(h),onClick:t=>(e=>{k.value=e,n.value=!0})(e),class:"preview-btn"},{default:ae(()=>[...z[34]||(z[34]=[le(" 详情 ",-1)])]),_:1},8,["icon","onClick"])])):(G(),X("div",la,[Z("div",oa,[z[35]||(z[35]=Z("span",{class:"result-label"},"处理结果：",-1)),Z("span",{class:ue(["result-text",e.status])},oe(q(e.status)),3)]),Z("div",sa,[Z("span",null,oe(pe(e.processedAt)),1)])]))],2))),128)),0!==O.value.length||l.value?ne("",!0):(G(),se(H,{key:0,description:"暂无短信记录","image-size":120}))])),[[xe,l.value]])]),_:1}),ee(W,{label:"发送记录",name:"records"},{default:ae(()=>[Z("div",na,[z[37]||(z[37]=Z("div",{class:"tab-title"},[Z("h3",null,"发送记录")],-1)),Z("div",ia,[ee(ge,{modelValue:S.value,"onUpdate:modelValue":z[5]||(z[5]=e=>S.value=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{"margin-right":"12px"}},null,8,["modelValue"]),ee(fe,{modelValue:x.value,"onUpdate:modelValue":z[6]||(z[6]=e=>x.value=e),placeholder:"状态筛选",style:{width:"120px","margin-right":"12px"}},{default:ae(()=>[ee(me,{label:"全部",value:""}),ee(me,{label:"发送成功",value:"success"}),ee(me,{label:"发送失败",value:"failed"}),ee(me,{label:"发送中",value:"sending"})]),_:1},8,["modelValue"]),ee(P,{type:"primary",icon:te(y),onClick:N},{default:ae(()=>[...z[36]||(z[36]=[le("刷新",-1)])]),_:1},8,["icon"])])]),Z("div",ra,[ie((G(),se(he,{data:D.value,stripe:"",style:{width:"100%"}},{default:ae(()=>[ee(ve,{prop:"templateName",label:"模板名称",width:"150"},{default:ae(({row:e})=>[Z("span",null,oe(e.templateName||"自定义内容"),1)]),_:1}),ee(ve,{prop:"content",label:"短信内容","min-width":"200"},{default:ae(({row:e})=>[Z("div",ca,oe(e.content),1)]),_:1}),ee(ve,{prop:"recipientCount",label:"接收人数",width:"100",align:"center"},{default:ae(({row:e})=>[Z("span",ua,oe(e.recipientCount),1)]),_:1}),ee(ve,{prop:"status",label:"发送状态",width:"100"},{default:ae(({row:e})=>{return[ee(J,{type:(t=e.status,{success:"success",failed:"danger",sending:"warning"}[t]||"info"),size:"small"},{default:ae(()=>[le(oe(de(e.status)),1)]),_:2},1032,["type"])];var t}),_:1}),ee(ve,{prop:"successCount",label:"成功/失败",width:"100",align:"center"},{default:ae(({row:e})=>[Z("div",da,[Z("span",pa,oe(e.successCount),1),z[38]||(z[38]=Z("span",{class:"divider"},"/",-1)),Z("span",ma,oe(e.failedCount),1)])]),_:1}),ee(ve,{prop:"sentAt",label:"发送时间",width:"160"},{default:ae(({row:e})=>[Z("span",null,oe(pe(e.sentAt)),1)]),_:1}),ee(ve,{prop:"operator",label:"操作人",width:"120"},{default:ae(({row:e})=>[Z("span",null,oe(e.operator),1)]),_:1}),ee(ve,{label:"操作",width:"120",fixed:"right"},{default:ae(({row:e})=>[ee(P,{size:"small",type:"primary",icon:te(h),onClick:e=>{i.info("查看发送记录详情")}},{default:ae(()=>[...z[39]||(z[39]=[le(" 详情 ",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[xe,o.value]]),Z("div",fa,[ee(ye,{"current-page":I.currentPage,"onUpdate:currentPage":z[7]||(z[7]=e=>I.currentPage=e),"page-size":I.pageSize,"onUpdate:pageSize":z[8]||(z[8]=e=>I.pageSize=e),"page-sizes":[10,20,50,100],total:I.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:$},null,8,["current-page","page-size","total"])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),ee(we,{modelValue:s.value,"onUpdate:modelValue":z[10]||(z[10]=e=>s.value=e),title:"模板预览",width:"600px",class:"preview-dialog"},{default:ae(()=>[C.value?(G(),X("div",ga,[Z("div",va,[Z("h4",null,oe(C.value.name),1),ee(J,{type:"warning"},{default:ae(()=>[...z[40]||(z[40]=[le("待审核",-1)])]),_:1})]),Z("div",ha,[Z("div",ya,[z[41]||(z[41]=Z("h5",null,"模板内容",-1)),Z("div",ba,oe(C.value.content),1)]),C.value.variables?.length?(G(),X("div",_a,[z[42]||(z[42]=Z("h5",null,"变量列表",-1)),Z("div",wa,[(G(!0),X(re,null,ce(C.value.variables,e=>(G(),se(J,{key:e,class:"variable-tag"},{default:ae(()=>[le(oe(e),1)]),_:2},1024))),128))])])):ne("",!0),Z("div",xa,[Z("div",Sa,[z[43]||(z[43]=Z("span",{class:"label"},"分类：",-1)),Z("span",Ca,oe(F(C.value.category)),1)]),Z("div",ka,[z[44]||(z[44]=Z("span",{class:"label"},"申请人：",-1)),Z("span",Va,oe(C.value.applicantName),1)]),Z("div",Ta,[z[45]||(z[45]=Z("span",{class:"label"},"申请时间：",-1)),Z("span",Aa,oe(pe(C.value.createdAt)),1)])]),C.value.description?(G(),X("div",Da,[z[46]||(z[46]=Z("h5",null,"申请说明",-1)),Z("div",Ia,oe(C.value.description),1)])):ne("",!0)])])):ne("",!0)]),_:1},8,["modelValue"]),ee(we,{modelValue:n.value,"onUpdate:modelValue":z[11]||(z[11]=e=>n.value=e),title:"短信详情",width:"800px",class:"detail-dialog"},{default:ae(()=>[k.value?(G(),X("div",Ea,[Z("div",Oa,[Z("h4",null,oe(k.value.templateName||"自定义短信"),1),ee(J,{type:L(k.value.status)},{default:ae(()=>[le(oe(q(k.value.status)),1)]),_:1},8,["type"])]),Z("div",za,[Z("div",Pa,[z[47]||(z[47]=Z("h5",null,"短信内容",-1)),Z("div",Na,oe(k.value.content),1)]),Z("div",Ua,[Z("h5",null,"接收人列表 ("+oe(k.value.recipients.length)+" 人)",1),Z("div",Ma,[ee(he,{data:k.value.recipients,"max-height":"300"},{default:ae(()=>[ee(ve,{prop:"name",label:"姓名",width:"120"}),ee(ve,{prop:"phone",label:"手机号",width:"140"}),ee(ve,{prop:"department",label:"部门",width:"120"}),ee(ve,{prop:"status",label:"发送状态",width:"100"},{default:ae(({row:e})=>[ee(J,{type:"success"===e.status?"success":"failed"===e.status?"danger":"warning",size:"small"},{default:ae(()=>[le(oe("success"===e.status?"成功":"failed"===e.status?"失败":"待发送"),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])])]),Z("div",Ba,[Z("div",Ra,[z[48]||(z[48]=Z("span",{class:"label"},"申请人：",-1)),Z("span",$a,oe(k.value.applicantName),1)]),Z("div",Fa,[z[49]||(z[49]=Z("span",{class:"label"},"申请部门：",-1)),Z("span",La,oe(k.value.applicantDept),1)]),Z("div",qa,[z[50]||(z[50]=Z("span",{class:"label"},"申请时间：",-1)),Z("span",ja,oe(pe(k.value.createdAt)),1)]),k.value.processedAt?(G(),X("div",Ka,[z[51]||(z[51]=Z("span",{class:"label"},"处理时间：",-1)),Z("span",Ja,oe(pe(k.value.processedAt)),1)])):ne("",!0)]),k.value.reason?(G(),X("div",Ha,[z[52]||(z[52]=Z("h5",null,"发送原因",-1)),Z("div",Wa,oe(k.value.reason),1)])):ne("",!0)])])):ne("",!0)]),_:1},8,["modelValue"])])}}}),Qa=t(Ya,[["__scopeId","data-v-440989b0"]]),Xa={class:"health-check-notification-settings"},Ga={class:"card-header"},Za={key:0,class:"no-permission"},el={key:1,class:"settings-content"},tl={class:"status-section"},al={class:"preference-section"},ll={class:"current-preference"},ol={class:"suppress-time"},sl={class:"suppress-time"},nl={class:"last-notification"},il={class:"test-section"},rl={class:"info-section"},cl=t(q({__name:"HealthCheckNotificationSettings",setup(e){const t=a(),s=j(!1),n=j({suppressType:"none",suppressUntil:null,lastNotificationTime:null}),c=J(()=>t.isSuperAdmin),u=J(()=>l.isApiMode()),d=J(()=>{const e=localStorage.getItem("api_health_check_errors");return e&&JSON.parse(e).count||0}),p=J(()=>{const e=localStorage.getItem("api_health_check_errors");if(e){const t=JSON.parse(e);return t.lastCheck?new Date(t.lastCheck).toLocaleString():null}return null}),m=J(()=>"none"===n.value.suppressType),f=()=>{switch(n.value.suppressType){case"none":return"正常接收";case"today":return"今天已暂停";case"month":return"一个月已暂停";default:return"未知状态"}},g=e=>e?new Date(e).toLocaleString():"",v=async e=>{const a=t.currentUser?.id;if(a)try{if("none"===e)n.value={suppressType:"none",suppressUntil:null,lastNotificationTime:n.value.lastNotificationTime},o.clearAllPreferences(),i.success("已恢复API健康检查通知");else{const t=Date.now();let l;if("today"===e){const e=new Date;e.setDate(e.getDate()+1),e.setHours(0,0,0,0),l=e.getTime(),i.success("已设置今天不再提醒API健康检查失败")}else l=t+2592e6,i.success("已设置一个月内不再提醒API健康检查失败");n.value={suppressType:e,suppressUntil:l,lastNotificationTime:n.value.lastNotificationTime};o.setSuppression(a,e)}}catch(l){console.error("设置通知偏好失败:",l),i.error("设置失败，请重试")}else i.error("用户信息获取失败")},h=async()=>{s.value=!0;try{await o.showHealthCheckFailureNotification("这是一个测试通知")}catch(e){console.error("测试通知失败:",e)}finally{s.value=!1}},y=async()=>{try{await r.confirm("确定要清除所有用户的通知偏好设置吗？此操作不可撤销。","确认清除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),o.clearAllPreferences(),b(),i.success("已清除所有通知偏好设置")}catch{}},b=()=>{const e=t.currentUser?.id;if(!e)return;const a=o.getUserPreference(e);a&&(n.value={suppressType:a.suppressType,suppressUntil:a.suppressUntil,lastNotificationTime:a.lastNotificationTime})};return H(()=>{b()}),(e,t)=>{const a=Y("el-tag"),l=Y("el-result"),o=Y("el-descriptions-item"),i=Y("el-descriptions"),r=Y("el-form-item"),b=Y("el-button"),_=Y("el-button-group"),w=Y("el-form"),x=Y("el-alert"),S=Y("el-card");return G(),X("div",Xa,[ee(S,{class:"setting-card"},{header:ae(()=>[Z("div",Ga,[t[4]||(t[4]=Z("span",null,"API健康检查通知设置",-1)),c.value?ne("",!0):(G(),se(a,{key:0,type:"info",size:"small"},{default:ae(()=>[...t[3]||(t[3]=[le(" 仅超级管理员可见 ",-1)])]),_:1}))])]),default:ae(()=>[c.value?(G(),X("div",el,[Z("div",tl,[t[5]||(t[5]=Z("h4",null,"当前状态",-1)),ee(i,{column:2,border:""},{default:ae(()=>[ee(o,{label:"API状态"},{default:ae(()=>[ee(a,{type:u.value?"success":"danger"},{default:ae(()=>[le(oe(u.value?"正常":"异常"),1)]),_:1},8,["type"])]),_:1}),ee(o,{label:"通知状态"},{default:ae(()=>[ee(a,{type:m.value?"success":"warning"},{default:ae(()=>[le(oe(f()),1)]),_:1},8,["type"])]),_:1}),ee(o,{label:"上次检查时间"},{default:ae(()=>[le(oe(p.value||"暂无"),1)]),_:1}),ee(o,{label:"错误次数"},{default:ae(()=>[le(oe(d.value),1)]),_:1})]),_:1})]),Z("div",al,[t[12]||(t[12]=Z("h4",null,"通知偏好",-1)),ee(w,{model:n.value,"label-width":"140px"},{default:ae(()=>[ee(r,{label:"当前设置"},{default:ae(()=>[Z("div",ll,["none"===n.value.suppressType?(G(),se(a,{key:0,type:"success"},{default:ae(()=>[...t[6]||(t[6]=[le(" 正常接收通知 ",-1)])]),_:1})):"today"===n.value.suppressType?(G(),se(a,{key:1,type:"warning"},{default:ae(()=>[t[7]||(t[7]=le(" 今天不再提醒 ",-1)),Z("span",ol," (至 "+oe(g(n.value.suppressUntil))+") ",1)]),_:1})):"month"===n.value.suppressType?(G(),se(a,{key:2,type:"info"},{default:ae(()=>[t[8]||(t[8]=le(" 一个月不再提醒 ",-1)),Z("span",sl," (至 "+oe(g(n.value.suppressUntil))+") ",1)]),_:1})):ne("",!0)])]),_:1}),ee(r,{label:"快速设置"},{default:ae(()=>[ee(_,null,{default:ae(()=>[ee(b,{onClick:t[0]||(t[0]=e=>v("none")),type:"none"===n.value.suppressType?"primary":"default"},{default:ae(()=>[...t[9]||(t[9]=[le(" 恢复通知 ",-1)])]),_:1},8,["type"]),ee(b,{onClick:t[1]||(t[1]=e=>v("today")),type:"today"===n.value.suppressType?"primary":"default"},{default:ae(()=>[...t[10]||(t[10]=[le(" 今天不再提醒 ",-1)])]),_:1},8,["type"]),ee(b,{onClick:t[2]||(t[2]=e=>v("month")),type:"month"===n.value.suppressType?"primary":"default"},{default:ae(()=>[...t[11]||(t[11]=[le(" 一个月不再提醒 ",-1)])]),_:1},8,["type"])]),_:1})]),_:1}),ee(r,{label:"上次通知时间"},{default:ae(()=>[Z("span",nl,oe(n.value.lastNotificationTime?new Date(n.value.lastNotificationTime).toLocaleString():"暂无通知记录"),1)]),_:1})]),_:1},8,["model"])]),Z("div",il,[t[17]||(t[17]=Z("h4",null,"测试功能",-1)),ee(w,{"label-width":"140px"},{default:ae(()=>[ee(r,{label:"手动测试"},{default:ae(()=>[ee(b,{onClick:h,loading:s.value,type:"warning"},{default:ae(()=>[...t[13]||(t[13]=[le(" 模拟API失败通知 ",-1)])]),_:1},8,["loading"]),t[14]||(t[14]=Z("span",{class:"test-tip"}," 点击此按钮可以测试API健康检查失败时的通知效果 ",-1))]),_:1}),ee(r,{label:"清除设置"},{default:ae(()=>[ee(b,{onClick:y,type:"danger",plain:""},{default:ae(()=>[...t[15]||(t[15]=[le(" 清除所有通知偏好 ",-1)])]),_:1}),t[16]||(t[16]=Z("span",{class:"clear-tip"}," 清除所有用户的通知偏好设置，恢复默认状态 ",-1))]),_:1})]),_:1})]),Z("div",rl,[ee(x,{title:"功能说明",type:"info",closable:!1,"show-icon":""},{default:ae(()=>[...t[18]||(t[18]=[Z("ul",{class:"info-list"},[Z("li",null,"API健康检查每12小时自动执行一次（每天2次）"),Z("li",null,"只有超级管理员才能看到API失败通知"),Z("li",null,'可以设置"今天不再提醒"或"一个月不再提醒"'),Z("li",null,"系统会自动记住您的通知偏好设置"),Z("li",null,"API恢复正常后，错误计数会自动重置")],-1)])]),_:1})])])):(G(),X("div",Za,[ee(l,{icon:"info",title:"权限提示","sub-title":"API健康检查通知功能仅对超级管理员开放"})]))]),_:1})])}}}),[["__scopeId","data-v-617f40f4"]]);
/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function ul(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,l)}return a}function dl(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ul(Object(a),!0).forEach(function(t){ml(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ul(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function pl(e){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function fl(){return fl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},fl.apply(this,arguments)}function gl(e,t){if(null==e)return{};var a,l,o=function(e,t){if(null==e)return{};var a,l,o={},s=Object.keys(e);for(l=0;l<s.length;l++)a=s[l],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)a=s[l],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}function vl(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var hl=vl(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),yl=vl(/Edge/i),bl=vl(/firefox/i),_l=vl(/safari/i)&&!vl(/chrome/i)&&!vl(/android/i),wl=vl(/iP(ad|od|hone)/i),xl=vl(/chrome/i)&&vl(/android/i),Sl={capture:!1,passive:!1};function Cl(e,t,a){e.addEventListener(t,a,!hl&&Sl)}function kl(e,t,a){e.removeEventListener(t,a,!hl&&Sl)}function Vl(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(a){return!1}return!1}}function Tl(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Al(e,t,a,l){if(e){a=a||document;do{if(null!=t&&(">"===t[0]?e.parentNode===a&&Vl(e,t):Vl(e,t))||l&&e===a)return e;if(e===a)break}while(e=Tl(e))}return null}var Dl,Il=/\s+/g;function El(e,t,a){if(e&&t)if(e.classList)e.classList[a?"add":"remove"](t);else{var l=(" "+e.className+" ").replace(Il," ").replace(" "+t+" "," ");e.className=(l+(a?" "+t:"")).replace(Il," ")}}function Ol(e,t,a){var l=e&&e.style;if(l){if(void 0===a)return document.defaultView&&document.defaultView.getComputedStyle?a=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(a=e.currentStyle),void 0===t?a:a[t];t in l||-1!==t.indexOf("webkit")||(t="-webkit-"+t),l[t]=a+("string"==typeof a?"":"px")}}function zl(e,t){var a="";if("string"==typeof e)a=e;else do{var l=Ol(e,"transform");l&&"none"!==l&&(a=l+" "+a)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(a)}function Pl(e,t,a){if(e){var l=e.getElementsByTagName(t),o=0,s=l.length;if(a)for(;o<s;o++)a(l[o],o);return l}return[]}function Nl(){var e=document.scrollingElement;return e||document.documentElement}function Ul(e,t,a,l,o){if(e.getBoundingClientRect||e===window){var s,n,i,r,c,u,d;if(e!==window&&e.parentNode&&e!==Nl()?(n=(s=e.getBoundingClientRect()).top,i=s.left,r=s.bottom,c=s.right,u=s.height,d=s.width):(n=0,i=0,r=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(t||a)&&e!==window&&(o=o||e.parentNode,!hl))do{if(o&&o.getBoundingClientRect&&("none"!==Ol(o,"transform")||a&&"static"!==Ol(o,"position"))){var p=o.getBoundingClientRect();n-=p.top+parseInt(Ol(o,"border-top-width")),i-=p.left+parseInt(Ol(o,"border-left-width")),r=n+s.height,c=i+s.width;break}}while(o=o.parentNode);if(l&&e!==window){var m=zl(o||e),f=m&&m.a,g=m&&m.d;m&&(r=(n/=g)+(u/=g),c=(i/=f)+(d/=f))}return{top:n,left:i,bottom:r,right:c,width:d,height:u}}}function Ml(e,t,a){for(var l=Ll(e,!0),o=Ul(e)[t];l;){if(!(o>=Ul(l)[a]))return l;if(l===Nl())break;l=Ll(l,!1)}return!1}function Bl(e,t,a,l){for(var o=0,s=0,n=e.children;s<n.length;){if("none"!==n[s].style.display&&n[s]!==Ho.ghost&&(l||n[s]!==Ho.dragged)&&Al(n[s],a.draggable,e,!1)){if(o===t)return n[s];o++}s++}return null}function Rl(e,t){for(var a=e.lastElementChild;a&&(a===Ho.ghost||"none"===Ol(a,"display")||t&&!Vl(a,t));)a=a.previousElementSibling;return a||null}function $l(e,t){var a=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Ho.clone||t&&!Vl(e,t)||a++;return a}function Fl(e){var t=0,a=0,l=Nl();if(e)do{var o=zl(e),s=o.a,n=o.d;t+=e.scrollLeft*s,a+=e.scrollTop*n}while(e!==l&&(e=e.parentNode));return[t,a]}function Ll(e,t){if(!e||!e.getBoundingClientRect)return Nl();var a=e,l=!1;do{if(a.clientWidth<a.scrollWidth||a.clientHeight<a.scrollHeight){var o=Ol(a);if(a.clientWidth<a.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||a.clientHeight<a.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!a.getBoundingClientRect||a===document.body)return Nl();if(l||t)return a;l=!0}}}while(a=a.parentNode);return Nl()}function ql(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function jl(e,t){return function(){if(!Dl){var a=arguments;1===a.length?e.call(this,a[0]):e.apply(this,a),Dl=setTimeout(function(){Dl=void 0},t)}}}function Kl(e,t,a){e.scrollLeft+=t,e.scrollTop+=a}function Jl(e){var t=window.Polymer,a=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):a?a(e).clone(!0)[0]:e.cloneNode(!0)}function Hl(e,t,a){var l={};return Array.from(e.children).forEach(function(o){var s,n,i,r;if(Al(o,t.draggable,e,!1)&&!o.animated&&o!==a){var c=Ul(o);l.left=Math.min(null!==(s=l.left)&&void 0!==s?s:1/0,c.left),l.top=Math.min(null!==(n=l.top)&&void 0!==n?n:1/0,c.top),l.right=Math.max(null!==(i=l.right)&&void 0!==i?i:-1/0,c.right),l.bottom=Math.max(null!==(r=l.bottom)&&void 0!==r?r:-1/0,c.bottom)}}),l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}var Wl="Sortable"+(new Date).getTime();function Yl(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach(function(e){if("none"!==Ol(e,"display")&&e!==Ho.ghost){t.push({target:e,rect:Ul(e)});var a=dl({},t[t.length-1].rect);if(e.thisAnimationDuration){var l=zl(e,!0);l&&(a.top-=l.f,a.left-=l.e)}e.fromRect=a}})},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var a in e)if(e.hasOwnProperty(a))for(var l in t)if(t.hasOwnProperty(l)&&t[l]===e[a][l])return Number(a);return-1}(t,{target:e}),1)},animateAll:function(a){var l=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof a&&a());var o=!1,s=0;t.forEach(function(e){var t=0,a=e.target,n=a.fromRect,i=Ul(a),r=a.prevFromRect,c=a.prevToRect,u=e.rect,d=zl(a,!0);d&&(i.top-=d.f,i.left-=d.e),a.toRect=i,a.thisAnimationDuration&&ql(r,i)&&!ql(n,i)&&(u.top-i.top)/(u.left-i.left)===(n.top-i.top)/(n.left-i.left)&&(t=function(e,t,a,l){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-a.top,2)+Math.pow(t.left-a.left,2))*l.animation}(u,r,c,l.options)),ql(i,n)||(a.prevFromRect=n,a.prevToRect=i,t||(t=l.options.animation),l.animate(a,u,i,t)),t&&(o=!0,s=Math.max(s,t),clearTimeout(a.animationResetTimer),a.animationResetTimer=setTimeout(function(){a.animationTime=0,a.prevFromRect=null,a.fromRect=null,a.prevToRect=null,a.thisAnimationDuration=null},t),a.thisAnimationDuration=t)}),clearTimeout(e),o?e=setTimeout(function(){"function"==typeof a&&a()},s):"function"==typeof a&&a(),t=[]},animate:function(e,t,a,l){if(l){Ol(e,"transition",""),Ol(e,"transform","");var o=zl(this.el),s=o&&o.a,n=o&&o.d,i=(t.left-a.left)/(s||1),r=(t.top-a.top)/(n||1);e.animatingX=!!i,e.animatingY=!!r,Ol(e,"transform","translate3d("+i+"px,"+r+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),Ol(e,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),Ol(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){Ol(e,"transition",""),Ol(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},l)}}}}var Ql=[],Xl={initializeByDefault:!0},Gl={mount:function(e){for(var t in Xl)Xl.hasOwnProperty(t)&&!(t in e)&&(e[t]=Xl[t]);Ql.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ql.push(e)},pluginEvent:function(e,t,a){var l=this;this.eventCanceled=!1,a.cancel=function(){l.eventCanceled=!0};var o=e+"Global";Ql.forEach(function(l){t[l.pluginName]&&(t[l.pluginName][o]&&t[l.pluginName][o](dl({sortable:t},a)),t.options[l.pluginName]&&t[l.pluginName][e]&&t[l.pluginName][e](dl({sortable:t},a)))})},initializePlugins:function(e,t,a,l){for(var o in Ql.forEach(function(l){var o=l.pluginName;if(e.options[o]||l.initializeByDefault){var s=new l(e,t,e.options);s.sortable=e,s.options=e.options,e[o]=s,fl(a,s.defaults)}}),e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);void 0!==s&&(e.options[o]=s)}},getEventProperties:function(e,t){var a={};return Ql.forEach(function(l){"function"==typeof l.eventProperties&&fl(a,l.eventProperties.call(t[l.pluginName],e))}),a},modifyOption:function(e,t,a){var l;return Ql.forEach(function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(l=o.optionListeners[t].call(e[o.pluginName],a))}),l}};var Zl=["evt"],eo=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=a.evt,o=gl(a,Zl);Gl.pluginEvent.bind(Ho)(e,t,dl({dragEl:ao,parentEl:lo,ghostEl:oo,rootEl:so,nextEl:no,lastDownEl:io,cloneEl:ro,cloneHidden:co,dragStarted:So,putSortable:vo,activeSortable:Ho.active,originalEvent:l,oldIndex:uo,oldDraggableIndex:mo,newIndex:po,newDraggableIndex:fo,hideGhostForTarget:qo,unhideGhostForTarget:jo,cloneNowHidden:function(){co=!0},cloneNowShown:function(){co=!1},dispatchSortableEvent:function(e){to({sortable:t,name:e,originalEvent:l})}},o))};function to(e){!function(e){var t=e.sortable,a=e.rootEl,l=e.name,o=e.targetEl,s=e.cloneEl,n=e.toEl,i=e.fromEl,r=e.oldIndex,c=e.newIndex,u=e.oldDraggableIndex,d=e.newDraggableIndex,p=e.originalEvent,m=e.putSortable,f=e.extraEventProperties;if(t=t||a&&a[Wl]){var g,v=t.options,h="on"+l.charAt(0).toUpperCase()+l.substr(1);!window.CustomEvent||hl||yl?(g=document.createEvent("Event")).initEvent(l,!0,!0):g=new CustomEvent(l,{bubbles:!0,cancelable:!0}),g.to=n||a,g.from=i||a,g.item=o||a,g.clone=s,g.oldIndex=r,g.newIndex=c,g.oldDraggableIndex=u,g.newDraggableIndex=d,g.originalEvent=p,g.pullMode=m?m.lastPutMode:void 0;var y=dl(dl({},f),Gl.getEventProperties(l,t));for(var b in y)g[b]=y[b];a&&a.dispatchEvent(g),v[h]&&v[h].call(t,g)}}(dl({putSortable:vo,cloneEl:ro,targetEl:ao,rootEl:so,oldIndex:uo,oldDraggableIndex:mo,newIndex:po,newDraggableIndex:fo},e))}var ao,lo,oo,so,no,io,ro,co,uo,po,mo,fo,go,vo,ho,yo,bo,_o,wo,xo,So,Co,ko,Vo,To,Ao=!1,Do=!1,Io=[],Eo=!1,Oo=!1,zo=[],Po=!1,No=[],Uo="undefined"!=typeof document,Mo=wl,Bo=yl||hl?"cssFloat":"float",Ro=Uo&&!xl&&!wl&&"draggable"in document.createElement("div"),$o=function(){if(Uo){if(hl)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Fo=function(e,t){var a=Ol(e),l=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),o=Bl(e,0,t),s=Bl(e,1,t),n=o&&Ol(o),i=s&&Ol(s),r=n&&parseInt(n.marginLeft)+parseInt(n.marginRight)+Ul(o).width,c=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+Ul(s).width;if("flex"===a.display)return"column"===a.flexDirection||"column-reverse"===a.flexDirection?"vertical":"horizontal";if("grid"===a.display)return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&n.float&&"none"!==n.float){var u="left"===n.float?"left":"right";return!s||"both"!==i.clear&&i.clear!==u?"horizontal":"vertical"}return o&&("block"===n.display||"flex"===n.display||"table"===n.display||"grid"===n.display||r>=l&&"none"===a[Bo]||s&&"none"===a[Bo]&&r+c>l)?"vertical":"horizontal"},Lo=function(e){function t(e,a){return function(l,o,s,n){var i=l.options.group.name&&o.options.group.name&&l.options.group.name===o.options.group.name;if(null==e&&(a||i))return!0;if(null==e||!1===e)return!1;if(a&&"clone"===e)return e;if("function"==typeof e)return t(e(l,o,s,n),a)(l,o,s,n);var r=(a?l:o).options.group.name;return!0===e||"string"==typeof e&&e===r||e.join&&e.indexOf(r)>-1}}var a={},l=e.group;l&&"object"==pl(l)||(l={name:l}),a.name=l.name,a.checkPull=t(l.pull,!0),a.checkPut=t(l.put),a.revertClone=l.revertClone,e.group=a},qo=function(){!$o&&oo&&Ol(oo,"display","none")},jo=function(){!$o&&oo&&Ol(oo,"display","")};Uo&&!xl&&document.addEventListener("click",function(e){if(Do)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Do=!1,!1},!0);var Ko=function(e){if(ao){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,s=e.clientY,Io.some(function(e){var t=e[Wl].options.emptyInsertThreshold;if(t&&!Rl(e)){var a=Ul(e),l=o>=a.left-t&&o<=a.right+t,i=s>=a.top-t&&s<=a.bottom+t;return l&&i?n=e:void 0}}),n);if(t){var a={};for(var l in e)e.hasOwnProperty(l)&&(a[l]=e[l]);a.target=a.rootEl=t,a.preventDefault=void 0,a.stopPropagation=void 0,t[Wl]._onDragOver(a)}}var o,s,n},Jo=function(e){ao&&ao.parentNode[Wl]._isOutsideThisEl(e.target)};function Ho(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=fl({},t),e[Wl]=this;var a={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Fo(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Ho.supportPointer&&"PointerEvent"in window&&(!_l||wl),emptyInsertThreshold:5};for(var l in Gl.initializePlugins(this,e,a),a)!(l in t)&&(t[l]=a[l]);for(var o in Lo(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&Ro,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Cl(e,"pointerdown",this._onTapStart):(Cl(e,"mousedown",this._onTapStart),Cl(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Cl(e,"dragover",this),Cl(e,"dragenter",this)),Io.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),fl(this,Yl())}function Wo(e,t,a,l,o,s,n,i){var r,c,u=e[Wl],d=u.options.onMove;return!window.CustomEvent||hl||yl?(r=document.createEvent("Event")).initEvent("move",!0,!0):r=new CustomEvent("move",{bubbles:!0,cancelable:!0}),r.to=t,r.from=e,r.dragged=a,r.draggedRect=l,r.related=o||t,r.relatedRect=s||Ul(t),r.willInsertAfter=i,r.originalEvent=n,e.dispatchEvent(r),d&&(c=d.call(u,r,n)),c}function Yo(e){e.draggable=!1}function Qo(){Po=!1}function Xo(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,a=t.length,l=0;a--;)l+=t.charCodeAt(a);return l.toString(36)}function Go(e){return setTimeout(e,0)}function Zo(e){return clearTimeout(e)}Ho.prototype={constructor:Ho,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Co=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,ao):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,a=this.el,l=this.options,o=l.preventOnFilter,s=e.type,n=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,i=(n||e).target,r=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||i,c=l.filter;if(function(e){No.length=0;var t=e.getElementsByTagName("input"),a=t.length;for(;a--;){var l=t[a];l.checked&&No.push(l)}}(a),!ao&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||l.disabled)&&!r.isContentEditable&&(this.nativeDraggable||!_l||!i||"SELECT"!==i.tagName.toUpperCase())&&!((i=Al(i,l.draggable,a,!1))&&i.animated||io===i)){if(uo=$l(i),mo=$l(i,l.draggable),"function"==typeof c){if(c.call(this,e,i,this))return to({sortable:t,rootEl:r,name:"filter",targetEl:i,toEl:a,fromEl:a}),eo("filter",t,{evt:e}),void(o&&e.preventDefault())}else if(c&&(c=c.split(",").some(function(l){if(l=Al(r,l.trim(),a,!1))return to({sortable:t,rootEl:l,name:"filter",targetEl:i,fromEl:a,toEl:a}),eo("filter",t,{evt:e}),!0})))return void(o&&e.preventDefault());l.handle&&!Al(r,l.handle,a,!1)||this._prepareDragStart(e,n,i)}}},_prepareDragStart:function(e,t,a){var l,o=this,s=o.el,n=o.options,i=s.ownerDocument;if(a&&!ao&&a.parentNode===s){var r=Ul(a);if(so=s,lo=(ao=a).parentNode,no=ao.nextSibling,io=a,go=n.group,Ho.dragged=ao,ho={target:ao,clientX:(t||e).clientX,clientY:(t||e).clientY},wo=ho.clientX-r.left,xo=ho.clientY-r.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,ao.style["will-change"]="all",l=function(){eo("delayEnded",o,{evt:e}),Ho.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!bl&&o.nativeDraggable&&(ao.draggable=!0),o._triggerDragStart(e,t),to({sortable:o,name:"choose",originalEvent:e}),El(ao,n.chosenClass,!0))},n.ignore.split(",").forEach(function(e){Pl(ao,e.trim(),Yo)}),Cl(i,"dragover",Ko),Cl(i,"mousemove",Ko),Cl(i,"touchmove",Ko),n.supportPointer?(Cl(i,"pointerup",o._onDrop),!this.nativeDraggable&&Cl(i,"pointercancel",o._onDrop)):(Cl(i,"mouseup",o._onDrop),Cl(i,"touchend",o._onDrop),Cl(i,"touchcancel",o._onDrop)),bl&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ao.draggable=!0),eo("delayStart",this,{evt:e}),!n.delay||n.delayOnTouchOnly&&!t||this.nativeDraggable&&(yl||hl))l();else{if(Ho.eventCanceled)return void this._onDrop();n.supportPointer?(Cl(i,"pointerup",o._disableDelayedDrag),Cl(i,"pointercancel",o._disableDelayedDrag)):(Cl(i,"mouseup",o._disableDelayedDrag),Cl(i,"touchend",o._disableDelayedDrag),Cl(i,"touchcancel",o._disableDelayedDrag)),Cl(i,"mousemove",o._delayedDragTouchMoveHandler),Cl(i,"touchmove",o._delayedDragTouchMoveHandler),n.supportPointer&&Cl(i,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(l,n.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ao&&Yo(ao),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;kl(e,"mouseup",this._disableDelayedDrag),kl(e,"touchend",this._disableDelayedDrag),kl(e,"touchcancel",this._disableDelayedDrag),kl(e,"pointerup",this._disableDelayedDrag),kl(e,"pointercancel",this._disableDelayedDrag),kl(e,"mousemove",this._delayedDragTouchMoveHandler),kl(e,"touchmove",this._delayedDragTouchMoveHandler),kl(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Cl(document,"pointermove",this._onTouchMove):Cl(document,t?"touchmove":"mousemove",this._onTouchMove):(Cl(ao,"dragend",this),Cl(so,"dragstart",this._onDragStart));try{document.selection?Go(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(a){}},_dragStarted:function(e,t){if(Ao=!1,so&&ao){eo("dragStarted",this,{evt:t}),this.nativeDraggable&&Cl(document,"dragover",Jo);var a=this.options;!e&&El(ao,a.dragClass,!1),El(ao,a.ghostClass,!0),Ho.active=this,e&&this._appendGhost(),to({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(yo){this._lastX=yo.clientX,this._lastY=yo.clientY,qo();for(var e=document.elementFromPoint(yo.clientX,yo.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(yo.clientX,yo.clientY))!==t;)t=e;if(ao.parentNode[Wl]._isOutsideThisEl(e),t)do{if(t[Wl]){if(t[Wl]._onDragOver({clientX:yo.clientX,clientY:yo.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=Tl(t));jo()}},_onTouchMove:function(e){if(ho){var t=this.options,a=t.fallbackTolerance,l=t.fallbackOffset,o=e.touches?e.touches[0]:e,s=oo&&zl(oo,!0),n=oo&&s&&s.a,i=oo&&s&&s.d,r=Mo&&To&&Fl(To),c=(o.clientX-ho.clientX+l.x)/(n||1)+(r?r[0]-zo[0]:0)/(n||1),u=(o.clientY-ho.clientY+l.y)/(i||1)+(r?r[1]-zo[1]:0)/(i||1);if(!Ho.active&&!Ao){if(a&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<a)return;this._onDragStart(e,!0)}if(oo){s?(s.e+=c-(bo||0),s.f+=u-(_o||0)):s={a:1,b:0,c:0,d:1,e:c,f:u};var d="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");Ol(oo,"webkitTransform",d),Ol(oo,"mozTransform",d),Ol(oo,"msTransform",d),Ol(oo,"transform",d),bo=c,_o=u,yo=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!oo){var e=this.options.fallbackOnBody?document.body:so,t=Ul(ao,!0,Mo,!0,e),a=this.options;if(Mo){for(To=e;"static"===Ol(To,"position")&&"none"===Ol(To,"transform")&&To!==document;)To=To.parentNode;To!==document.body&&To!==document.documentElement?(To===document&&(To=Nl()),t.top+=To.scrollTop,t.left+=To.scrollLeft):To=Nl(),zo=Fl(To)}El(oo=ao.cloneNode(!0),a.ghostClass,!1),El(oo,a.fallbackClass,!0),El(oo,a.dragClass,!0),Ol(oo,"transition",""),Ol(oo,"transform",""),Ol(oo,"box-sizing","border-box"),Ol(oo,"margin",0),Ol(oo,"top",t.top),Ol(oo,"left",t.left),Ol(oo,"width",t.width),Ol(oo,"height",t.height),Ol(oo,"opacity","0.8"),Ol(oo,"position",Mo?"absolute":"fixed"),Ol(oo,"zIndex","100000"),Ol(oo,"pointerEvents","none"),Ho.ghost=oo,e.appendChild(oo),Ol(oo,"transform-origin",wo/parseInt(oo.style.width)*100+"% "+xo/parseInt(oo.style.height)*100+"%")}},_onDragStart:function(e,t){var a=this,l=e.dataTransfer,o=a.options;eo("dragStart",this,{evt:e}),Ho.eventCanceled?this._onDrop():(eo("setupClone",this),Ho.eventCanceled||((ro=Jl(ao)).removeAttribute("id"),ro.draggable=!1,ro.style["will-change"]="",this._hideClone(),El(ro,this.options.chosenClass,!1),Ho.clone=ro),a.cloneId=Go(function(){eo("clone",a),Ho.eventCanceled||(a.options.removeCloneOnHide||so.insertBefore(ro,ao),a._hideClone(),to({sortable:a,name:"clone"}))}),!t&&El(ao,o.dragClass,!0),t?(Do=!0,a._loopId=setInterval(a._emulateDragOver,50)):(kl(document,"mouseup",a._onDrop),kl(document,"touchend",a._onDrop),kl(document,"touchcancel",a._onDrop),l&&(l.effectAllowed="move",o.setData&&o.setData.call(a,l,ao)),Cl(document,"drop",a),Ol(ao,"transform","translateZ(0)")),Ao=!0,a._dragStartId=Go(a._dragStarted.bind(a,t,e)),Cl(document,"selectstart",a),So=!0,window.getSelection().removeAllRanges(),_l&&Ol(document.body,"user-select","none"))},_onDragOver:function(e){var t,a,l,o,s=this.el,n=e.target,i=this.options,r=i.group,c=Ho.active,u=go===r,d=i.sort,p=vo||c,m=this,f=!1;if(!Po){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),n=Al(n,i.draggable,s,!0),D("dragOver"),Ho.eventCanceled)return f;if(ao.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||m._ignoreWhileAnimating===n)return E(!1);if(Do=!1,c&&!i.disabled&&(u?d||(l=lo!==so):vo===this||(this.lastPutMode=go.checkPull(this,c,ao,e))&&r.checkPut(this,c,ao,e))){if(o="vertical"===this._getDirection(e,n),t=Ul(ao),D("dragOverValid"),Ho.eventCanceled)return f;if(l)return lo=so,I(),this._hideClone(),D("revert"),Ho.eventCanceled||(no?so.insertBefore(ao,no):so.appendChild(ao)),E(!0);var g=Rl(s,i.draggable);if(!g||function(e,t,a){var l=Ul(Rl(a.el,a.options.draggable)),o=Hl(a.el,a.options,oo),s=10;return t?e.clientX>o.right+s||e.clientY>l.bottom&&e.clientX>l.left:e.clientY>o.bottom+s||e.clientX>l.right&&e.clientY>l.top}(e,o,this)&&!g.animated){if(g===ao)return E(!1);if(g&&s===e.target&&(n=g),n&&(a=Ul(n)),!1!==Wo(so,s,ao,t,n,a,e,!!n))return I(),g&&g.nextSibling?s.insertBefore(ao,g.nextSibling):s.appendChild(ao),lo=s,O(),E(!0)}else if(g&&function(e,t,a){var l=Ul(Bl(a.el,0,a.options,!0)),o=Hl(a.el,a.options,oo),s=10;return t?e.clientX<o.left-s||e.clientY<l.top&&e.clientX<l.right:e.clientY<o.top-s||e.clientY<l.bottom&&e.clientX<l.left}(e,o,this)){var v=Bl(s,0,i,!0);if(v===ao)return E(!1);if(a=Ul(n=v),!1!==Wo(so,s,ao,t,n,a,e,!1))return I(),s.insertBefore(ao,v),lo=s,O(),E(!0)}else if(n.parentNode===s){a=Ul(n);var h,y,b,_=ao.parentNode!==s,w=!function(e,t,a){var l=a?e.left:e.top,o=a?e.right:e.bottom,s=a?e.width:e.height,n=a?t.left:t.top,i=a?t.right:t.bottom,r=a?t.width:t.height;return l===n||o===i||l+s/2===n+r/2}(ao.animated&&ao.toRect||t,n.animated&&n.toRect||a,o),x=o?"top":"left",S=Ml(n,"top","top")||Ml(ao,"top","top"),C=S?S.scrollTop:void 0;if(Co!==n&&(y=a[x],Eo=!1,Oo=!w&&i.invertSwap||_),h=function(e,t,a,l,o,s,n,i){var r=l?e.clientY:e.clientX,c=l?a.height:a.width,u=l?a.top:a.left,d=l?a.bottom:a.right,p=!1;if(!n)if(i&&Vo<c*o){if(!Eo&&(1===ko?r>u+c*s/2:r<d-c*s/2)&&(Eo=!0),Eo)p=!0;else if(1===ko?r<u+Vo:r>d-Vo)return-ko}else if(r>u+c*(1-o)/2&&r<d-c*(1-o)/2)return function(e){return $l(ao)<$l(e)?1:-1}(t);if((p=p||n)&&(r<u+c*s/2||r>d-c*s/2))return r>u+c/2?1:-1;return 0}(e,n,a,o,w?1:i.swapThreshold,null==i.invertedSwapThreshold?i.swapThreshold:i.invertedSwapThreshold,Oo,Co===n),0!==h){var k=$l(ao);do{k-=h,b=lo.children[k]}while(b&&("none"===Ol(b,"display")||b===oo))}if(0===h||b===n)return E(!1);Co=n,ko=h;var V=n.nextElementSibling,T=!1,A=Wo(so,s,ao,t,n,a,e,T=1===h);if(!1!==A)return 1!==A&&-1!==A||(T=1===A),Po=!0,setTimeout(Qo,30),I(),T&&!V?s.appendChild(ao):n.parentNode.insertBefore(ao,T?V:n),S&&Kl(S,0,C-S.scrollTop),lo=ao.parentNode,void 0===y||Oo||(Vo=Math.abs(y-Ul(n)[x])),O(),E(!0)}if(s.contains(ao))return E(!1)}return!1}function D(i,r){eo(i,m,dl({evt:e,isOwner:u,axis:o?"vertical":"horizontal",revert:l,dragRect:t,targetRect:a,canSort:d,fromSortable:p,target:n,completed:E,onMove:function(a,l){return Wo(so,s,ao,t,a,Ul(a),e,l)},changed:O},r))}function I(){D("dragOverAnimationCapture"),m.captureAnimationState(),m!==p&&p.captureAnimationState()}function E(t){return D("dragOverCompleted",{insertion:t}),t&&(u?c._hideClone():c._showClone(m),m!==p&&(El(ao,vo?vo.options.ghostClass:c.options.ghostClass,!1),El(ao,i.ghostClass,!0)),vo!==m&&m!==Ho.active?vo=m:m===Ho.active&&vo&&(vo=null),p===m&&(m._ignoreWhileAnimating=n),m.animateAll(function(){D("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(n===ao&&!ao.animated||n===s&&!n.animated)&&(Co=null),i.dragoverBubble||e.rootEl||n===document||(ao.parentNode[Wl]._isOutsideThisEl(e.target),!t&&Ko(e)),!i.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function O(){po=$l(ao),fo=$l(ao,i.draggable),to({sortable:m,name:"change",toEl:s,newIndex:po,newDraggableIndex:fo,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){kl(document,"mousemove",this._onTouchMove),kl(document,"touchmove",this._onTouchMove),kl(document,"pointermove",this._onTouchMove),kl(document,"dragover",Ko),kl(document,"mousemove",Ko),kl(document,"touchmove",Ko)},_offUpEvents:function(){var e=this.el.ownerDocument;kl(e,"mouseup",this._onDrop),kl(e,"touchend",this._onDrop),kl(e,"pointerup",this._onDrop),kl(e,"pointercancel",this._onDrop),kl(e,"touchcancel",this._onDrop),kl(document,"selectstart",this)},_onDrop:function(e){var t=this.el,a=this.options;po=$l(ao),fo=$l(ao,a.draggable),eo("drop",this,{evt:e}),lo=ao&&ao.parentNode,po=$l(ao),fo=$l(ao,a.draggable),Ho.eventCanceled||(Ao=!1,Oo=!1,Eo=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Zo(this.cloneId),Zo(this._dragStartId),this.nativeDraggable&&(kl(document,"drop",this),kl(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),_l&&Ol(document.body,"user-select",""),Ol(ao,"transform",""),e&&(So&&(e.cancelable&&e.preventDefault(),!a.dropBubble&&e.stopPropagation()),oo&&oo.parentNode&&oo.parentNode.removeChild(oo),(so===lo||vo&&"clone"!==vo.lastPutMode)&&ro&&ro.parentNode&&ro.parentNode.removeChild(ro),ao&&(this.nativeDraggable&&kl(ao,"dragend",this),Yo(ao),ao.style["will-change"]="",So&&!Ao&&El(ao,vo?vo.options.ghostClass:this.options.ghostClass,!1),El(ao,this.options.chosenClass,!1),to({sortable:this,name:"unchoose",toEl:lo,newIndex:null,newDraggableIndex:null,originalEvent:e}),so!==lo?(po>=0&&(to({rootEl:lo,name:"add",toEl:lo,fromEl:so,originalEvent:e}),to({sortable:this,name:"remove",toEl:lo,originalEvent:e}),to({rootEl:lo,name:"sort",toEl:lo,fromEl:so,originalEvent:e}),to({sortable:this,name:"sort",toEl:lo,originalEvent:e})),vo&&vo.save()):po!==uo&&po>=0&&(to({sortable:this,name:"update",toEl:lo,originalEvent:e}),to({sortable:this,name:"sort",toEl:lo,originalEvent:e})),Ho.active&&(null!=po&&-1!==po||(po=uo,fo=mo),to({sortable:this,name:"end",toEl:lo,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){eo("nulling",this),so=ao=lo=oo=no=ro=io=co=ho=yo=So=po=fo=uo=mo=Co=ko=vo=go=Ho.dragged=Ho.ghost=Ho.clone=Ho.active=null,No.forEach(function(e){e.checked=!0}),No.length=bo=_o=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":ao&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],a=this.el.children,l=0,o=a.length,s=this.options;l<o;l++)Al(e=a[l],s.draggable,this.el,!1)&&t.push(e.getAttribute(s.dataIdAttr)||Xo(e));return t},sort:function(e,t){var a={},l=this.el;this.toArray().forEach(function(e,t){var o=l.children[t];Al(o,this.options.draggable,l,!1)&&(a[e]=o)},this),t&&this.captureAnimationState(),e.forEach(function(e){a[e]&&(l.removeChild(a[e]),l.appendChild(a[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Al(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var a=this.options;if(void 0===t)return a[e];var l=Gl.modifyOption(this,e,t);a[e]=void 0!==l?l:t,"group"===e&&Lo(a)},destroy:function(){eo("destroy",this);var e=this.el;e[Wl]=null,kl(e,"mousedown",this._onTapStart),kl(e,"touchstart",this._onTapStart),kl(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(kl(e,"dragover",this),kl(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Io.splice(Io.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!co){if(eo("hideClone",this),Ho.eventCanceled)return;Ol(ro,"display","none"),this.options.removeCloneOnHide&&ro.parentNode&&ro.parentNode.removeChild(ro),co=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(co){if(eo("showClone",this),Ho.eventCanceled)return;ao.parentNode!=so||this.options.group.revertClone?no?so.insertBefore(ro,no):so.appendChild(ro):so.insertBefore(ro,ao),this.options.group.revertClone&&this.animate(ao,ro),Ol(ro,"display",""),co=!1}}else this._hideClone()}},Uo&&Cl(document,"touchmove",function(e){(Ho.active||Ao)&&e.cancelable&&e.preventDefault()}),Ho.utils={on:Cl,off:kl,css:Ol,find:Pl,is:function(e,t){return!!Al(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e},throttle:jl,closest:Al,toggleClass:El,clone:Jl,index:$l,nextTick:Go,cancelNextTick:Zo,detectDirection:Fo,getChild:Bl,expando:Wl},Ho.get=function(e){return e[Wl]},Ho.mount=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Ho.utils=dl(dl({},Ho.utils),e.utils)),Gl.mount(e)})},Ho.create=function(e,t){return new Ho(e,t)},Ho.version="1.15.6";var es,ts,as,ls,os,ss,ns=[],is=!1;function rs(){ns.forEach(function(e){clearInterval(e.pid)}),ns=[]}function cs(){clearInterval(ss)}var us=jl(function(e,t,a,l){if(t.scroll){var o,s=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,i=t.scrollSensitivity,r=t.scrollSpeed,c=Nl(),u=!1;ts!==a&&(ts=a,rs(),es=t.scroll,o=t.scrollFn,!0===es&&(es=Ll(a,!0)));var d=0,p=es;do{var m=p,f=Ul(m),g=f.top,v=f.bottom,h=f.left,y=f.right,b=f.width,_=f.height,w=void 0,x=void 0,S=m.scrollWidth,C=m.scrollHeight,k=Ol(m),V=m.scrollLeft,T=m.scrollTop;m===c?(w=b<S&&("auto"===k.overflowX||"scroll"===k.overflowX||"visible"===k.overflowX),x=_<C&&("auto"===k.overflowY||"scroll"===k.overflowY||"visible"===k.overflowY)):(w=b<S&&("auto"===k.overflowX||"scroll"===k.overflowX),x=_<C&&("auto"===k.overflowY||"scroll"===k.overflowY));var A=w&&(Math.abs(y-s)<=i&&V+b<S)-(Math.abs(h-s)<=i&&!!V),D=x&&(Math.abs(v-n)<=i&&T+_<C)-(Math.abs(g-n)<=i&&!!T);if(!ns[d])for(var I=0;I<=d;I++)ns[I]||(ns[I]={});ns[d].vx==A&&ns[d].vy==D&&ns[d].el===m||(ns[d].el=m,ns[d].vx=A,ns[d].vy=D,clearInterval(ns[d].pid),0==A&&0==D||(u=!0,ns[d].pid=setInterval(function(){l&&0===this.layer&&Ho.active._onTouchMove(os);var t=ns[this.layer].vy?ns[this.layer].vy*r:0,a=ns[this.layer].vx?ns[this.layer].vx*r:0;"function"==typeof o&&"continue"!==o.call(Ho.dragged.parentNode[Wl],a,t,e,os,ns[this.layer].el)||Kl(ns[this.layer].el,a,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&p!==c&&(p=Ll(p,!1)));is=u}},30),ds=function(e){var t=e.originalEvent,a=e.putSortable,l=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,n=e.hideGhostForTarget,i=e.unhideGhostForTarget;if(t){var r=a||o;n();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);i(),r&&!r.el.contains(u)&&(s("spill"),this.onSpill({dragEl:l,putSortable:a}))}};function ps(){}function ms(){}ps.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,a=e.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var l=Bl(this.sortable.el,this.startIndex,this.options);l?this.sortable.el.insertBefore(t,l):this.sortable.el.appendChild(t),this.sortable.animateAll(),a&&a.animateAll()},drop:ds},fl(ps,{pluginName:"revertOnSpill"}),ms.prototype={onSpill:function(e){var t=e.dragEl,a=e.putSortable||this.sortable;a.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),a.animateAll()},drop:ds},fl(ms,{pluginName:"removeOnSpill"}),Ho.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Cl(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Cl(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Cl(document,"touchmove",this._handleFallbackAutoScroll):Cl(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?kl(document,"dragover",this._handleAutoScroll):(kl(document,"pointermove",this._handleFallbackAutoScroll),kl(document,"touchmove",this._handleFallbackAutoScroll),kl(document,"mousemove",this._handleFallbackAutoScroll)),cs(),rs(),clearTimeout(Dl),Dl=void 0},nulling:function(){os=ts=es=is=ss=as=ls=null,ns.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var a=this,l=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,s=document.elementFromPoint(l,o);if(os=e,t||this.options.forceAutoScrollFallback||yl||hl||_l){us(e,this.options,s,t);var n=Ll(s,!0);!is||ss&&l===as&&o===ls||(ss&&cs(),ss=setInterval(function(){var s=Ll(document.elementFromPoint(l,o),!0);s!==n&&(n=s,rs()),us(e,a.options,s,t)},10),as=l,ls=o)}else{if(!this.options.bubbleScroll||Ll(s,!0)===Nl())return void rs();us(e,this.options,Ll(s,!1),!1)}}},fl(e,{pluginName:"scroll",initializeByDefault:!0})}),Ho.mount(ms,ps);const fs={class:"order-settings-container"},gs={class:"card-header"},vs={class:"options-preview"},hs={class:"card-header"},ys={class:"card-header"},bs={class:"card-header"},_s={key:1,class:"drag-tip"},ws={class:"card-header"},xs={class:"save-actions"},Ss={class:"options-editor"},Cs={class:"options-editor"},ks=q({__name:"OrderSettings",setup(e){const t=ve(),a=K({orderSourceFieldName:"",orderSourceOptions:[],customFields:[]}),l=K({mode:"delayed",delayMinutes:3}),o=j(!1),s=j([]),n=j(!1),u=j(!1),d=j(!1),p=j(!1),m=j(""),f=K({label:"",value:"",sortOrder:0}),g=async()=>{try{n.value=!0;const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/payment-methods/all",{headers:{Authorization:`Bearer ${e}`}}),a=await t.json();a.success&&a.data&&(s.value=a.data)}catch(e){console.error("加载支付方式失败:",e)}finally{n.value=!1}},v=()=>{d.value=!1,m.value="",f.label="",f.value="",f.sortOrder=s.value.length+1,u.value=!0},h=async()=>{if(f.label&&f.value)try{p.value=!0;const e=localStorage.getItem("auth_token"),t=d.value?`/api/v1/system/payment-methods/${m.value}`:"/api/v1/system/payment-methods",a=d.value?"PUT":"POST",l=await fetch(t,{method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(f)}),o=await l.json();o.success?(i.success(d.value?"支付方式更新成功":"支付方式添加成功"),u.value=!1,g()):i.error(o.message||"操作失败")}catch(e){console.error("保存支付方式失败:",e),i.error("保存失败")}finally{p.value=!1}else i.warning("请填写完整信息")},y=e=>{l.delayMinutes="immediate"===e?0:3},x=async()=>{try{o.value=!0;const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/order-transfer-config",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({mode:l.mode,delayMinutes:"immediate"===l.mode?0:l.delayMinutes})}),a=await t.json();a.success?i.success("流转配置保存成功，已全局生效"):i.error(a.message||"保存失败")}catch(e){console.error("保存流转配置失败:",e),i.error("保存流转配置失败")}finally{o.value=!1}},S=j(!1),C=j(!1),k=j(!1),V=j(-1),T=j(!1),A=j(),D=K({fieldName:"",options:[]}),I=K({fieldName:"",fieldKey:"",fieldType:"text",required:!1,placeholder:"",showInList:!0,options:[]}),E={fieldName:[{required:!0,message:"请输入字段名称",trigger:"blur"}],fieldKey:[{required:!0,message:"请输入字段键名",trigger:"blur"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"字段键名必须以字母开头，只能包含字母、数字和下划线",trigger:"blur"}],fieldType:[{required:!0,message:"请选择字段类型",trigger:"change"}]},O=e=>({text:"文本",number:"数字",date:"日期",datetime:"日期时间",select:"下拉选择",radio:"单选",checkbox:"多选"}[e]||e),z=()=>{a.orderSourceFieldName=t.orderSourceFieldName,a.orderSourceOptions=JSON.parse(JSON.stringify(t.orderSourceOptions)),a.customFields=JSON.parse(JSON.stringify(t.customFields))},P=()=>{D.fieldName=a.orderSourceFieldName,D.options=JSON.parse(JSON.stringify(a.orderSourceOptions)),S.value=!0},N=()=>{if(D.fieldName.trim())if(0!==D.options.length){for(const e of D.options)if(!e.label.trim()||!e.value.trim())return void i.warning("请填写完整的选项信息");a.orderSourceFieldName=D.fieldName,a.orderSourceOptions=JSON.parse(JSON.stringify(D.options)),S.value=!1,i.success('订单来源配置已更新，请点击"保存配置"按钮保存')}else i.warning("请至少添加一个选项");else i.warning("请输入字段名称")},U=()=>{D.options.push({label:"",value:""})},M=()=>{k.value=!1,V.value=-1,Object.assign(I,{fieldName:"",fieldKey:"",fieldType:"text",required:!1,placeholder:"",showInList:!0,options:[]}),C.value=!0},B=async()=>{try{if(await(A.value?.validate()),!k.value){if(a.customFields.some(e=>e.fieldKey===I.fieldKey))return void i.warning("字段键名已存在，请使用其他键名")}if(["select","radio","checkbox"].includes(I.fieldType)){if(0===I.options.length)return void i.warning("请至少添加一个选项");for(const e of I.options)if(!e.label.trim()||!e.value.trim())return void i.warning("请填写完整的选项信息")}if(k.value){const e=a.customFields[V.value];e.fieldName=I.fieldName,e.required=I.required,e.placeholder=I.placeholder,e.showInList=I.showInList,I.options.length>0&&(e.options=JSON.parse(JSON.stringify(I.options))),i.success('字段已更新，请点击"保存配置"按钮保存')}else{const e={id:"field_"+Date.now(),fieldName:I.fieldName,fieldKey:I.fieldKey,fieldType:I.fieldType,required:I.required,placeholder:I.placeholder,showInList:I.showInList,sortOrder:a.customFields.length,options:I.options.length>0?JSON.parse(JSON.stringify(I.options)):void 0};a.customFields.push(e),i.success('字段已添加，请点击"保存配置"按钮保存')}C.value=!1}catch(e){console.error("保存字段失败:",e)}},R=()=>{I.options.push({label:"",value:""})},$=async()=>{try{if(T.value=!0,!a.orderSourceFieldName.trim())return void i.warning("请配置订单来源字段名称");if(0===a.orderSourceOptions.length)return void i.warning("请至少添加一个订单来源选项");t.updateOrderSourceConfig(a.orderSourceFieldName,a.orderSourceOptions);const e=[...t.customFields];for(const a of e)t.deleteCustomField(a.id);for(const l of a.customFields)t.addCustomField({fieldName:l.fieldName,fieldKey:l.fieldKey,fieldType:l.fieldType,required:l.required,placeholder:l.placeholder,showInList:l.showInList,options:l.options});i.success("配置保存成功，已全局生效")}catch(e){console.error("保存配置失败:",e),i.error("保存配置失败")}finally{T.value=!1}},F=async()=>{try{await r.confirm("确定要重置配置吗？将恢复到当前保存的配置。","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),z(),i.success("配置已重置")}catch{}},L=j([]),q=j([]),J=j(""),W=j(!1),ue=j(!1),de=K({departmentId:"",departmentName:"",orderCountEnabled:!1,maxOrderCount:1,singleAmountEnabled:!1,maxSingleAmount:1e4,totalAmountEnabled:!1,maxTotalAmount:5e4,isEnabled:!0,remark:""}),pe=async()=>{try{const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/department-order-limits",{headers:{Authorization:`Bearer ${e}`}}),a=await t.json();a.success&&a.data&&(q.value=a.data)}catch(e){console.error("加载部门下单限制配置失败:",e)}},me=async e=>{if(!e)return;const t=q.value.find(t=>t.departmentId===e);t&&Object.assign(de,t)},fe=()=>{if(!J.value)return void i.warning("请先选择部门");const e=L.value.find(e=>e.id===J.value);if(!e)return;const t=q.value.find(e=>e.departmentId===J.value);t?Object.assign(de,t):(de.departmentId=e.id,de.departmentName=e.name,de.orderCountEnabled=!1,de.maxOrderCount=1,de.singleAmountEnabled=!1,de.maxSingleAmount=1e4,de.totalAmountEnabled=!1,de.maxTotalAmount=5e4,de.isEnabled=!0,de.remark=""),W.value=!0},ge=async()=>{try{ue.value=!0;const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/department-order-limits",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(de)}),a=await t.json();a.success?(i.success("部门下单限制配置保存成功"),W.value=!1,await pe()):i.error(a.message||"保存失败")}catch(e){console.error("保存部门下单限制配置失败:",e),i.error("保存失败")}finally{ue.value=!1}},he=async()=>{try{const e=localStorage.getItem("auth_token");for(const t of s.value)await fetch(`/api/v1/system/payment-methods/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({sortOrder:t.sortOrder})});i.success("排序已保存")}catch(e){console.error("保存排序失败:",e),i.error("保存排序失败")}};return H(async()=>{z(),(async()=>{try{const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/order-transfer-config",{headers:{Authorization:`Bearer ${e}`}}),a=await t.json();a.success&&a.data&&(l.mode=a.data.mode||"delayed",l.delayMinutes=a.data.delayMinutes??3)}catch(e){console.error("加载流转配置失败:",e)}})(),(async()=>{try{const e=localStorage.getItem("auth_token"),t=await fetch("/api/v1/system/departments",{headers:{Authorization:`Bearer ${e}`}}),a=await t.json();a.success&&a.data&&(L.value=a.data,console.log("[订单设置] 加载部门列表成功:",L.value.length,"个部门"))}catch(e){console.error("加载部门列表失败:",e)}})(),pe(),await g(),setTimeout(()=>{const e=document.querySelector(".config-card .el-table__body-wrapper tbody");e&&Ho.create(e,{handle:".drag-handle",animation:150,onEnd:async e=>{const{oldIndex:t,newIndex:a}=e;if(t!==a){const e=s.value.splice(t,1)[0];s.value.splice(a,0,e),s.value.forEach((e,t)=>{e.sortOrder=t+1}),await he()}}})},500)}),(e,t)=>{const z=Y("el-button"),j=Y("el-descriptions-item"),K=Y("el-descriptions"),H=Y("el-tag"),ve=Y("el-card"),he=Y("el-table-column"),ye=Y("el-table"),be=Y("el-empty"),_e=Y("el-radio"),we=Y("el-radio-group"),xe=Y("el-form-item"),Se=Y("el-input-number"),Ce=Y("el-form"),ke=Y("el-icon"),Ve=Y("el-switch"),Te=Y("el-input"),Ae=Y("el-dialog"),De=Y("el-alert"),Ie=Y("el-option"),Ee=Y("el-select"),Oe=Y("el-divider"),ze=Q("loading");return G(),X("div",fs,[t[80]||(t[80]=Z("div",{class:"page-header"},[Z("h2",null,"订单设置"),Z("p",null,"配置订单字段和自定义字段")],-1)),ee(ve,{class:"config-card"},{header:ae(()=>[Z("div",gs,[t[30]||(t[30]=Z("span",null,"订单来源配置",-1)),ee(z,{type:"primary",size:"small",onClick:P},{default:ae(()=>[...t[29]||(t[29]=[le(" 编辑配置 ",-1)])]),_:1})])]),default:ae(()=>[ee(K,{column:2,border:""},{default:ae(()=>[ee(j,{label:"字段名称"},{default:ae(()=>[le(oe(a.orderSourceFieldName),1)]),_:1}),ee(j,{label:"选项数量"},{default:ae(()=>[le(oe(a.orderSourceOptions.length)+" 个 ",1)]),_:1})]),_:1}),Z("div",vs,[t[31]||(t[31]=Z("h4",null,"当前选项:",-1)),(G(!0),X(re,null,ce(a.orderSourceOptions,e=>(G(),se(H,{key:e.value,style:{margin:"5px"}},{default:ae(()=>[le(oe(e.label),1)]),_:2},1024))),128))])]),_:1}),ee(ve,{class:"config-card"},{header:ae(()=>[Z("div",hs,[t[33]||(t[33]=Z("span",null,"自定义字段管理",-1)),ee(z,{type:"primary",size:"small",icon:te(c),onClick:M},{default:ae(()=>[...t[32]||(t[32]=[le(" 添加字段 ",-1)])]),_:1},8,["icon"])])]),default:ae(()=>[a.customFields.length>0?(G(),se(ye,{key:0,data:a.customFields,style:{width:"100%"}},{default:ae(()=>[ee(he,{prop:"fieldName",label:"字段名称",width:"150"}),ee(he,{prop:"fieldKey",label:"字段键名",width:"150"}),ee(he,{prop:"fieldType",label:"字段类型",width:"120"},{default:ae(({row:e})=>{return[ee(H,{type:(t=e.fieldType,{text:"primary",number:"success",date:"warning",datetime:"warning",select:"info",radio:"danger",checkbox:"danger"}[t]||"primary"),size:"small"},{default:ae(()=>[le(oe(O(e.fieldType)),1)]),_:2},1032,["type"])];var t}),_:1}),ee(he,{prop:"required",label:"必填",width:"80"},{default:ae(({row:e})=>[ee(H,{type:e.required?"danger":"info",size:"small"},{default:ae(()=>[le(oe(e.required?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),ee(he,{prop:"showInList",label:"列表显示",width:"100"},{default:ae(({row:e})=>[ee(H,{type:e.showInList?"success":"info",size:"small"},{default:ae(()=>[le(oe(e.showInList?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),ee(he,{prop:"placeholder",label:"占位符","min-width":"150","show-overflow-tooltip":""}),ee(he,{label:"操作",width:"200",fixed:"right"},{default:ae(({row:e,$index:l})=>[ee(z,{size:"small",type:"primary",link:"",onClick:t=>((e,t)=>{k.value=!0,V.value=t,Object.assign(I,{fieldName:e.fieldName,fieldKey:e.fieldKey,fieldType:e.fieldType,required:e.required,placeholder:e.placeholder||"",showInList:e.showInList,options:e.options?JSON.parse(JSON.stringify(e.options)):[]}),C.value=!0})(e,l)},{default:ae(()=>[...t[34]||(t[34]=[le(" 编辑 ",-1)])]),_:1},8,["onClick"]),ee(z,{size:"small",link:"",onClick:e=>(e=>{if(e>0){const t=a.customFields[e];a.customFields[e]=a.customFields[e-1],a.customFields[e-1]=t,a.customFields.forEach((e,t)=>{e.sortOrder=t}),i.success('字段已上移，请点击"保存配置"按钮保存')}})(l),disabled:0===l},{default:ae(()=>[...t[35]||(t[35]=[le(" 上移 ",-1)])]),_:1},8,["onClick","disabled"]),ee(z,{size:"small",link:"",onClick:e=>(e=>{if(e<a.customFields.length-1){const t=a.customFields[e];a.customFields[e]=a.customFields[e+1],a.customFields[e+1]=t,a.customFields.forEach((e,t)=>{e.sortOrder=t}),i.success('字段已下移，请点击"保存配置"按钮保存')}})(l),disabled:l===a.customFields.length-1},{default:ae(()=>[...t[36]||(t[36]=[le(" 下移 ",-1)])]),_:1},8,["onClick","disabled"]),ee(z,{size:"small",type:"danger",link:"",onClick:e=>(async e=>{try{const t=a.customFields[e];await r.confirm(`确定要删除字段"${t.fieldName}"吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),a.customFields.splice(e,1),a.customFields.forEach((e,t)=>{e.sortOrder=t}),i.success('字段已删除，请点击"保存配置"按钮保存')}catch{}})(l)},{default:ae(()=>[...t[37]||(t[37]=[le(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(G(),se(be,{key:1,description:"暂无自定义字段，点击上方【添加字段】按钮开始配置"}))]),_:1}),ee(ve,{class:"config-card"},{header:ae(()=>[Z("div",ys,[t[39]||(t[39]=Z("span",null,"订单流转时间配置",-1)),ee(H,{type:"warning",size:"small"},{default:ae(()=>[...t[38]||(t[38]=[le("全局生效",-1)])]),_:1})])]),default:ae(()=>[ee(Ce,{"label-width":"140px"},{default:ae(()=>[ee(xe,{label:"流转模式"},{default:ae(()=>[ee(we,{modelValue:l.mode,"onUpdate:modelValue":t[0]||(t[0]=e=>l.mode=e),onChange:y},{default:ae(()=>[ee(_e,{label:"immediate"},{default:ae(()=>[...t[40]||(t[40]=[le("无等待（立即流转）",-1)])]),_:1}),ee(_e,{label:"delayed"},{default:ae(()=>[...t[41]||(t[41]=[le("延迟流转",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"delayed"===l.mode?(G(),se(xe,{key:0,label:"流转等待时间"},{default:ae(()=>[ee(Se,{modelValue:l.delayMinutes,"onUpdate:modelValue":t[1]||(t[1]=e=>l.delayMinutes=e),min:1,max:1440,step:1,style:{width:"200px"}},null,8,["modelValue"]),t[42]||(t[42]=Z("span",{style:{"margin-left":"10px",color:"#666"}},"分钟",-1)),t[43]||(t[43]=Z("div",{class:"form-tip"}," 订单创建后，将在设定时间后自动流转到审核。范围：1-1440分钟（最长24小时） ",-1))]),_:1})):ne("",!0),ee(xe,{label:"当前配置预览"},{default:ae(()=>[ee(H,{type:"immediate"===l.mode?"success":"warning",size:"large"},{default:ae(()=>[le(oe("immediate"===l.mode?"订单创建后立即流转到审核":`订单创建后 ${l.delayMinutes} 分钟后流转到审核`),1)]),_:1},8,["type"])]),_:1}),ee(xe,null,{default:ae(()=>[ee(z,{type:"primary",onClick:x,loading:o.value},{default:ae(()=>[...t[44]||(t[44]=[le(" 保存流转配置 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),ee(ve,{class:"config-card"},{header:ae(()=>[Z("div",bs,[t[46]||(t[46]=Z("span",null,"支付方式配置",-1)),ee(z,{type:"primary",size:"small",icon:te(c),onClick:v},{default:ae(()=>[...t[45]||(t[45]=[le(" 添加支付方式 ",-1)])]),_:1},8,["icon"])])]),default:ae(()=>[s.value.length>0?ie((G(),se(ye,{key:0,data:s.value,style:{width:"100%"},"row-key":"id"},{default:ae(()=>[ee(he,{width:"50",align:"center"},{default:ae(()=>[ee(ke,{class:"drag-handle",style:{cursor:"move",color:"#999"}},{default:ae(()=>[ee(te(b))]),_:1})]),_:1}),ee(he,{prop:"label",label:"支付方式名称",width:"200"}),ee(he,{prop:"value",label:"选项值",width:"150"}),ee(he,{prop:"sortOrder",label:"排序",width:"100"}),ee(he,{label:"启用",width:"100"},{default:ae(({row:e})=>[ee(Ve,{modelValue:e.isEnabled,"onUpdate:modelValue":t=>e.isEnabled=t,onChange:t=>(async e=>{try{e.toggling=!0;const t=localStorage.getItem("auth_token"),a=await fetch(`/api/v1/system/payment-methods/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({isEnabled:e.isEnabled})}),l=await a.json();l.success?i.success(e.isEnabled?"已启用":"已禁用"):(e.isEnabled=!e.isEnabled,i.error(l.message||"操作失败"))}catch(t){console.error("切换状态失败:",t),e.isEnabled=!e.isEnabled,i.error("切换状态失败")}finally{e.toggling=!1}})(e),loading:e.toggling},null,8,["modelValue","onUpdate:modelValue","onChange","loading"])]),_:1}),ee(he,{label:"操作",width:"150",fixed:"right"},{default:ae(({row:e})=>[ee(z,{size:"small",type:"primary",link:"",onClick:t=>(e=>{d.value=!0,m.value=e.id,f.label=e.label,f.value=e.value,f.sortOrder=e.sortOrder,u.value=!0})(e)},{default:ae(()=>[...t[47]||(t[47]=[le(" 编辑 ",-1)])]),_:1},8,["onClick"]),ee(z,{size:"small",type:"danger",link:"",onClick:t=>(async e=>{try{await r.confirm("确定要删除该支付方式吗？","确认删除",{type:"warning"});const t=localStorage.getItem("auth_token"),a=await fetch(`/api/v1/system/payment-methods/${e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}});(await a.json()).success&&(i.success("删除成功"),g())}catch(t){"cancel"!==t&&console.error("删除失败:",t)}})(e)},{default:ae(()=>[...t[48]||(t[48]=[le(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ze,n.value]]):ne("",!0),s.value.length>0?(G(),X("div",_s,[ee(ke,null,{default:ae(()=>[ee(te(_))]),_:1}),t[49]||(t[49]=Z("span",null,"拖拽左侧图标可调整排序，排序变更后自动保存",-1))])):(G(),se(be,{key:2,description:"暂无支付方式配置，点击上方【添加支付方式】按钮开始配置"}))]),_:1}),ee(Ae,{modelValue:u.value,"onUpdate:modelValue":t[6]||(t[6]=e=>u.value=e),title:d.value?"编辑支付方式":"添加支付方式",width:"500px"},{footer:ae(()=>[ee(z,{onClick:t[5]||(t[5]=e=>u.value=!1)},{default:ae(()=>[...t[50]||(t[50]=[le("取消",-1)])]),_:1}),ee(z,{type:"primary",onClick:h,loading:p.value},{default:ae(()=>[...t[51]||(t[51]=[le("保存",-1)])]),_:1},8,["loading"])]),default:ae(()=>[ee(Ce,{model:f,"label-width":"100px"},{default:ae(()=>[ee(xe,{label:"名称",required:""},{default:ae(()=>[ee(Te,{modelValue:f.label,"onUpdate:modelValue":t[2]||(t[2]=e=>f.label=e),placeholder:"请输入支付方式名称"},null,8,["modelValue"])]),_:1}),ee(xe,{label:"选项值",required:""},{default:ae(()=>[ee(Te,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),placeholder:"请输入选项值（英文）",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),ee(xe,{label:"排序"},{default:ae(()=>[ee(Se,{modelValue:f.sortOrder,"onUpdate:modelValue":t[4]||(t[4]=e=>f.sortOrder=e),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),ee(ve,{class:"config-card"},{header:ae(()=>[Z("div",ws,[t[53]||(t[53]=Z("span",null,"部门下单限制配置",-1)),ee(H,{type:"danger",size:"small"},{default:ae(()=>[...t[52]||(t[52]=[le("全局生效",-1)])]),_:1})])]),default:ae(()=>[ee(De,{type:"info",closable:!1,style:{"margin-bottom":"20px"}},{title:ae(()=>[...t[54]||(t[54]=[le(" 配置说明：可针对不同部门设置同一客户的下单次数、单笔金额、累计金额限制。配置后，该部门成员创建订单时将自动验证限制条件。 ",-1)])]),_:1}),ee(Ce,{"label-width":"140px"},{default:ae(()=>[ee(xe,{label:"选择部门"},{default:ae(()=>[ee(Ee,{modelValue:J.value,"onUpdate:modelValue":t[7]||(t[7]=e=>J.value=e),placeholder:"请选择要配置的部门",style:{width:"300px"},onChange:me,clearable:""},{default:ae(()=>[(G(!0),X(re,null,ce(L.value,e=>(G(),se(Ie,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),ee(z,{type:"primary",icon:te(c),style:{"margin-left":"10px"},onClick:fe,disabled:!J.value},{default:ae(()=>[...t[55]||(t[55]=[le(" 添加/编辑配置 ",-1)])]),_:1},8,["icon","disabled"])]),_:1})]),_:1}),q.value.length>0?(G(),se(ye,{key:0,data:q.value,style:{width:"100%"}},{default:ae(()=>[ee(he,{prop:"departmentName",label:"部门名称",width:"150"}),ee(he,{label:"下单次数限制",width:"180"},{default:ae(({row:e})=>[e.orderCountEnabled?(G(),se(H,{key:0,type:"warning",size:"small"},{default:ae(()=>[le(" 最多"+oe(e.maxOrderCount)+"次 ",1)]),_:2},1024)):(G(),se(H,{key:1,type:"info",size:"small"},{default:ae(()=>[...t[56]||(t[56]=[le("无限制",-1)])]),_:1}))]),_:1}),ee(he,{label:"单笔金额限制",width:"180"},{default:ae(({row:e})=>[e.singleAmountEnabled?(G(),se(H,{key:0,type:"warning",size:"small"},{default:ae(()=>[le(" 最高¥"+oe(e.maxSingleAmount),1)]),_:2},1024)):(G(),se(H,{key:1,type:"info",size:"small"},{default:ae(()=>[...t[57]||(t[57]=[le("无限制",-1)])]),_:1}))]),_:1}),ee(he,{label:"累计金额限制",width:"180"},{default:ae(({row:e})=>[e.totalAmountEnabled?(G(),se(H,{key:0,type:"warning",size:"small"},{default:ae(()=>[le(" 最高¥"+oe(e.maxTotalAmount),1)]),_:2},1024)):(G(),se(H,{key:1,type:"info",size:"small"},{default:ae(()=>[...t[58]||(t[58]=[le("无限制",-1)])]),_:1}))]),_:1}),ee(he,{prop:"isEnabled",label:"状态",width:"100"},{default:ae(({row:e})=>[ee(H,{type:e.isEnabled?"success":"danger",size:"small"},{default:ae(()=>[le(oe(e.isEnabled?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),ee(he,{label:"操作",width:"150",fixed:"right"},{default:ae(({row:e})=>[ee(z,{size:"small",type:"primary",link:"",onClick:t=>(e=>{Object.assign(de,e),W.value=!0})(e)},{default:ae(()=>[...t[59]||(t[59]=[le(" 编辑 ",-1)])]),_:1},8,["onClick"]),ee(z,{size:"small",type:"danger",link:"",onClick:t=>(async e=>{try{await r.confirm(`确定要删除部门"${e.departmentName}"的下单限制配置吗？`,"确认删除",{type:"warning"});const t=localStorage.getItem("auth_token"),a=await fetch(`/api/v1/system/department-order-limits/${e.departmentId}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),l=await a.json();l.success?(i.success("删除成功"),await pe()):i.error(l.message||"删除失败")}catch(t){"cancel"!==t&&(console.error("删除部门下单限制配置失败:",t),i.error("删除失败"))}})(e)},{default:ae(()=>[...t[60]||(t[60]=[le(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(G(),se(be,{key:1,description:"暂无部门下单限制配置"}))]),_:1}),ee(Ae,{modelValue:W.value,"onUpdate:modelValue":t[17]||(t[17]=e=>W.value=e),title:"部门下单限制配置",width:"600px","close-on-click-modal":!1},{footer:ae(()=>[ee(z,{onClick:t[16]||(t[16]=e=>W.value=!1)},{default:ae(()=>[...t[68]||(t[68]=[le("取消",-1)])]),_:1}),ee(z,{type:"primary",onClick:ge,loading:ue.value},{default:ae(()=>[...t[69]||(t[69]=[le(" 保存配置 ",-1)])]),_:1},8,["loading"])]),default:ae(()=>[ee(Ce,{model:de,"label-width":"140px"},{default:ae(()=>[ee(xe,{label:"部门"},{default:ae(()=>[ee(H,{size:"large"},{default:ae(()=>[le(oe(de.departmentName),1)]),_:1})]),_:1}),ee(Oe,{"content-position":"left"},{default:ae(()=>[...t[61]||(t[61]=[le("下单次数限制",-1)])]),_:1}),ee(xe,{label:"启用限制"},{default:ae(()=>[ee(Ve,{modelValue:de.orderCountEnabled,"onUpdate:modelValue":t[8]||(t[8]=e=>de.orderCountEnabled=e)},null,8,["modelValue"])]),_:1}),de.orderCountEnabled?(G(),se(xe,{key:0,label:"最大下单次数"},{default:ae(()=>[ee(Se,{modelValue:de.maxOrderCount,"onUpdate:modelValue":t[9]||(t[9]=e=>de.maxOrderCount=e),min:1,max:100},null,8,["modelValue"]),t[62]||(t[62]=Z("span",{style:{"margin-left":"10px",color:"#666"}},"次（同一客户在该部门最多下单次数）",-1))]),_:1})):ne("",!0),ee(Oe,{"content-position":"left"},{default:ae(()=>[...t[63]||(t[63]=[le("单笔金额限制",-1)])]),_:1}),ee(xe,{label:"启用限制"},{default:ae(()=>[ee(Ve,{modelValue:de.singleAmountEnabled,"onUpdate:modelValue":t[10]||(t[10]=e=>de.singleAmountEnabled=e)},null,8,["modelValue"])]),_:1}),de.singleAmountEnabled?(G(),se(xe,{key:1,label:"单笔最大金额"},{default:ae(()=>[ee(Se,{modelValue:de.maxSingleAmount,"onUpdate:modelValue":t[11]||(t[11]=e=>de.maxSingleAmount=e),min:1,max:9999999,precision:2},null,8,["modelValue"]),t[64]||(t[64]=Z("span",{style:{"margin-left":"10px",color:"#666"}},"元",-1))]),_:1})):ne("",!0),ee(Oe,{"content-position":"left"},{default:ae(()=>[...t[65]||(t[65]=[le("累计金额限制",-1)])]),_:1}),ee(xe,{label:"启用限制"},{default:ae(()=>[ee(Ve,{modelValue:de.totalAmountEnabled,"onUpdate:modelValue":t[12]||(t[12]=e=>de.totalAmountEnabled=e)},null,8,["modelValue"])]),_:1}),de.totalAmountEnabled?(G(),se(xe,{key:2,label:"累计最大金额"},{default:ae(()=>[ee(Se,{modelValue:de.maxTotalAmount,"onUpdate:modelValue":t[13]||(t[13]=e=>de.maxTotalAmount=e),min:1,max:99999999,precision:2},null,8,["modelValue"]),t[66]||(t[66]=Z("span",{style:{"margin-left":"10px",color:"#666"}},"元（同一客户在该部门累计订单金额）",-1))]),_:1})):ne("",!0),ee(Oe),ee(xe,{label:"启用配置"},{default:ae(()=>[ee(Ve,{modelValue:de.isEnabled,"onUpdate:modelValue":t[14]||(t[14]=e=>de.isEnabled=e)},null,8,["modelValue"]),t[67]||(t[67]=Z("span",{style:{"margin-left":"10px",color:"#999"}},"关闭后该部门不受限制",-1))]),_:1}),ee(xe,{label:"备注"},{default:ae(()=>[ee(Te,{modelValue:de.remark,"onUpdate:modelValue":t[15]||(t[15]=e=>de.remark=e),type:"textarea",rows:2,placeholder:"可选，填写配置说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),Z("div",xs,[ee(z,{size:"large",onClick:F},{default:ae(()=>[...t[70]||(t[70]=[le("重置配置",-1)])]),_:1}),ee(z,{type:"primary",size:"large",onClick:$,loading:T.value},{default:ae(()=>[...t[71]||(t[71]=[le(" 保存配置 ",-1)])]),_:1},8,["loading"])]),ee(Ae,{modelValue:S.value,"onUpdate:modelValue":t[20]||(t[20]=e=>S.value=e),title:"编辑订单来源配置",width:"700px","close-on-click-modal":!1},{footer:ae(()=>[ee(z,{onClick:t[19]||(t[19]=e=>S.value=!1)},{default:ae(()=>[...t[73]||(t[73]=[le("取消",-1)])]),_:1}),ee(z,{type:"primary",onClick:N},{default:ae(()=>[...t[74]||(t[74]=[le("确定",-1)])]),_:1})]),default:ae(()=>[ee(Ce,{model:D,"label-width":"100px"},{default:ae(()=>[ee(xe,{label:"字段名称",required:""},{default:ae(()=>[ee(Te,{modelValue:D.fieldName,"onUpdate:modelValue":t[18]||(t[18]=e=>D.fieldName=e),placeholder:"请输入字段名称，如：订单来源、订单渠道"},null,8,["modelValue"])]),_:1}),ee(xe,{label:"选项配置",required:""},{default:ae(()=>[Z("div",Ss,[(G(!0),X(re,null,ce(D.options,(e,t)=>(G(),X("div",{key:t,class:"option-item"},[ee(Te,{modelValue:e.label,"onUpdate:modelValue":t=>e.label=t,placeholder:"选项名称，如：线上商城",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),ee(Te,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"选项值，如：online",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),ee(z,{type:"danger",icon:te(w),circle:"",size:"small",onClick:e=>(e=>{D.options.splice(e,1)})(t),disabled:D.options.length<=1},null,8,["icon","onClick","disabled"])]))),128)),ee(z,{type:"primary",size:"small",icon:te(c),onClick:U},{default:ae(()=>[...t[72]||(t[72]=[le(" 添加选项 ",-1)])]),_:1},8,["icon"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),ee(Ae,{modelValue:C.value,"onUpdate:modelValue":t[28]||(t[28]=e=>C.value=e),title:k.value?"编辑自定义字段":"添加自定义字段",width:"700px","close-on-click-modal":!1},{footer:ae(()=>[ee(z,{onClick:t[27]||(t[27]=e=>C.value=!1)},{default:ae(()=>[...t[78]||(t[78]=[le("取消",-1)])]),_:1}),ee(z,{type:"primary",onClick:B},{default:ae(()=>[...t[79]||(t[79]=[le("确定",-1)])]),_:1})]),default:ae(()=>[ee(Ce,{ref_key:"customFieldFormRef",ref:A,model:I,rules:E,"label-width":"100px"},{default:ae(()=>[ee(xe,{label:"字段名称",prop:"fieldName"},{default:ae(()=>[ee(Te,{modelValue:I.fieldName,"onUpdate:modelValue":t[21]||(t[21]=e=>I.fieldName=e),placeholder:"请输入字段名称，如：客户等级"},null,8,["modelValue"])]),_:1}),ee(xe,{label:"字段键名",prop:"fieldKey"},{default:ae(()=>[ee(Te,{modelValue:I.fieldKey,"onUpdate:modelValue":t[22]||(t[22]=e=>I.fieldKey=e),placeholder:"请输入字段键名，如：customerLevel",disabled:k.value},null,8,["modelValue","disabled"]),t[75]||(t[75]=Z("div",{class:"form-tip"},"字段键名用于数据存储，只能包含字母、数字和下划线，且以字母开头",-1))]),_:1}),ee(xe,{label:"字段类型",prop:"fieldType"},{default:ae(()=>[ee(Ee,{modelValue:I.fieldType,"onUpdate:modelValue":t[23]||(t[23]=e=>I.fieldType=e),placeholder:"请选择字段类型",style:{width:"100%"},disabled:k.value},{default:ae(()=>[ee(Ie,{label:"文本",value:"text"}),ee(Ie,{label:"数字",value:"number"}),ee(Ie,{label:"日期",value:"date"}),ee(Ie,{label:"日期时间",value:"datetime"}),ee(Ie,{label:"下拉选择",value:"select"}),ee(Ie,{label:"单选",value:"radio"}),ee(Ie,{label:"多选",value:"checkbox"})]),_:1},8,["modelValue","disabled"])]),_:1}),ee(xe,{label:"必填",prop:"required"},{default:ae(()=>[ee(Ve,{modelValue:I.required,"onUpdate:modelValue":t[24]||(t[24]=e=>I.required=e)},null,8,["modelValue"])]),_:1}),ee(xe,{label:"占位符",prop:"placeholder"},{default:ae(()=>[ee(Te,{modelValue:I.placeholder,"onUpdate:modelValue":t[25]||(t[25]=e=>I.placeholder=e),placeholder:"请输入占位符提示文本"},null,8,["modelValue"])]),_:1}),ee(xe,{label:"列表显示",prop:"showInList"},{default:ae(()=>[ee(Ve,{modelValue:I.showInList,"onUpdate:modelValue":t[26]||(t[26]=e=>I.showInList=e)},null,8,["modelValue"]),t[76]||(t[76]=Z("div",{class:"form-tip"},"开启后，该字段将在订单列表中显示",-1))]),_:1}),["select","radio","checkbox"].includes(I.fieldType)?(G(),se(xe,{key:0,label:"选项配置",required:""},{default:ae(()=>[Z("div",Cs,[(G(!0),X(re,null,ce(I.options,(e,t)=>(G(),X("div",{key:t,class:"option-item"},[ee(Te,{modelValue:e.label,"onUpdate:modelValue":t=>e.label=t,placeholder:"选项名称",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),ee(Te,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,placeholder:"选项值",style:{width:"200px"}},null,8,["modelValue","onUpdate:modelValue"]),ee(z,{type:"danger",icon:te(w),circle:"",size:"small",onClick:e=>(e=>{I.options.splice(e,1)})(t),disabled:I.options.length<=1},null,8,["icon","onClick","disabled"])]))),128)),ee(z,{type:"primary",size:"small",icon:te(c),onClick:R},{default:ae(()=>[...t[77]||(t[77]=[le(" 添加选项 ",-1)])]),_:1},8,["icon"])])]),_:1})):ne("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Vs=t(ks,[["__scopeId","data-v-048a2d36"]]),Ts={class:"rich-text-editor"},As=t(q({__name:"RichTextEditor",props:{modelValue:{},height:{default:"400px"},placeholder:{default:"请输入内容..."},mode:{default:"default"}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=t,o=de(),s=j(a.modelValue),n={excludeKeys:["group-video","insertImage","uploadImage"]},i={placeholder:a.placeholder,MENU_CONF:{}};pe(()=>{const e=o.value;null!=e&&e.destroy()});const r=e=>{o.value=e},c=e=>{l("update:modelValue",s.value)};return W(()=>a.modelValue,e=>{e!==s.value&&(s.value=e)}),(t,a)=>(G(),X("div",Ts,[ee(te(he),{editor:o.value,defaultConfig:n,mode:e.mode,class:"editor-toolbar"},null,8,["editor","mode"]),ee(te(ye),{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=e=>s.value=e),defaultConfig:i,mode:e.mode,onOnCreated:r,onOnChange:c,class:"editor-content",style:me({height:e.height})},null,8,["modelValue","mode","style"])]))}}),[["__scopeId","data-v-25050145"]]),Ds={class:"agreement-editor"},Is={class:"dialog-footer"},Es=t(q({__name:"AgreementEditorDialog",props:{modelValue:{type:Boolean},agreement:{}},emits:["update:modelValue","save"],setup(e,{emit:t}){const a=e,l=t,o=j(a.modelValue),s=j(a.agreement),n=j(""),r=j(!1);W(()=>a.modelValue,e=>{o.value=e}),W(()=>a.agreement,async e=>{s.value=e,e&&e.content?(n.value=e.content,await fe()):n.value=""}),W(o,e=>{l("update:modelValue",e)});const c=()=>{o.value=!1},u=()=>{n.value.trim()?(l("save",n.value),c()):i.warning("协议内容不能为空")};return(e,t)=>{const a=Y("el-button"),l=Y("el-dialog");return G(),se(l,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),title:`编辑${s.value?.title||"协议"}`,width:"65%","close-on-click-modal":!1,onClose:c,class:"agreement-editor-dialog"},{footer:ae(()=>[Z("div",Is,[ee(a,{onClick:c},{default:ae(()=>[...t[2]||(t[2]=[le("取消",-1)])]),_:1}),ee(a,{type:"primary",onClick:u,loading:r.value},{default:ae(()=>[...t[3]||(t[3]=[le(" 保存 ",-1)])]),_:1},8,["loading"])])]),default:ae(()=>[Z("div",Ds,[ee(As,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),height:"500px",placeholder:`请输入${s.value?.title}内容，支持富文本格式`},null,8,["modelValue","placeholder"])])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-e7dbbc25"]]),Os={class:"system-settings"},zs={class:"settings-tabs-container"},Ps={class:"tabs-nav-container"},Ns={class:"tabs-nav-wrapper"},Us={class:"card-header"},Ms=["src"],Bs={class:"qr-upload-buttons"},Rs={key:0,class:"qr-preview-area"},$s=["src"],Fs={class:"qr-overlay"},Ls={key:1,class:"qr-empty-state"},qs={class:"card-header"},js={class:"card-header"},Ks={class:"header-actions"},Js={class:"form-section"},Hs={class:"section-title"},Ws={class:"form-section"},Ys={class:"section-title"},Qs={class:"form-section"},Xs={class:"section-title"},Gs={class:"form-section"},Zs={class:"section-title"},en={class:"card-header"},tn={class:"header-actions"},an={class:"card-header"},ln={class:"header-actions"},on={class:"card-header"},sn={class:"header-actions"},nn={class:"sync-status"},rn={key:1,class:"sync-info"},cn={key:2,class:"sync-progress"},un={key:0,class:"failed-count"},dn={class:"sync-actions"},pn={class:"card-header"},mn={class:"form-section"},fn={class:"section-title"},gn={class:"form-section"},vn={class:"section-title"},hn={class:"form-section"},yn={class:"section-title"},bn={class:"form-section"},_n={class:"section-title"},wn={class:"form-section"},xn={class:"section-title"},Sn={key:0,class:"form-actions"},Cn={class:"card-header"},kn={class:"monitor-content"},Vn={class:"monitor-section"},Tn={class:"monitor-section"},An={class:"monitor-section"},Dn={class:"monitor-section"},In={class:"card-header"},En={class:"header-actions"},On={class:"form-section"},zn={class:"form-section"},Pn={class:"form-section"},Nn={class:"card-header"},Un={class:"header-actions"},Mn={class:"migration-content"},Bn={key:0,class:"data-statistics"},Rn={key:1,class:"validation-result"},$n={key:0},Fn={class:"migration-steps"},Ln={class:"documentation-links"},qn={class:"card-header"},jn={class:"header-actions"},Kn={class:"agreement-title"},Jn={class:"word-count"},Hn={class:"content-summary"},Wn={class:"update-time"},Yn={class:"card-header"},Qn={class:"header-actions"},Xn={class:"mobile-app-content"},Gn={class:"sdk-overview"},Zn={class:"section-title"},ei={class:"status-info"},ti={class:"file-size"},ai={class:"status-info"},li={class:"file-size"},oi={class:"status-info"},si={class:"sdk-management"},ni={class:"section-title"},ii={class:"sdk-grid"},ri={class:"sdk-item"},ci={class:"sdk-header"},ui={class:"sdk-icon android"},di={class:"sdk-details"},pi={class:"detail-item"},mi={class:"value"},fi={class:"detail-item"},gi={class:"value"},vi={class:"detail-item"},hi={class:"value"},yi={class:"sdk-actions"},bi={class:"sdk-item"},_i={class:"sdk-header"},wi={class:"sdk-icon ios"},xi={class:"sdk-details"},Si={class:"detail-item"},Ci={class:"value"},ki={class:"detail-item"},Vi={class:"value"},Ti={class:"detail-item"},Ai={class:"value"},Di={class:"sdk-actions"},Ii={class:"sdk-item"},Ei={class:"sdk-header"},Oi={class:"sdk-icon pwa"},zi={class:"sdk-actions"},Pi={class:"connection-status"},Ni={class:"section-title"},Ui={class:"qr-connection-management"},Mi={class:"section-title"},Bi={class:"qr-generator"},Ri={class:"qr-display"},$i={key:0,class:"qr-code-container"},Fi=["src"],Li={class:"qr-info"},qi={class:"qr-status"},ji={key:0,class:"qr-expire"},Ki={key:1,class:"qr-id"},Ji={key:1,class:"qr-placeholder"},Hi={class:"alternative-connections"},Wi={class:"section-title"},Yi={class:"connection-header"},Qi={class:"connection-content"},Xi={class:"connection-status"},Gi={class:"connection-config"},Zi={class:"connection-actions"},er={class:"connection-header"},tr={class:"connection-content"},ar={class:"connection-status"},lr={class:"connection-config"},or={class:"connection-actions"},sr={class:"connection-header"},nr={class:"connection-content"},ir={class:"connection-status"},rr={class:"connection-config"},cr={class:"pairing-code-display"},ur={class:"pairing-code"},dr={class:"connection-actions"},pr={class:"stat-item"},mr={class:"stat-value"},fr={class:"stat-item"},gr={class:"stat-value"},vr={class:"stat-item"},hr={class:"stat-value"},yr={class:"stat-item"},br={class:"stat-value"},_r={class:"connected-devices-section"},wr={class:"card-header"},xr={key:0,class:"empty-devices"},Sr={class:"usage-guide"},Cr={class:"section-title"},kr={class:"guide-content"},Vr={class:"card-header"},Tr={class:"logs-container"},Ar=q({__name:"Settings",setup(t){const l=a(),o=e(),u=j("basic"),p=j(!1),m=j(!1),f=j(!1),v=j(!1),b=j(!1),_=j(!1),L=j(!1),q=j(!1),W=j(!1),ue=j(!1),de=j(!1),pe=j(!1),me=j(!1),fe=j(!1),ve=J(()=>o.systemConfig),he=J(()=>o.securityConfig),ye=j([{id:1,type:"user",title:"用户使用协议",content:'<div style="font-family: Microsoft YaHei, PingFang SC, sans-serif; line-height: 1.8; color: #333; padding: 20px;"><h1 style="text-align: center; color: #409eff; font-size: 20px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #409eff; font-weight: bold;">用户使用协议</h1><p style="text-indent: 2em; margin-bottom: 15px; font-size: 14px; color: #606266;">欢迎使用本CRM客户管理系统（以下简称<strong style="color: #409eff;">"本系统"</strong>）。在使用本系统之前，请您<strong style="color: #409eff;">仔细阅读并充分理解</strong>本协议的全部内容。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">一、协议的接受</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">1.1 本协议是您与本系统运营方之间关于使用本系统服务所订立的协议。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">1.2 您点击<strong style="color: #409eff;">"同意"</strong>按钮即表示您<strong style="color: #409eff;">完全接受</strong>本协议的全部条款。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">二、服务内容</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">2.1 本系统为企业提供<strong style="color: #409eff;">客户关系管理服务</strong>，包括但不限于：</p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">客户信息管理</li><li style="margin-bottom: 5px; font-size: 14px;">订单管理</li><li style="margin-bottom: 5px; font-size: 14px;">业绩统计</li><li style="margin-bottom: 5px; font-size: 14px;">数据分析</li><li style="margin-bottom: 5px; font-size: 14px;">团队协作</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">2.2 本系统保留随时修改或中断服务而不需通知用户的权利。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">三、用户权利和义务</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #409eff;">3.1 用户权利：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">使用本系统提供的各项功能</li><li style="margin-bottom: 5px; font-size: 14px;">管理自己的客户数据</li><li style="margin-bottom: 5px; font-size: 14px;">查看业绩统计报表</li><li style="margin-bottom: 5px; font-size: 14px;">获得技术支持服务</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #409eff;">3.2 用户义务：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">遵守国家法律法规</li><li style="margin-bottom: 5px; font-size: 14px;">不得利用本系统从事违法活动</li><li style="margin-bottom: 5px; font-size: 14px;">妥善保管账号密码</li><li style="margin-bottom: 5px; font-size: 14px;">对账号下的所有行为负责</li><li style="margin-bottom: 5px; font-size: 14px;">不得恶意攻击系统</li><li style="margin-bottom: 5px; font-size: 14px;">不得泄露客户隐私信息</li></ul><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">四、数据安全</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">4.1 本系统采用<strong style="color: #409eff;">行业标准的安全措施</strong>保护用户数据。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">4.2 用户应定期备份重要数据，本系统不对数据丢失承担责任。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">4.3 未经授权访问、使用、修改或破坏系统数据的行为将<strong style="color: #f56c6c;">承担法律责任</strong>。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">五、知识产权</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">5.1 本系统的所有内容，包括但不限于<strong style="color: #409eff;">文字、图片、软件、程序</strong>等，均受知识产权法保护。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">5.2 未经许可，用户不得复制、传播、修改本系统的任何内容。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">六、免责声明</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">6.1 本系统不对因以下原因导致的损失承担责任：</p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">不可抗力因素</li><li style="margin-bottom: 5px; font-size: 14px;">网络故障</li><li style="margin-bottom: 5px; font-size: 14px;">用户操作不当</li><li style="margin-bottom: 5px; font-size: 14px;">第三方侵权行为</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">6.2 本系统提供的数据分析结果仅供参考，不构成任何投资建议。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">七、协议的变更</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">7.1 本系统有权随时修改本协议条款。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">7.2 协议变更后，继续使用本系统即视为<strong style="color: #409eff;">接受新协议</strong>。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">八、争议解决</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">8.1 本协议的解释、效力及纠纷的解决，适用<strong style="color: #409eff;">中华人民共和国法律</strong>。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">8.2 若发生争议，双方应友好协商解决；协商不成的，可向本系统所在地人民法院提起诉讼。</p><h2 style="color: #409eff; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #409eff; font-weight: bold;">九、其他</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">9.1 本协议自用户点击同意之日起生效。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">9.2 如本协议中的任何条款无论因何种原因完全或部分无效或不具有执行力，本协议的其余条款仍应有效并且有约束力。</p><p style="text-align: center; margin-top: 30px; color: #909399; font-size: 13px;">最后更新日期：2025年11月22日</p></div>',wordCount:1456,summary:'欢迎使用本CRM客户管理系统（以下简称"本系统"）。在使用本系统之前，请您仔细阅读并充分理解本协议的全部内容。一、协议的接受1.1 本协议是您与本系统运营方之间关于使用本系统服务所订立的协议。1.2 您点击"同意"按钮即表示您完全接受本协议的全部条款...',updateTime:"2025/11/22 17:30:00",enabled:!0},{id:2,type:"privacy",title:"用户隐私协议",content:'<div style="font-family: Microsoft YaHei, PingFang SC, sans-serif; line-height: 1.8; color: #333; padding: 20px;"><h1 style="text-align: center; color: #67C23A; font-size: 20px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #67C23A; font-weight: bold;">用户隐私协议</h1><p style="text-indent: 2em; margin-bottom: 15px; font-size: 14px; color: #606266;">本隐私协议（以下简称<strong style="color: #67C23A;">"本协议"</strong>）适用于本CRM客户管理系统（以下简称<strong style="color: #67C23A;">"本系统"</strong>）。我们非常重视用户的隐私保护，特制定本协议。</p><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">一、信息收集</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">1.1 我们收集的信息类型：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">账号信息：用户名、密码、邮箱、手机号</li><li style="margin-bottom: 5px; font-size: 14px;">个人信息：姓名、部门、职位</li><li style="margin-bottom: 5px; font-size: 14px;">业务信息：客户数据、订单信息、业绩数据</li><li style="margin-bottom: 5px; font-size: 14px;">使用信息：登录日志、操作记录、访问时间</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">1.2 信息收集方式：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">用户主动提供</li><li style="margin-bottom: 5px; font-size: 14px;">系统自动收集</li><li style="margin-bottom: 5px; font-size: 14px;">第三方合法提供</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">二、信息使用</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">2.1 我们使用收集的信息用于：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">提供系统服务</li><li style="margin-bottom: 5px; font-size: 14px;">改进用户体验</li><li style="margin-bottom: 5px; font-size: 14px;">数据统计分析</li><li style="margin-bottom: 5px; font-size: 14px;">安全监控</li><li style="margin-bottom: 5px; font-size: 14px;">技术支持</li><li style="margin-bottom: 5px; font-size: 14px;">发送系统通知</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">2.2 我们承诺：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">不会将用户信息用于本协议未载明的其他用途</li><li style="margin-bottom: 5px; font-size: 14px;">不会向第三方出售用户信息</li><li style="margin-bottom: 5px; font-size: 14px;">严格限制信息访问权限</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">三、信息存储</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">3.1 存储位置：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">用户数据存储在本地浏览器</li><li style="margin-bottom: 5px; font-size: 14px;">部分数据可能存储在服务器</li><li style="margin-bottom: 5px; font-size: 14px;">采用加密技术保护敏感信息</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">3.2 存储期限：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">账号存续期间持续存储</li><li style="margin-bottom: 5px; font-size: 14px;">账号注销后，数据将在30天内删除</li><li style="margin-bottom: 5px; font-size: 14px;">法律法规要求保留的除外</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">四、信息保护</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">4.1 安全措施：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">数据加密传输（HTTPS）</li><li style="margin-bottom: 5px; font-size: 14px;">密码加密存储</li><li style="margin-bottom: 5px; font-size: 14px;">访问权限控制</li><li style="margin-bottom: 5px; font-size: 14px;">定期安全审计</li><li style="margin-bottom: 5px; font-size: 14px;">异常行为监控</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">4.2 安全承诺：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">采用行业标准的安全技术</li><li style="margin-bottom: 5px; font-size: 14px;">建立数据安全管理制度</li><li style="margin-bottom: 5px; font-size: 14px;">定期进行安全培训</li><li style="margin-bottom: 5px; font-size: 14px;">及时修复安全漏洞</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">五、信息共享</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">5.1 我们不会与第三方共享用户信息，除非：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">获得用户明确同意</li><li style="margin-bottom: 5px; font-size: 14px;">法律法规要求</li><li style="margin-bottom: 5px; font-size: 14px;">保护系统安全所必需</li><li style="margin-bottom: 5px; font-size: 14px;">维护用户合法权益所必需</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">5.2 共享原则：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">最小必要原则</li><li style="margin-bottom: 5px; font-size: 14px;">合法正当原则</li><li style="margin-bottom: 5px; font-size: 14px;">安全可控原则</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">六、用户权利</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">6.1 您享有以下权利：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">访问您的个人信息</li><li style="margin-bottom: 5px; font-size: 14px;">更正不准确的信息</li><li style="margin-bottom: 5px; font-size: 14px;">删除您的个人信息</li><li style="margin-bottom: 5px; font-size: 14px;">撤回信息使用授权</li><li style="margin-bottom: 5px; font-size: 14px;">注销您的账号</li><li style="margin-bottom: 5px; font-size: 14px;">投诉举报</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">6.2 权利行使方式：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">通过系统设置自行操作</li><li style="margin-bottom: 5px; font-size: 14px;">联系客服协助处理</li><li style="margin-bottom: 5px; font-size: 14px;">发送邮件申请</li></ul><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">七、Cookie使用</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;"><strong style="color: #67C23A;">7.1 本系统使用Cookie技术：</strong></p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">记住登录状态</li><li style="margin-bottom: 5px; font-size: 14px;">保存用户偏好设置</li><li style="margin-bottom: 5px; font-size: 14px;">统计访问数据</li><li style="margin-bottom: 5px; font-size: 14px;">改善用户体验</li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">7.2 您可以通过浏览器设置管理Cookie。</p><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">八、未成年人保护</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">8.1 本系统不向未满18周岁的未成年人提供服务。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">8.2 如发现未成年人使用本系统，我们将立即停止服务并删除相关信息。</p><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">九、隐私协议的变更</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">9.1 我们可能适时修订本协议。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">9.2 变更后的协议将在系统内公布，继续使用即视为<strong style="color: #67C23A;">接受新协议</strong>。</p><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">9.3 重大变更将通过系统通知或邮件方式告知用户。</p><h2 style="color: #67C23A; font-size: 16px; margin: 20px 0 10px; padding-left: 10px; border-left: 3px solid #67C23A; font-weight: bold;">十、联系我们</h2><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">如您对本隐私协议有任何疑问、意见或建议，请通过以下方式联系我们：</p><ul style="margin-left: 3em; margin-bottom: 15px; list-style: disc; color: #606266;"><li style="margin-bottom: 5px; font-size: 14px;">客服电话：<strong style="color: #67C23A;">13570727364</strong></li><li style="margin-bottom: 5px; font-size: 14px;">客服微信：<strong style="color: #67C23A;">nxys789</strong></li><li style="margin-bottom: 5px; font-size: 14px;">客服邮箱：<strong style="color: #67C23A;">xianhuquwang@163.com</strong></li><li style="margin-bottom: 5px; font-size: 14px;">公司地址：<strong style="color: #67C23A;">广州市黄埔区南翔一路68号</strong></li></ul><p style="text-indent: 2em; margin-bottom: 10px; font-size: 14px;">我们将在收到您的反馈后<strong style="color: #67C23A;">15个工作日</strong>内予以回复。</p><p style="text-align: center; margin-top: 30px; color: #909399; font-size: 13px;">最后更新日期：2025年11月22日</p></div>',wordCount:1523,summary:'本隐私协议（以下简称"本协议"）适用于本CRM客户管理系统（以下简称"本系统"）。我们非常重视用户的隐私保护，特制定本协议。一、信息收集1.1 我们收集的信息类型：账号信息：用户名、密码、邮箱、手机号；个人信息：姓名、部门、职位；业务信息：客户数据、订单信息、业绩数据...',updateTime:"2025/11/22 17:45:00",enabled:!0}]),Oe=j(!1),ze=J(()=>l.isAdmin),Ne=j(!1),Me=j(null),Be=K({smtpHost:"smtp.qq.com",smtpPort:587,senderEmail:"",senderName:"CRM系统",emailPassword:"",enableSsl:!1,enableTls:!0,testEmail:""}),Fe=K({sipServer:"",sipPort:5060,sipUsername:"",sipPassword:"",sipTransport:"UDP",autoAnswer:!1,autoRecord:!0,qualityMonitoring:!0,incomingCallPopup:!0,maxCallDuration:3600,recordFormat:"wav",recordQuality:"standard",recordPath:"/recordings",recordRetentionDays:30,outboundPermission:["admin","manager","sales"],recordAccessPermission:["admin","manager"],statisticsPermission:["admin","manager"],numberRestriction:!1,allowedPrefixes:""}),Le=J(()=>o.smsConfig),qe=J(()=>o.storageConfig),je=J(()=>o.productConfig),He=j(Ue.getSyncConfig()),We=j(Ue.getSyncStatus()),Ye=j({systemInfo:{os:"",arch:"",cpuCores:0,totalMemory:"",nodeVersion:"",uptime:""},performance:{cpuUsage:0,memoryUsage:0,diskUsage:0,networkLatency:0},database:{type:"localStorage",version:"浏览器存储",connected:!0,activeConnections:0,size:"0 KB",lastBackup:"未备份"},services:[]}),Qe=()=>{try{if(Ye.value.systemInfo={os:navigator.platform||"未知",arch:navigator.userAgent.includes("x64")?"x64":navigator.userAgent.includes("ARM")?"ARM":"x86",cpuCores:navigator.hardwareConcurrency||0,totalMemory:performance.memory?`${(performance.memory.jsHeapSizeLimit/1024/1024/1024).toFixed(2)} GB (JS堆)`:"未知",nodeVersion:"浏览器环境",uptime:`页面运行 ${Math.floor(performance.now()/1e3/60)} 分钟`},performance&&performance.memory){const e=performance.memory;Ye.value.performance.memoryUsage=Math.round(e.usedJSHeapSize/e.jsHeapSizeLimit*100)}else Ye.value.performance.memoryUsage=0;const e=performance.getEntriesByType("navigation");if(e.length>0){const t=e[0],a=t.loadEventEnd-t.fetchStart;Ye.value.performance.cpuUsage=Math.min(Math.round(a/100),100)}let t=0;for(const l in localStorage)localStorage.hasOwnProperty(l)&&(t+=localStorage[l].length);const a=10;if(Ye.value.performance.diskUsage=Math.min(Math.round(t/1024/1024/a*100),100),navigator.connection&&navigator.connection.rtt)Ye.value.performance.networkLatency=navigator.connection.rtt;else{const e=performance.getEntriesByType("resource");if(e.length>0){const t=e.reduce((e,t)=>e+t.duration,0)/e.length;Ye.value.performance.networkLatency=Math.round(t)}}Ye.value.database={type:"localStorage",version:"浏览器存储",connected:!0,activeConnections:1,size:`${(t/1024).toFixed(2)} KB`,lastBackup:localStorage.getItem("lastBackupTime")||"未备份"},Ye.value.services=[{name:"前端应用",status:"running",port:window.location.port||"80",uptime:`${Math.floor(performance.now()/1e3/60)} 分钟`,memory:performance.memory?`${(performance.memory.usedJSHeapSize/1024/1024).toFixed(2)} MB`:"未知"},{name:"localStorage",status:"running",port:"-",uptime:"持久化",memory:`${(t/1024).toFixed(2)} KB`},{name:"网络连接",status:navigator.onLine?"running":"stopped",port:"-",uptime:navigator.onLine?"在线":"离线",memory:navigator.connection?`${navigator.connection.effectiveType||"未知"}`:"未知"}],console.log("[系统监控] 真实数据已加载:",Ye.value)}catch(e){console.error("[系统监控] 获取真实数据失败:",e)}};H(()=>{Qe()});const Xe=j(!1),Ge=j(!1),Ze=j(!1),et=j(""),tt=j(!1),at=K({autoBackupEnabled:!1,backupFrequency:"daily",retentionDays:30,compression:!0}),lt=j(""),ot=j(0),st=j(0),nt=j([]),it=j(!1),rt=j(!1),ct=j(null),ut=j(null),dt=j(0),pt=j([]),mt=j(!1),ft=j("android"),gt=j({android:{version:"v2.1.3",size:"6.0 MB",updateTime:"2024-01-20 16:45:00",available:!0,downloadUrl:"/api/sdk/download/android/latest",features:["通话管理","客户管理","数据同步","离线支持"]},ios:{version:"v2.1.3",size:"32.8 MB",updateTime:"2024-01-20 16:45:00",available:!0,downloadUrl:"/api/sdk/download/ios/latest",features:["通话管理","客户管理","数据同步","离线支持"]}}),vt=j(!1);j({qrCodeUrl:"",connectionId:"",expiresAt:"",isActive:!1}),K({userId:l.user?.id||"",permissions:["read","write"],expirationMinutes:30});const ht=j([]),yt=j(!1),bt=j({qrCodeUrl:"",connectionId:"",status:"inactive",expiresAt:"",connectedDevices:[]}),_t=K({permissions:["call","sms"],expireTime:"30"}),wt=j(!1),xt=j({host:"localhost",port:3e3,wsPort:3001,ssl:!1,apiVersion:"v1.0"}),St=j({active:5,today:23,total:156,lastConnection:"2024-01-15 16:45:00",qr:0,bluetooth:0,network:0,digital:0}),Ct=j({enabled:!1,deviceName:"CRM-Server",pairingCode:""}),kt=j(!1),Vt=j({enabled:!1,port:8080,broadcastInterval:"10"}),Tt=j(!1),At=j({enabled:!1,currentCode:"",expireTime:"10"}),Dt=j(!1),It=j(!1),Et=J(()=>{const e=o.storageConfig;return"oss"===e.storageType&&e.accessKey&&e.secretKey&&e.bucketName&&e.region}),Ot=J(()=>{const e=qe.value;if(!e.imageCompressEnabled)return"图片压缩已关闭，上传的图片将保持原始大小";let t=60,a=1200,l="标准";switch(e.imageCompressQuality){case"high":t=80,a=1920,l="高清";break;case"medium":t=60,a=1200,l="标准";break;case"low":t=40,a=800,l="省流";break;case"custom":t=e.imageCompressCustomQuality||60,a=e.imageCompressMaxWidth||1200,l="自定义"}return`当前配置：${l}模式，压缩质量${t}%，最大宽度${a}px。预计可减少50%-80%的文件大小。`}),zt=J(()=>l.hasPermission("system:backup:edit")),Pt={systemName:[{required:!0,message:"请输入系统名称",trigger:"blur"}],companyName:[{required:!0,message:"请输入公司名称",trigger:"blur"}],contactEmail:[{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}]},Nt={passwordMinLength:[{required:!0,message:"请设置密码最小长度",trigger:"blur"}],maxLoginFails:[{required:!0,message:"请设置最大失败次数",trigger:"blur"}],lockDuration:[{required:!0,message:"请设置锁定时间",trigger:"blur"}],sessionTimeout:[{required:!0,message:"请设置会话超时时间",trigger:"blur"}]},Ut={smtpHost:[{required:!0,message:"请输入SMTP服务器",trigger:"blur"}],smtpPort:[{required:!0,message:"请输入SMTP端口",trigger:"blur"}],senderEmail:[{required:!0,message:"请输入发件人邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],testEmail:[{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}]},Mt={sipServer:[{required:!0,message:"请输入SIP服务器地址",trigger:"blur"}],sipPort:[{required:!0,message:"请输入SIP端口",trigger:"blur"},{type:"number",min:1,max:65535,message:"端口范围为1-65535",trigger:"blur"}],sipUsername:[{required:!0,message:"请输入SIP用户名",trigger:"blur"}],sipPassword:[{required:!0,message:"请输入SIP密码",trigger:"blur"}],recordPath:[{required:!0,message:"请输入录音保存路径",trigger:"blur"}],recordRetentionDays:[{required:!0,message:"请设置录音保留时间",trigger:"blur"},{type:"number",min:1,max:365,message:"保留时间范围为1-365天",trigger:"blur"}]},Bt={provider:[{required:!0,message:"请选择短信服务商",trigger:"change"}],accessKey:[{required:!0,message:"请输入AccessKey",trigger:"blur"}],secretKey:[{required:!0,message:"请输入SecretKey",trigger:"blur"}],signName:[{required:!0,message:"请输入短信签名",trigger:"blur"}],dailyLimit:[{required:!0,message:"请设置每日发送限制",trigger:"blur"}],monthlyLimit:[{required:!0,message:"请设置每月发送限制",trigger:"blur"}],testPhone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}]},Rt=J(()=>{const e={};return"local"===qe.value.storageType?e.localPath=[{required:!0,message:"请输入存储路径",trigger:"blur"}]:"oss"===qe.value.storageType&&(e.accessKey=[{required:!0,message:"请输入Access Key",trigger:"blur"}],e.secretKey=[{required:!0,message:"请输入Secret Key",trigger:"blur"}],e.bucketName=[{required:!0,message:"请输入存储桶名称",trigger:"blur"}],e.region=[{required:!0,message:"请选择存储区域",trigger:"change"}]),e}),$t={maxDiscountPercent:[{required:!0,message:"请设置全局最大优惠比例",trigger:"blur"},{type:"number",min:0,max:100,message:"优惠比例应在0-100之间",trigger:"blur"}],adminMaxDiscount:[{required:!0,message:"请设置管理员最大优惠",trigger:"blur"},{type:"number",min:0,max:100,message:"优惠比例应在0-100之间",trigger:"blur"}],managerMaxDiscount:[{required:!0,message:"请设置经理最大优惠",trigger:"blur"},{type:"number",min:0,max:100,message:"优惠比例应在0-100之间",trigger:"blur"}],salesMaxDiscount:[{required:!0,message:"请设置销售员最大优惠",trigger:"blur"},{type:"number",min:0,max:100,message:"优惠比例应在0-100之间",trigger:"blur"}],discountApprovalThreshold:[{required:!0,message:"请设置优惠审批阈值",trigger:"blur"},{type:"number",min:0,max:100,message:"审批阈值应在0-100之间",trigger:"blur"}],lowStockThreshold:[{required:!0,message:"请设置低库存预警阈值",trigger:"blur"},{type:"number",min:0,message:"预警阈值不能为负数",trigger:"blur"}],defaultCategory:[{required:!0,message:"请输入默认分类名称",trigger:"blur"},{min:1,max:20,message:"分类名称长度在1-20个字符",trigger:"blur"}],maxCategoryLevel:[{required:!0,message:"请设置分类层级限制",trigger:"blur"},{type:"number",min:1,max:5,message:"分类层级应在1-5之间",trigger:"blur"}],costPriceViewRoles:[{required:!0,message:"请选择成本价格查看权限角色",trigger:"change"}],salesDataViewRoles:[{required:!0,message:"请选择销售数据查看权限角色",trigger:"change"}],stockInfoViewRoles:[{required:!0,message:"请选择库存信息查看权限角色",trigger:"change"}],operationLogsViewRoles:[{required:!0,message:"请选择操作日志查看权限角色",trigger:"change"}],sensitiveInfoHideMethod:[{required:!0,message:"请选择敏感信息隐藏方式",trigger:"change"}]},Ft={backupFrequency:[{required:!0,message:"请选择备份频率",trigger:"change"}],retentionDays:[{required:!0,message:"请设置保留天数",trigger:"blur"},{type:"number",min:1,max:365,message:"保留天数应在1-365之间",trigger:"blur"}]},Lt=j(),qt=j(),jt=j(),Kt=j(),Jt=j(),Ht=j(),Wt=j(),Yt=j(),Qt=J(()=>l.isAdmin),Xt=J(()=>l.isAdmin),Gt=J(()=>l.isAdmin),Zt=J(()=>l.isAdmin),ea=J(()=>l.isAdmin),ta=J(()=>l.isAdmin),aa=J(()=>l.isAdmin||l.isManager),la=J(()=>l.isAdmin||l.isManager),oa=J(()=>l.isAdmin),sa=e=>{const t="image/jpeg"===e.type||"image/png"===e.type,a=e.size/1024/1024<2;return t?!!a||(i.error("Logo大小不能超过 2MB!"),!1):(i.error("Logo只能是 JPG/PNG 格式!"),!1)},na=(e,t)=>{ve.value.systemLogo=URL.createObjectURL(t.raw)},ia=j(),ra=()=>{ia.value?.click()},ca=e=>{const t=e.target,a=t.files;a&&a.length>0&&da(a[0]),t.value=""},ua=async()=>{try{const e=await navigator.clipboard.read();for(const t of e)for(const e of t.types)if(e.startsWith("image/")){const a=await t.getType(e),l=new File([a],"qr-code.png",{type:e});return void da(l)}i.warning("剪贴板中没有图片")}catch(e){i.error("粘贴图片失败，请检查浏览器权限")}},da=async e=>{try{const{uploadImageWithMessage:t}=await n(async()=>{const{uploadImageWithMessage:e}=await import("./uploadService-C3xZb1GB.js");return{uploadImageWithMessage:e}},__vite__mapDeps([0,1,2,3,4,5])),a=await t(e,"system");a&&(o.updateSystemConfig({contactQRCode:a}),console.log("[Settings] 二维码URL已更新:",a))}catch(t){console.error("二维码上传失败:",t),i.error("上传失败，请重试")}},pa=()=>{ve.value.contactQRCode&&r.alert(`<div style="text-align: center; padding: 20px;">\n        <img src="${ve.value.contactQRCode}" alt="二维码" style="max-width: 400px; max-height: 400px; border: 1px solid #ddd; border-radius: 8px;" />\n      </div>`,"二维码预览",{confirmButtonText:"关闭",dangerouslyUseHTMLString:!0})},ma=async()=>{try{await r.confirm("确定要删除该二维码吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=ve.value.contactQRCode;if(t&&t.includes("/uploads/system/"))try{const e=t.split("/").pop(),{apiService:a}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await a.delete("/system/delete-image",{data:{filename:e}})}catch(e){console.warn("删除服务器文件失败:",e)}o.updateSystemConfig({contactQRCode:"",contactQRCodeLabel:""}),i.success("删除成功")}catch{}},fa=e=>e.replace(/<[^>]+>/g,"").replace(/\s+/g,"").length,ga=e=>{const t=e.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();return t.substring(0,50)+(t.length>50?"...":"")},va=e=>{if(!Me.value)return;const t=ye.value.findIndex(e=>e.id===Me.value.id);if(-1!==t)ye.value[t].content=e,ye.value[t].wordCount=fa(e),ye.value[t].summary=ga(e),ye.value[t].updateTime=(new Date).toLocaleString("zh-CN"),i.success("协议内容已更新");else{const t={...Me.value,content:e,wordCount:fa(e),summary:ga(e),updateTime:(new Date).toLocaleString("zh-CN")};ye.value.push(t),i.success("协议已添加")}},ha=()=>{const e={id:Math.max(...ye.value.map(e=>e.id),0)+1,type:"custom",title:"新协议",content:"<p>请输入协议内容...</p>",wordCount:0,summary:"暂无内容",updateTime:(new Date).toLocaleString("zh-CN"),enabled:!1};Me.value=e,Ne.value=!0},ya=async()=>{try{Oe.value=!0,(()=>{try{localStorage.setItem("crm_agreement_list",JSON.stringify(ye.value));const e=ye.value.find(e=>"user"===e.type),t=ye.value.find(e=>"privacy"===e.type);e&&t&&o.updateSystemConfig({userAgreement:e.content,privacyPolicy:t.content}),console.log("[协议列表] 已保存")}catch(e){throw console.error("[协议列表] 保存失败:",e),e}})(),i.success("协议配置保存成功")}catch(e){console.error("[协议列表] 保存配置失败:",e),i.error("保存失败，请重试")}finally{Oe.value=!1}},ba=async()=>{try{await(Lt.value?.validate()),p.value=!0,o.updateSystemConfig(ve.value),console.log("[基本设置] 已保存到localStorage:",ve.value);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/basic-settings",ve.value),console.log("[基本设置] 已同步到后端API"),i.success("基本设置保存成功")}catch(e){const t=e;console.warn("[基本设置] API调用失败:",t?.message||t),"ECONNREFUSED"===t?.code||404===t?.response?.status?i.success("基本设置保存成功（本地模式）"):403===t?.response?.status?i.error("没有权限修改系统设置，请联系管理员"):500===t?.response?.status?i.error("服务器内部错误: "+(t?.response?.data?.message||"请稍后重试")):i.success("基本设置保存成功")}}catch(t){console.error("[基本设置] 表单验证失败:",t),i.error("保存基本设置失败，请重试")}finally{p.value=!1}},_a=async()=>{try{await(qt.value?.validate()),m.value=!0,o.updateSecurityConfig(he.value),console.log("[安全设置] 已保存到localStorage:",he.value);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/security-settings",he.value),console.log("[安全设置] 已同步到后端API"),i.success("安全设置保存成功")}catch(e){console.warn("[安全设置] API调用失败，已保存到本地:",e.message||e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("安全设置保存成功（本地模式）"):i.warning("安全设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[安全设置] 表单验证失败:",t),i.error("保存安全设置失败，请重试")}finally{m.value=!1}},wa=async()=>{try{await(Kt.value?.validate()),f.value=!0,o.updateEmailConfig(Be),console.log("[邮件设置] 已保存到localStorage:",Be);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/email-settings",Be),console.log("[邮件设置] 已同步到后端API"),i.success("邮件设置保存成功")}catch(e){console.warn("[邮件设置] API调用失败，已保存到本地:",e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("邮件设置保存成功（本地模式）"):i.warning("邮件设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[邮件设置] 表单验证失败:",t),i.error("保存邮件设置失败，请重试")}finally{f.value=!1}},xa=async()=>{try{await(jt.value?.validate()),pe.value=!0,o.updateCallConfig(Fe),console.log("[通话设置] 已保存到localStorage:",Fe);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/call-settings",Fe),console.log("[通话设置] 已同步到后端API"),i.success("通话设置保存成功")}catch(e){console.warn("[通话设置] API调用失败，已保存到本地:",e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("通话设置保存成功（本地模式）"):i.warning("通话设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[通话设置] 表单验证失败:",t),i.error("保存通话设置失败，请重试")}finally{pe.value=!1}},Sa=async()=>{try{me.value=!0,await new Promise(e=>setTimeout(e,2e3)),i.success("SIP连接测试成功")}catch(e){i.error("SIP连接测试失败")}finally{me.value=!1}},Ca=async()=>{if(Be.testEmail)try{v.value=!0,await new Promise(e=>setTimeout(e,2e3)),i.success("测试邮件发送成功，请检查邮箱")}catch(e){i.error("测试邮件发送失败")}finally{v.value=!1}else i.warning("请先输入测试邮箱地址")},ka=async()=>{try{await(Jt.value?.validate()),b.value=!0,o.updateSmsConfig(Le.value),console.log("[短信设置] 已保存到localStorage:",Le.value);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/sms-settings",Le.value),console.log("[短信设置] 已同步到后端API"),i.success("短信设置保存成功")}catch(e){console.warn("[短信设置] API调用失败，已保存到本地:",e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("短信设置保存成功（本地模式）"):i.warning("短信设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[短信设置] 表单验证失败:",t),i.error("保存短信设置失败，请重试")}finally{b.value=!1}},Va=async()=>{if(Le.value.testPhone)try{_.value=!0,await new Promise(e=>setTimeout(e,2e3)),i.success("测试短信发送成功，请检查手机")}catch(e){i.error("测试短信发送失败")}finally{_.value=!1}else i.warning("请先输入测试手机号")},Ta=()=>{ue.value=!0},Aa=async()=>{try{if(kt.value=!0,Ct.value.enabled)await _e(),Ct.value.enabled=!1,Ct.value.pairingCode="",i.success("蓝牙服务已停止");else{const e=await we({deviceName:Ct.value.deviceName});Ct.value.enabled=!0,Ct.value.pairingCode=e.data.pairingCode||Oa(6),i.success("蓝牙服务已启动")}await za()}catch(e){console.error("切换蓝牙连接失败:",e),i.error("操作失败，请重试")}finally{kt.value=!1}},Da=async()=>{try{Tt.value=!0,Vt.value.enabled?(await xe(),Vt.value.enabled=!1,i.success("网络发现已停止")):(await Se({port:Vt.value.port,broadcastInterval:Vt.value.broadcastInterval}),Vt.value.enabled=!0,i.success(`网络发现已启动，端口: ${Vt.value.port}`)),await za()}catch(e){console.error("切换网络连接失败:",e),i.error("操作失败，请重试")}finally{Tt.value=!1}},Ia=async()=>{try{if(Dt.value=!0,At.value.enabled)await Ce(),At.value.enabled=!1,At.value.currentCode="",i.success("数字配对已停止");else{const e=await ke({expireTime:At.value.expireTime});At.value.enabled=!0,At.value.currentCode=e.data.pairingCode||Oa(6),i.success("数字配对已启动")}await za()}catch(e){console.error("切换数字配对失败:",e),i.error("操作失败，请重试")}finally{Dt.value=!1}},Ea=async()=>{try{It.value=!0;const e=await Ve();At.value.currentCode=e.data.pairingCode||Oa(6),i.success("配对码已更新")}catch(e){console.error("生成配对码失败:",e),At.value.currentCode=Oa(6),i.error("生成配对码失败，使用本地生成的配对码")}finally{It.value=!1}},Oa=e=>{const t="0123456789";let a="";for(let l=0;l<e;l++)a+=t.charAt(Math.floor(10*Math.random()));return a},za=async()=>{try{const e=(await Te()).data;St.value={qr:e.qr||St.value.qr,bluetooth:e.bluetooth||0,network:e.network||0,digital:e.digital||0,active:e.active||0}}catch(e){console.error("获取连接统计失败:",e),Ct.value.enabled?St.value.bluetooth=Math.floor(5*Math.random())+1:St.value.bluetooth=0,Vt.value.enabled?St.value.network=Math.floor(8*Math.random())+1:St.value.network=0,At.value.enabled?St.value.digital=Math.floor(3*Math.random())+1:St.value.digital=0,St.value.active=St.value.qr+St.value.bluetooth+St.value.network+St.value.digital}},Pa=async()=>{try{await(Ht.value?.validate()),L.value=!0,o.updateStorageConfig(qe.value),console.log("[存储设置] 已保存到localStorage:",qe.value);const{clearStorageConfigCache:t}=await n(async()=>{const{clearStorageConfigCache:e}=await import("./uploadService-C3xZb1GB.js");return{clearStorageConfigCache:e}},__vite__mapDeps([0,1,2,3,4,5]));if(t(),console.log("[存储设置] 已清除上传服务缓存"),"oss"===qe.value.storageType){const{ossService:e}=await n(async()=>{const{ossService:e}=await Promise.resolve().then(()=>Pe);return{ossService:e}},void 0);await e.reinitialize()}try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/storage-settings",qe.value),console.log("[存储设置] 已同步到后端API"),i.success("存储设置保存成功")}catch(e){console.warn("[存储设置] API调用失败，已保存到本地:",e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("存储设置保存成功（本地模式）"):i.warning("存储设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[存储设置] 表单验证失败:",t),i.error("保存存储设置失败，请重试")}finally{L.value=!1}},Na=async()=>{try{if(await(Wt.value?.validate()),je.value.salesMaxDiscount>je.value.managerMaxDiscount)return void i.warning("销售员最大优惠不能超过经理最大优惠");if(je.value.managerMaxDiscount>je.value.adminMaxDiscount)return void i.warning("经理最大优惠不能超过管理员最大优惠");if(je.value.discountApprovalThreshold>je.value.maxDiscountPercent)return void i.warning("优惠审批阈值不能超过全局最大优惠比例");q.value=!0,o.updateProductConfig(je.value),console.log("[商品设置] 已保存到localStorage:",je.value);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/product-settings",je.value),console.log("[商品设置] 已同步到后端API"),i.success("商品设置保存成功")}catch(e){console.warn("[商品设置] API调用失败，已保存到本地:",e.message||e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("商品设置保存成功（本地模式）"):i.warning("商品设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[商品设置] 表单验证失败:",t),t.message?i.error(t.message):i.error("保存商品设置失败，请重试")}finally{q.value=!1}},Ua=()=>{r.confirm("确定要重置商品设置吗？这将恢复到默认配置。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.resetProductConfig(),Wt.value?.clearValidate(),i.success("商品设置已重置为默认配置")}).catch(()=>{})},Ma=async()=>{try{W.value=!0,Qe();try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5])),t=await e.get("/system/monitor");t.systemInfo&&(Ye.value.systemInfo={...Ye.value.systemInfo,...t.systemInfo}),t.performance&&(Ye.value.performance={...Ye.value.performance,...t.performance}),t.database&&(Ye.value.database={...Ye.value.database,...t.database}),t.services&&t.services.length>0&&(Ye.value.services=[...Ye.value.services,...t.services]),console.log("[系统监控] 已同步服务器监控数据"),i.success("监控数据刷新成功（包含服务器数据）")}catch(e){console.warn("[系统监控] API调用失败，使用前端数据:",e.message||e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("监控数据刷新成功（前端模式）"):i.warning("监控数据已刷新，但未能获取服务器数据")}}catch(t){console.error("[系统监控] 刷新失败:",t),i.error("刷新监控数据失败")}finally{W.value=!1}},Ba=()=>{Ue.updateSyncConfig(He.value),i.success("同步配置已更新")},Ra=async()=>{try{i.info("开始同步数据到云端...");const e=await Ue.syncAllData();We.value=Ue.getSyncStatus(),e?i.success("数据同步完成"):i.warning("数据同步完成，但有部分失败项")}catch(e){console.error("手动同步失败:",e),i.error("数据同步失败，请检查网络连接和OSS配置")}},$a=async()=>{try{await r.confirm("确定要从云端恢复数据吗？这将覆盖本地数据。","恢复数据确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i.info("开始从云端恢复数据...");await Ue.restoreFromOSS()?(i.success("数据恢复完成"),location.reload()):i.error("数据恢复失败")}catch(e){"cancel"!==e&&(console.error("数据恢复失败:",e),i.error("数据恢复失败，请重试"))}},Fa=async()=>{try{i.info("正在检查数据完整性...");await Ue.checkDataIntegrity()?i.success("数据完整性检查通过"):i.warning("数据完整性检查发现问题，建议重新同步")}catch(e){console.error("数据完整性检查失败:",e),i.error("数据完整性检查失败")}},La=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(t){return e}},qa=async()=>{de.value=!0;try{i.info("开始测试数据持久性功能...");const e=await Re(),t=e.length,a=e.filter(e=>e.passed).length,l=t-a;0===l?i.success(`所有测试通过！(${a}/${t})`):i.warning(`测试完成：${a}/${t} 通过，${l} 失败`),console.group("数据持久性测试结果"),e.forEach(e=>{e.passed?console.log(`✅ ${e.name}: ${e.message}`):(console.error(`❌ ${e.name}: ${e.message}`),e.error&&console.error("错误详情:",e.error))}),console.groupEnd();const o=e.filter(e=>!e.passed);if(o.length>0){const e=o.map(e=>`• ${e.name}: ${e.message}`).join("\n");r.alert(`失败的测试:\n${e}\n\n请查看控制台获取详细错误信息`,"测试结果",{type:"warning"})}}catch(e){console.error("测试执行失败:",e),i.error("测试执行失败，请查看控制台获取详细信息")}finally{de.value=!1}},ja=async()=>{if(Et.value)try{Xe.value=!0,await $e.performManualBackup(),i.success("备份成功"),await Ha(),await Wa()}catch(e){console.error("备份失败:",e),i.error("备份失败: "+e.message)}finally{Xe.value=!1}else i.warning("请先配置OSS存储")},Ka=async()=>{try{await(Yt.value?.validate()),Ge.value=!0,await $e.setBackupConfig(at),console.log("[备份设置] 已保存到本地:",at);try{const{apiService:e}=await n(async()=>{const{apiService:e}=await import("./index-DkAJPKqn.js").then(e=>e.Q);return{apiService:e}},__vite__mapDeps([1,2,3,4,5]));await e.put("/system/backup-settings",at),console.log("[备份设置] 已同步到后端API"),i.success("备份设置保存成功")}catch(e){console.warn("[备份设置] API调用失败，已保存到本地:",e),"ECONNREFUSED"===e.code||404===e.response?.status?i.success("备份设置保存成功（本地模式）"):i.warning("备份设置已保存到本地，但未能同步到服务器")}}catch(t){console.error("[备份设置] 保存失败:",t),i.error("保存失败: "+t.message)}finally{Ge.value=!1}},Ja=async()=>{try{tt.value=!0,i.info("开始运行备份功能测试..."),await Ke()}catch(e){console.error("测试备份功能失败:",e),i.error("测试失败: "+e.message)}finally{tt.value=!1}},Ha=async()=>{try{Ze.value=!0,nt.value=await $e.getBackupList()}catch(e){console.error("加载备份列表失败:",e)}finally{Ze.value=!1}},Wa=async()=>{try{const e=await $e.getBackupConfig();Object.assign(at,e);const t=await $e.getBackupList();if(t&&Array.isArray(t)){if(ot.value=t.length,st.value=t.reduce((e,t)=>e+t.size,0),t.length>0){const e=t.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())[0];lt.value=e.timestamp}}else ot.value=0,st.value=0}catch(e){console.error("加载备份状态失败:",e)}},Ya=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},Xa=async()=>{try{it.value=!0;const e=new Je,t=await e.exportAllData();t.success?(i.success("数据导出成功！"),ct.value=t.statistics,dt.value=1):i.error(`数据导出失败：${t.error}`)}catch(e){console.error("导出数据失败:",e),i.error("导出数据失败，请检查控制台错误信息")}finally{it.value=!1}},Ga=async()=>{try{rt.value=!0;const e=new Je,t=await e.validateData();ut.value=t,0===t.issues.length?i.success("数据验证通过！"):i.warning(`发现 ${t.issues.length} 个数据问题`)}catch(e){console.error("验证数据失败:",e),i.error("验证数据失败，请检查控制台错误信息")}finally{rt.value=!1}},Za=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]},el=e=>{const t={database:"DATABASE_ARCHITECTURE.md",api:"BACKEND_API_ARCHITECTURE.md",migration:"DATA_MIGRATION_PLAN.md"}[e];t&&i.info(`请查看项目根目录下的 ${t} 文件`)},tl=e=>{switch(e){case"ERROR":return"danger";case"WARN":return"warning";case"INFO":return"success";case"DEBUG":return"info";default:return""}},al=async()=>{try{fe.value=!0;const t=await(e={limit:100},s({url:"/logs/system",method:"get",params:e}));t.success&&t.data?(pt.value=t.data,i.success(`已刷新 ${t.data.length} 条日志`)):i.error("获取日志失败")}catch(t){console.error("刷新日志失败:",t),i.error("刷新日志失败")}finally{fe.value=!1}var e},ll=async()=>{try{await r.confirm("确定要清空所有系统日志吗？此操作不可恢复。","确认清空",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await s({url:"/logs/clear",method:"delete"});e.success?(pt.value=[],i.success(e.message)):i.error("清空日志失败")}catch(e){"cancel"!==e&&(console.error("清空日志失败:",e),i.error("清空日志失败"))}},ol=async()=>{mt.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),gt.value.android.updateTime=(new Date).toLocaleString(),gt.value.ios.updateTime=(new Date).toLocaleString(),St.value.active=Math.floor(10*Math.random())+1,St.value.today=Math.floor(50*Math.random())+10,St.value.lastConnection=(new Date).toLocaleString(),i.success("SDK信息已刷新")}catch(e){i.error("刷新SDK信息失败")}finally{mt.value=!1}},sl=()=>{if(!gt.value.android.available)return void i.warning("Android SDK暂不可用");const e=document.createElement("a");e.href="/downloads/CRM-Mobile-SDK-v2.1.3.apk",e.download="CRM-Mobile-SDK-v2.1.3.apk",document.body.appendChild(e),e.click(),document.body.removeChild(e),i.success("开始下载Android SDK v2.1.3 (6MB)")},nl=()=>{if(!gt.value.ios.available)return void i.warning("iOS SDK暂不可用");const e=document.createElement("a");e.href="/downloads/crm-ios-v1.0.0.ipa",e.download="crm-ios-v1.0.0.ipa",document.body.appendChild(e),e.click(),document.body.removeChild(e),i.success("开始下载iOS SDK")},il=e=>{ft.value=e;const t=document.querySelector(".usage-guide");t&&t.scrollIntoView({behavior:"smooth"})},rl=()=>{const e=`${window.location.origin}/mobile`;window.open(e,"_blank"),i.success("正在打开PWA应用")},ul=async()=>{const e=`${window.location.origin}/mobile`;try{const t=await dl(e);r.alert(`<div style="text-align: center; padding: 20px;">\n        <div style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">扫描二维码访问PWA应用</div>\n        <div style="margin-bottom: 16px;">\n          <img src="${t}" alt="PWA二维码" style="width: 200px; height: 200px; border: 1px solid #ddd; border-radius: 8px;" />\n        </div>\n        <div style="font-size: 14px; color: #666;">\n          或直接访问：<br>\n          <a href="${e}" target="_blank" style="color: #409eff;">${e}</a>\n        </div>\n      </div>`,"移动应用二维码",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0})}catch(t){console.error("生成二维码失败:",t),i.error("生成二维码失败")}},dl=async e=>{try{const t=await n(()=>import("./browser-BKsVyEpb.js").then(e=>e.b),[]);return await t.toDataURL(e,{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"})}catch(t){return console.error("生成二维码图片失败:",t),`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(e)}`}},pl=async()=>{vt.value=!0;try{const e="qr_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),t=parseInt(_t.expireTime),a=new Date(Date.now()+60*t*1e3),l={connectionId:e,serverUrl:`${window.location.protocol}//${window.location.host}`,permissions:_t.permissions,expiresAt:a.getTime(),type:"system_connection"},o=await dl(JSON.stringify(l));bt.value={qrCodeUrl:o,connectionId:e,status:"active",expiresAt:a.toISOString(),connectedDevices:[]},i.success("二维码生成成功")}catch(e){console.error("生成二维码失败:",e),i.error("生成二维码失败")}finally{vt.value=!1}},ml=async()=>{bt.value.connectionId?(await pl(),i.success("二维码已刷新")):i.warning("请先生成二维码")},fl=e=>{switch(e){case"active":return"success";case"connected":return"primary";case"expired":return"danger";default:return"info"}},gl=e=>{switch(e){case"active":return"等待连接";case"connected":return"已连接";case"expired":return"已过期";default:return"未激活"}},vl=async()=>{wt.value=!0;try{const e=await Ae();ht.value=e.data||[],i.success("设备列表已刷新")}catch(e){console.error("刷新设备列表失败:",e),i.error("刷新设备列表失败"),ht.value=[{id:"device_001",name:"iPhone 13 Pro",type:"iOS",connectionType:"QR Code",connectedAt:"2024-01-20 15:30:00",lastActivity:"2024-01-20 16:45:00",status:"online"},{id:"device_002",name:"Samsung Galaxy S21",type:"Android",connectionType:"Bluetooth",connectedAt:"2024-01-20 14:20:00",lastActivity:"2024-01-20 16:40:00",status:"online"}]}finally{wt.value=!1}},hl=e=>e?new Date(e).toLocaleString("zh-CN"):"";return H(()=>{Wa(),Ha(),al(),(()=>{try{const e=localStorage.getItem("crm_agreement_list");e?(ye.value=JSON.parse(e),console.log("[协议列表] 已加载:",ye.value.length,"个协议")):console.log("[协议列表] 未找到保存的数据，使用默认空列表")}catch(e){console.error("[协议列表] 加载失败:",e)}})();(async()=>{try{const e=new Je,t=await e.getDataStatistics();ct.value=t}catch(e){console.error("获取数据统计失败:",e)}})(),(async()=>{try{yt.value=!0;const{getConnectedDevices:e}=await n(async()=>{const{getConnectedDevices:e}=await import("./qr-connection-KDiO-aU-.js");return{getConnectedDevices:e}},__vite__mapDeps([6,1,2,3,4,5])),t=await e();ht.value=t,i.success("设备列表刷新成功")}catch(e){console.error("刷新设备列表失败:",e),i.error("刷新设备列表失败，请重试")}finally{yt.value=!1}})();(async()=>{try{const e=await De();e.data&&(Ct.value.enabled=e.data.enabled||!1,Ct.value.pairingCode=e.data.pairingCode||"");const t=await Ie();t.data&&(Vt.value.enabled=t.data.enabled||!1);const a=await Ee();a.data&&(At.value.enabled=a.data.enabled||!1,At.value.currentCode=a.data.currentCode||""),await za()}catch(e){console.error("初始化替代连接状态失败:",e)}})();const e=setInterval(()=>{We.value=Ue.getSyncStatus()},5e3);ge(()=>{clearInterval(e)})}),(e,t)=>{const a=Y("el-button"),l=Y("el-input"),o=Y("el-form-item"),s=Y("el-col"),n=Y("el-row"),j=Y("el-icon"),K=Y("el-upload"),J=Y("el-divider"),H=Y("el-form"),ge=Y("el-card"),_e=Y("el-tab-pane"),we=Y("el-input-number"),xe=Y("el-checkbox"),Se=Y("el-checkbox-group"),Ce=Y("el-switch"),ke=Y("el-radio"),Ve=Y("el-radio-group"),Te=Y("el-option"),Ae=Y("el-select"),De=Y("el-slider"),Ie=Y("el-alert"),Ee=Y("el-tag"),Pe=Y("el-descriptions-item"),Ue=Y("el-descriptions"),Re=Y("el-statistic"),Ke=Y("el-table-column"),Je=Y("el-table"),Qe=Y("el-step"),yt=Y("el-steps"),da=Y("el-space"),fa=Y("el-tooltip"),ga=Y("el-empty"),Oa=Y("el-tabs"),za=Y("el-dialog"),dl=Q("loading");return G(),X("div",Os,[t[342]||(t[342]=Z("div",{class:"page-header"},[Z("h2",null,"系统设置"),Z("p",null,"管理系统的基本配置和参数设置")],-1)),Z("div",zs,[Z("div",Ps,[Z("div",Ns,[ee(Oa,{modelValue:u.value,"onUpdate:modelValue":t[110]||(t[110]=e=>u.value=e),class:"settings-tabs",ref:"tabsRef"},{default:ae(()=>[ee(_e,{label:"基本设置",name:"basic"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",Us,[t[114]||(t[114]=Z("span",null,"基本信息",-1)),Qt.value?(G(),se(a,{key:0,onClick:ba,type:"primary",loading:p.value},{default:ae(()=>[...t[113]||(t[113]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])]),default:ae(()=>[ee(H,{ref_key:"basicFormRef",ref:Lt,model:ve.value,rules:Pt,"label-width":"120px",class:"setting-form"},{default:ae(()=>[ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"系统名称",prop:"systemName"},{default:ae(()=>[ee(l,{modelValue:ve.value.systemName,"onUpdate:modelValue":t[0]||(t[0]=e=>ve.value.systemName=e),placeholder:"请输入系统名称"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"系统版本",prop:"systemVersion"},{default:ae(()=>[ee(l,{modelValue:ve.value.systemVersion,"onUpdate:modelValue":t[1]||(t[1]=e=>ve.value.systemVersion=e),placeholder:"请输入系统版本"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"公司名称",prop:"companyName"},{default:ae(()=>[ee(l,{modelValue:ve.value.companyName,"onUpdate:modelValue":t[2]||(t[2]=e=>ve.value.companyName=e),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"联系电话",prop:"contactPhone"},{default:ae(()=>[ee(l,{modelValue:ve.value.contactPhone,"onUpdate:modelValue":t[3]||(t[3]=e=>ve.value.contactPhone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"联系邮箱",prop:"contactEmail"},{default:ae(()=>[ee(l,{modelValue:ve.value.contactEmail,"onUpdate:modelValue":t[4]||(t[4]=e=>ve.value.contactEmail=e),placeholder:"请输入联系邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"网站地址",prop:"websiteUrl"},{default:ae(()=>[ee(l,{modelValue:ve.value.websiteUrl,"onUpdate:modelValue":t[5]||(t[5]=e=>ve.value.websiteUrl=e),placeholder:"请输入网站地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ee(o,{label:"公司地址",prop:"companyAddress"},{default:ae(()=>[ee(l,{modelValue:ve.value.companyAddress,"onUpdate:modelValue":t[6]||(t[6]=e=>ve.value.companyAddress=e),placeholder:"请输入公司地址"},null,8,["modelValue"])]),_:1}),ee(o,{label:"系统描述",prop:"systemDescription"},{default:ae(()=>[ee(l,{modelValue:ve.value.systemDescription,"onUpdate:modelValue":t[7]||(t[7]=e=>ve.value.systemDescription=e),type:"textarea",rows:3,placeholder:"请输入系统描述"},null,8,["modelValue"])]),_:1}),ee(o,{label:"系统Logo",prop:"systemLogo"},{default:ae(()=>[ee(K,{class:"logo-uploader",action:"#","show-file-list":!1,"before-upload":sa,"on-success":na},{default:ae(()=>[ve.value.systemLogo?(G(),X("img",{key:0,src:ve.value.systemLogo,class:"logo"},null,8,Ms)):(G(),se(j,{key:1,class:"logo-uploader-icon"},{default:ae(()=>[ee(te(c))]),_:1}))]),_:1}),t[115]||(t[115]=Z("div",{class:"upload-tip"},"建议尺寸：200x60px，支持 jpg、png 格式",-1))]),_:1}),ee(J,{"content-position":"left"},{default:ae(()=>[...t[116]||(t[116]=[le("联系二维码",-1)])]),_:1}),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"二维码标签"},{default:ae(()=>[ee(l,{modelValue:ve.value.contactQRCodeLabel,"onUpdate:modelValue":t[8]||(t[8]=e=>ve.value.contactQRCodeLabel=e),placeholder:"请输入二维码标签（如：微信、企业微信、QQ等）"},null,8,["modelValue"]),t[117]||(t[117]=Z("div",{class:"upload-tip"},"用于说明二维码的用途",-1))]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"上传二维码"},{default:ae(()=>[Z("div",Bs,[ee(a,{type:"primary",size:"small",icon:te(x),onClick:ra},{default:ae(()=>[...t[118]||(t[118]=[le(" 点击上传 ",-1)])]),_:1},8,["icon"]),ee(a,{type:"success",size:"small",icon:te(S),onClick:ua},{default:ae(()=>[...t[119]||(t[119]=[le(" 粘贴图片 ",-1)])]),_:1},8,["icon"])]),ve.value.contactQRCode?(G(),X("div",Rs,[Z("div",{class:"qr-thumbnail",onClick:pa},[Z("img",{src:ve.value.contactQRCode,alt:"二维码"},null,8,$s),Z("div",Fs,[ee(j,{class:"zoom-icon"},{default:ae(()=>[ee(te(C))]),_:1})])]),ee(a,{size:"small",type:"danger",text:"",icon:te(w),onClick:ma},{default:ae(()=>[...t[120]||(t[120]=[le(" 删除 ",-1)])]),_:1},8,["icon"])])):(G(),X("div",Ls,[ee(j,{size:"48",color:"#dcdfe6"},{default:ae(()=>[ee(te(k))]),_:1}),t[121]||(t[121]=Z("p",null,"点击上传或粘贴二维码图片",-1))])),t[122]||(t[122]=Z("div",{class:"upload-tip"},"建议尺寸：200x200px，支持 jpg、png 格式，大小不超过2MB",-1)),Z("input",{ref_key:"qrFileInput",ref:ia,type:"file",accept:"image/*",style:{display:"none"},onChange:ca},null,544)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"安全设置",name:"security"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",qs,[t[124]||(t[124]=Z("span",null,"安全配置",-1)),Xt.value?(G(),se(a,{key:0,onClick:_a,type:"primary",loading:m.value},{default:ae(()=>[...t[123]||(t[123]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])]),default:ae(()=>[ee(H,{ref_key:"securityFormRef",ref:qt,model:he.value,rules:Nt,"label-width":"150px",class:"setting-form"},{default:ae(()=>[ee(o,{label:"密码最小长度",prop:"passwordMinLength"},{default:ae(()=>[ee(we,{modelValue:he.value.passwordMinLength,"onUpdate:modelValue":t[9]||(t[9]=e=>he.value.passwordMinLength=e),min:6,max:20,placeholder:"密码最小长度"},null,8,["modelValue"]),t[125]||(t[125]=Z("span",{class:"form-tip"},"建议设置为6-20位",-1))]),_:1}),ee(o,{label:"密码复杂度要求",prop:"passwordComplexity"},{default:ae(()=>[ee(Se,{modelValue:he.value.passwordComplexity,"onUpdate:modelValue":t[10]||(t[10]=e=>he.value.passwordComplexity=e)},{default:ae(()=>[ee(xe,{label:"uppercase"},{default:ae(()=>[...t[126]||(t[126]=[le("包含大写字母",-1)])]),_:1}),ee(xe,{label:"lowercase"},{default:ae(()=>[...t[127]||(t[127]=[le("包含小写字母",-1)])]),_:1}),ee(xe,{label:"number"},{default:ae(()=>[...t[128]||(t[128]=[le("包含数字",-1)])]),_:1}),ee(xe,{label:"special"},{default:ae(()=>[...t[129]||(t[129]=[le("包含特殊字符",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"密码有效期",prop:"passwordExpireDays"},{default:ae(()=>[ee(we,{modelValue:he.value.passwordExpireDays,"onUpdate:modelValue":t[11]||(t[11]=e=>he.value.passwordExpireDays=e),min:0,max:365,placeholder:"密码有效期"},null,8,["modelValue"]),t[130]||(t[130]=Z("span",{class:"form-tip"},"天（0表示永不过期）",-1))]),_:1}),ee(o,{label:"登录失败锁定",prop:"loginFailLock"},{default:ae(()=>[ee(Ce,{modelValue:he.value.loginFailLock,"onUpdate:modelValue":t[12]||(t[12]=e=>he.value.loginFailLock=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),he.value.loginFailLock?(G(),se(o,{key:0,label:"最大失败次数",prop:"maxLoginFails"},{default:ae(()=>[ee(we,{modelValue:he.value.maxLoginFails,"onUpdate:modelValue":t[13]||(t[13]=e=>he.value.maxLoginFails=e),min:3,max:10,placeholder:"最大失败次数"},null,8,["modelValue"]),t[131]||(t[131]=Z("span",{class:"form-tip"},"次",-1))]),_:1})):ne("",!0),he.value.loginFailLock?(G(),se(o,{key:1,label:"锁定时间",prop:"lockDuration"},{default:ae(()=>[ee(we,{modelValue:he.value.lockDuration,"onUpdate:modelValue":t[14]||(t[14]=e=>he.value.lockDuration=e),min:5,max:1440,placeholder:"锁定时间"},null,8,["modelValue"]),t[132]||(t[132]=Z("span",{class:"form-tip"},"分钟",-1))]),_:1})):ne("",!0),ee(o,{label:"会话超时时间",prop:"sessionTimeout"},{default:ae(()=>[ee(we,{modelValue:he.value.sessionTimeout,"onUpdate:modelValue":t[15]||(t[15]=e=>he.value.sessionTimeout=e),min:30,max:1440,placeholder:"会话超时时间"},null,8,["modelValue"]),t[133]||(t[133]=Z("span",{class:"form-tip"},"分钟",-1))]),_:1}),ee(o,{label:"强制HTTPS",prop:"forceHttps"},{default:ae(()=>[ee(Ce,{modelValue:he.value.forceHttps,"onUpdate:modelValue":t[16]||(t[16]=e=>he.value.forceHttps=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),ee(o,{label:"IP白名单",prop:"ipWhitelist"},{default:ae(()=>[ee(l,{modelValue:he.value.ipWhitelist,"onUpdate:modelValue":t[17]||(t[17]=e=>he.value.ipWhitelist=e),type:"textarea",rows:3,placeholder:"请输入IP地址，多个IP用换行分隔"},null,8,["modelValue"]),t[134]||(t[134]=Z("div",{class:"form-tip"},"留空表示不限制IP访问",-1))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"通话设置",name:"call"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",js,[t[137]||(t[137]=Z("span",null,"通话配置",-1)),Z("div",Ks,[ee(a,{onClick:Sa,type:"info",size:"small",loading:me.value},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(I))]),_:1}),t[135]||(t[135]=le(" 测试连接 ",-1))]),_:1},8,["loading"]),Gt.value?(G(),se(a,{key:0,onClick:xa,type:"primary",loading:pe.value},{default:ae(()=>[...t[136]||(t[136]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])])]),default:ae(()=>[ee(H,{ref_key:"callFormRef",ref:jt,model:Fe,rules:Mt,"label-width":"150px",class:"setting-form"},{default:ae(()=>[Z("div",Js,[Z("h4",Hs,[ee(j,null,{default:ae(()=>[ee(te(V))]),_:1}),t[138]||(t[138]=le(" SIP服务器配置 ",-1))]),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"SIP服务器地址",prop:"sipServer"},{default:ae(()=>[ee(l,{modelValue:Fe.sipServer,"onUpdate:modelValue":t[18]||(t[18]=e=>Fe.sipServer=e),placeholder:"请输入SIP服务器地址"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"SIP端口",prop:"sipPort"},{default:ae(()=>[ee(we,{modelValue:Fe.sipPort,"onUpdate:modelValue":t[19]||(t[19]=e=>Fe.sipPort=e),min:1,max:65535,placeholder:"SIP端口"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"用户名",prop:"sipUsername"},{default:ae(()=>[ee(l,{modelValue:Fe.sipUsername,"onUpdate:modelValue":t[20]||(t[20]=e=>Fe.sipUsername=e),placeholder:"请输入SIP用户名"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"密码",prop:"sipPassword"},{default:ae(()=>[ee(l,{modelValue:Fe.sipPassword,"onUpdate:modelValue":t[21]||(t[21]=e=>Fe.sipPassword=e),type:"password",placeholder:"请输入SIP密码","show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),ee(o,{label:"传输协议",prop:"sipTransport"},{default:ae(()=>[ee(Ve,{modelValue:Fe.sipTransport,"onUpdate:modelValue":t[22]||(t[22]=e=>Fe.sipTransport=e)},{default:ae(()=>[ee(ke,{label:"UDP"},{default:ae(()=>[...t[139]||(t[139]=[le("UDP",-1)])]),_:1}),ee(ke,{label:"TCP"},{default:ae(()=>[...t[140]||(t[140]=[le("TCP",-1)])]),_:1}),ee(ke,{label:"TLS"},{default:ae(()=>[...t[141]||(t[141]=[le("TLS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Z("div",Ws,[Z("h4",Ys,[ee(j,null,{default:ae(()=>[ee(te(T))]),_:1}),t[142]||(t[142]=le(" 通话功能配置 ",-1))]),ee(o,{label:"自动接听",prop:"autoAnswer"},{default:ae(()=>[ee(Ce,{modelValue:Fe.autoAnswer,"onUpdate:modelValue":t[23]||(t[23]=e=>Fe.autoAnswer=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[143]||(t[143]=Z("span",{class:"form-tip"},"启用后将自动接听来电",-1))]),_:1}),ee(o,{label:"自动录音",prop:"autoRecord"},{default:ae(()=>[ee(Ce,{modelValue:Fe.autoRecord,"onUpdate:modelValue":t[24]||(t[24]=e=>Fe.autoRecord=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[144]||(t[144]=Z("span",{class:"form-tip"},"启用后将自动录制通话",-1))]),_:1}),ee(o,{label:"通话质量监控",prop:"qualityMonitoring"},{default:ae(()=>[ee(Ce,{modelValue:Fe.qualityMonitoring,"onUpdate:modelValue":t[25]||(t[25]=e=>Fe.qualityMonitoring=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[145]||(t[145]=Z("span",{class:"form-tip"},"启用后将监控通话质量",-1))]),_:1}),ee(o,{label:"呼入弹窗",prop:"incomingCallPopup"},{default:ae(()=>[ee(Ce,{modelValue:Fe.incomingCallPopup,"onUpdate:modelValue":t[26]||(t[26]=e=>Fe.incomingCallPopup=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[146]||(t[146]=Z("span",{class:"form-tip"},"启用后来电时自动弹出客户详情",-1))]),_:1}),ee(o,{label:"最大通话时长",prop:"maxCallDuration"},{default:ae(()=>[ee(we,{modelValue:Fe.maxCallDuration,"onUpdate:modelValue":t[27]||(t[27]=e=>Fe.maxCallDuration=e),min:1,max:7200,placeholder:"最大通话时长"},null,8,["modelValue"]),t[147]||(t[147]=Z("span",{class:"form-tip"},"秒（1-7200秒，0表示不限制）",-1))]),_:1})]),Z("div",Qs,[Z("h4",Xs,[ee(j,null,{default:ae(()=>[ee(te(A))]),_:1}),t[148]||(t[148]=le(" 录音配置 ",-1))]),ee(o,{label:"录音格式",prop:"recordFormat"},{default:ae(()=>[ee(Ae,{modelValue:Fe.recordFormat,"onUpdate:modelValue":t[28]||(t[28]=e=>Fe.recordFormat=e),placeholder:"请选择录音格式"},{default:ae(()=>[ee(Te,{label:"WAV",value:"wav"}),ee(Te,{label:"MP3",value:"mp3"}),ee(Te,{label:"AAC",value:"aac"})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"录音质量",prop:"recordQuality"},{default:ae(()=>[ee(Ae,{modelValue:Fe.recordQuality,"onUpdate:modelValue":t[29]||(t[29]=e=>Fe.recordQuality=e),placeholder:"请选择录音质量"},{default:ae(()=>[ee(Te,{label:"标准质量",value:"standard"}),ee(Te,{label:"高质量",value:"high"}),ee(Te,{label:"超高质量",value:"ultra"})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"录音保存路径",prop:"recordPath"},{default:ae(()=>[ee(l,{modelValue:Fe.recordPath,"onUpdate:modelValue":t[30]||(t[30]=e=>Fe.recordPath=e),placeholder:"请输入录音保存路径"},null,8,["modelValue"]),t[149]||(t[149]=Z("span",{class:"form-tip"},"录音文件的存储路径",-1))]),_:1}),ee(o,{label:"录音保留时间",prop:"recordRetentionDays"},{default:ae(()=>[ee(we,{modelValue:Fe.recordRetentionDays,"onUpdate:modelValue":t[31]||(t[31]=e=>Fe.recordRetentionDays=e),min:1,max:365,placeholder:"录音保留时间"},null,8,["modelValue"]),t[150]||(t[150]=Z("span",{class:"form-tip"},"天（1-365天）",-1))]),_:1})]),Z("div",Gs,[Z("h4",Zs,[ee(j,null,{default:ae(()=>[ee(te(D))]),_:1}),t[151]||(t[151]=le(" 权限管理 ",-1))]),ee(o,{label:"外呼权限",prop:"outboundPermission"},{default:ae(()=>[ee(Se,{modelValue:Fe.outboundPermission,"onUpdate:modelValue":t[32]||(t[32]=e=>Fe.outboundPermission=e)},{default:ae(()=>[ee(xe,{label:"admin"},{default:ae(()=>[...t[152]||(t[152]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[153]||(t[153]=[le("经理",-1)])]),_:1}),ee(xe,{label:"sales"},{default:ae(()=>[...t[154]||(t[154]=[le("销售",-1)])]),_:1}),ee(xe,{label:"service"},{default:ae(()=>[...t[155]||(t[155]=[le("客服",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"录音访问权限",prop:"recordAccessPermission"},{default:ae(()=>[ee(Se,{modelValue:Fe.recordAccessPermission,"onUpdate:modelValue":t[33]||(t[33]=e=>Fe.recordAccessPermission=e)},{default:ae(()=>[ee(xe,{label:"admin"},{default:ae(()=>[...t[156]||(t[156]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[157]||(t[157]=[le("经理",-1)])]),_:1}),ee(xe,{label:"self"},{default:ae(()=>[...t[158]||(t[158]=[le("仅本人",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"通话统计权限",prop:"statisticsPermission"},{default:ae(()=>[ee(Se,{modelValue:Fe.statisticsPermission,"onUpdate:modelValue":t[34]||(t[34]=e=>Fe.statisticsPermission=e)},{default:ae(()=>[ee(xe,{label:"admin"},{default:ae(()=>[...t[159]||(t[159]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[160]||(t[160]=[le("经理",-1)])]),_:1}),ee(xe,{label:"sales"},{default:ae(()=>[...t[161]||(t[161]=[le("销售",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"号码限制",prop:"numberRestriction"},{default:ae(()=>[ee(Ce,{modelValue:Fe.numberRestriction,"onUpdate:modelValue":t[35]||(t[35]=e=>Fe.numberRestriction=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[162]||(t[162]=Z("span",{class:"form-tip"},"启用后将限制可拨打的号码范围",-1))]),_:1}),Fe.numberRestriction?(G(),se(o,{key:0,label:"允许的号码前缀",prop:"allowedPrefixes"},{default:ae(()=>[ee(l,{modelValue:Fe.allowedPrefixes,"onUpdate:modelValue":t[36]||(t[36]=e=>Fe.allowedPrefixes=e),type:"textarea",rows:3,placeholder:"请输入允许的号码前缀，多个前缀用换行分隔"},null,8,["modelValue"]),t[163]||(t[163]=Z("span",{class:"form-tip"},"例如：138、139、186等",-1))]),_:1})):ne("",!0)])]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"邮件设置",name:"email"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",en,[t[166]||(t[166]=Z("span",null,"邮件配置",-1)),Z("div",tn,[Zt.value?(G(),se(a,{key:0,onClick:Ca,loading:v.value},{default:ae(()=>[...t[164]||(t[164]=[le(" 测试邮件 ",-1)])]),_:1},8,["loading"])):ne("",!0),Zt.value?(G(),se(a,{key:1,onClick:wa,type:"primary",loading:f.value},{default:ae(()=>[...t[165]||(t[165]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])])]),default:ae(()=>[ee(H,{ref_key:"emailFormRef",ref:Kt,model:Be,rules:Ut,"label-width":"120px",class:"setting-form"},{default:ae(()=>[ee(o,{label:"SMTP服务器",prop:"smtpHost"},{default:ae(()=>[ee(l,{modelValue:Be.smtpHost,"onUpdate:modelValue":t[37]||(t[37]=e=>Be.smtpHost=e),placeholder:"请输入SMTP服务器地址"},null,8,["modelValue"])]),_:1}),ee(o,{label:"SMTP端口",prop:"smtpPort"},{default:ae(()=>[ee(we,{modelValue:Be.smtpPort,"onUpdate:modelValue":t[38]||(t[38]=e=>Be.smtpPort=e),min:1,max:65535,placeholder:"SMTP端口"},null,8,["modelValue"])]),_:1}),ee(o,{label:"发件人邮箱",prop:"senderEmail"},{default:ae(()=>[ee(l,{modelValue:Be.senderEmail,"onUpdate:modelValue":t[39]||(t[39]=e=>Be.senderEmail=e),placeholder:"请输入发件人邮箱"},null,8,["modelValue"])]),_:1}),ee(o,{label:"发件人名称",prop:"senderName"},{default:ae(()=>[ee(l,{modelValue:Be.senderName,"onUpdate:modelValue":t[40]||(t[40]=e=>Be.senderName=e),placeholder:"请输入发件人名称"},null,8,["modelValue"])]),_:1}),ee(o,{label:"邮箱密码",prop:"emailPassword"},{default:ae(()=>[ee(l,{modelValue:Be.emailPassword,"onUpdate:modelValue":t[41]||(t[41]=e=>Be.emailPassword=e),type:"password",placeholder:"请输入邮箱密码或授权码","show-password":""},null,8,["modelValue"])]),_:1}),ee(o,{label:"启用SSL",prop:"enableSsl"},{default:ae(()=>[ee(Ce,{modelValue:Be.enableSsl,"onUpdate:modelValue":t[42]||(t[42]=e=>Be.enableSsl=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),ee(o,{label:"启用TLS",prop:"enableTls"},{default:ae(()=>[ee(Ce,{modelValue:Be.enableTls,"onUpdate:modelValue":t[43]||(t[43]=e=>Be.enableTls=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),ee(o,{label:"测试邮箱",prop:"testEmail"},{default:ae(()=>[ee(l,{modelValue:Be.testEmail,"onUpdate:modelValue":t[44]||(t[44]=e=>Be.testEmail=e),placeholder:"请输入测试邮箱地址"},null,8,["modelValue"]),t[167]||(t[167]=Z("div",{class:"form-tip"},"用于测试邮件发送功能",-1))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"短信设置",name:"sms"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",an,[t[171]||(t[171]=Z("span",null,"短信配置",-1)),Z("div",ln,[oa.value?(G(),se(a,{key:0,onClick:Ta,type:"success",icon:te(T)},{default:ae(()=>[...t[168]||(t[168]=[le(" 短信管理 ",-1)])]),_:1},8,["icon"])):ne("",!0),ea.value?(G(),se(a,{key:1,onClick:Va,loading:_.value},{default:ae(()=>[...t[169]||(t[169]=[le(" 测试短信 ",-1)])]),_:1},8,["loading"])):ne("",!0),ea.value?(G(),se(a,{key:2,onClick:ka,type:"primary",loading:b.value},{default:ae(()=>[...t[170]||(t[170]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])])]),default:ae(()=>[ee(H,{ref_key:"smsFormRef",ref:Jt,model:Le.value,rules:Bt,"label-width":"120px",class:"setting-form"},{default:ae(()=>[ee(o,{label:"短信服务商",prop:"provider"},{default:ae(()=>[ee(Ae,{modelValue:Le.value.provider,"onUpdate:modelValue":t[45]||(t[45]=e=>Le.value.provider=e),placeholder:"请选择短信服务商",style:{width:"100%"}},{default:ae(()=>[ee(Te,{label:"阿里云短信",value:"aliyun"}),ee(Te,{label:"腾讯云短信",value:"tencent"}),ee(Te,{label:"华为云短信",value:"huawei"}),ee(Te,{label:"网易云信",value:"netease"})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"AccessKey",prop:"accessKey"},{default:ae(()=>[ee(l,{modelValue:Le.value.accessKey,"onUpdate:modelValue":t[46]||(t[46]=e=>Le.value.accessKey=e),placeholder:"请输入AccessKey","show-password":""},null,8,["modelValue"])]),_:1}),ee(o,{label:"SecretKey",prop:"secretKey"},{default:ae(()=>[ee(l,{modelValue:Le.value.secretKey,"onUpdate:modelValue":t[47]||(t[47]=e=>Le.value.secretKey=e),placeholder:"请输入SecretKey","show-password":""},null,8,["modelValue"])]),_:1}),ee(o,{label:"短信签名",prop:"signName"},{default:ae(()=>[ee(l,{modelValue:Le.value.signName,"onUpdate:modelValue":t[48]||(t[48]=e=>Le.value.signName=e),placeholder:"请输入短信签名"},null,8,["modelValue"]),t[172]||(t[172]=Z("div",{class:"form-tip"},"短信签名需要在服务商平台申请并审核通过",-1))]),_:1}),ee(o,{label:"每日发送限制",prop:"dailyLimit"},{default:ae(()=>[ee(we,{modelValue:Le.value.dailyLimit,"onUpdate:modelValue":t[49]||(t[49]=e=>Le.value.dailyLimit=e),min:1,max:1e4,placeholder:"每日发送限制",style:{width:"100%"}},null,8,["modelValue"]),t[173]||(t[173]=Z("div",{class:"form-tip"},"单个用户每日最大发送短信数量",-1))]),_:1}),ee(o,{label:"每月发送限制",prop:"monthlyLimit"},{default:ae(()=>[ee(we,{modelValue:Le.value.monthlyLimit,"onUpdate:modelValue":t[50]||(t[50]=e=>Le.value.monthlyLimit=e),min:1,max:1e5,placeholder:"每月发送限制",style:{width:"100%"}},null,8,["modelValue"]),t[174]||(t[174]=Z("div",{class:"form-tip"},"单个用户每月最大发送短信数量",-1))]),_:1}),ee(o,{label:"启用短信功能"},{default:ae(()=>[ee(Ce,{modelValue:Le.value.enabled,"onUpdate:modelValue":t[51]||(t[51]=e=>Le.value.enabled=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),ee(o,{label:"需要审核"},{default:ae(()=>[ee(Ce,{modelValue:Le.value.requireApproval,"onUpdate:modelValue":t[52]||(t[52]=e=>Le.value.requireApproval=e),"active-text":"需要","inactive-text":"不需要"},null,8,["modelValue"]),t[175]||(t[175]=Z("div",{class:"form-tip"},"开启后，短信发送需要管理员审核",-1))]),_:1}),ee(o,{label:"测试手机号",prop:"testPhone"},{default:ae(()=>[ee(l,{modelValue:Le.value.testPhone,"onUpdate:modelValue":t[53]||(t[53]=e=>Le.value.testPhone=e),placeholder:"请输入测试手机号"},null,8,["modelValue"]),t[176]||(t[176]=Z("div",{class:"form-tip"},"用于测试短信发送功能",-1))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"存储设置",name:"storage"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",on,[t[179]||(t[179]=Z("span",null,"存储配置",-1)),Z("div",sn,[ee(a,{onClick:qa,type:"info",size:"small",loading:de.value},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(T))]),_:1}),t[177]||(t[177]=le(" 测试功能 ",-1))]),_:1},8,["loading"]),ta.value?(G(),se(a,{key:0,onClick:Pa,type:"primary",loading:L.value},{default:ae(()=>[...t[178]||(t[178]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])])]),default:ae(()=>[ee(H,{ref_key:"storageFormRef",ref:Ht,model:qe.value,rules:Rt.value,"label-width":"120px",class:"setting-form"},{default:ae(()=>[ee(o,{label:"存储类型",prop:"storageType"},{default:ae(()=>[ee(Ve,{modelValue:qe.value.storageType,"onUpdate:modelValue":t[54]||(t[54]=e=>qe.value.storageType=e)},{default:ae(()=>[ee(ke,{label:"local"},{default:ae(()=>[...t[180]||(t[180]=[le("本地存储",-1)])]),_:1}),ee(ke,{label:"oss"},{default:ae(()=>[...t[181]||(t[181]=[le("阿里云OSS",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"local"===qe.value.storageType?(G(),X(re,{key:0},[ee(o,{label:"存储路径",prop:"localPath"},{default:ae(()=>[ee(l,{modelValue:qe.value.localPath,"onUpdate:modelValue":t[55]||(t[55]=e=>qe.value.localPath=e),placeholder:"请输入本地存储路径"},null,8,["modelValue"])]),_:1}),ee(o,{label:"访问域名",prop:"localDomain"},{default:ae(()=>[ee(l,{modelValue:qe.value.localDomain,"onUpdate:modelValue":t[56]||(t[56]=e=>qe.value.localDomain=e),placeholder:"请输入访问域名"},null,8,["modelValue"])]),_:1})],64)):ne("",!0),"local"!==qe.value.storageType?(G(),X(re,{key:1},[ee(o,{label:"Access Key",prop:"accessKey"},{default:ae(()=>[ee(l,{modelValue:qe.value.accessKey,"onUpdate:modelValue":t[57]||(t[57]=e=>qe.value.accessKey=e),placeholder:"请输入Access Key"},null,8,["modelValue"])]),_:1}),ee(o,{label:"Secret Key",prop:"secretKey"},{default:ae(()=>[ee(l,{modelValue:qe.value.secretKey,"onUpdate:modelValue":t[58]||(t[58]=e=>qe.value.secretKey=e),type:"password",placeholder:"请输入Secret Key","show-password":""},null,8,["modelValue"])]),_:1}),ee(o,{label:"存储桶名称",prop:"bucketName"},{default:ae(()=>[ee(l,{modelValue:qe.value.bucketName,"onUpdate:modelValue":t[59]||(t[59]=e=>qe.value.bucketName=e),placeholder:"请输入存储桶名称"},null,8,["modelValue"])]),_:1}),ee(o,{label:"存储区域",prop:"region"},{default:ae(()=>[ee(Ae,{modelValue:qe.value.region,"onUpdate:modelValue":t[60]||(t[60]=e=>qe.value.region=e),placeholder:"请选择存储区域",style:{width:"100%"}},{default:ae(()=>[ee(Te,{label:"华东1（杭州）",value:"oss-cn-hangzhou"}),ee(Te,{label:"华东2（上海）",value:"oss-cn-shanghai"}),ee(Te,{label:"华北1（青岛）",value:"oss-cn-qingdao"}),ee(Te,{label:"华北2（北京）",value:"oss-cn-beijing"}),ee(Te,{label:"华北3（张家口）",value:"oss-cn-zhangjiakou"}),ee(Te,{label:"华北5（呼和浩特）",value:"oss-cn-huhehaote"}),ee(Te,{label:"华北6（乌兰察布）",value:"oss-cn-wulanchabu"}),ee(Te,{label:"华南1（深圳）",value:"oss-cn-shenzhen"}),ee(Te,{label:"华南2（河源）",value:"oss-cn-heyuan"}),ee(Te,{label:"华南3（广州）",value:"oss-cn-guangzhou"}),ee(Te,{label:"西南1（成都）",value:"oss-cn-chengdu"}),ee(Te,{label:"中国（香港）",value:"oss-cn-hongkong"}),ee(Te,{label:"美国西部1（硅谷）",value:"oss-us-west-1"}),ee(Te,{label:"美国东部1（弗吉尼亚）",value:"oss-us-east-1"}),ee(Te,{label:"亚太东南1（新加坡）",value:"oss-ap-southeast-1"}),ee(Te,{label:"亚太东南2（悉尼）",value:"oss-ap-southeast-2"}),ee(Te,{label:"亚太东南3（吉隆坡）",value:"oss-ap-southeast-3"}),ee(Te,{label:"亚太东南5（雅加达）",value:"oss-ap-southeast-5"}),ee(Te,{label:"亚太东北1（东京）",value:"oss-ap-northeast-1"}),ee(Te,{label:"亚太南部1（孟买）",value:"oss-ap-south-1"}),ee(Te,{label:"欧洲中部1（法兰克福）",value:"oss-eu-central-1"}),ee(Te,{label:"英国（伦敦）",value:"oss-eu-west-1"}),ee(Te,{label:"中东东部1（迪拜）",value:"oss-me-east-1"})]),_:1},8,["modelValue"]),t[182]||(t[182]=Z("div",{class:"form-tip"},"选择与您的Bucket相同的区域",-1))]),_:1}),ee(o,{label:"自定义域名",prop:"customDomain"},{default:ae(()=>[ee(l,{modelValue:qe.value.customDomain,"onUpdate:modelValue":t[61]||(t[61]=e=>qe.value.customDomain=e),placeholder:"请输入自定义域名（可选）"},null,8,["modelValue"])]),_:1})],64)):ne("",!0),ee(o,{label:"最大文件大小",prop:"maxFileSize"},{default:ae(()=>[ee(we,{modelValue:qe.value.maxFileSize,"onUpdate:modelValue":t[62]||(t[62]=e=>qe.value.maxFileSize=e),min:1,max:100,placeholder:"最大文件大小"},null,8,["modelValue"]),t[183]||(t[183]=Z("span",{class:"form-tip"},"MB",-1))]),_:1}),ee(o,{label:"允许的文件类型",prop:"allowedTypes"},{default:ae(()=>[ee(l,{modelValue:qe.value.allowedTypes,"onUpdate:modelValue":t[63]||(t[63]=e=>qe.value.allowedTypes=e),placeholder:"请输入允许的文件类型，用逗号分隔"},null,8,["modelValue"]),t[184]||(t[184]=Z("div",{class:"form-tip"},"例如：jpg,png,gif,pdf,doc,docx",-1))]),_:1}),ee(J,{"content-position":"left"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(k))]),_:1}),t[185]||(t[185]=le(" 图片上传压缩配置 ",-1))]),_:1}),ee(o,{label:"启用压缩"},{default:ae(()=>[ee(Ce,{modelValue:qe.value.imageCompressEnabled,"onUpdate:modelValue":t[64]||(t[64]=e=>qe.value.imageCompressEnabled=e)},null,8,["modelValue"]),t[186]||(t[186]=Z("div",{class:"form-tip"},"启用后上传的图片将自动压缩，减少存储空间和加载时间",-1))]),_:1}),qe.value.imageCompressEnabled?(G(),X(re,{key:2},[ee(o,{label:"压缩质量"},{default:ae(()=>[ee(Ve,{modelValue:qe.value.imageCompressQuality,"onUpdate:modelValue":t[65]||(t[65]=e=>qe.value.imageCompressQuality=e)},{default:ae(()=>[ee(ke,{label:"high"},{default:ae(()=>[...t[187]||(t[187]=[Z("span",{class:"quality-option"},[Z("span",{class:"quality-name"},"高清"),Z("span",{class:"quality-desc"},"（质量80%，最大宽度1920px）")],-1)])]),_:1}),ee(ke,{label:"medium"},{default:ae(()=>[...t[188]||(t[188]=[Z("span",{class:"quality-option"},[Z("span",{class:"quality-name"},"标准"),Z("span",{class:"quality-desc"},"（质量60%，最大宽度1200px）")],-1)])]),_:1}),ee(ke,{label:"low"},{default:ae(()=>[...t[189]||(t[189]=[Z("span",{class:"quality-option"},[Z("span",{class:"quality-name"},"省流"),Z("span",{class:"quality-desc"},"（质量40%，最大宽度800px）")],-1)])]),_:1}),ee(ke,{label:"custom"},{default:ae(()=>[...t[190]||(t[190]=[Z("span",{class:"quality-option"},[Z("span",{class:"quality-name"},"自定义")],-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"custom"===qe.value.imageCompressQuality?(G(),X(re,{key:0},[ee(o,{label:"最大宽度"},{default:ae(()=>[ee(we,{modelValue:qe.value.imageCompressMaxWidth,"onUpdate:modelValue":t[66]||(t[66]=e=>qe.value.imageCompressMaxWidth=e),min:400,max:4096,step:100},null,8,["modelValue"]),t[191]||(t[191]=Z("span",{class:"form-tip"},"px（超过此宽度的图片将被等比缩放）",-1))]),_:1}),ee(o,{label:"压缩比例"},{default:ae(()=>[ee(De,{modelValue:qe.value.imageCompressCustomQuality,"onUpdate:modelValue":t[67]||(t[67]=e=>qe.value.imageCompressCustomQuality=e),min:10,max:100,step:5,"show-input":"",style:{"max-width":"400px"}},null,8,["modelValue"]),t[192]||(t[192]=Z("div",{class:"form-tip"},"数值越低压缩越强，文件越小，但图片质量会下降",-1))]),_:1})],64)):ne("",!0),ee(o,null,{default:ae(()=>[ee(Ie,{title:Ot.value,type:"info",closable:!1,"show-icon":""},null,8,["title"])]),_:1})],64)):ne("",!0),"local"!==qe.value.storageType?(G(),X(re,{key:3},[ee(J,{"content-position":"left"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(x))]),_:1}),t[193]||(t[193]=le(" 数据同步设置 ",-1))]),_:1}),ee(o,{label:"自动同步"},{default:ae(()=>[ee(Ce,{modelValue:He.value.autoSync,"onUpdate:modelValue":t[68]||(t[68]=e=>He.value.autoSync=e),onChange:Ba},null,8,["modelValue"]),t[194]||(t[194]=Z("div",{class:"form-tip"},"启用后将定期自动同步数据到云端",-1))]),_:1}),He.value.autoSync?(G(),se(o,{key:0,label:"同步间隔"},{default:ae(()=>[ee(we,{modelValue:He.value.syncInterval,"onUpdate:modelValue":t[69]||(t[69]=e=>He.value.syncInterval=e),min:5,max:1440,onChange:Ba},null,8,["modelValue"]),t[195]||(t[195]=Z("span",{class:"form-tip"},"分钟（建议30-60分钟）",-1))]),_:1})):ne("",!0),ee(o,{label:"实时同步"},{default:ae(()=>[ee(Ce,{modelValue:He.value.syncOnDataChange,"onUpdate:modelValue":t[70]||(t[70]=e=>He.value.syncOnDataChange=e),onChange:Ba},null,8,["modelValue"]),t[196]||(t[196]=Z("div",{class:"form-tip"},"数据变更时立即同步到云端",-1))]),_:1}),ee(o,{label:"备份保留数量"},{default:ae(()=>[ee(we,{modelValue:He.value.backupRetention,"onUpdate:modelValue":t[71]||(t[71]=e=>He.value.backupRetention=e),min:1,max:20,onChange:Ba},null,8,["modelValue"]),t[197]||(t[197]=Z("span",{class:"form-tip"},"个（保留最近的备份文件数量）",-1))]),_:1}),ee(o,{label:"同步状态"},{default:ae(()=>[Z("div",nn,[ee(Ee,{type:We.value.isEnabled?"success":"danger",class:"status-tag"},{default:ae(()=>[le(oe(We.value.isEnabled?"已启用":"未启用"),1)]),_:1},8,["type"]),We.value.syncInProgress?(G(),se(Ee,{key:0,type:"warning",class:"status-tag"},{default:ae(()=>[...t[198]||(t[198]=[le(" 同步中... ",-1)])]),_:1})):ne("",!0),We.value.lastSyncTime?(G(),X("div",rn," 最后同步: "+oe(La(We.value.lastSyncTime)),1)):ne("",!0),We.value.totalItems>0?(G(),X("div",cn,[le(" 已同步: "+oe(We.value.syncedItems)+"/"+oe(We.value.totalItems)+" ",1),We.value.failedItems>0?(G(),X("span",un," (失败: "+oe(We.value.failedItems)+") ",1)):ne("",!0)])):ne("",!0)])]),_:1}),ee(o,{label:"同步操作"},{default:ae(()=>[Z("div",dn,[ee(a,{onClick:Ra,loading:We.value.syncInProgress,disabled:!We.value.isEnabled,type:"primary",size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(x))]),_:1}),t[199]||(t[199]=le(" 立即同步 ",-1))]),_:1},8,["loading","disabled"]),ee(a,{onClick:$a,disabled:!We.value.isEnabled||We.value.syncInProgress,type:"warning",size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(E))]),_:1}),t[200]||(t[200]=le(" 恢复数据 ",-1))]),_:1},8,["disabled"]),ee(a,{onClick:Fa,disabled:We.value.syncInProgress,size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(g))]),_:1}),t[201]||(t[201]=le(" 检查完整性 ",-1))]),_:1},8,["disabled"])])]),_:1}),We.value.errors.length>0?(G(),se(o,{key:1,label:"同步错误"},{default:ae(()=>[(G(!0),X(re,null,ce(We.value.errors,(e,t)=>(G(),se(Ie,{key:t,title:e,type:"error",closable:!1,class:"sync-error"},null,8,["title"]))),128))]),_:1})):ne("",!0)],64)):ne("",!0)]),_:1},8,["model","rules"])]),_:1})]),_:1}),ee(_e,{label:"商品设置",name:"product"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",pn,[t[203]||(t[203]=Z("span",null,"商品配置",-1)),aa.value?(G(),se(a,{key:0,onClick:Na,type:"primary",loading:q.value},{default:ae(()=>[...t[202]||(t[202]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])]),default:ae(()=>[ee(H,{ref_key:"productFormRef",ref:Wt,model:je.value,rules:$t,"label-width":"150px",class:"setting-form"},{default:ae(()=>[Z("div",mn,[Z("h4",fn,[ee(j,null,{default:ae(()=>[ee(te(O))]),_:1}),t[204]||(t[204]=le(" 优惠折扣设置 ",-1))]),ee(o,{label:"全局最大优惠比例",prop:"maxDiscountPercent"},{default:ae(()=>[ee(we,{modelValue:je.value.maxDiscountPercent,"onUpdate:modelValue":t[72]||(t[72]=e=>je.value.maxDiscountPercent=e),min:0,max:100,precision:1,placeholder:"最大优惠比例"},null,8,["modelValue"]),t[205]||(t[205]=Z("span",{class:"form-tip"},"%（0-100，建议不超过50%）",-1))]),_:1}),ee(o,{label:"管理员最大优惠",prop:"adminMaxDiscount"},{default:ae(()=>[ee(we,{modelValue:je.value.adminMaxDiscount,"onUpdate:modelValue":t[73]||(t[73]=e=>je.value.adminMaxDiscount=e),min:0,max:100,precision:1,placeholder:"管理员最大优惠"},null,8,["modelValue"]),t[206]||(t[206]=Z("span",{class:"form-tip"},"%（管理员权限下的最大优惠比例）",-1))]),_:1}),ee(o,{label:"经理最大优惠",prop:"managerMaxDiscount"},{default:ae(()=>[ee(we,{modelValue:je.value.managerMaxDiscount,"onUpdate:modelValue":t[74]||(t[74]=e=>je.value.managerMaxDiscount=e),min:0,max:100,precision:1,placeholder:"经理最大优惠"},null,8,["modelValue"]),t[207]||(t[207]=Z("span",{class:"form-tip"},"%（经理权限下的最大优惠比例）",-1))]),_:1}),ee(o,{label:"销售员最大优惠",prop:"salesMaxDiscount"},{default:ae(()=>[ee(we,{modelValue:je.value.salesMaxDiscount,"onUpdate:modelValue":t[75]||(t[75]=e=>je.value.salesMaxDiscount=e),min:0,max:100,precision:1,placeholder:"销售员最大优惠"},null,8,["modelValue"]),t[208]||(t[208]=Z("span",{class:"form-tip"},"%（销售员权限下的最大优惠比例）",-1))]),_:1}),ee(o,{label:"优惠审批阈值",prop:"discountApprovalThreshold"},{default:ae(()=>[ee(we,{modelValue:je.value.discountApprovalThreshold,"onUpdate:modelValue":t[76]||(t[76]=e=>je.value.discountApprovalThreshold=e),min:0,max:100,precision:1,placeholder:"优惠审批阈值"},null,8,["modelValue"]),t[209]||(t[209]=Z("span",{class:"form-tip"},"%（超过此比例需要审批）",-1))]),_:1})]),Z("div",gn,[Z("h4",vn,[ee(j,null,{default:ae(()=>[ee(te(z))]),_:1}),t[210]||(t[210]=le(" 价格管理设置 ",-1))]),ee(o,{label:"允许价格修改",prop:"allowPriceModification"},{default:ae(()=>[ee(Ce,{modelValue:je.value.allowPriceModification,"onUpdate:modelValue":t[77]||(t[77]=e=>je.value.allowPriceModification=e),"active-text":"允许","inactive-text":"禁止"},null,8,["modelValue"]),t[211]||(t[211]=Z("div",{class:"form-tip"},"是否允许在订单中修改商品价格",-1))]),_:1}),ee(o,{label:"价格修改权限",prop:"priceModificationRoles"},{default:ae(()=>[ee(Se,{modelValue:je.value.priceModificationRoles,"onUpdate:modelValue":t[78]||(t[78]=e=>je.value.priceModificationRoles=e)},{default:ae(()=>[ee(xe,{label:"admin"},{default:ae(()=>[...t[212]||(t[212]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[213]||(t[213]=[le("经理",-1)])]),_:1}),ee(xe,{label:"sales"},{default:ae(()=>[...t[214]||(t[214]=[le("销售员",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"价格变动记录",prop:"enablePriceHistory"},{default:ae(()=>[ee(Ce,{modelValue:je.value.enablePriceHistory,"onUpdate:modelValue":t[79]||(t[79]=e=>je.value.enablePriceHistory=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[215]||(t[215]=Z("div",{class:"form-tip"},"记录商品价格变动历史",-1))]),_:1}),ee(o,{label:"价格显示精度",prop:"pricePrecision"},{default:ae(()=>[ee(Ae,{modelValue:je.value.pricePrecision,"onUpdate:modelValue":t[80]||(t[80]=e=>je.value.pricePrecision=e),placeholder:"选择价格精度"},{default:ae(()=>[ee(Te,{label:"整数（如：100）",value:"0"}),ee(Te,{label:"一位小数（如：100.0）",value:"1"}),ee(Te,{label:"两位小数（如：100.00）",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),Z("div",hn,[Z("h4",yn,[ee(j,null,{default:ae(()=>[ee(te(P))]),_:1}),t[216]||(t[216]=le(" 库存管理设置 ",-1))]),ee(o,{label:"启用库存管理",prop:"enableInventory"},{default:ae(()=>[ee(Ce,{modelValue:je.value.enableInventory,"onUpdate:modelValue":t[81]||(t[81]=e=>je.value.enableInventory=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[217]||(t[217]=Z("div",{class:"form-tip"},"是否启用商品库存管理功能",-1))]),_:1}),ee(o,{label:"低库存预警阈值",prop:"lowStockThreshold"},{default:ae(()=>[ee(we,{modelValue:je.value.lowStockThreshold,"onUpdate:modelValue":t[82]||(t[82]=e=>je.value.lowStockThreshold=e),min:0,max:1e3,placeholder:"低库存预警阈值"},null,8,["modelValue"]),t[218]||(t[218]=Z("span",{class:"form-tip"},"件（库存低于此数量时预警）",-1))]),_:1}),ee(o,{label:"允许负库存销售",prop:"allowNegativeStock"},{default:ae(()=>[ee(Ce,{modelValue:je.value.allowNegativeStock,"onUpdate:modelValue":t[83]||(t[83]=e=>je.value.allowNegativeStock=e),"active-text":"允许","inactive-text":"禁止"},null,8,["modelValue"]),t[219]||(t[219]=Z("div",{class:"form-tip"},"库存不足时是否允许继续销售",-1))]),_:1})]),Z("div",bn,[Z("h4",_n,[ee(j,null,{default:ae(()=>[ee(te(N))]),_:1}),t[220]||(t[220]=le(" 商品分类设置 ",-1))]),ee(o,{label:"默认分类",prop:"defaultCategory"},{default:ae(()=>[ee(l,{modelValue:je.value.defaultCategory,"onUpdate:modelValue":t[84]||(t[84]=e=>je.value.defaultCategory=e),placeholder:"请输入默认分类名称"},null,8,["modelValue"]),t[221]||(t[221]=Z("div",{class:"form-tip"},"新建商品时的默认分类",-1))]),_:1}),ee(o,{label:"分类层级限制",prop:"maxCategoryLevel"},{default:ae(()=>[ee(we,{modelValue:je.value.maxCategoryLevel,"onUpdate:modelValue":t[85]||(t[85]=e=>je.value.maxCategoryLevel=e),min:1,max:5,placeholder:"分类层级限制"},null,8,["modelValue"]),t[222]||(t[222]=Z("span",{class:"form-tip"},"级（最多支持的分类层级数）",-1))]),_:1}),ee(o,{label:"启用分类编码",prop:"enableCategoryCode"},{default:ae(()=>[ee(Ce,{modelValue:je.value.enableCategoryCode,"onUpdate:modelValue":t[86]||(t[86]=e=>je.value.enableCategoryCode=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[223]||(t[223]=Z("div",{class:"form-tip"},"为商品分类生成唯一编码",-1))]),_:1})]),Z("div",wn,[Z("h4",xn,[ee(j,null,{default:ae(()=>[ee(te(D))]),_:1}),t[224]||(t[224]=le(" 权限配置设置 ",-1))]),ee(o,{label:"成本价格查看权限",prop:"costPriceViewRoles"},{default:ae(()=>[ee(Se,{modelValue:je.value.costPriceViewRoles,"onUpdate:modelValue":t[87]||(t[87]=e=>je.value.costPriceViewRoles=e)},{default:ae(()=>[ee(xe,{label:"super_admin"},{default:ae(()=>[...t[225]||(t[225]=[le("超级管理员",-1)])]),_:1}),ee(xe,{label:"admin"},{default:ae(()=>[...t[226]||(t[226]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[227]||(t[227]=[le("经理",-1)])]),_:1}),ee(xe,{label:"finance"},{default:ae(()=>[...t[228]||(t[228]=[le("财务人员",-1)])]),_:1})]),_:1},8,["modelValue"]),t[229]||(t[229]=Z("div",{class:"form-tip"},"选择可以查看商品成本价格的角色",-1))]),_:1}),ee(o,{label:"销售数据查看权限",prop:"salesDataViewRoles"},{default:ae(()=>[ee(Se,{modelValue:je.value.salesDataViewRoles,"onUpdate:modelValue":t[88]||(t[88]=e=>je.value.salesDataViewRoles=e)},{default:ae(()=>[ee(xe,{label:"super_admin"},{default:ae(()=>[...t[230]||(t[230]=[le("超级管理员",-1)])]),_:1}),ee(xe,{label:"admin"},{default:ae(()=>[...t[231]||(t[231]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[232]||(t[232]=[le("经理",-1)])]),_:1}),ee(xe,{label:"sales_manager"},{default:ae(()=>[...t[233]||(t[233]=[le("销售经理",-1)])]),_:1})]),_:1},8,["modelValue"]),t[234]||(t[234]=Z("div",{class:"form-tip"},"选择可以查看销售数据的角色",-1))]),_:1}),ee(o,{label:"库存信息查看权限",prop:"stockInfoViewRoles"},{default:ae(()=>[ee(Se,{modelValue:je.value.stockInfoViewRoles,"onUpdate:modelValue":t[89]||(t[89]=e=>je.value.stockInfoViewRoles=e)},{default:ae(()=>[ee(xe,{label:"super_admin"},{default:ae(()=>[...t[235]||(t[235]=[le("超级管理员",-1)])]),_:1}),ee(xe,{label:"admin"},{default:ae(()=>[...t[236]||(t[236]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"manager"},{default:ae(()=>[...t[237]||(t[237]=[le("经理",-1)])]),_:1}),ee(xe,{label:"warehouse"},{default:ae(()=>[...t[238]||(t[238]=[le("仓库管理员",-1)])]),_:1})]),_:1},8,["modelValue"]),t[239]||(t[239]=Z("div",{class:"form-tip"},"选择可以查看库存信息的角色",-1))]),_:1}),ee(o,{label:"操作日志查看权限",prop:"operationLogsViewRoles"},{default:ae(()=>[ee(Se,{modelValue:je.value.operationLogsViewRoles,"onUpdate:modelValue":t[90]||(t[90]=e=>je.value.operationLogsViewRoles=e)},{default:ae(()=>[ee(xe,{label:"super_admin"},{default:ae(()=>[...t[240]||(t[240]=[le("超级管理员",-1)])]),_:1}),ee(xe,{label:"admin"},{default:ae(()=>[...t[241]||(t[241]=[le("管理员",-1)])]),_:1}),ee(xe,{label:"audit"},{default:ae(()=>[...t[242]||(t[242]=[le("审计人员",-1)])]),_:1})]),_:1},8,["modelValue"]),t[243]||(t[243]=Z("div",{class:"form-tip"},"选择可以查看操作日志的角色",-1))]),_:1}),ee(o,{label:"敏感信息隐藏方式",prop:"sensitiveInfoHideMethod"},{default:ae(()=>[ee(Ve,{modelValue:je.value.sensitiveInfoHideMethod,"onUpdate:modelValue":t[91]||(t[91]=e=>je.value.sensitiveInfoHideMethod=e)},{default:ae(()=>[ee(ke,{label:"asterisk"},{default:ae(()=>[...t[244]||(t[244]=[le("星号（****）",-1)])]),_:1}),ee(ke,{label:"eye_icon"},{default:ae(()=>[...t[245]||(t[245]=[le("眼睛图标",-1)])]),_:1}),ee(ke,{label:"dash"},{default:ae(()=>[...t[246]||(t[246]=[le("横线（----）",-1)])]),_:1})]),_:1},8,["modelValue"]),t[247]||(t[247]=Z("div",{class:"form-tip"},"选择敏感信息的隐藏显示方式",-1))]),_:1}),ee(o,{label:"启用权限控制",prop:"enablePermissionControl"},{default:ae(()=>[ee(Ce,{modelValue:je.value.enablePermissionControl,"onUpdate:modelValue":t[92]||(t[92]=e=>je.value.enablePermissionControl=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),t[248]||(t[248]=Z("div",{class:"form-tip"},"是否启用商品信息权限控制功能",-1))]),_:1})]),aa.value?(G(),X("div",Sn,[ee(a,{onClick:Ua,disabled:q.value},{default:ae(()=>[...t[249]||(t[249]=[le(" 重置默认 ",-1)])]),_:1},8,["disabled"]),ee(a,{type:"primary",onClick:Na,loading:q.value},{default:ae(()=>[...t[250]||(t[250]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])])):ne("",!0)]),_:1},8,["model"])]),_:1})]),_:1}),la.value?(G(),se(_e,{key:0,label:"系统监控",name:"monitor"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",Cn,[t[252]||(t[252]=Z("span",null,"系统状态",-1)),ee(a,{onClick:Ma,loading:W.value},{default:ae(()=>[...t[251]||(t[251]=[le(" 刷新状态 ",-1)])]),_:1},8,["loading"])])]),default:ae(()=>[Z("div",kn,[Z("div",Vn,[t[253]||(t[253]=Z("h4",null,"系统信息",-1)),ee(Ue,{column:2,border:""},{default:ae(()=>[ee(Pe,{label:"操作系统"},{default:ae(()=>[le(oe(Ye.value.systemInfo.os),1)]),_:1}),ee(Pe,{label:"系统架构"},{default:ae(()=>[le(oe(Ye.value.systemInfo.arch),1)]),_:1}),ee(Pe,{label:"CPU核心数"},{default:ae(()=>[le(oe(Ye.value.systemInfo.cpuCores),1)]),_:1}),ee(Pe,{label:"总内存"},{default:ae(()=>[le(oe(Ye.value.systemInfo.totalMemory),1)]),_:1}),ee(Pe,{label:"Node.js版本"},{default:ae(()=>[le(oe(Ye.value.systemInfo.nodeVersion),1)]),_:1}),ee(Pe,{label:"系统运行时间"},{default:ae(()=>[le(oe(Ye.value.systemInfo.uptime),1)]),_:1})]),_:1})]),Z("div",Tn,[t[254]||(t[254]=Z("h4",null,"性能监控",-1)),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:6},{default:ae(()=>{return[ee(Re,{title:"CPU使用率",value:Ye.value.performance.cpuUsage,suffix:"%","value-style":{color:(e=Ye.value.performance.cpuUsage,e<50?"#67c23a":e<80?"#e6a23c":"#f56c6c")}},null,8,["value","value-style"])];var e}),_:1}),ee(s,{span:6},{default:ae(()=>{return[ee(Re,{title:"内存使用率",value:Ye.value.performance.memoryUsage,suffix:"%","value-style":{color:(e=Ye.value.performance.memoryUsage,e<60?"#67c23a":e<85?"#e6a23c":"#f56c6c")}},null,8,["value","value-style"])];var e}),_:1}),ee(s,{span:6},{default:ae(()=>{return[ee(Re,{title:"磁盘使用率",value:Ye.value.performance.diskUsage,suffix:"%","value-style":{color:(e=Ye.value.performance.diskUsage,e<70?"#67c23a":e<90?"#e6a23c":"#f56c6c")}},null,8,["value","value-style"])];var e}),_:1}),ee(s,{span:6},{default:ae(()=>[ee(Re,{title:"网络延迟",value:Ye.value.performance.networkLatency,suffix:"ms"},null,8,["value"])]),_:1})]),_:1})]),Z("div",An,[t[255]||(t[255]=Z("h4",null,"数据库状态",-1)),ee(Ue,{column:2,border:""},{default:ae(()=>[ee(Pe,{label:"数据库类型"},{default:ae(()=>[le(oe(Ye.value.database.type),1)]),_:1}),ee(Pe,{label:"数据库版本"},{default:ae(()=>[le(oe(Ye.value.database.version),1)]),_:1}),ee(Pe,{label:"连接状态"},{default:ae(()=>[ee(Ee,{type:Ye.value.database.connected?"success":"danger"},{default:ae(()=>[le(oe(Ye.value.database.connected?"已连接":"未连接"),1)]),_:1},8,["type"])]),_:1}),ee(Pe,{label:"活跃连接数"},{default:ae(()=>[le(oe(Ye.value.database.activeConnections),1)]),_:1}),ee(Pe,{label:"数据库大小"},{default:ae(()=>[le(oe(Ye.value.database.size),1)]),_:1}),ee(Pe,{label:"最后备份时间"},{default:ae(()=>[le(oe(Ye.value.database.lastBackup),1)]),_:1})]),_:1})]),Z("div",Dn,[t[256]||(t[256]=Z("h4",null,"服务状态",-1)),ee(Je,{data:Ye.value.services,style:{width:"100%"}},{default:ae(()=>[ee(Ke,{prop:"name",label:"服务名称",width:"200"}),ee(Ke,{label:"状态",width:"100"},{default:ae(({row:e})=>[ee(Ee,{type:"running"===e.status?"success":"danger"},{default:ae(()=>[le(oe("running"===e.status?"运行中":"已停止"),1)]),_:2},1032,["type"])]),_:1}),ee(Ke,{prop:"port",label:"端口",width:"100"}),ee(Ke,{prop:"uptime",label:"运行时间"}),ee(Ke,{prop:"memory",label:"内存使用",width:"120"})]),_:1},8,["data"])])])]),_:1})]),_:1})):ne("",!0),ee(_e,{label:"订单设置",name:"order"},{default:ae(()=>[ee(Vs)]),_:1}),ee(_e,{label:"数据备份",name:"backup"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",In,[t[260]||(t[260]=Z("span",null,"数据备份与恢复",-1)),Z("div",En,[ee(a,{onClick:ja,type:"primary",loading:Xe.value,disabled:!Et.value},{default:ae(()=>[...t[257]||(t[257]=[le(" 立即备份 ",-1)])]),_:1},8,["loading","disabled"]),zt.value?(G(),se(a,{key:0,onClick:Ka,type:"success",loading:Ge.value},{default:ae(()=>[...t[258]||(t[258]=[le(" 保存设置 ",-1)])]),_:1},8,["loading"])):ne("",!0),ee(a,{onClick:Ja,type:"info",plain:"",loading:tt.value},{default:ae(()=>[...t[259]||(t[259]=[le(" 测试功能 ",-1)])]),_:1},8,["loading"])])])]),default:ae(()=>[ee(H,{ref_key:"backupFormRef",ref:Yt,model:at,rules:Ft,"label-width":"120px",class:"setting-form"},{default:ae(()=>[Z("div",On,[t[261]||(t[261]=Z("h4",null,"备份配置",-1)),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"自动备份",prop:"autoBackupEnabled"},{default:ae(()=>[ee(Ce,{modelValue:at.autoBackupEnabled,"onUpdate:modelValue":t[93]||(t[93]=e=>at.autoBackupEnabled=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[at.autoBackupEnabled?(G(),se(o,{key:0,label:"备份频率",prop:"backupFrequency"},{default:ae(()=>[ee(Ae,{modelValue:at.backupFrequency,"onUpdate:modelValue":t[94]||(t[94]=e=>at.backupFrequency=e),placeholder:"请选择备份频率"},{default:ae(()=>[ee(Te,{label:"每小时",value:"hourly"}),ee(Te,{label:"每天",value:"daily"}),ee(Te,{label:"每周",value:"weekly"}),ee(Te,{label:"每月",value:"monthly"})]),_:1},8,["modelValue"])]),_:1})):ne("",!0)]),_:1})]),_:1}),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(o,{label:"保留天数",prop:"retentionDays"},{default:ae(()=>[ee(we,{modelValue:at.retentionDays,"onUpdate:modelValue":t[95]||(t[95]=e=>at.retentionDays=e),min:1,max:365,placeholder:"备份文件保留天数"},null,8,["modelValue"])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(o,{label:"压缩备份",prop:"compression"},{default:ae(()=>[ee(Ce,{modelValue:at.compression,"onUpdate:modelValue":t[96]||(t[96]=e=>at.compression=e),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),Z("div",zn,[t[262]||(t[262]=Z("h4",null,"备份状态",-1)),ee(Ue,{column:2,border:""},{default:ae(()=>[ee(Pe,{label:"最后备份时间"},{default:ae(()=>[le(oe(lt.value||"暂无备份"),1)]),_:1}),ee(Pe,{label:"备份文件数量"},{default:ae(()=>[le(oe(ot.value)+" 个 ",1)]),_:1}),ee(Pe,{label:"总备份大小"},{default:ae(()=>[le(oe(Ya(st.value)),1)]),_:1}),ee(Pe,{label:"自动备份状态"},{default:ae(()=>[ee(Ee,{type:at.autoBackupEnabled?"success":"info"},{default:ae(()=>[le(oe(at.autoBackupEnabled?"已启用":"已禁用"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),Z("div",Pn,[t[266]||(t[266]=Z("h4",null,"备份历史",-1)),ie((G(),se(Je,{data:nt.value,style:{width:"100%"}},{default:ae(()=>[ee(Ke,{prop:"filename",label:"备份文件"}),ee(Ke,{prop:"timestamp",label:"备份时间",width:"180"},{default:ae(({row:e})=>[le(oe(hl(e.timestamp)),1)]),_:1}),ee(Ke,{prop:"size",label:"文件大小",width:"120"},{default:ae(({row:e})=>[le(oe(Ya(e.size)),1)]),_:1}),ee(Ke,{prop:"type",label:"备份类型",width:"100"},{default:ae(({row:e})=>[ee(Ee,{type:"manual"===e.type?"primary":"success"},{default:ae(()=>[le(oe("manual"===e.type?"手动":"自动"),1)]),_:2},1032,["type"])]),_:1}),ee(Ke,{label:"操作",width:"200"},{default:ae(({row:e})=>[ee(a,{onClick:t=>(async e=>{try{await r.confirm(`确定要恢复备份 "${e.filename}" 吗？这将覆盖当前所有数据！`,"确认恢复",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),et.value=e.filename,await $e.restoreFromBackup(e.filename),i.success("数据恢复成功，请刷新页面"),setTimeout(()=>{window.location.reload()},2e3)}catch(t){"cancel"!==t&&(console.error("恢复失败:",t),i.error("恢复失败: "+t.message))}finally{et.value=""}})(e),type:"warning",size:"small",loading:et.value===e.filename},{default:ae(()=>[...t[263]||(t[263]=[le(" 恢复 ",-1)])]),_:1},8,["onClick","loading"]),ee(a,{onClick:t=>(async e=>{try{const t=await $e.getBackupDownloadUrl(e.filename),a=document.createElement("a");a.href=t,a.download=e.filename,document.body.appendChild(a),a.click(),document.body.removeChild(a),i.success("备份下载开始")}catch(t){console.error("下载失败:",t),i.error("下载失败: "+t.message)}})(e),type:"info",size:"small"},{default:ae(()=>[...t[264]||(t[264]=[le(" 下载 ",-1)])]),_:1},8,["onClick"]),ee(a,{onClick:t=>(async e=>{try{await r.confirm(`确定要删除备份 "${e.filename}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await $e.deleteBackup(e.filename),i.success("备份删除成功"),await Ha(),await Wa()}catch(t){"cancel"!==t&&(console.error("删除失败:",t),i.error("删除失败: "+t.message))}})(e),type:"danger",size:"small"},{default:ae(()=>[...t[265]||(t[265]=[le(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[dl,Ze.value]])]),Et.value?ne("",!0):(G(),se(Ie,{key:0,title:"请先配置OSS存储",description:"数据备份功能需要先在存储设置中配置阿里云OSS，才能正常使用备份和恢复功能。",type:"warning",closable:!1,"show-icon":""}))]),_:1},8,["model"])]),_:1})]),_:1}),ee(_e,{label:"数据迁移",name:"migration"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",Nn,[t[269]||(t[269]=Z("span",null,"数据迁移工具",-1)),Z("div",Un,[ee(a,{onClick:Xa,type:"primary",loading:it.value},{default:ae(()=>[...t[267]||(t[267]=[le(" 导出数据 ",-1)])]),_:1},8,["loading"]),ee(a,{onClick:Ga,type:"success",plain:"",loading:rt.value},{default:ae(()=>[...t[268]||(t[268]=[le(" 验证数据 ",-1)])]),_:1},8,["loading"])])])]),default:ae(()=>[Z("div",Mn,[ee(Ie,{title:"数据迁移说明",type:"info",closable:!1,"show-icon":"",class:"migration-alert"},{default:ae(()=>[...t[270]||(t[270]=[Z("p",null,"当前系统使用浏览器本地存储(localStorage)保存数据，存在以下问题：",-1),Z("ul",null,[Z("li",null,"换电脑或浏览器数据会丢失"),Z("li",null,"清除浏览器缓存数据会消失"),Z("li",null,"无法实现多设备数据同步"),Z("li",null,"不同用户之间无法数据隔离")],-1),Z("p",null,[Z("strong",null,"建议："),le("导出现有数据，然后部署数据库实现真正的数据持久化。")],-1)])]),_:1}),ct.value?(G(),X("div",Bn,[t[271]||(t[271]=Z("h4",null,"当前数据统计",-1)),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"客户数据",value:ct.value.customers,suffix:"条"},null,8,["value"])]),_:1}),ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"订单数据",value:ct.value.orders,suffix:"条"},null,8,["value"])]),_:1}),ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"产品数据",value:ct.value.products,suffix:"条"},null,8,["value"])]),_:1}),ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"部门数据",value:ct.value.departments,suffix:"条"},null,8,["value"])]),_:1}),ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"用户数据",value:ct.value.users,suffix:"条"},null,8,["value"])]),_:1}),ee(s,{span:4},{default:ae(()=>[ee(Re,{title:"数据大小",value:Za(ct.value.totalSize)},null,8,["value"])]),_:1})]),_:1})])):ne("",!0),ut.value?(G(),X("div",Rn,[t[273]||(t[273]=Z("h4",null,"数据验证结果",-1)),0===ut.value.issues.length?(G(),se(Ie,{key:0,title:"数据验证通过",description:"所有数据完整性检查通过，可以安全迁移！",type:"success",closable:!1,"show-icon":""})):(G(),se(Ie,{key:1,title:`发现 ${ut.value.issues.length} 个数据问题`,type:"warning",closable:!1,"show-icon":""},{default:ae(()=>[t[272]||(t[272]=Z("p",null,"建议修复以下问题后再进行迁移：",-1)),Z("ul",null,[(G(!0),X(re,null,ce(ut.value.issues.slice(0,10),e=>(G(),X("li",{key:e},oe(e),1))),128)),ut.value.issues.length>10?(G(),X("li",$n," ... 还有 "+oe(ut.value.issues.length-10)+" 个问题 ",1)):ne("",!0)])]),_:1},8,["title"]))])):ne("",!0),Z("div",Fn,[t[274]||(t[274]=Z("h4",null,"数据迁移步骤",-1)),ee(yt,{active:dt.value,direction:"vertical"},{default:ae(()=>[ee(Qe,{title:"导出现有数据",description:"将localStorage中的数据导出为JSON文件"}),ee(Qe,{title:"部署数据库",description:"在阿里云服务器使用宝塔面板创建MySQL数据库"}),ee(Qe,{title:"部署后端API",description:"部署Node.js后端服务，提供数据API接口"}),ee(Qe,{title:"导入数据",description:"将导出的数据导入到数据库中"}),ee(Qe,{title:"切换存储模式",description:"前端切换到API模式，实现真正的数据持久化"})]),_:1},8,["active"])]),Z("div",Ln,[t[278]||(t[278]=Z("h4",null,"技术文档",-1)),ee(da,{wrap:""},{default:ae(()=>[ee(a,{onClick:t[97]||(t[97]=e=>el("database")),type:"primary",plain:"",icon:"Document"},{default:ae(()=>[...t[275]||(t[275]=[le(" 数据库架构设计 ",-1)])]),_:1}),ee(a,{onClick:t[98]||(t[98]=e=>el("api")),type:"success",plain:"",icon:"Document"},{default:ae(()=>[...t[276]||(t[276]=[le(" 后端API架构 ",-1)])]),_:1}),ee(a,{onClick:t[99]||(t[99]=e=>el("migration")),type:"warning",plain:"",icon:"Document"},{default:ae(()=>[...t[277]||(t[277]=[le(" 数据迁移方案 ",-1)])]),_:1})]),_:1})])])]),_:1})]),_:1}),ee(_e,{label:"通知设置",name:"notification"},{default:ae(()=>[ee(cl)]),_:1}),ee(_e,{label:"用户协议",name:"agreement"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",qn,[t[281]||(t[281]=Z("span",null,"用户协议管理",-1)),Z("div",jn,[ze.value?(G(),se(a,{key:0,onClick:ha,type:"success",icon:te(c)},{default:ae(()=>[...t[279]||(t[279]=[le(" 新增协议 ",-1)])]),_:1},8,["icon"])):ne("",!0),ze.value?(G(),se(a,{key:1,onClick:ya,type:"primary",loading:Oe.value},{default:ae(()=>[...t[280]||(t[280]=[le(" 保存配置 ",-1)])]),_:1},8,["loading"])):ne("",!0)])])]),default:ae(()=>[ee(Ie,{title:"协议说明",type:"info",closable:!1,style:{"margin-bottom":"20px"}},{default:ae(()=>[...t[282]||(t[282]=[Z("p",null,"用户协议将在登录页面显示，用户必须同意协议才能登录系统。",-1),Z("p",null,'点击"编辑"按钮可以使用富文本编辑器编辑协议内容，启用后的协议将在登录页面显示。',-1)])]),_:1}),ee(Je,{data:ye.value,border:"",stripe:"",style:{width:"100%"},class:"agreement-table"},{default:ae(()=>[ee(Ke,{type:"index",label:"序号",width:"60",align:"center"}),ee(Ke,{prop:"title",label:"标题",width:"180"},{default:ae(({row:e})=>[Z("div",Kn,["user"===e.type?(G(),se(j,{key:0,color:"#409EFF"},{default:ae(()=>[ee(te(U))]),_:1})):(G(),se(j,{key:1,color:"#67C23A"},{default:ae(()=>[ee(te(D))]),_:1})),Z("span",null,oe(e.title),1)])]),_:1}),ee(Ke,{prop:"type",label:"类型",width:"120",align:"center"},{default:ae(({row:e})=>[ee(Ee,{type:"user"===e.type?"primary":"success",size:"small"},{default:ae(()=>[le(oe("user"===e.type?"使用协议":"隐私协议"),1)]),_:2},1032,["type"])]),_:1}),ee(Ke,{prop:"wordCount",label:"字数",width:"100",align:"center"},{default:ae(({row:e})=>[Z("span",Jn,oe(e.wordCount)+" 字",1)]),_:1}),ee(Ke,{prop:"summary",label:"内容概述","min-width":"200"},{default:ae(({row:e})=>[Z("div",Hn,oe(e.summary),1)]),_:1}),ee(Ke,{prop:"updateTime",label:"更新日期",width:"160",align:"center"},{default:ae(({row:e})=>[Z("div",Wn,[ee(j,null,{default:ae(()=>[ee(te(d))]),_:1}),Z("span",null,oe(e.updateTime),1)])]),_:1}),ee(Ke,{label:"状态",width:"80",align:"center"},{default:ae(({row:e})=>[ee(fa,{content:e.enabled?"已启用":"已禁用",placement:"top"},{default:ae(()=>[ee(Ce,{modelValue:e.enabled,"onUpdate:modelValue":t=>e.enabled=t,onChange:t=>{return a=e,void i.success(`${a.title}已${a.enabled?"启用":"禁用"}`);var a}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["content"])]),_:1}),ee(Ke,{label:"操作",width:"200",align:"center",fixed:"right"},{default:ae(({row:e})=>[ee(a,{type:"primary",size:"small",icon:te(M),onClick:t=>{return a=e,Me.value={...a},void(Ne.value=!0);var a}},{default:ae(()=>[...t[283]||(t[283]=[le(" 编辑 ",-1)])]),_:1},8,["icon","onClick"]),ee(a,{type:"info",size:"small",icon:te(h),onClick:t=>{return a=e,void r.alert(`<div style="max-height: 500px; overflow-y: auto; padding: 10px; text-align: left; font-size: 14px; line-height: 1.8;">${a.content}</div>`,a.title,{confirmButtonText:"关闭",dangerouslyUseHTMLString:!0,customStyle:{width:"65%",maxWidth:"800px"}});var a}},{default:ae(()=>[...t[284]||(t[284]=[le(" 预览 ",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),ee(_e,{label:"移动应用",name:"mobile"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",Yn,[t[286]||(t[286]=Z("span",null,"移动应用管理",-1)),Z("div",Qn,[ee(a,{onClick:ol,loading:mt.value,type:"primary",size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(y))]),_:1}),t[285]||(t[285]=le(" 刷新信息 ",-1))]),_:1},8,["loading"])])])]),default:ae(()=>[Z("div",Xn,[Z("div",Gn,[Z("h4",Zn,[ee(j,null,{default:ae(()=>[ee(te(V))]),_:1}),t[287]||(t[287]=le(" SDK 状态概览 ",-1))]),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"status-card"},{default:ae(()=>[ee(Re,{title:"Android SDK",value:gt.value.android.version},null,8,["value"]),Z("div",ei,[ee(Ee,{type:gt.value.android.available?"success":"danger",size:"small"},{default:ae(()=>[le(oe(gt.value.android.available?"可用":"未构建"),1)]),_:1},8,["type"]),Z("span",ti,oe(gt.value.android.size),1)])]),_:1})]),_:1}),ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"status-card"},{default:ae(()=>[ee(Re,{title:"iOS SDK",value:gt.value.ios.version},null,8,["value"]),Z("div",ai,[ee(Ee,{type:gt.value.ios.available?"success":"warning",size:"small"},{default:ae(()=>[le(oe(gt.value.ios.available?"可用":"开发中"),1)]),_:1},8,["type"]),Z("span",li,oe(gt.value.ios.size),1)])]),_:1})]),_:1}),ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"status-card"},{default:ae(()=>[ee(Re,{title:"PWA应用",value:"v1.0.0"}),Z("div",oi,[ee(Ee,{type:"success",size:"small"},{default:ae(()=>[...t[288]||(t[288]=[le("已部署",-1)])]),_:1}),t[289]||(t[289]=Z("span",{class:"file-size"},"轻量级",-1))])]),_:1})]),_:1})]),_:1})]),Z("div",si,[Z("h4",ni,[ee(j,null,{default:ae(()=>[ee(te(E))]),_:1}),t[290]||(t[290]=le(" SDK 下载和管理 ",-1))]),Z("div",ii,[Z("div",ri,[Z("div",ci,[Z("div",ui,[ee(j,{size:"32"},{default:ae(()=>[ee(te(B))]),_:1})]),t[291]||(t[291]=Z("div",{class:"sdk-info"},[Z("h5",null,"Android SDK"),Z("p",null,"原生Android应用，支持完整CRM功能")],-1))]),Z("div",di,[Z("div",pi,[t[292]||(t[292]=Z("span",{class:"label"},"版本:",-1)),Z("span",mi,oe(gt.value.android.version),1)]),Z("div",fi,[t[293]||(t[293]=Z("span",{class:"label"},"大小:",-1)),Z("span",gi,oe(gt.value.android.size),1)]),Z("div",vi,[t[294]||(t[294]=Z("span",{class:"label"},"更新时间:",-1)),Z("span",hi,oe(gt.value.android.updateTime),1)])]),Z("div",yi,[ee(a,{onClick:sl,type:"primary",disabled:!gt.value.android.available,size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(E))]),_:1}),t[295]||(t[295]=le(" 下载APK ",-1))]),_:1},8,["disabled"]),ee(a,{onClick:t[100]||(t[100]=e=>il("android")),type:"info",plain:"",size:"small"},{default:ae(()=>[...t[296]||(t[296]=[le(" 安装说明 ",-1)])]),_:1})])]),Z("div",bi,[Z("div",_i,[Z("div",wi,[ee(j,{size:"32"},{default:ae(()=>[ee(te(R))]),_:1})]),t[297]||(t[297]=Z("div",{class:"sdk-info"},[Z("h5",null,"iOS SDK"),Z("p",null,"适用于iPhone和iPad的CRM应用")],-1))]),Z("div",xi,[Z("div",Si,[t[298]||(t[298]=Z("span",{class:"label"},"版本:",-1)),Z("span",Ci,oe(gt.value.ios.version),1)]),Z("div",ki,[t[299]||(t[299]=Z("span",{class:"label"},"大小:",-1)),Z("span",Vi,oe(gt.value.ios.size),1)]),Z("div",Ti,[t[300]||(t[300]=Z("span",{class:"label"},"状态:",-1)),Z("span",Ai,[ee(Ee,{type:gt.value.ios.available?"success":"warning",size:"small"},{default:ae(()=>[le(oe(gt.value.ios.available?"可用":"开发中"),1)]),_:1},8,["type"])])])]),Z("div",Di,[ee(a,{onClick:nl,type:"primary",disabled:!gt.value.ios.available,size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(E))]),_:1}),t[301]||(t[301]=le(" 下载IPA ",-1))]),_:1},8,["disabled"]),ee(a,{onClick:t[101]||(t[101]=e=>il("ios")),type:"info",plain:"",size:"small"},{default:ae(()=>[...t[302]||(t[302]=[le(" 安装说明 ",-1)])]),_:1})])]),Z("div",Ii,[Z("div",Ei,[Z("div",Oi,[ee(j,{size:"32"},{default:ae(()=>[ee(te($))]),_:1})]),t[303]||(t[303]=Z("div",{class:"sdk-info"},[Z("h5",null,"PWA 应用"),Z("p",null,"渐进式Web应用，无需安装")],-1))]),t[306]||(t[306]=Z("div",{class:"sdk-details"},[Z("div",{class:"detail-item"},[Z("span",{class:"label"},"版本:"),Z("span",{class:"value"},"v1.0.0")]),Z("div",{class:"detail-item"},[Z("span",{class:"label"},"类型:"),Z("span",{class:"value"},"Web应用")]),Z("div",{class:"detail-item"},[Z("span",{class:"label"},"状态:"),Z("span",{class:"value"},"已部署")])],-1)),Z("div",zi,[ee(a,{onClick:rl,type:"success",size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(F))]),_:1}),t[304]||(t[304]=le(" 打开应用 ",-1))]),_:1}),ee(a,{onClick:ul,type:"info",plain:"",size:"small"},{default:ae(()=>[...t[305]||(t[305]=[le(" 二维码 ",-1)])]),_:1})])])])]),Z("div",Pi,[Z("h4",Ni,[ee(j,null,{default:ae(()=>[ee(te(I))]),_:1}),t[307]||(t[307]=le(" 连接状态和配置 ",-1))]),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(ge,{class:"config-card"},{header:ae(()=>[...t[308]||(t[308]=[Z("span",null,"服务器配置",-1)])]),default:ae(()=>[ee(Ue,{column:1,border:"",size:"small"},{default:ae(()=>[ee(Pe,{label:"服务器地址"},{default:ae(()=>[le(oe(xt.value.host)+":"+oe(xt.value.port),1)]),_:1}),ee(Pe,{label:"WebSocket端口"},{default:ae(()=>[le(oe(xt.value.wsPort),1)]),_:1}),ee(Pe,{label:"SSL状态"},{default:ae(()=>[ee(Ee,{type:xt.value.ssl?"success":"warning",size:"small"},{default:ae(()=>[le(oe(xt.value.ssl?"已启用":"未启用"),1)]),_:1},8,["type"])]),_:1}),ee(Pe,{label:"API版本"},{default:ae(()=>[le(oe(xt.value.apiVersion),1)]),_:1})]),_:1})]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(ge,{class:"config-card"},{header:ae(()=>[...t[309]||(t[309]=[Z("span",null,"连接统计",-1)])]),default:ae(()=>[ee(Ue,{column:1,border:"",size:"small"},{default:ae(()=>[ee(Pe,{label:"活跃连接"},{default:ae(()=>[ee(Ee,{type:"success",size:"small"},{default:ae(()=>[le(oe(St.value.active),1)]),_:1})]),_:1}),ee(Pe,{label:"今日连接"},{default:ae(()=>[le(oe(St.value.today),1)]),_:1}),ee(Pe,{label:"总连接数"},{default:ae(()=>[le(oe(St.value.total),1)]),_:1}),ee(Pe,{label:"最后连接"},{default:ae(()=>[le(oe(St.value.lastConnection||"暂无"),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),Z("div",Ui,[Z("h4",Mi,[ee(j,null,{default:ae(()=>[ee(te(I))]),_:1}),t[310]||(t[310]=le(" 二维码连接管理 ",-1))]),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:12},{default:ae(()=>[ee(ge,{class:"qr-card"},{header:ae(()=>[...t[311]||(t[311]=[Z("span",null,"生成连接二维码",-1)])]),default:ae(()=>[Z("div",Bi,[ee(H,{model:_t,"label-width":"100px",size:"small"},{default:ae(()=>[ee(o,{label:"用户权限"},{default:ae(()=>[ee(Se,{modelValue:_t.permissions,"onUpdate:modelValue":t[102]||(t[102]=e=>_t.permissions=e)},{default:ae(()=>[ee(xe,{label:"call"},{default:ae(()=>[...t[312]||(t[312]=[le("通话权限",-1)])]),_:1}),ee(xe,{label:"sms"},{default:ae(()=>[...t[313]||(t[313]=[le("短信权限",-1)])]),_:1}),ee(xe,{label:"contacts"},{default:ae(()=>[...t[314]||(t[314]=[le("联系人权限",-1)])]),_:1}),ee(xe,{label:"storage"},{default:ae(()=>[...t[315]||(t[315]=[le("存储权限",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),ee(o,{label:"有效期"},{default:ae(()=>[ee(Ae,{modelValue:_t.expireTime,"onUpdate:modelValue":t[103]||(t[103]=e=>_t.expireTime=e),placeholder:"选择有效期"},{default:ae(()=>[ee(Te,{label:"5分钟",value:"5"}),ee(Te,{label:"10分钟",value:"10"}),ee(Te,{label:"30分钟",value:"30"}),ee(Te,{label:"1小时",value:"60"})]),_:1},8,["modelValue"])]),_:1}),ee(o,null,{default:ae(()=>[ee(a,{type:"primary",onClick:pl,loading:vt.value},{default:ae(()=>[...t[316]||(t[316]=[le(" 生成二维码 ",-1)])]),_:1},8,["loading"]),bt.value.connectionId?(G(),se(a,{key:0,onClick:ml,loading:vt.value},{default:ae(()=>[...t[317]||(t[317]=[le(" 刷新二维码 ",-1)])]),_:1},8,["loading"])):ne("",!0)]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1}),ee(s,{span:12},{default:ae(()=>[ee(ge,{class:"qr-display-card"},{header:ae(()=>[...t[318]||(t[318]=[Z("span",null,"扫码连接",-1)])]),default:ae(()=>[Z("div",Ri,[bt.value.qrCodeUrl?(G(),X("div",$i,[Z("img",{src:bt.value.qrCodeUrl,alt:"连接二维码",class:"qr-code-image"},null,8,Fi),Z("div",Li,[Z("p",qi,[ee(Ee,{type:fl(bt.value.status),size:"small"},{default:ae(()=>[le(oe(gl(bt.value.status)),1)]),_:1},8,["type"])]),bt.value.expiresAt?(G(),X("p",ji," 过期时间: "+oe(hl(bt.value.expiresAt)),1)):ne("",!0),bt.value.connectionId?(G(),X("p",Ki," 连接ID: "+oe(bt.value.connectionId.substring(0,8))+"... ",1)):ne("",!0)])])):(G(),X("div",Ji,[ee(j,{size:"48",color:"#dcdfe6"},{default:ae(()=>[ee(te(I))]),_:1}),t[319]||(t[319]=Z("p",null,"点击生成二维码",-1))]))])]),_:1})]),_:1})]),_:1})]),Z("div",Hi,[Z("h4",Wi,[ee(j,null,{default:ae(()=>[ee(te(B))]),_:1}),t[320]||(t[320]=le(" 替代连接方式 ",-1))]),ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"connection-card"},{header:ae(()=>[Z("div",Yi,[ee(j,null,{default:ae(()=>[ee(te(I))]),_:1}),t[321]||(t[321]=Z("span",null,"蓝牙连接",-1))])]),default:ae(()=>[Z("div",Qi,[Z("div",Xi,[ee(Ee,{type:Ct.value.enabled?"success":"info",size:"small"},{default:ae(()=>[le(oe(Ct.value.enabled?"已启用":"未启用"),1)]),_:1},8,["type"])]),t[322]||(t[322]=Z("div",{class:"connection-description"},[Z("p",null,"通过蓝牙配对连接移动设备，适用于近距离连接场景。")],-1)),Z("div",Gi,[ee(H,{size:"small"},{default:ae(()=>[ee(o,{label:"设备名称"},{default:ae(()=>[ee(l,{modelValue:Ct.value.deviceName,"onUpdate:modelValue":t[104]||(t[104]=e=>Ct.value.deviceName=e),placeholder:"CRM-Server"},null,8,["modelValue"])]),_:1}),ee(o,{label:"配对码"},{default:ae(()=>[ee(l,{modelValue:Ct.value.pairingCode,"onUpdate:modelValue":t[105]||(t[105]=e=>Ct.value.pairingCode=e),placeholder:"自动生成",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),Z("div",Zi,[ee(a,{type:Ct.value.enabled?"danger":"primary",onClick:Aa,loading:kt.value,size:"small"},{default:ae(()=>[le(oe(Ct.value.enabled?"停止":"启动")+"蓝牙服务 ",1)]),_:1},8,["type","loading"])])])]),_:1})]),_:1}),ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"connection-card"},{header:ae(()=>[Z("div",er,[ee(j,null,{default:ae(()=>[ee(te($))]),_:1}),t[323]||(t[323]=Z("span",null,"同网络连接",-1))])]),default:ae(()=>[Z("div",tr,[Z("div",ar,[ee(Ee,{type:Vt.value.enabled?"success":"info",size:"small"},{default:ae(()=>[le(oe(Vt.value.enabled?"已启用":"未启用"),1)]),_:1},8,["type"])]),t[324]||(t[324]=Z("div",{class:"connection-description"},[Z("p",null,"在同一局域网内自动发现并连接移动设备。")],-1)),Z("div",lr,[ee(H,{size:"small"},{default:ae(()=>[ee(o,{label:"服务端口"},{default:ae(()=>[ee(we,{modelValue:Vt.value.port,"onUpdate:modelValue":t[106]||(t[106]=e=>Vt.value.port=e),min:1024,max:65535,placeholder:"8080"},null,8,["modelValue"])]),_:1}),ee(o,{label:"广播间隔"},{default:ae(()=>[ee(Ae,{modelValue:Vt.value.broadcastInterval,"onUpdate:modelValue":t[107]||(t[107]=e=>Vt.value.broadcastInterval=e)},{default:ae(()=>[ee(Te,{label:"5秒",value:"5"}),ee(Te,{label:"10秒",value:"10"}),ee(Te,{label:"30秒",value:"30"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),Z("div",or,[ee(a,{type:Vt.value.enabled?"danger":"primary",onClick:Da,loading:Tt.value,size:"small"},{default:ae(()=>[le(oe(Vt.value.enabled?"停止":"启动")+"网络发现 ",1)]),_:1},8,["type","loading"])])])]),_:1})]),_:1}),ee(s,{span:8},{default:ae(()=>[ee(ge,{class:"connection-card"},{header:ae(()=>[Z("div",sr,[ee(j,null,{default:ae(()=>[ee(te(D))]),_:1}),t[325]||(t[325]=Z("span",null,"数字配对",-1))])]),default:ae(()=>[Z("div",nr,[Z("div",ir,[ee(Ee,{type:At.value.enabled?"success":"info",size:"small"},{default:ae(()=>[le(oe(At.value.enabled?"已启用":"未启用"),1)]),_:1},8,["type"])]),t[326]||(t[326]=Z("div",{class:"connection-description"},[Z("p",null,"通过6位数字配对码连接，安全便捷。")],-1)),Z("div",rr,[ee(H,{size:"small"},{default:ae(()=>[ee(o,{label:"当前配对码"},{default:ae(()=>[Z("div",cr,[Z("span",ur,oe(At.value.currentCode||"------"),1),ee(a,{onClick:Ea,loading:It.value,size:"small",type:"text"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(y))]),_:1})]),_:1},8,["loading"])])]),_:1}),ee(o,{label:"有效期"},{default:ae(()=>[ee(Ae,{modelValue:At.value.expireTime,"onUpdate:modelValue":t[108]||(t[108]=e=>At.value.expireTime=e)},{default:ae(()=>[ee(Te,{label:"5分钟",value:"5"}),ee(Te,{label:"10分钟",value:"10"}),ee(Te,{label:"30分钟",value:"30"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),Z("div",dr,[ee(a,{type:At.value.enabled?"danger":"primary",onClick:Ia,loading:Dt.value,size:"small"},{default:ae(()=>[le(oe(At.value.enabled?"停止":"启动")+"数字配对 ",1)]),_:1},8,["type","loading"])])])]),_:1})]),_:1})]),_:1}),ee(ge,{class:"connection-stats-card",style:{"margin-top":"20px"}},{header:ae(()=>[...t[327]||(t[327]=[Z("span",null,"连接统计",-1)])]),default:ae(()=>[ee(n,{gutter:20},{default:ae(()=>[ee(s,{span:6},{default:ae(()=>[Z("div",pr,[Z("div",mr,oe(St.value.qr||0),1),t[328]||(t[328]=Z("div",{class:"stat-label"},"二维码连接",-1))])]),_:1}),ee(s,{span:6},{default:ae(()=>[Z("div",fr,[Z("div",gr,oe(St.value.bluetooth||0),1),t[329]||(t[329]=Z("div",{class:"stat-label"},"蓝牙连接",-1))])]),_:1}),ee(s,{span:6},{default:ae(()=>[Z("div",vr,[Z("div",hr,oe(St.value.network||0),1),t[330]||(t[330]=Z("div",{class:"stat-label"},"网络连接",-1))])]),_:1}),ee(s,{span:6},{default:ae(()=>[Z("div",yr,[Z("div",br,oe(St.value.digital||0),1),t[331]||(t[331]=Z("div",{class:"stat-label"},"数字配对",-1))])]),_:1})]),_:1})]),_:1})]),Z("div",_r,[ee(ge,{class:"connected-devices-card",style:{"margin-top":"20px"}},{header:ae(()=>[Z("div",wr,[t[333]||(t[333]=Z("span",null,"已连接设备",-1)),ee(a,{onClick:vl,loading:wt.value,type:"primary",size:"small"},{default:ae(()=>[ee(j,null,{default:ae(()=>[ee(te(y))]),_:1}),t[332]||(t[332]=le(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:ae(()=>[ie((G(),se(Je,{data:ht.value,style:{width:"100%"}},{default:ae(()=>[ee(Ke,{prop:"deviceName",label:"设备名称",width:"200"}),ee(Ke,{prop:"deviceType",label:"设备类型",width:"120"},{default:ae(({row:e})=>[ee(Ee,{size:"small"},{default:ae(()=>[le(oe(e.deviceType),1)]),_:2},1024)]),_:1}),ee(Ke,{prop:"ipAddress",label:"IP地址",width:"150"}),ee(Ke,{prop:"connectedAt",label:"连接时间",width:"180"},{default:ae(({row:e})=>[le(oe(hl(e.connectedAt)),1)]),_:1}),ee(Ke,{prop:"lastActivity",label:"最后活动",width:"180"},{default:ae(({row:e})=>[le(oe(hl(e.lastActivity)),1)]),_:1}),ee(Ke,{prop:"status",label:"状态",width:"100"},{default:ae(({row:e})=>[ee(Ee,{type:"connected"===e.status?"success":"warning",size:"small"},{default:ae(()=>[le(oe("connected"===e.status?"在线":"离线"),1)]),_:2},1032,["type"])]),_:1}),ee(Ke,{label:"操作",width:"120"},{default:ae(({row:e})=>[ee(a,{type:"danger",size:"small",plain:"",onClick:t=>(async e=>{try{await r.confirm("确定要断开此设备的连接吗？","断开连接确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await be(e),await vl(),i.success("设备连接已断开")}catch(t){"cancel"!==t&&(console.error("断开设备连接失败:",t),i.error("断开设备连接失败，请重试"))}})(e.deviceId)},{default:ae(()=>[...t[334]||(t[334]=[le(" 断开连接 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[dl,wt.value]]),0===ht.value.length?(G(),X("div",xr,[ee(ga,{description:"暂无连接的设备"})])):ne("",!0)]),_:1})]),Z("div",Sr,[Z("h4",Cr,[ee(j,null,{default:ae(()=>[ee(te(U))]),_:1}),t[335]||(t[335]=le(" 使用说明 ",-1))]),ee(Oa,{modelValue:ft.value,"onUpdate:modelValue":t[109]||(t[109]=e=>ft.value=e),class:"guide-tabs"},{default:ae(()=>[ee(_e,{label:"Android安装",name:"android"},{default:ae(()=>[...t[336]||(t[336]=[Z("div",{class:"guide-content"},[Z("ol",null,[Z("li",null,"下载APK文件到Android设备"),Z("li",null,'在设备设置中允许"未知来源"应用安装'),Z("li",null,"点击APK文件进行安装"),Z("li",null,"打开应用，扫描二维码或手动输入服务器地址"),Z("li",null,"授予必要的权限（通话、录音、网络等）"),Z("li",null,"完成连接配置，开始使用CRM功能")])],-1)])]),_:1}),ee(_e,{label:"iOS安装",name:"ios"},{default:ae(()=>[Z("div",kr,[ee(Ie,{title:"iOS版本开发中",description:"iOS版本正在开发中，敬请期待。目前可以使用PWA版本在Safari浏览器中使用。",type:"info",closable:!1})])]),_:1}),ee(_e,{label:"PWA使用",name:"pwa"},{default:ae(()=>[...t[337]||(t[337]=[Z("div",{class:"guide-content"},[Z("ol",null,[Z("li",null,"在手机浏览器中访问PWA应用链接"),Z("li",null,'点击浏览器菜单中的"添加到主屏幕"'),Z("li",null,"确认添加，应用图标将出现在桌面"),Z("li",null,"点击桌面图标打开应用"),Z("li",null,"享受类似原生应用的体验")])],-1)])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1}),ee(_e,{label:"系统日志",name:"logs"},{default:ae(()=>[ee(ge,{class:"setting-card"},{header:ae(()=>[Z("div",Vr,[t[340]||(t[340]=Z("span",null,"系统日志",-1)),Z("div",null,[ee(a,{onClick:al,loading:fe.value,type:"primary"},{default:ae(()=>[...t[338]||(t[338]=[le(" 刷新日志 ",-1)])]),_:1},8,["loading"]),ee(a,{onClick:ll,type:"danger",plain:""},{default:ae(()=>[...t[339]||(t[339]=[le(" 清空日志 ",-1)])]),_:1})])])]),default:ae(()=>[Z("div",Tr,[ie((G(),se(Je,{data:pt.value,style:{width:"100%"},height:"500",stripe:""},{default:ae(()=>[ee(Ke,{prop:"timestamp",label:"时间",width:"180"},{default:ae(({row:e})=>{return[le(oe((t=e.timestamp,t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))),1)];var t}),_:1}),ee(Ke,{prop:"level",label:"级别",width:"100"},{default:ae(({row:e})=>[ee(Ee,{type:tl(e.level),size:"small"},{default:ae(()=>[le(oe(e.level),1)]),_:2},1032,["type"])]),_:1}),ee(Ke,{prop:"module",label:"模块",width:"120"}),ee(Ke,{prop:"message",label:"消息","show-overflow-tooltip":""}),ee(Ke,{prop:"details",label:"详情",width:"100"},{default:ae(({row:e})=>[e.details?(G(),se(a,{key:0,type:"text",size:"small",onClick:t=>{return a=e,void r.alert(a.details,`日志详情 - ${a.message}`,{confirmButtonText:"确定",type:"info"});var a}},{default:ae(()=>[...t[341]||(t[341]=[le(" 查看详情 ",-1)])]),_:1},8,["onClick"])):ne("",!0)]),_:1})]),_:1},8,["data"])),[[dl,fe.value]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),ee(za,{modelValue:ue.value,"onUpdate:modelValue":t[111]||(t[111]=e=>ue.value=e),title:"短信管理",width:"90%","close-on-click-modal":!1,class:"sms-management-dialog"},{default:ae(()=>[ee(Qa)]),_:1},8,["modelValue"]),ee(Es,{modelValue:Ne.value,"onUpdate:modelValue":t[112]||(t[112]=e=>Ne.value=e),agreement:Me.value,onSave:va},null,8,["modelValue","agreement"])])}}}),Dr=t(Ar,[["__scopeId","data-v-58067d47"]]);export{Dr as default};
