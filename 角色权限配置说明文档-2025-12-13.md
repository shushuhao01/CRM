# 角色权限配置说明文档

> 文档版本：v2.0
> 
> 创建日期：2025年12月13日
> 
> 本文档详细说明了CRM系统中各角色的完整权限配置，包括一级菜单、二级菜单、三级菜单、按钮权限、数据范围等。

---

## 一、系统角色概览

| 角色ID | 角色名称 | 角色代码 | 数据范围 | 说明 |
|--------|----------|----------|----------|------|
| 1 | 超级管理员 | `super_admin` | 全部 | 拥有系统所有权限，包括超管面板 |
| 2 | 管理员 | `admin` | 全部 | 拥有系统所有权限，除超管面板外 |
| 3 | 部门经理 | `department_manager` | 部门 | 管理本部门业务和团队 |
| 4 | 销售员 | `sales_staff` | 个人 | 专注于客户开发和订单管理 |
| 5 | 客服 | `customer_service` | 全部（特定功能） | 处理订单审核、物流和售后服务 |

---

## 二、权限标识说明

### 权限层级结构
```
一级菜单权限 (如: dashboard, customer, order)
├── 二级菜单权限 (如: customer.list, customer.add)
│   ├── 三级操作权限 (如: customer.list.view, customer.list.edit)
│   │   └── 按钮权限 (如: customer.list.export, customer.list.import)
```

### 数据范围说明
| 范围 | 说明 |
|------|------|
| `all` | 可查看系统所有数据 |
| `department` | 仅可查看本部门相关数据 |
| `self` | 仅可查看个人相关数据 |
| `assigned` | 仅可查看被分配给自己的数据 |

---

## 三、禁止权限清单（重要）

### 部门经理和销售员禁止的权限

| 功能模块 | 权限标识 | 菜单路径 | 说明 |
|----------|----------|----------|------|
| 客户分组 | `customer.groups` | 客户管理 → 客户分组 | 仅管理员可用 |
| 客户标签 | `customer.tags` | 客户管理 → 客户标签 | 仅管理员可用 |
| 短信管理 | `service.sms` | 服务管理 → 短信管理 | 仅管理员、客服可用 |
| 发货列表 | `logistics.shipping` | 物流管理 → 发货列表 | 仅管理员、客服可用 |
| 状态更新 | `logistics.status` | 物流管理 → 状态更新 | 仅管理员、客服可用 |
| 回收站 | `data.recycle` | 资料管理 → 回收站 | 仅管理员可用 |

### 销售员额外禁止的权限

| 功能模块 | 权限标识 | 菜单路径 | 说明 |
|----------|----------|----------|------|
| 资料列表 | `data.list` | 资料管理 → 资料列表 | 完全禁止访问 |
| 业绩分析 | `performance.analysis` | 业绩统计 → 业绩分析 | 仅管理员、经理可用 |
| 业绩分享 | `performance.share` | 业绩统计 → 业绩分享 | 仅管理员、经理可用 |
| 售后数据 | `afterSales.data` | 售后管理 → 售后数据 | 仅管理员、经理、客服可用 |

---

## 四、各角色详细权限配置


### 1. 超级管理员 (super_admin)

**权限标识**：`*`（所有权限）
**数据范围**：全部数据

#### 完整权限列表

| 一级菜单 | 二级菜单 | 三级功能 | 查看 | 新增 | 编辑 | 删除 | 其他按钮 | 数据范围 |
|----------|----------|----------|:----:|:----:|:----:|:----:|----------|----------|
| **数据看板** | 个人看板 | - | ✅ | - | - | - | - | 全部 |
| | 部门看板 | - | ✅ | - | - | - | - | 全部 |
| **客户管理** | 客户列表 | 查看客户 | ✅ | - | - | - | - | 全部 |
| | | 编辑客户 | - | - | ✅ | - | - | 全部 |
| | | 导入客户 | - | - | - | - | ✅导入 | 全部 |
| | | 导出客户 | - | - | - | - | ✅导出 | 全部 |
| | 新增客户 | 创建客户 | - | ✅ | - | - | - | - |
| | 客户分组 | 查看分组 | ✅ | - | - | - | - | 全部 |
| | | 新增分组 | - | ✅ | - | - | - | - |
| | | 编辑分组 | - | - | ✅ | - | - | - |
| | | 删除分组 | - | - | - | ✅ | - | - |
| | 客户标签 | 查看标签 | ✅ | - | - | - | - | 全部 |
| | | 新增标签 | - | ✅ | - | - | - | - |
| | | 编辑标签 | - | - | ✅ | - | - | - |
| | | 删除标签 | - | - | - | ✅ | - | - |
| **订单管理** | 订单列表 | 查看订单 | ✅ | - | - | - | - | 全部 |
| | | 编辑订单 | - | - | ✅ | - | - | 全部 |
| | | 删除订单 | - | - | - | ✅ | - | 全部 |
| | 新增订单 | 创建订单 | - | ✅ | - | - | - | - |
| | 订单审核 | 查看待审核 | ✅ | - | - | - | - | 全部 |
| | | 审核通过 | - | - | - | - | ✅通过 | 全部 |
| | | 审核拒绝 | - | - | - | - | ✅拒绝 | 全部 |
| **服务管理** | 通话管理 | 查看通话 | ✅ | - | - | - | - | 全部 |
| | | 新增通话 | - | ✅ | - | - | - | - |
| | | 编辑通话 | - | - | ✅ | - | - | - |
| | | 删除通话 | - | - | - | ✅ | - | - |
| | 短信管理 | 查看短信 | ✅ | - | - | - | - | 全部 |
| | | 发送短信 | - | ✅ | - | - | - | - |
| | | 删除短信 | - | - | - | ✅ | - | - |
| **业绩统计** | 个人业绩 | 查看业绩 | ✅ | - | - | - | - | 全部 |
| | 团队业绩 | 查看团队 | ✅ | - | - | - | ✅查看详情 | 全部 |
| | | 点击单量 | - | - | - | - | ✅全部可点 | 全部 |
| | 业绩分析 | 查看分析 | ✅ | - | - | - | - | 全部 |
| | 业绩分享 | 查看分享 | ✅ | - | - | - | - | 全部 |
| | | 新增分享 | - | ✅ | - | - | - | - |
| | | 编辑分享 | - | - | ✅ | - | - | - |
| | | 删除分享 | - | - | - | ✅ | - | - |
| **物流管理** | 发货列表 | 查看发货 | ✅ | - | - | - | - | 全部 |
| | | 新增发货 | - | ✅ | - | - | - | - |
| | | 编辑发货 | - | - | ✅ | - | - | - |
| | 物流列表 | 查看物流 | ✅ | - | - | - | - | 全部 |
| | 物流跟踪 | 查看跟踪 | ✅ | - | - | - | - | 全部 |
| | | 更新跟踪 | - | - | ✅ | - | - | - |
| | 状态更新 | 查看状态 | ✅ | - | - | - | - | 全部 |
| | | 更新状态 | - | - | ✅ | - | - | - |
| | 物流公司 | 查看公司 | ✅ | - | - | - | - | 全部 |
| | | 新增公司 | - | ✅ | - | - | - | - |
| | | 编辑公司 | - | - | ✅ | - | - | - |
| | | 删除公司 | - | - | - | ✅ | - | - |
| **售后管理** | 售后订单 | 查看售后 | ✅ | - | - | - | - | 全部 |
| | | 编辑售后 | - | - | ✅ | - | - | - |
| | | 删除售后 | - | - | - | ✅ | - | - |
| | 新建售后 | 创建售后 | - | ✅ | - | - | - | - |
| | 售后数据 | 查看数据 | ✅ | - | - | - | - | 全部 |
| | | 数据分析 | - | - | - | - | ✅分析 | 全部 |
| **资料管理** | 资料列表 | 查看资料 | ✅ | - | - | - | - | 全部 |
| | | 分配资料 | - | - | - | - | ✅分配 | 全部 |
| | | 封存资料 | - | - | - | - | ✅封存 | 全部 |
| | | 回收资料 | - | - | - | - | ✅回收 | 全部 |
| | 客户查询 | 基础搜索 | ✅ | - | - | - | - | 全部 |
| | | 高级搜索 | ✅ | - | - | - | - | 全部 |
| | 回收站 | 查看回收 | ✅ | - | - | - | - | 全部 |
| | | 恢复数据 | - | - | - | - | ✅恢复 | 全部 |
| | | 永久删除 | - | - | - | ✅ | - | 全部 |
| **商品管理** | 商品列表 | 查看商品 | ✅ | - | - | - | - | 全部 |
| | | 编辑商品 | - | - | ✅ | - | - | - |
| | | 删除商品 | - | - | - | ✅ | - | - |
| | 新增商品 | 创建商品 | - | ✅ | - | - | - | - |
| | 库存管理 | 查看库存 | ✅ | - | - | - | - | 全部 |
| | | 编辑库存 | - | - | ✅ | - | - | - |
| | 商品分类 | 查看分类 | ✅ | - | - | - | - | 全部 |
| | | 新增分类 | - | ✅ | - | - | - | - |
| | | 编辑分类 | - | - | ✅ | - | - | - |
| | | 删除分类 | - | - | - | ✅ | - | - |
| | 商品分析 | 查看分析 | ✅ | - | - | - | - | 全部 |
| **系统管理** | 部门管理 | 查看部门 | ✅ | - | - | - | - | 全部 |
| | | 新增部门 | - | ✅ | - | - | - | - |
| | | 编辑部门 | - | - | ✅ | - | - | - |
| | | 删除部门 | - | - | - | ✅ | - | - |
| | 用户管理 | 查看用户 | ✅ | - | - | - | - | 全部 |
| | | 新增用户 | - | ✅ | - | - | - | - |
| | | 编辑用户 | - | - | ✅ | - | - | - |
| | | 删除用户 | - | - | - | ✅ | - | - |
| | | 重置密码 | - | - | - | - | ✅重置 | 全部 |
| | 角色权限 | 查看角色 | ✅ | - | - | - | - | 全部 |
| | | 新增角色 | - | ✅ | - | - | - | - |
| | | 编辑角色 | - | - | ✅ | - | - | - |
| | | 删除角色 | - | - | - | ✅ | - | - |
| | | 分配权限 | - | - | - | - | ✅分配 | 全部 |
| | 权限管理 | 查看权限 | ✅ | - | - | - | - | 全部 |
| | | 编辑权限 | - | - | ✅ | - | - | - |
| | 超管面板 | 系统配置 | ✅ | - | ✅ | - | - | 全部 |
| | 客服管理 | 查看客服 | ✅ | - | - | - | - | 全部 |
| | | 新增客服 | - | ✅ | - | - | - | - |
| | | 编辑客服 | - | - | ✅ | - | - | - |
| | | 删除客服 | - | - | - | ✅ | - | - |
| | 消息管理 | 查看消息 | ✅ | - | - | - | - | 全部 |
| | | 发送消息 | - | ✅ | - | - | - | - |
| | | 编辑消息 | - | - | ✅ | - | - | - |
| | | 删除消息 | - | - | - | ✅ | - | - |
| | 系统设置 | 查看设置 | ✅ | - | - | - | - | 全部 |
| | | 编辑设置 | - | - | ✅ | - | - | - |

---


### 2. 管理员 (admin)

**权限标识**：除超管面板外的所有权限
**数据范围**：全部数据

#### 与超级管理员的区别

| 功能 | 超级管理员 | 管理员 |
|------|:----------:|:------:|
| 超管面板 | ✅ | ❌ |
| 其他所有功能 | ✅ | ✅ |

#### 权限代码列表
```typescript
permissions: [
  // 数据看板
  'dashboard', 'dashboard:personal', 'dashboard:department', 'dashboard:all',
  
  // 客户管理
  'customer', 'customer:list', 'customer:view:all', 'customer:add', 'customer:edit', 
  'customer:delete', 'customer:import', 'customer:export', 'customer:groups', 'customer:tags',
  
  // 订单管理
  'order', 'order:list', 'order:view:all', 'order:add', 'order:edit', 'order:delete', 'order:audit',
  
  // 服务管理
  'service', 'service:call', 'service:call:view', 'service:call:add', 'service:call:edit', 
  'service:call:delete', 'service:sms',
  
  // 业绩统计
  'performance', 'performance:personal', 'performance:team', 'performance:analysis', 'performance:share',
  
  // 物流管理
  'logistics', 'logistics:list', 'logistics:view', 'logistics:add', 'logistics:edit', 
  'logistics:tracking', 'logistics:shipping', 'logistics:status', 'logistics:companies',
  
  // 售后管理
  'aftersale', 'aftersale:order', 'aftersale:view:all', 'aftersale:add', 'aftersale:edit', 
  'aftersale:delete', 'aftersale:analysis',
  
  // 资料管理
  'data', 'data:customer', 'data:customer:search', 'data:import', 'data:export', 
  'data:list', 'data:recycle',
  
  // 商品管理
  'sales:product', 'sales:product:view', 'sales:product:add', 'sales:product:edit', 'product:analytics',
  
  // 系统管理（除超管面板）
  'system', 'system:user', 'system:role', 'system:department', 'system:permission', 
  'system:settings', 'customer_service:manage', 'system:message'
]
```

---

### 3. 部门经理 (department_manager)

**数据范围**：本部门数据
**特殊说明**：
- 资料列表仅显示被分配给自己的资料
- 团队业绩可查看本部门所有成员，可点击所有成员的详情

#### 完整权限列表

| 一级菜单 | 二级菜单 | 三级功能 | 查看 | 新增 | 编辑 | 删除 | 其他按钮 | 数据范围 | 备注 |
|----------|----------|----------|:----:|:----:|:----:|:----:|----------|----------|------|
| **数据看板** | 个人看板 | - | ✅ | - | - | - | - | 个人 | |
| | 部门看板 | - | ✅ | - | - | - | - | 部门 | |
| **客户管理** | 客户列表 | 查看客户 | ✅ | - | - | - | - | 部门 | |
| | | 编辑客户 | - | - | ✅ | - | - | 部门 | |
| | | 导入客户 | - | - | - | - | ✅导入 | 部门 | |
| | | 导出客户 | - | - | - | - | ✅导出 | 部门 | |
| | 新增客户 | 创建客户 | - | ✅ | - | - | - | - | |
| | 客户分组 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 客户标签 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **订单管理** | 订单列表 | 查看订单 | ✅ | - | - | - | - | 部门 | |
| | | 编辑订单 | - | - | ✅ | - | - | 部门 | |
| | 新增订单 | 创建订单 | - | ✅ | - | - | - | - | |
| | 订单审核 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **服务管理** | 通话管理 | 查看通话 | ✅ | - | - | - | - | 部门 | |
| | | 新增通话 | - | ✅ | - | - | - | - | |
| | | 编辑通话 | - | - | ✅ | - | - | 部门 | |
| | 短信管理 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **业绩统计** | 个人业绩 | 查看业绩 | ✅ | - | - | - | - | 个人 | |
| | 团队业绩 | 查看团队 | ✅ | - | - | - | ✅查看详情 | 部门 | 可点击所有成员 |
| | | 点击单量 | - | - | - | - | ✅全部可点 | 部门 | |
| | 业绩分析 | 查看分析 | ✅ | - | - | - | - | 部门 | |
| | 业绩分享 | 查看分享 | ✅ | - | - | - | - | 部门 | |
| | | 新增分享 | - | ✅ | - | - | - | - | |
| | | 编辑分享 | - | - | ✅ | - | - | 部门 | |
| **物流管理** | 发货列表 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 物流列表 | 查看物流 | ✅ | - | - | - | - | 部门 | |
| | 物流跟踪 | 查看跟踪 | ✅ | - | - | - | - | 部门 | |
| | 状态更新 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 物流公司 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **售后管理** | 售后订单 | 查看售后 | ✅ | - | - | - | - | 部门 | |
| | 新建售后 | 创建售后 | - | ✅ | - | - | - | - | |
| | 售后数据 | 查看数据 | ✅ | - | - | - | - | 部门 | |
| | | 数据分析 | - | - | - | - | ✅分析 | 部门 | |
| **资料管理** | 资料列表 | 查看资料 | ✅ | - | - | - | - | 仅分配给自己 | 特殊限制 |
| | | 分配资料 | - | - | - | - | ✅分配 | 部门成员 | 可再分配 |
| | 客户查询 | 基础搜索 | ✅ | - | - | - | - | 全部 | |
| | | 高级搜索 | ✅ | - | - | - | - | 全部 | |
| | 回收站 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **商品管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **系统管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |

#### 权限代码列表
```typescript
permissions: [
  // 数据看板
  'dashboard', 'dashboard.personal', 'dashboard.personal.view', 
  'dashboard.department', 'dashboard.department.view',
  
  // 客户管理（禁止：客户分组、客户标签）
  'customer', 'customer.list', 'customer.list.view', 'customer.list.edit', 
  'customer.list.export', 'customer.list.import', 'customer.add', 'customer.add.create',
  
  // 订单管理
  'order', 'order.list', 'order.list.view', 'order.list.edit', 
  'order.add', 'order.add.create',
  
  // 服务管理（禁止：短信管理）
  'service', 'service.call', 'service.call.view', 'service.call.make',
  
  // 业绩统计
  'performance', 'performance.personal', 'performance.personal.view',
  'performance.team', 'performance.team.view', 
  'performance.analysis', 'performance.analysis.view',
  'performance.share', 'performance.share.view',
  
  // 物流管理（禁止：发货列表、状态更新）
  'logistics', 'logistics.list', 'logistics.list.view',
  'logistics.track', 'logistics.track.view',
  
  // 售后管理
  'afterSales', 'afterSales.list', 'afterSales.list.view',
  'afterSales.add', 'afterSales.add.create',
  'afterSales.data', 'afterSales.data.view', 'afterSales.data.analysis',
  
  // 资料管理（禁止：回收站）
  'data', 'data.search', 'data.search.basic', 'data.search.advanced'
]
```

---


### 4. 销售员 (sales_staff)

**数据范围**：个人数据
**特殊说明**：
- 资料列表完全禁止访问
- 团队业绩可查看本部门所有成员，但只能点击自己行的详情
- 订单数据可查看同部门订单（用于团队业绩统计）

#### 完整权限列表

| 一级菜单 | 二级菜单 | 三级功能 | 查看 | 新增 | 编辑 | 删除 | 其他按钮 | 数据范围 | 备注 |
|----------|----------|----------|:----:|:----:|:----:|:----:|----------|----------|------|
| **数据看板** | 个人看板 | - | ✅ | - | - | - | - | 个人 | |
| | 部门看板 | - | ❌ | - | - | - | - | - | 不可访问 |
| **客户管理** | 客户列表 | 查看客户 | ✅ | - | - | - | - | 个人 | 仅自己的客户 |
| | 新增客户 | 创建客户 | - | ✅ | - | - | - | - | |
| | 客户分组 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 客户标签 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **订单管理** | 订单列表 | 查看订单 | ✅ | - | - | - | - | 部门 | 可查看同部门 |
| | | 编辑订单 | - | - | ✅ | - | - | 个人 | 仅自己的订单 |
| | 新增订单 | 创建订单 | - | ✅ | - | - | - | - | |
| | 订单审核 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **服务管理** | 通话管理 | 查看通话 | ✅ | - | - | - | - | 个人 | |
| | | 新增通话 | - | ✅ | - | - | - | - | |
| | | 编辑通话 | - | - | ✅ | - | - | 个人 | |
| | 短信管理 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **业绩统计** | 个人业绩 | 查看业绩 | ✅ | - | - | - | - | 个人 | |
| | 团队业绩 | 查看团队 | ✅ | - | - | - | ⚠️仅自己行 | 部门 | 特殊限制 |
| | | 点击单量 | - | - | - | - | ⚠️仅自己行 | 部门 | 特殊限制 |
| | 业绩分析 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| | 业绩分享 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **物流管理** | 发货列表 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 物流列表 | 查看物流 | ✅ | - | - | - | - | 部门 | |
| | 物流跟踪 | 查看跟踪 | ✅ | - | - | - | - | 部门 | |
| | 状态更新 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 物流公司 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **售后管理** | 售后订单 | 查看售后 | ✅ | - | - | - | - | 个人 | |
| | 新建售后 | 创建售后 | - | ✅ | - | - | - | - | |
| | 售后数据 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **资料管理** | 资料列表 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| | 客户查询 | 基础搜索 | ✅ | - | - | - | - | 全部 | 仅基础搜索 |
| | | 高级搜索 | ❌ | - | - | - | - | - | 不可用 |
| | 回收站 | - | ❌ | ❌ | ❌ | ❌ | - | - | **禁止访问** |
| **商品管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **系统管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |

#### 权限代码列表
```typescript
permissions: [
  // 数据看板
  'dashboard', 'dashboard.personal', 'dashboard.personal.view',
  
  // 客户管理（禁止：客户分组、客户标签）
  'customer', 'customer.list', 'customer.list.view',
  'customer.add', 'customer.add.create',
  
  // 订单管理（添加编辑订单权限）
  'order', 'order.list', 'order.list.view', 'order.list.edit',
  'order.add', 'order.add.create',
  
  // 服务管理（禁止：短信管理）
  'service', 'service.call', 'service.call.view', 'service.call.make',
  
  // 业绩统计（禁止：业绩分析、业绩分享）
  'performance', 'performance.personal', 'performance.personal.view',
  'performance.team', 'performance.team.view',
  
  // 物流管理（禁止：发货列表、状态更新）
  'logistics', 'logistics.list', 'logistics.list.view',
  'logistics.track', 'logistics.track.view',
  
  // 售后管理（禁止：售后数据分析）
  'afterSales', 'afterSales.list', 'afterSales.list.view',
  'afterSales.add', 'afterSales.add.create',
  
  // 资料管理（禁止：资料列表、回收站）
  'data', 'data.search', 'data.search.basic'
]
```

---

### 5. 客服 (customer_service)

**数据范围**：全公司数据（特定功能）
**特殊说明**：
- 专注于订单审核、物流处理和售后服务
- 不能访问客户管理、订单列表、业绩统计等销售相关功能

#### 完整权限列表

| 一级菜单 | 二级菜单 | 三级功能 | 查看 | 新增 | 编辑 | 删除 | 其他按钮 | 数据范围 | 备注 |
|----------|----------|----------|:----:|:----:|:----:|:----:|----------|----------|------|
| **数据看板** | 个人看板 | - | ✅ | - | - | - | - | 个人 | |
| | 部门看板 | - | ❌ | - | - | - | - | - | 不可访问 |
| **客户管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **订单管理** | 订单列表 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| | 新增订单 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| | 订单审核 | 查看待审核 | ✅ | - | - | - | - | 全部 | |
| | | 审核通过 | - | - | - | - | ✅通过 | 全部 | |
| | | 审核拒绝 | - | - | - | - | ✅拒绝 | 全部 | |
| **服务管理** | 通话管理 | 查看通话 | ✅ | - | - | - | - | 全部 | |
| | 短信管理 | 查看短信 | ✅ | - | - | - | - | 全部 | |
| | | 发送短信 | - | ✅ | - | - | - | - | |
| **业绩统计** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **物流管理** | 发货列表 | 查看发货 | ✅ | - | - | - | - | 全部 | |
| | | 新增发货 | - | ✅ | - | - | - | - | |
| | | 编辑发货 | - | - | ✅ | - | - | 全部 | |
| | 物流列表 | 查看物流 | ✅ | - | - | - | - | 全部 | |
| | 物流跟踪 | 查看跟踪 | ✅ | - | - | - | - | 全部 | |
| | | 更新跟踪 | - | - | ✅ | - | - | 全部 | |
| | 状态更新 | 查看状态 | ✅ | - | - | - | - | 全部 | |
| | | 更新状态 | - | - | ✅ | - | - | 全部 | |
| | 物流公司 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **售后管理** | 售后订单 | 查看售后 | ✅ | - | - | - | - | 全部 | |
| | 新建售后 | 创建售后 | - | ✅ | - | - | - | - | |
| | 售后数据 | 查看数据 | ✅ | - | - | - | - | 全部 | |
| | | 数据分析 | - | - | - | - | ✅分析 | 全部 | |
| **资料管理** | 资料列表 | 查看资料 | ✅ | - | - | - | - | 全部 | |
| | | 分配资料 | - | - | - | - | ✅分配 | 全部 | |
| | 客户查询 | 基础搜索 | ✅ | - | - | - | - | 全部 | |
| | | 高级搜索 | ✅ | - | - | - | - | 全部 | |
| | 回收站 | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **商品管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |
| **系统管理** | - | - | ❌ | ❌ | ❌ | ❌ | - | - | 不可访问 |

#### 权限代码列表
```typescript
permissions: [
  // 数据看板
  'dashboard', 'dashboard.personal', 'dashboard.personal.view',
  
  // 订单审核权限
  'order', 'order.audit', 'order.audit.view', 'order.audit.approve', 'order.audit.reject',
  
  // 物流管理权限
  'logistics', 'logistics.list', 'logistics.list.view',
  'logistics.shipping', 'logistics.shipping.view', 'logistics.shipping.create',
  'logistics.track', 'logistics.track.view', 'logistics.track.update',
  'logistics.status', 'logistics.status.view', 'logistics.status.update',
  
  // 售后管理权限
  'afterSales', 'afterSales.list', 'afterSales.list.view',
  'afterSales.add', 'afterSales.add.create',
  'afterSales.data', 'afterSales.data.view', 'afterSales.data.analysis',
  
  // 资料管理权限
  'data', 'data.list', 'data.list.view', 
  'data.search', 'data.search.basic', 'data.search.advanced'
]
```

---


## 五、特殊权限规则说明

### 1. 团队业绩页面权限

| 角色 | 可查看数据 | 单量超链接 | 查看详情按钮 | 说明 |
|------|-----------|:----------:|:------------:|------|
| 超级管理员 | 所有成员 | ✅ 全部可点 | ✅ 全部可点 | 无限制 |
| 管理员 | 所有成员 | ✅ 全部可点 | ✅ 全部可点 | 无限制 |
| 部门经理 | 本部门成员 | ✅ 全部可点 | ✅ 全部可点 | 可管理部门成员 |
| 销售员 | 本部门成员 | ⚠️ 仅自己行 | ⚠️ 仅自己行 | 只能操作自己的数据 |
| 客服 | - | - | - | 无权访问 |

### 2. 资料列表页面权限

| 角色 | 可查看资料 | 分配权限 | 封存权限 | 回收权限 |
|------|-----------|----------|----------|----------|
| 超级管理员 | 所有资料 | ✅ 可分配给任何人 | ✅ | ✅ |
| 管理员 | 所有资料 | ✅ 可分配给任何人 | ✅ | ✅ |
| 部门经理 | 仅被分配给自己的 | ✅ 可再分配给部门成员 | ❌ | ❌ |
| 销售员 | 无 | ❌ | ❌ | ❌ |
| 客服 | 所有资料 | ✅ 可分配资料 | ❌ | ❌ |

### 3. 订单数据权限

| 角色 | 可查看订单范围 | 可编辑订单范围 | 说明 |
|------|---------------|---------------|------|
| 超级管理员 | 所有订单 | 所有订单 | 无限制 |
| 管理员 | 所有订单 | 所有订单 | 无限制 |
| 部门经理 | 本部门所有成员的订单 | 本部门所有成员的订单 | 部门范围 |
| 销售员 | 本部门所有成员的订单 | 仅自己的订单 | 查看用于团队业绩统计 |
| 客服 | 仅订单审核页面 | 仅审核操作 | 不能访问订单列表 |

### 4. 客户数据权限

| 角色 | 可查看客户范围 | 可编辑客户范围 | 说明 |
|------|---------------|---------------|------|
| 超级管理员 | 所有客户 | 所有客户 | 无限制 |
| 管理员 | 所有客户 | 所有客户 | 无限制 |
| 部门经理 | 本部门所有成员的客户 | 本部门所有成员的客户 | 部门范围 |
| 销售员 | 仅自己的客户 | 仅自己的客户 | 个人范围 |
| 客服 | 仅客户查询功能 | 无 | 不能访问客户列表 |

---

## 六、客服子类型权限（扩展）

系统支持客服角色的细分类型，每种类型有不同的权限侧重：

### 1. 售后客服 (customer_service_after_sales)
```typescript
permissions: [
  'dashboard', 'dashboard:view',
  'order', 'order:list', 'order:list:view',
  'aftersale', 'aftersale:order', 'aftersale:order:view', 'aftersale:order:edit',
  'aftersale:add', 'aftersale:data', 'aftersale:data:view',
  'service', 'service:afterSales:view', 'service:afterSales:edit',
  'data', 'data:customer', 'data:customer:search'
]
```

### 2. 审核客服 (customer_service_audit)
```typescript
permissions: [
  'dashboard', 'dashboard:view',
  'order', 'order:list', 'order:list:view', 'order:audit', 'order:audit:view',
  'order:audit:approve', 'order:audit:reject',
  'customer', 'customer:list', 'customer:list:view',
  'data', 'data:customer', 'data:customer:search'
]
```

### 3. 物流客服 (customer_service_logistics)
```typescript
permissions: [
  'dashboard', 'dashboard:view',
  'order', 'order:list', 'order:list:view',
  'logistics', 'logistics:list', 'logistics:list:view', 
  'logistics:shipping', 'logistics:shipping:view', 'logistics:shipping:edit', 
  'logistics:tracking', 'logistics:tracking:view', 'logistics:tracking:edit',
  'logistics:status_update', 'logistics:status_update:edit',
  'data', 'data:customer', 'data:customer:search'
]
```

### 4. 商品客服 (customer_service_product)
```typescript
permissions: [
  'dashboard', 'dashboard:view',
  'customer', 'customer:list', 'customer:list:view',
  'order', 'order:list', 'order:list:view',
  'product', 'product:list', 'product:list:view',
  'data', 'data:customer', 'data:customer:search'
]
```

---

## 七、配置文件位置

| 文件路径 | 说明 | 用途 |
|----------|------|------|
| `src/config/defaultRolePermissions.ts` | 角色默认权限配置 | 定义各角色的权限代码列表 |
| `src/config/menu.ts` | 菜单权限配置 | 定义菜单的角色访问控制 |
| `src/stores/user.ts` | 用户状态管理 | 处理用户登录和权限加载 |
| `src/stores/data.ts` | 资料数据管理 | 资料列表的数据过滤逻辑 |
| `src/views/Performance/Team.vue` | 团队业绩页面 | 团队业绩的权限控制 |
| `backend/src/routes/orders.ts` | 订单API路由 | 订单数据的后端权限过滤 |
| `backend/src/routes/users.ts` | 用户API路由 | 用户数据的后端权限过滤 |

---

## 八、权限修改指南

### 1. 修改菜单访问权限
编辑 `src/config/menu.ts` 中对应菜单的 `roles` 数组：
```typescript
{
  id: 'customer-groups',
  title: '客户分组',
  path: '/customer/groups',
  roles: ['super_admin', 'admin'], // 修改这里
  permissions: ['customer:groups']
}
```

### 2. 修改角色默认权限
编辑 `src/config/defaultRolePermissions.ts` 中对应角色的 `permissions` 数组：
```typescript
department_manager: {
  roleId: 'department_manager',
  roleName: '部门经理',
  permissions: [
    // 在这里添加或删除权限代码
  ]
}
```

### 3. 修改数据范围权限
编辑对应 store 或后端 API 的过滤逻辑，如 `src/stores/data.ts`：
```typescript
if (isDepartmentManager) {
  result = result.filter(item => item.assigneeId === currentUserId)
}
```

### 4. 修改按钮权限
编辑对应 Vue 组件中的条件判断：
```vue
<el-button v-if="userStore.isAdmin || userStore.isDepartmentManager">
  分配
</el-button>
```

---

## 九、注意事项

1. **权限继承**：超级管理员和管理员拥有 `*` 通配符权限，自动拥有所有权限
2. **数据隔离**：部门经理和销售员的数据范围受限，需要在前后端同时实现过滤
3. **特殊限制**：部门经理和销售员禁止的权限（客户分组、标签、短信、发货、状态更新、回收站）需要严格执行
4. **动态配置**：系统支持在"系统管理 → 角色权限"中动态调整权限，调整后会覆盖默认配置
5. **权限缓存**：用户权限会缓存在 localStorage 中，修改权限后需要用户重新登录生效

---

> 文档版本：v2.0
> 
> 维护人员：系统管理员
> 
> 最后更新：2025年12月13日

